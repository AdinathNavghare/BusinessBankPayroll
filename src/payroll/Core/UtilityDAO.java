package payroll.Core;

import java.awt.Color;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.FileWriter;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.text.DateFormat;
import java.text.DecimalFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Date;
import java.util.List;
import java.util.Locale;
import java.util.Properties;

import org.jfree.ui.Align;

import payroll.Core.UtilityDAO.Footer;
import payroll.Core.UtilityDAO.Footer1;
import payroll.DAO.BankStmntHandler;
import payroll.DAO.BranchDAO;
import payroll.DAO.CodeMasterHandler;
import payroll.DAO.ConnectionManager;
import payroll.DAO.EmpOffHandler;
import payroll.DAO.GradeHandler;
import payroll.DAO.LookupHandler;
import payroll.DAO.TranHandler;
import payroll.Model.BankStmntBean;
import payroll.Model.BranchBean;
import payroll.Model.PFExcelBean;
import payroll.Model.RepoartBean;
import payroll.Model.TranBean;
import payroll.Model.TransactionBean;

import com.ibm.icu.text.NumberFormat;
import com.ibm.icu.util.Calendar;
import com.lowagie.text.Chunk;
import com.lowagie.text.Document;
import com.lowagie.text.DocumentException;
import com.lowagie.text.Element;
import com.lowagie.text.ExceptionConverter;
import com.lowagie.text.Font;
import com.lowagie.text.FontFactory;
import com.lowagie.text.Image;
import com.lowagie.text.PageSize;
import com.lowagie.text.Paragraph;
import com.lowagie.text.Phrase;
import com.lowagie.text.Rectangle;
import com.lowagie.text.pdf.ColumnText;
import com.lowagie.text.pdf.GrayColor;
import com.lowagie.text.pdf.PdfPCell;
import com.lowagie.text.pdf.PdfPTable;
import com.lowagie.text.pdf.PdfPageEventHelper;
import com.lowagie.text.pdf.PdfTemplate;
import com.lowagie.text.pdf.PdfWriter;
/**
 * @author Disha
 *
 */
public class UtilityDAO {
	
	static String lable1="";
	static String label2="";
	public class Footer extends PdfPageEventHelper {



		protected Phrase footer;
		protected Phrase header;
		private final  Font footerFont = new Font(Font.TIMES_ROMAN, 12,
				Font.BOLD);
		PdfTemplate total;


		@Override
		public void onOpenDocument(PdfWriter writer, Document document) {
			total = writer.getDirectContent().createTemplate(20, 30);
		}

		public Footer(String lbl)
		{
			UtilityDAO.lable1=lbl;
		}

		@Override
		public void onEndPage(PdfWriter writer, Document document) {

			PdfPTable table = new PdfPTable(3);

			try{
				table.setWidths(new int[]{24,24,2});
				table.setTotalWidth(880);
				table.setLockedWidth(true);
				table.getDefaultCell().setFixedHeight(30);
				table.getDefaultCell().setBorder(Rectangle.BOTTOM);
				table.getDefaultCell().setHorizontalAlignment(Element.ALIGN_RIGHT);
				table.addCell(new Phrase(lable1+"( "+ReportDAO.getSysDate()+" )",footerFont));
				table.addCell(new Phrase(String.format("Page %d of  ", writer.getPageNumber()),footerFont));
				PdfPCell cell = new PdfPCell(Image.getInstance(total));
				cell.setBorder(0);
				cell.setHorizontalAlignment(Align.LEFT);
				//cell.setFixedHeight(72f);
				table.addCell(cell);
				table.writeSelectedRows(0, -1, 2, 35, writer.getDirectContent());


			} 
			catch(DocumentException de){
				throw new ExceptionConverter(de);
			}

		}

		@Override
		public void onCloseDocument(PdfWriter writer, Document document) {
			ColumnText.showTextAligned(total, Element.ALIGN_BOTTOM, new Phrase(String.valueOf(writer.getPageNumber()-1),footerFont),15,20,0);
		}


	}
	public class Footer1 extends PdfPageEventHelper {



		protected Phrase footer;
		protected Phrase header;
		PdfTemplate total;

		private final  Font footerFont = new Font(Font.TIMES_ROMAN, 20,
				Font.BOLD);
		@Override
		public void onOpenDocument(PdfWriter writer, Document document) {
			total = writer.getDirectContent().createTemplate(40, 40);
		}

		public Footer1(String lbl)
		{
			UtilityDAO.lable1=lbl;
		}
		@Override
		public void onEndPage(PdfWriter writer, Document document) {

			PdfPTable table = new PdfPTable(3);

			try{
				table.setWidths(new int[]{24,24,2});
				table.setTotalWidth(2380);
				table.setLockedWidth(true);
				table.getDefaultCell().setFixedHeight(30);
				table.getDefaultCell().setBorder(Rectangle.BOTTOM);
				table.getDefaultCell().setHorizontalAlignment(Element.ALIGN_RIGHT);
				table.addCell(new Phrase(lable1+"( "+ReportDAO.getSysDate()+" )",footerFont));
				table.addCell(new Phrase(String.format("Page %d of  ", writer.getPageNumber()),footerFont));
				PdfPCell cell = new PdfPCell(Image.getInstance(total));
				cell.setBorder(0);
				//cell.setFixedHeight(72f);
				table.addCell(cell);
				table.writeSelectedRows(0, -1, 10, 45, writer.getDirectContent());


			} 
			catch(DocumentException de){
				throw new ExceptionConverter(de);
			}

		}

		@Override
		public void onCloseDocument(PdfWriter writer, Document document) {
			ColumnText.showTextAligned(total, Element.ALIGN_CENTER, new Phrase(String.valueOf(writer.getPageNumber()-1),footerFont),15,20,0);
		}



	}
	public static int dateDiff(String dtDiffIn,java.sql.Date frmDate,java.sql.Date toDt){

		int diff=0;

		if(dtDiffIn.equalsIgnoreCase("D"))
		{
			long d1 = frmDate.getTime();
			long d2 = toDt.getTime();

			long difference = d2-d1;
			diff = (int) (difference /(1000 * 60 * 60 * 24));
		}
		return diff;
	}

	public static void PrintBlankLine(RepoartBean repBean){
		String str1 = "       |                                          |";
		int aCtr = 0;
		for(int i = aCtr+1; i<=12; i++){
			str1 = str1 + ReportDAO.addSpaces("", 14)+"|";
		}
		ReportDAO.println(str1, 10, 1, false, "BANK",repBean);
	}

	public static String GetBranch(int brncd,RepoartBean repBean){
		Statement st;
		String result = "";
		try {
			st = repBean.getCn().createStatement();
			ResultSet rs = st.executeQuery("SELECT * FROM BRANCH WHERE BRCD = "+brncd);
			if (rs.next()) {
				result = rs.getString("BRNAME");
			}else
				result = "not found";
			repBean.getCn().close();

		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return result;

	}

	/*public static void Branch_Footer(){
		bCode = bCode + 1;
		int i = 0;
		for(i = 100;i <= 200;i++){
			bInc[bCode][i] = Inc[i];
		}
		for(i = 200;i <= 300;i++){
			bDed[bCode][i] = ded[i];
		}
		for(i = 1;i <= 4;i++){
			BtotBngd[bCode][i] = TotBngd[i];
		}
		PrintFootLines(Inc, ded, TotBngd, "TOTAL->" + "|" + "Grand Total For Current Month :"+ReportDAO.addSpaces("", 10) + "|");
		PrintFootLines(PInc, PDed, PTotBNGD, "        " + "|" + "Grand Total For Previous Month :"+ReportDAO.addSpaces("", 9) + "|");
		for(i = 100;i <= 200;i++){
			Inc[i] = Math.abs(Inc[i] - PInc[i]);

		}
		for(i = 200;i <= 300;i++){
			ded[i] = Math.abs(ded[i] - PDed[i]);

		}
		for(i = 1;i <= 4;i++){
			TotBngd[i] = Math.abs(TotBngd[i] - PTotBNGD[i]);

		}
		PrintFootLines(Inc, ded, TotBngd, "        " + "|" + "Variance Betwn Previous & Current Month:"+ReportDAO.addSpaces("", 2) + "|");
		for(i = 100;i <= 200;i++){
			Inc[i] = 0;
			PInc[i] = 0;

		}
		for(i = 200;i <= 300;i++){
			ded[i] = 0;
			PDed[i] = 0;

		}
		for(i = 1;i <= 4;i++){
			TotBngd[i] = 0;
			PTotBNGD[i] = 0;

		}
	}*/

	public static void PrintFootLines(int INC1[],int DED1[], int TOTBNGD1[],String s1,RepoartBean repBean)
	{
		String Str1 = "";
		String Str2 = "";
		String Str3 = "";
		String Str4 = "";
		String Arr1 = "";
		String Arr2 = "";
		repBean.setPayrep(true);
		int i = 0;
		for(i = 1; i <= 24; i++){
			if(i <= 12){
				if(repBean.getIcode(i) != 0){
					Str1 = Str1 + FixStr(trans(INC1[repBean.getIcode(i)], "999,99,999.99", "", false, false), 14, 3) + "|";
				}else {
					Str1 = Str1 + ReportDAO.addSpaces("", 14) + "|";
				}
			}else {
				if(repBean.getIcode(i) != 0){
					Str2 = Str2 + FixStr(trans(INC1[repBean.getIcode(i)], "999,99,999.99", "", false, false), 14, 3) + "|";
				}else {
					Str2 = Str2 + ReportDAO.addSpaces("", 14) + "|";
				}
			}

			if(i <= 12){
				if(repBean.getEcode(i) != 0){
					Str3 = Str3 + FixStr(trans(DED1[repBean.getEcode(i)], "999,99,999.99", "", false, false), 14, 3) + "|";
				}else {
					Str3 = Str3 + ReportDAO.addSpaces("", 14) + "|";
				}
			}else {
				if(repBean.getEcode(i) != 0){
					Str4 = Str4 + FixStr(trans(DED1[repBean.getEcode(i)], "999,99,999.99", "", false, false), 14, 3) + "|";
				}else {
					Str4 = Str4 + ReportDAO.addSpaces("", 14) + "|";
				}
			}
		}
		Str1 = s1 + Str1;
		Str2 = ReportDAO.addSpaces("", 7) + "|" + ReportDAO.addSpaces("", 42) + "|" + Str2;
		Str3 = ReportDAO.addSpaces("", 7) + "|" + FixStr(trans(TOTBNGD1[1], "99,99,999.99", "", false, false), 14, 3) + ReportDAO.addSpaces("", 28) + "|" + Str3;
		Str4 = "|" + FixStr(trans(TOTBNGD1[3], "99,99,999.99", "", false, false), 14, 3) + FixStr(trans(TOTBNGD1[4], "99,99,999.99", "", false, false), 14, 3) + FixStr(trans(TOTBNGD1[2], "99,99,999.99", "", false, false), 14, 3) + "|" + Str4;
		Arr1 = "|" + ReportDAO.addSpaces("", 42) + "|";
		Arr2 = "|" + ReportDAO.addSpaces("", 42) + "|";
		ReportDAO.println(Str1, 10, 1, false, "",repBean);
		PrintBlankLine(repBean);

		ReportDAO.println(Str2, 10, 1, false, "",repBean);
		ReportDAO.println(Str3, 10, 1, false, "",repBean);
		PrintBlankLine(repBean);
		ReportDAO.println("", 10, 0, false, "",repBean);
		ReportDAO.println(Str4, 17, 1, false, "",repBean);
		PrintBlankLine(repBean);

	}

	public static String stringOfSize(int size, char ch)
	{
		final char[] array = new
				char[size];
		Arrays.fill(array, ch);
		return new String(array);
	}

	public static boolean compareDate(String date1, String date2)
	{
		boolean flag = false;
		try
		{

			SimpleDateFormat sdf = new SimpleDateFormat("dd-MMM-yyyy");

			Date Date1 = sdf.parse(date1);
			Date Date2 = sdf.parse(date2);
			if(Date1.compareTo(Date2)>0)
			{
				flag = true;
			}
			else if(Date1.compareTo(Date2)<0)
			{
				flag = false;
			}
			else if(Date1.compareTo(Date2)==0)
			{
				flag = true;
			}
		}
		catch(ParseException ex)
		{
			ex.printStackTrace();
		}
		return flag;
	}

	public static String trans(int p_num,String p_pic,String p_lzc,boolean p_sgn,boolean blankif0)
	{

		String result= Integer.toString(p_num);
		if(!result.contains("-")){
			NumberFormat format = com.ibm.icu.text.NumberFormat.getCurrencyInstance(new Locale("en", "in"));
			
	 result = format.format(p_num).substring(4);

		}
		else
		{
		 result = Integer.toString(p_num);
		}
		int Reslength = result.length();
		int p_picLength = p_pic.length();
		if(Reslength < p_picLength)
		{
			result = ReportDAO.addSpaces("", p_picLength-Reslength) + result;
		}
		return result;
	
	}
	public static String transLeavetoLIC(Double p_num,String p_pic,String p_lzc,boolean p_sgn,boolean blankif0)
	{

		String result= Double.toString(p_num);
		if(!result.contains("-")){
			NumberFormat format = com.ibm.icu.text.NumberFormat.getCurrencyInstance(new Locale("en", "in"));
			
	 result = format.format(p_num).substring(4);

		}
		else
		{
		 result = Double.toString(p_num);
		}
		int Reslength = result.length();
		int p_picLength = p_pic.length();
		if(Reslength < p_picLength)
		{
			result = ReportDAO.addSpaces("", p_picLength-Reslength) + result;
		}
		return result;
	
	}
	
	public static String transString(String p_num,String p_pic,String p_lzc,boolean p_sgn,boolean blankif0)
	{
		NumberFormat format = NumberFormat.getCurrencyInstance(new Locale("en", "in"));
		String result = "                                          ";
		
		return result;
	}
	

	public static String FixStr(String str11,int ctr,int lrc)
	{
		
		//lrc stand for left right, center
		//lrc= 1 for left alignment
		//lrc= 2 for center alignment
		//lrc= 3 for right alignment
		//System.out.println("Before :->"+str11);
		String result = "";
		String s1 = "";
		str11 = str11.trim();
		if(str11.length() > ctr )
		{
			result = str11.substring(0, ctr); //confirm From Mr P H Patil for Mid Functuon 
			return result;
		}
		str11 = str11.trim();
		switch (lrc) 
		{
		case 1: s1 = str11 + ReportDAO.addSpaces("", ctr - str11.length());
		break;
		case 2: s1 = ReportDAO.addSpaces("", (ctr - str11.length()) / 2) + str11 + ReportDAO.addSpaces("", (ctr - str11.length()) / 2);
		break;
		case 3: s1 = ReportDAO.addSpaces("", ctr - str11.length()) + str11;
		break;
		default:
			break;
		}
		if(s1.length() < ctr)
		{
			s1 = s1 + ReportDAO.addSpaces("", ctr - s1.length());
		}
		else
		{
			s1 = s1.substring(0,ctr);//confirm From Mr P H Patil for Mid Functuon 
		}
		result = s1;
		//System.out.println("After :->"+result);
		return result; 
	}

	public static String ltrim(String s) {
		int i = 0;
		while (i < s.length() && Character.isWhitespace(s.charAt(i))) {
			i++;
		}
		return s.substring(i);
	}

	public static String rtrim(String s) {
		int i = s.length()-1;
		while (i >= 0 && Character.isWhitespace(s.charAt(i))) {
			i--;
		}
		return s.substring(0,i+1);
	}

	public static void PaySummary(int s,RepoartBean repBean)
	{
		String str1 = "";
		String str2 = "";
		String str3 = "";
		String str4 = "";

		String Arr1 = "";
		String Arr2 = "";
		String s1 = "       "+"|" + FixStr(" Branch Total For : " + GetBranch(s,repBean), 42, 1) + "|";
		int i;
		repBean.setPayrep(true);
		for(i = 1; i <= 24; i++)
		{
			if(i <= 12)
			{
				if(repBean.getIcode(i) != 0)
				{
					str1 = str1 + FixStr(trans(repBean.getbInc(s,repBean.getIcode(i)), "999,99,999.99", "", false, false), 14, 3) + "|"; //Chk bt ph patil sir
				}
				else 
					str1 = str1 +  ReportDAO.addSpaces("", 14) + "|";
			}
			else if(repBean.getIcode(i) != 0)
			{
				str2 = str2 + FixStr(trans(repBean.getbInc(s,repBean.getIcode(i)), "999,99,999.99", "", false, false), 14, 3) + "|"; //Chk bt ph patil sir
			}
			else 
				str2 = str2 +  ReportDAO.addSpaces("", 14) + "|";

			if(i <= 12)
			{
				if(repBean.getEcode(i) != 0)
				{
					str3 = str3 + FixStr(trans(repBean.getbDed(s,repBean.getEcode(i)), "999,99,999.99", "", false, false), 14, 3) + "|"; //Chk bt ph patil sir
				}
				else 
					str3 = str3 +  ReportDAO.addSpaces("", 14) + "|";
			}
			else if(repBean.getEcode(i) != 0)
			{
				str4 = str4 + FixStr(trans(repBean.getbDed(s,repBean.getEcode(i)), "999,99,999.99", "", false, false), 14, 3) + "|"; //Chk bt ph patil sir
			}
			else 
				str4 = str4 +  ReportDAO.addSpaces("", 14) + "|";
		}

		str1 = s1 + str1;
		str2 = ReportDAO.addSpaces("", 7) + "|" + ReportDAO.addSpaces("", 42) + "|" + str2;
		str3 = ReportDAO.addSpaces("", 7) + "|" + FixStr(trans(repBean.getBtotBngd(s,1), "999,99,999.99", "", false, false), 14, 3) + "|" + str3;
		str4 = "|" + ReportDAO.addSpaces("", 7) + "|" + FixStr(trans(repBean.getBtotBngd(s,3), "999,99,999.99", "", false, false), 14, 3)
				+ ReportDAO.addSpaces("", 7) + "|" + FixStr(trans(repBean.getBtotBngd(s,4), "999,99,999.99", "", false, false), 14, 3) 
				+ ReportDAO.addSpaces("", 7) + "|" + FixStr(trans(repBean.getBtotBngd(s,2), "999,99,999.99", "", false, false), 14, 3) + "|" + str4;
		Arr1 = "|" + ReportDAO.addSpaces("", 42) + "|";
		Arr2 = "|" + ReportDAO.addSpaces("", 42) + "|";
		ReportDAO.println(str1, 0, 1, false, "BANK",repBean);
		PrintBlankLine(repBean);
		ReportDAO.println(str2, 0, 1, false, "BANK",repBean);
		ReportDAO.println(str3, 0, 1, false, "BANK",repBean);
		PrintBlankLine(repBean);
		ReportDAO.println(str4, 0, 1, false, "BANK",repBean);
		PrintBlankLine(repBean);

	}

	//payslip printing
	public static void PaySlipPDF(String dt,String empList,String filepath,String imgpath)
	{

		RepoartBean repBean  = new RepoartBean();
		Statement mst = null;
		try
		{
			Connection Cn = null;
			ReportDAO.OpenCon("", "", "",repBean);
			Cn = repBean.getCn();
			LookupHandler lkp=new LookupHandler();
			ResultSet rs = null;
			ResultSet rs1 = null;
			ResultSet brs=null;
			ResultSet mrs=null;
			ResultSet wrs=null;

			String EmpSql = "";


			float total_amntIN = 0.0f;
			float total_arrIN = 0.0f;
			float total_totIN = 0.0f;

			float total_amntDED = 0.0f;
			float total_arrDED = 0.0f;
			float total_totDED = 0.0f;
			float absent = 0.0f;
			float gross = 0.0f;
			float nodays = 0.0f;
			float paiddays = 0.0f;
			float monthygross = 0.0f;
			float cl = 0;
			float pl = 0;
			float sl = 0;
			float ml = 0;
			nodays = Calculate.getDays(dt);
			SimpleDateFormat sdf=new SimpleDateFormat("dd-MMM-yyyy");
			SimpleDateFormat sdf1=new SimpleDateFormat("dd-MMM-yyyy");
			Date date=sdf.parse(dt);
			String slrydt=dt;

			String dt1="";


			Statement st3 = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);


			EmpSql = "SELECT emp.*,t.ACNO,t.BRANCH,t.GRADE,t.BANK_NAME FROM EMPMAST emp,EMPTRAN t WHERE t.EMPNO = emp.EMPNO" +
					" AND emp.EMPNO in ("+empList+") AND t.EFFDATE = (SELECT MAX(E2.EFFDATE) FROM EMPTRAN E2 " +
					" WHERE E2.EMPNO = emp.EMPNO AND E2.EFFDATE <= '"+dt+"') ORDER BY emp.EMPNO";
			ResultSet rs3 = st3.executeQuery(EmpSql);
			//System.out.println("-----"+EmpSql);

			if(!rs3.next()){
				System.out.println("Recordset EMpty");
			}

			Document doc = new Document();
			PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
			doc.open();
			doc.setPageSize(PageSize.A4);


			rs3.beforeFirst();
			while(rs3.next())
			{

				total_amntIN = 0.0f;
				total_arrIN = 0.0f;
				total_totIN = 0.0f;

				total_amntDED = 0.0f;
				total_arrDED = 0.0f;
				total_totDED = 0.0f;
				absent = 0.0f;
				gross = 0;
				//nodays = 0.0f;
				paiddays = 0.0f;
				monthygross = 0;


				paiddays = nodays;

				String WorkMssage="";
				String BirthdayMessage="";
				String MarrdMessage="";
				String mssgdate="";

				Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);



				Image image1 = Image.getInstance(imgpath);


				Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,10,Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(10);

				Paragraph parab = new Paragraph(title);

				Paragraph param = new Paragraph(title);

				Paragraph paraw = new Paragraph(title);


				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f);

				doc.add(image1);
				doc.add(para);


				para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir Circle, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Tel : 0253-2406100, 2469545",new Font(Font.TIMES_ROMAN,10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
//				para = new Paragraph(new Phrase("Email : hrd@namcobank.in",new Font(Font.TIMES_ROMAN,10)));
//				para.setAlignment(Element.ALIGN_CENTER);
//				para.setSpacingAfter(0);
//
//				doc.add(para);
				para = new Paragraph(new Phrase("Salary Slip For "+slrydt.substring(3),new Font(Font.TIMES_ROMAN,10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				sdf=new SimpleDateFormat("yyyy-MM-dd");
				dt=sdf.format(date);
				String qery="SELECT e.empno,e.fname,e.dob FROM empmast e WHERE MONTH(e.dob) = MONTH('"+dt+"') and e.empno="+rs3.getInt("empno");
				mst=Cn.createStatement();

				brs = mst.executeQuery(qery);
				while(brs.next())
				{

					BirthdayMessage = ReportDAO.getWishMessage("BIRTHDAY", Cn);
					BirthdayMessage="***"+BirthdayMessage+"( "+sdf1.format(brs.getDate("dob"))+" ) !!!";
				}
				brs.close();


				mrs = mst.executeQuery("SELECT e.empno,e.fname,e.MARRIEDDT FROM empmast e WHERE MONTH(e.MARRIEDDT) = MONTH('"+dt+"') and e.empno="+rs3.getInt("empno"));
				while(mrs.next())
				{
					MarrdMessage = ReportDAO.getWishMessage("WEDDING", Cn);
					MarrdMessage="***"+MarrdMessage+"( "+sdf1.format(mrs.getDate("MARRIEDDT"))+" )  !!!";
				}
				mrs.close();

				wrs = mst.executeQuery("SELECT e.empno,e.fname,e.doj FROM empmast e WHERE MONTH(e.doj) = MONTH('"+dt+"') and e.empno="+rs3.getInt("empno"));
				while(wrs.next())
				{
					WorkMssage = ReportDAO.getWishMessage("WORK", Cn);
					WorkMssage="***"+WorkMssage+"( "+sdf1.format(wrs.getDate("doj"))+" ) !!!";

				}
				wrs.close();


				parab = new Paragraph(new Phrase(""+BirthdayMessage,new Font(Font.TIMES_ROMAN,10,FONT.BOLDITALIC)));
				parab.setAlignment(Element.ALIGN_LEFT);
				param = new Paragraph(new Phrase(""+MarrdMessage,new Font(Font.TIMES_ROMAN,10,FONT.BOLDITALIC)));
				param.setAlignment(Element.ALIGN_LEFT);
				paraw = new Paragraph(new Phrase(""+WorkMssage,new Font(Font.TIMES_ROMAN,10,FONT.BOLDITALIC)));
				paraw.setAlignment(Element.ALIGN_LEFT);




				//System.out.println("BMssg=> "+BirthdayMessage+" Wmssg=> "+WorkMssage+" Mmssg=> "+MarrdMessage);




				Rectangle rec = new  Rectangle(100,100);

				PdfPTable tab = new PdfPTable(1);
				tab.setSpacingBefore(40);
				tab.setWidthPercentage(new float[]{100}, rec);
				tab.setHorizontalAlignment(Element.ALIGN_LEFT);


				PdfPTable tabt = new PdfPTable(1);
				tabt.setWidthPercentage(new float[]{100}, rec);
				tabt.setHorizontalAlignment(Element.ALIGN_LEFT);

				PdfPTable tabsec = new PdfPTable(2);
				tabsec.setWidthPercentage(new float[]{50,50}, new Rectangle(100,100));
				tabsec.setHorizontalAlignment(Element.ALIGN_LEFT);



				PdfPCell cell = new PdfPCell();
				PdfPCell cellt = new PdfPCell();


				PdfPTable tab1 = new PdfPTable(4);
				PdfPTable tab2 = new PdfPTable(4);


				PdfPTable tab3 = new PdfPTable(2);
				PdfPTable tab4 = new PdfPTable(2);

				PdfPTable tab5 = new PdfPTable(4);
				PdfPTable tab6 = new PdfPTable(4);

				PdfPTable tab7 = new PdfPTable(4);
				PdfPTable tab8 = new PdfPTable(4);
				PdfPTable tab9 = new PdfPTable(4);
				PdfPTable tab10 = new PdfPTable(2);


				PdfPCell cell3 = new PdfPCell();
				PdfPCell cell4 = new PdfPCell();

				PdfPCell cell5 = new PdfPCell();
				PdfPCell cell6 = new PdfPCell();
				PdfPCell cell7 = new PdfPCell();
				//PdfPCell cell8 = new PdfPCell();

				Statement st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
				Statement st1 = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
				boolean isRecord = false;	
				String frmTable = "";
				rs = st.executeQuery("select trndt  from PAYTRAN where empno="+rs3.getInt("EMPNO")+" and TRNDT  LIKE '"+dt.substring(0,7)+"%' order by trncd");

				if(rs.next())
				{
					frmTable = "PAYTRAN";
					isRecord = true;
					dt1=rs.getString("TRNDT");
					//rs1 = st1.executeQuery("select distinct(trncd)  from PAYTRAN where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' order by trncd");
					rs1 = st1.executeQuery("select distinct(pay.trncd)  from PAYTRAN pay,cdmast cd where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by trncd");

				}	
				else
				{
					rs = st.executeQuery("select trndt  from YTDTRAN where empno="+rs3.getInt("EMPNO")+" and TRNDT  LIKE '"+dt.substring(0,7)+"%' order by trncd");
					if(rs.next())
					{
						frmTable = "YTDTRAN";
						isRecord = true;
						dt1=rs.getString("TRNDT");
						//rs1 = st1.executeQuery("select distinct(trncd)  from YTDTRAN where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' order by trncd");
						rs1 = st1.executeQuery("select distinct(pay.trncd)  from YTDTRAN pay,cdmast cd where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by trncd");

					}
					else
					{
						rs = st.executeQuery("select trndt  from PAYTRAN_STAGE where empno="+rs3.getInt("EMPNO")+" and TRNDT  LIKE '"+dt.substring(0,7)+"%' order by trncd");
						if(rs.next())
							frmTable = "PAYTRAN_STAGE";
						isRecord = true;
						dt1=rs.getString("TRNDT");
						rs1 = st1.executeQuery("select distinct(pay.trncd)  from PAYTRAN_STAGE pay,cdmast cd where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by trncd");

					}

				}


				ArrayList<TranBean> trblist= new ArrayList<TranBean>();
				TranBean tb;
				TranHandler th = new TranHandler();
				TransactionBean trbn = new EmpOffHandler().getInfoEmpTran(rs3.getString("EMPNO"));

				if(isRecord){
					while(rs1.next())
					{

						tb = new TranBean();
						tb=th.getPaySlipTran(rs3.getInt("EMPNO"), rs1.getInt(1), 0, dt1,frmTable);
						trblist.add(tb);


					}

					SimpleDateFormat from = new SimpleDateFormat("yyyy-MM-dd");
					SimpleDateFormat to = new SimpleDateFormat("dd-MMM-yyyy");
					Date d = from.parse(dt);
					String monthDate = to.format(d);
					//	System.out.println(monthDate);

					ResultSet rs7 = null;
					Statement statement = repBean.getCn().createStatement();
					rs7=statement.executeQuery("select "+Calculate.getDays(monthDate)+" - DAY(DOJ)+1 from empmast where empno ="+rs3.getInt("EMPNO")+" and doj between cast('"+ReportDAO.BOM(monthDate)+"' as DATE) and cast('"+ReportDAO.EOM(monthDate)+"' as DATE)");
					if(rs7.next())
					{
						paiddays = rs7.getFloat(1);
					}
					//=== For Date of Leaving in same Month 
					rs7=statement.executeQuery("select "+paiddays+" - (DAY(cast('"+ReportDAO.EOM(monthDate)+"' as DATE))- DAY(DOL)) from empmast where empno ="+rs3.getInt("EMPNO")+" and dol between cast('"+ReportDAO.BOM(monthDate)+"' as DATE) and cast('"+ReportDAO.EOM(monthDate)+"' as DATE)");
					if(rs7.next())
					{
						/*int day = rs7.getInt(1);
				paiddays = day;*/
						paiddays = rs7.getFloat(1);
					}

					tab3.setWidthPercentage(new float[]{50,50},new Rectangle(100,100));
					PdfPCell subcell3 = new PdfPCell(new Phrase("INCOME ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell3.setColspan(2);
					subcell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab3.addCell(subcell3);

					tab4.setWidthPercentage(new float[]{50,50},new Rectangle(100,100));
					PdfPCell subcell5 = new PdfPCell(new Phrase("DEDUCTIONS ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell5.setColspan(2);
					subcell5.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab4.addCell(subcell5);

					tab5.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcell4 = new PdfPCell(new Phrase("Salary & Allowances ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcell4);


					PdfPCell subcellin = new PdfPCell(new Phrase("Amount.(Rs)",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcellin.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcellin);


					PdfPCell subcellin1 = new PdfPCell(new Phrase("Arrears ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcellin1.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcellin1);


					PdfPCell subcellin2 = new PdfPCell(new Phrase("Total ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcellin2.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcellin2);


					tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellout1 = new PdfPCell(new Phrase("Deductions ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcellout1.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout1);

					tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellout2 = new PdfPCell(new Phrase("Amount.(Rs) ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcellout2.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout2);

					tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellout3 = new PdfPCell(new Phrase("Arrears ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcellout3.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout3);

					tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellout4 = new PdfPCell(new Phrase("Total ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcellout4.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout4);


					for(TranBean trbn1 : trblist )
					{
						if(trbn1.getTRNCD()<199 && trbn1.getTRNCD()!=127  )
						{

							tab5.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells = new PdfPCell(new Phrase(""+CodeMasterHandler.getCDesc(trbn1.getTRNCD()),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
							subcells.setHorizontalAlignment(Element.ALIGN_LEFT);
							tab5.addCell(subcells);

							tab5.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells1 = new PdfPCell(new Phrase(""+trbn1.getCAL_AMT(),new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
							subcells1.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab5.addCell(subcells1);

							tab5.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells2 = new PdfPCell(new Phrase(""+trbn1.getARR_AMT(),new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
							subcells2.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab5.addCell(subcells2);

							tab5.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells3 = new PdfPCell(new Phrase(""+trbn1.getNET_AMT(),new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
							subcells3.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab5.addCell(subcells3);

							total_amntIN = total_amntIN + trbn1.getCAL_AMT() ;
							total_arrIN = total_arrIN + trbn1.getARR_AMT();
							total_totIN = total_totIN + trbn1.getNET_AMT();



						}

						else if(300 > trbn1.getTRNCD() && trbn1.getTRNCD()>200 )
						{

							tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells = new PdfPCell(new Phrase(""+CodeMasterHandler.getCDesc(trbn1.getTRNCD()),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
							subcells.setHorizontalAlignment(Element.ALIGN_LEFT);
							tab6.addCell(subcells);

							tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells1 = new PdfPCell(new Phrase(""+trbn1.getCAL_AMT(),new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
							subcells1.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab6.addCell(subcells1);

							tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells2 = new PdfPCell(new Phrase(""+trbn1.getARR_AMT(),new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
							subcells2.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab6.addCell(subcells2);

							tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells3 = new PdfPCell(new Phrase(""+trbn1.getNET_AMT(),new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
							subcells3.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab6.addCell(subcells3);

							total_amntDED = total_amntDED + trbn1.getCAL_AMT();
							total_arrDED = total_arrDED + trbn1.getARR_AMT();
							total_totDED = total_totDED + trbn1.getNET_AMT();
						}
						if(trbn1.getTRNCD()==301)
						{
							absent = trbn1.getCAL_AMT();
							paiddays =paiddays-absent;
						}
						if(trbn1.getTRNCD()==199)
						{
							gross = trbn1.getINP_AMT();
						}



						monthygross = (int)gross-Math.round(((gross/nodays)*absent));


					}
					tab7.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltin = new PdfPCell(new Phrase("Gross Salary",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltin.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin);

					tab7.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltin1 = new PdfPCell(new Phrase(""+total_amntIN,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcelltin1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin1);

					tab7.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltin2 = new PdfPCell(new Phrase(""+total_arrIN,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltin2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin2);

					tab7.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltin3 = new PdfPCell(new Phrase(""+total_totIN,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltin3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin3);



					tab8.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltded = new PdfPCell(new Phrase("TOTAL DEDUCTION",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltded.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded);

					tab8.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltded1 = new PdfPCell(new Phrase(""+total_amntDED,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltded1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded1);

					tab8.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltded2 = new PdfPCell(new Phrase(""+total_arrDED,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltded2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded2);

					tab8.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltded3 = new PdfPCell(new Phrase(""+total_totDED,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltded3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded3);

					tab9.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellts = new PdfPCell(new Phrase("Net Salary",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcellts.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab9.addCell(subcellts);

					tab9.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellts1 = new PdfPCell(new Phrase(""+( total_totIN-total_totDED),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcellts1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab9.addCell(subcellts1);

					tab9.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellts2 = new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcellts2.setColspan(2);
					subcellts2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab9.addCell(subcellts2);

					tab10.setWidthPercentage(new float[]{50,50},new Rectangle(100,100));
					PdfPCell subcellt = new PdfPCell(new Phrase("Net Salary In Words :- "+originalNumToLetter.getInWords(""+(int)(total_totIN - total_totDED)),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcellt.setHorizontalAlignment(Element.ALIGN_LEFT);
					subcellt.setColspan(2);
					tab10.addCell(subcellt);



					tab1.setWidthPercentage(new float[]{25,25,25,25},new Rectangle(100,100));
					PdfPCell subcell = new PdfPCell(new Phrase("Employee Number ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""+trbn.getEMPCODE(),new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Employee Name ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);


					subcell = new PdfPCell(new Phrase(""+trbn.getEmpname(),new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Department ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);


					subcell = new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("DEPT", trbn.getDept()),new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Designation ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);


					subcell = new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("DESIG", trbn.getDesg()),new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Bank Name ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);


					subcell = new PdfPCell(new Phrase(""+lkp.getLKP_Desc("BANK",rs3.getInt("BANK_NAME")),new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("A/No. ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);


					subcell = new PdfPCell(new Phrase(""+trbn.getAccno(),new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("PF No ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);


					subcell = new PdfPCell(new Phrase(""+trbn.getPfno(),new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("PAN No. ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);


					subcell = new PdfPCell(new Phrase(""+trbn.getPanno(),new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("ESI No. ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);


					subcell = new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					String lesql="SELECT SUM(TOTDR) AS TOTDED,LEAVECD FROM LEAVEBAL WHERE BALDT BETWEEN '"+ReportDAO.BOM(slrydt)+"' AND '"+ReportDAO.EOM(slrydt)+"' AND LEAVECD=1 AND EMPNO="+rs3.getInt("EMPNO")+" GROUP BY LEAVECD";
					cl=0;
					pl=0;
					sl=0;
					ml=0;
					ResultSet rsleave = st1.executeQuery(lesql);
					while(rsleave.next())
					{
						String leave = new LookupHandler().getLKP_Desc("LEAVE",rsleave.getInt(2));

						if(leave.equalsIgnoreCase("PL")){
							pl = rsleave.getFloat("TOTDED");
						}
						/*if(leave.equalsIgnoreCase("CL")){
					cl = rsleave.getInt(1);
				}
				if(leave.equalsIgnoreCase("SL")){
					sl = rsleave.getInt(1);
				}
				if(leave.equalsIgnoreCase("ML")){
					ml = rsleave.getInt(1);
				}*/
					}
					/*cl=0;
			pl=0;
			sl=0;
			ml=0;
			int otherlv=0;
			st1 = Cn.createStatement();
			rs1= st1.executeQuery("SELECT DISTINCT(LEAVECD) FROM LEAVEBAL WHERE EMPNO="+rs3.getInt("EMPNO")+" ORDER BY LEAVECD");
			while(rs1.next())
			{
				if(rs1.getInt(1) == 4){
					st = Cn.createStatement();
					rs=st.executeQuery("SELECT SUM(DAYS) FROM LEAVETRAN WHERE TRNDATE BETWEEN '"+ReportDAO.BOM(slrydt)+"' AND '"+ReportDAO.EOM(slrydt)+"' " +
										"AND LEAVECD="+rs1.getInt(1)+" AND EMPNO="+rs3.getInt("EMPNO")+" AND STATUS='SANCTION' GROUP BY LEAVECD");
					if(rs.next()){
							otherlv = rs.getInt(1);
					}
					rs.close();
					st.close();
				}
				st = Cn.createStatement();
				rs=st.executeQuery("SELECT TOP 1 * FROM LEAVEBAL WHERE BALDT<='"+ReportDAO.EOM(slrydt)+"' AND LEAVECD="+rs1.getInt(1)+" AND EMPNO="+rs3.getInt("EMPNO")+" ORDER BY BALDT DESC");
				if(rs.next())
				{
					String leave = new LookupHandler().getLKP_Desc("LEAVE",rs.getInt(3));

					if(leave.equalsIgnoreCase("PL")){
						pl = rs.getFloat("BAL");
					}
					if(leave.equalsIgnoreCase("CL")){
						cl = rs.getFloat("BAL");
					}
					if(leave.equalsIgnoreCase("SL")){
						sl = rs.getFloat("BAL");
					}
					if(leave.equalsIgnoreCase("ML")){
						ml = rs.getFloat("BAL");
					}
				}
				rs.close();
				st.close();
			}
			rs1.close();
			st1.close();*/

					tab2.setWidthPercentage(new float[]{25,25,25,25},new Rectangle(100,100));
					PdfPCell subcell2 = new PdfPCell(new Phrase("Date Of Joining ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+trbn.getDOJ(),new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Paid Leave ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);


					subcell2 = new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Gross Amount / Rate (Day)",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);


					subcell2 = new PdfPCell(new Phrase(""+gross,new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);




					subcell2 = new PdfPCell(new Phrase("Sick Leave",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+sl,new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);




					subcell2 = new PdfPCell(new Phrase("Absent",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);


					subcell2 = new PdfPCell(new Phrase(""+absent,new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);




					subcell2 = new PdfPCell(new Phrase("Priviledge Leave",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);


					subcell2 = new PdfPCell(new Phrase(""+pl,new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);




					subcell2 = new PdfPCell(new Phrase("Monthly Gross Payable Amount",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);


					subcell2 = new PdfPCell(new Phrase(""+monthygross,new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);


					subcell2 = new PdfPCell(new Phrase("Casual Leave",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+cl,new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);


					subcell2 = new PdfPCell(new Phrase("Paid Days",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);


					subcell2 = new PdfPCell(new Phrase(""+paiddays,new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);


					subcell2 = new PdfPCell(new Phrase("Maternity Leave",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+ml,new Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);


					tab1.addCell(subcell);
					cell.addElement(tab1);
					tab.addCell(cell);

					tab2.addCell(subcell2);
					cellt.addElement(tab2);
					tabt.addCell(cellt);




					//for loop for getting label and values for payslip income
					//for loop for getting label and values for payslip Deduction

					cell3.addElement(tab3);
					cell3.addElement(tab5);
					cell5.addElement(tab7);
					cell5.addElement(tab9);
					cell7.addElement(tab10);
					cell7.setColspan(2);


					cell4.addElement(tab4);
					cell4.addElement(tab6);
					cell6.addElement(tab8);



					tabsec.addCell(cell3);
					tabsec.addCell(cell4);
					tabsec.addCell(cell5);
					tabsec.addCell(cell6);
					tabsec.addCell(cell7);




					//tab.
					//doc.add(Chunk.NEWLINE);
					doc.add(tab);
					doc.add(tabt);
					doc.add(tabsec);

					doc.add(Chunk.NEWLINE);

					/*if(!(BirthdayMessage.equals("")) ||BirthdayMessage!=null )
			{
				doc.add(parab);
			}
			if(!(MarrdMessage.equals("")) ||MarrdMessage!=null )
			{
				doc.add(param);
			}

			if(!(WorkMssage.equals("")) ||WorkMssage!=null )
			{
				doc.add(paraw);
			}*/

					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);




					para = new Paragraph(new Phrase("For                                                                           ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					para.setAlignment(Element.ALIGN_RIGHT);
					para.setSpacingBefore(40);
					doc.add(para);
					para = new Paragraph(new Phrase("THE BUSINESS CO.OP BANK LTD.                              ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					para.setAlignment(Element.ALIGN_RIGHT);
					para.setSpacingAfter(0);
					doc.add(para);


					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);

					para = new Paragraph(new Phrase("ABC                                             ",new Font(Font.TIMES_ROMAN,10)));
					para.setAlignment(Element.ALIGN_RIGHT);
					para.setSpacingAfter(0);
					doc.add(para);
					para = new Paragraph(new Phrase("Authorised Signture & Stamp                              ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					para.setAlignment(Element.ALIGN_RIGHT);
					para.setSpacingAfter(0);
					doc.add(para);


				}
				doc.newPage();
			}
			doc.close();


			Cn.close();

		}
		catch(Exception e) 
		{
			e.printStackTrace();
		}


	
	}

	public static void PaySlip(String dt,String empList,String filepath, String imagepath)
	{

		System.out.println("Welcome in PaySlip");

		RepoartBean repBean  = new RepoartBean();
		Statement mst = null;
		try
		{
			Connection Cn = null;
			ReportDAO.OpenCon("", "", "",repBean);
			Cn = repBean.getCn();

			ResultSet rs = null;
			ResultSet rs1 = null;
			ResultSet brs=null;
			ResultSet mrs=null;
			ResultSet wrs=null;

			String EmpSql = "";

			float total_amntIN = 0.0f;
			float total_arrIN = 0.0f;
			float total_totIN = 0.0f;
			float total_amntDED = 0.0f;
			float total_arrDED = 0.0f;
			float total_totDED = 0.0f;
			float absent = 0.0f;
			float gross = 0.0f;
			float nodays = 0.0f;
			float paiddays = 0.0f;
			float monthygross = 0.0f;
			float cl = 0;
			float pl = 0;
			float sl = 0;
			float ml = 0;
			float currmonth_cl = 0;
			float currmonth_pl = 0;
			float currmonth_sl = 0;
			float currmonth_ml = 0;
			SimpleDateFormat sdf=new SimpleDateFormat("dd-MMM-yyyy");
			SimpleDateFormat sdf1=new SimpleDateFormat("dd-MMM-yyyy");
			Date date=sdf.parse(dt);
			String slrydt=dt;
			String dt1="";
			String dtmonth="";

			Statement st3 = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);

			EmpSql = "SELECT emp.*,t.ACNO,t.BRANCH,t.GRADE,ps.SITE_NAME,l.LKP_DISC as DEPARTMENT,(select LKP_DISC  from LOOKUP l1 where l1.LKP_CODE='BANK' and l1.LKP_SRNO=t.BANK_NAME)as BANKNAME FROM EMPMAST emp,EMPTRAN t,LOOKUP L,Project_Sites ps WHERE emp.EMPNO = t.EMPNO" +
					" AND emp.EMPNO in ("+empList+") AND t.SRNO=(SELECT MAX(SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO=emp.EMPNO) AND t.DEPT=l.LKP_SRNO AND l.LKP_CODE='DEPT' AND ps.SITE_ID=t.PRJ_SRNO ORDER BY emp.EMPNO";
			ResultSet rs3 = st3.executeQuery(EmpSql);
			System.out.println(EmpSql);
			if(!rs3.next()){
				System.out.println("Recordset EMpty");
			}

			Document doc = new Document();
			PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
			UtilityDAO dao = new UtilityDAO();
			UtilityDAO.lable1 = "Payslip date : ";
			Footer ftr = dao.new Footer(lable1);
			writer.setPageEvent(ftr);
			doc.open();
			doc.setPageSize(PageSize.A4);

			rs3.beforeFirst();
			while(rs3.next())
			{

				total_amntIN = 0.0f;
				total_arrIN = 0.0f;
				total_totIN = 0.0f;
				total_amntDED = 0.0f;
				total_arrDED = 0.0f;
				total_totDED = 0.0f;
				absent = 0.0f;
				gross = 0;
				nodays = 0.0f;
				paiddays = 0.0f;
				monthygross = 0;
				nodays = Calculate.getDays(dt);
				paiddays = nodays;

				String WorkMssage="";
				String BirthdayMessage="";
				String MarrdMessage="";
				String mssgdate="";

				Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 327.5f, 450, 55);

				Image image1 = Image.getInstance(imagepath);

				Properties prop = new Properties();
				try {

					ClassLoader classLoader = Thread.currentThread().getContextClassLoader();
					InputStream stream = classLoader.getResourceAsStream("constant.properties");
					prop.load(stream);
				} catch (Exception e) {
					System.out.println("Error in constant properties Manager " + e);
				}
		
				
				Phrase title = new Phrase(prop.getProperty("bankName2") ,new Font(FONT.TIMES_ROMAN,10,Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);

				Paragraph parab = new Paragraph(title);
				Paragraph param = new Paragraph(title);
				Paragraph paraw = new Paragraph(title);

				image1.scaleAbsolute(70f, 70f);
				image1.setAbsolutePosition(40f, 730f);

				doc.add(image1);
				doc.add(para);


				para = new Paragraph(new Phrase(prop.getProperty("addressForReport"),new Font(Font.TIMES_ROMAN,10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				
				
				doc.add(para);
				para = new Paragraph(new Phrase(prop.getProperty("contactForReport"),new Font(Font.TIMES_ROMAN,10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(prop.getProperty("mailForReport"),new Font(Font.TIMES_ROMAN,10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Pay Slip For the month  "+slrydt.substring(3),new Font(Font.TIMES_ROMAN,10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(15);

				doc.add(para);
				sdf=new SimpleDateFormat("yyyy-MM-dd");
				dt=sdf.format(date);
				
				System.out.println("DATE 4 :"+dt);
				
				String qery="SELECT e.empno,e.fname,e.dob FROM empmast e WHERE MONTH(e.dob) = MONTH('"+dt+"') and e.empno="+rs3.getInt("empno");
				mst=Cn.createStatement();

				brs = mst.executeQuery(qery);
				while(brs.next())
				{

			//		BirthdayMessage = ReportDAO.getWishMessage("BIRTHDAY", Cn);
			//		BirthdayMessage="***"+BirthdayMessage+"( "+sdf1.format(brs.getDate("dob"))+" ) !!!";
				}
				brs.close();


				mrs = mst.executeQuery("SELECT e.empno,e.fname,e.MARRIEDDT FROM empmast e WHERE MONTH(e.MARRIEDDT) = MONTH('"+dt+"') and e.empno="+rs3.getInt("empno"));
				while(mrs.next())
				{
		//			MarrdMessage = ReportDAO.getWishMessage("WEDDING", Cn);
		//			MarrdMessage="***"+MarrdMessage+"( "+sdf1.format(mrs.getDate("MARRIEDDT"))+" )  !!!";
				}
				mrs.close();

				wrs = mst.executeQuery("SELECT e.empno,e.fname,e.doj FROM empmast e WHERE MONTH(e.doj) = MONTH('"+dt+"') and e.empno="+rs3.getInt("empno"));
				while(wrs.next())
				{
		//			WorkMssage = ReportDAO.getWishMessage("WORK", Cn);
		//			WorkMssage="***"+WorkMssage+"( "+sdf1.format(wrs.getDate("doj"))+" ) !!!";

				}
				wrs.close();


				parab = new Paragraph(new Phrase(""+BirthdayMessage,new Font(Font.TIMES_ROMAN,10,FONT.BOLDITALIC)));
				parab.setAlignment(Element.ALIGN_LEFT);
				param = new Paragraph(new Phrase(""+MarrdMessage,new Font(Font.TIMES_ROMAN,10,FONT.BOLDITALIC)));
				param.setAlignment(Element.ALIGN_LEFT);
				paraw = new Paragraph(new Phrase(""+WorkMssage,new Font(Font.TIMES_ROMAN,10,FONT.BOLDITALIC)));
				paraw.setAlignment(Element.ALIGN_LEFT);

 
				Rectangle rec = new  Rectangle(100,100);

				PdfPTable tab = new PdfPTable(1);
				tab.setSpacingBefore(10);
				tab.setWidthPercentage(new float[]{100}, rec);
				tab.setHorizontalAlignment(Element.ALIGN_LEFT);


				PdfPTable tabt = new PdfPTable(1);
				tabt.setWidthPercentage(new float[]{100}, rec);
				tabt.setHorizontalAlignment(Element.ALIGN_LEFT);

				PdfPTable tabsec = new PdfPTable(2);
				tabsec.setWidthPercentage(new float[]{50,50}, new Rectangle(100,100));
				tabsec.setHorizontalAlignment(Element.ALIGN_LEFT);


				PdfPCell cell = new PdfPCell();
				PdfPCell cellt = new PdfPCell();

				PdfPTable tab1 = new PdfPTable(4);
				PdfPTable tab2 = new PdfPTable(5);
				PdfPTable tab3 = new PdfPTable(2);
				PdfPTable tab4 = new PdfPTable(2);
				PdfPTable tab5 = new PdfPTable(4);
				PdfPTable tab6 = new PdfPTable(4);
				PdfPTable tab7 = new PdfPTable(4);
				PdfPTable tab8 = new PdfPTable(4);
				PdfPTable tab9 = new PdfPTable(4);
				PdfPTable tab10 = new PdfPTable(2);


				PdfPCell cell3 = new PdfPCell();
				PdfPCell cell4 = new PdfPCell();
				PdfPCell cell5 = new PdfPCell();
				PdfPCell cell6 = new PdfPCell();
				PdfPCell cell7 = new PdfPCell();
				//PdfPCell cell8 = new PdfPCell();

				Statement st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
				Statement st1 = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
				Statement stt = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);

				boolean isRecord = false;	
				String frmTable = "";
				rs = st.executeQuery("select trndt  from PAYTRAN where empno="+rs3.getInt("EMPNO")+" and TRNDT  LIKE '"+dt.substring(0,7)+"%' order by trncd");

				if(rs.next())
				{
					frmTable = "PAYTRAN";
					isRecord = true;
					dt1=rs.getString("TRNDT");
					//rs1 = st1.executeQuery("select distinct(trncd)  from PAYTRAN where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' order by trncd");
	//				rs1 = st1.executeQuery("select distinct(pay.trncd)  from PAYTRAN pay,cdmast cd where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by trncd");
					rs1 = st1.executeQuery("select distinct(pay.trncd),cd.PRNTSEQNCE  from PAYTRAN pay,cdmast cd where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by cd.PRNTSEQNCE, pay.trncd");

				}
				else
				{
					rs = st.executeQuery("select trndt  from YTDTRAN where empno="+rs3.getInt("EMPNO")+" and TRNDT  LIKE '"+dt.substring(0,7)+"%' order by trncd");
					if(rs.next())
					{
						frmTable = "YTDTRAN";
						isRecord = true;
						dt1=rs.getString("TRNDT");
						//rs1 = st1.executeQuery("select distinct(trncd)  from YTDTRAN where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' order by trncd");
			//			rs1 = st1.executeQuery("select distinct(pay.trncd)  from YTDTRAN pay,cdmast cd where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by trncd");
						rs1 = st1.executeQuery("select distinct(pay.trncd),cd.PRNTSEQNCE  from YTDTRAN pay,cdmast cd where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by cd.PRNTSEQNCE,pay.trncd");
						System.out.println("AJ...  select distinct(pay.trncd),cd.PRNTSEQNCE  from PAYTRAN_STAGE pay,cdmast cd where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by cd.PRNTSEQNCE,pay.trncd");
					}
					else
					{
						rs = st.executeQuery("select trndt  from PAYTRAN_STAGE where empno="+rs3.getInt("EMPNO")+" and TRNDT  LIKE '"+dt.substring(0,7)+"%' order by trncd");
						if(rs.next())
							frmTable = "PAYTRAN_STAGE";
						isRecord = true;
						dt1=rs.getString("TRNDT");
		//				rs1 = st1.executeQuery("select distinct(pay.trncd)  from PAYTRAN_STAGE pay,cdmast cd where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by trncd");
						rs1 = st1.executeQuery("select distinct(pay.trncd),cd.PRNTSEQNCE  from PAYTRAN_STAGE pay,cdmast cd where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by cd.PRNTSEQNCE,pay.trncd");
						
					}

				}


				ArrayList<TranBean> trblist= new ArrayList<TranBean>();
				TranBean tb;
				TranHandler th = new TranHandler();
				TransactionBean trbn = new EmpOffHandler().getInfoEmpTran(rs3.getString("EMPNO"));

				if(isRecord){
					while(rs1.next())
					{
						tb = new TranBean();
						tb=th.getPaySlipTran(rs3.getInt("EMPNO"), rs1.getInt(1), 0, dt1,frmTable);
						trblist.add(tb);
					}

					SimpleDateFormat from = new SimpleDateFormat("yyyy-MM-dd");
					SimpleDateFormat to = new SimpleDateFormat("dd-MMM-yyyy");
					Date d = from.parse(dt);
					String monthDate = to.format(d);
					//	System.out.println(monthDate);

					ResultSet rs7 = null;
					Statement statement = repBean.getCn().createStatement();
					rs7=statement.executeQuery("select "+Calculate.getDays(monthDate)+" - DAY(DOJ)+1 from empmast where empno ="+rs3.getInt("EMPNO")+" and doj between cast('"+ReportDAO.BOM(monthDate)+"' as DATE) and cast('"+ReportDAO.EOM(monthDate)+"' as DATE)");
					if(rs7.next())
					{
						paiddays = rs7.getFloat(1);
					}
					//=== For Date of Leaving in same Month 
					rs7=statement.executeQuery("select "+paiddays+" - (DAY(cast('"+ReportDAO.EOM(monthDate)+"' as DATE))- DAY(DOL)) from empmast where empno ="+rs3.getInt("EMPNO")+" and dol between cast('"+ReportDAO.BOM(monthDate)+"' as DATE) and cast('"+ReportDAO.EOM(monthDate)+"' as DATE)");
					if(rs7.next())
					{
						/*int day = rs7.getInt(1);
				paiddays = day;*/
						paiddays = rs7.getFloat(1);
					}

					tab3.setWidthPercentage(new float[]{50,50},new Rectangle(100,100));
					PdfPCell subcell3 = new PdfPCell(new Phrase("INCOME ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell3.setColspan(2);
					subcell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab3.addCell(subcell3);

					tab4.setWidthPercentage(new float[]{50,50},new Rectangle(100,100));
					PdfPCell subcell5 = new PdfPCell(new Phrase("DEDUCTIONS ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell5.setColspan(2);
					subcell5.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab4.addCell(subcell5);

					tab5.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcell4 = new PdfPCell(new Phrase("Salary & Allowances ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcell4);

					PdfPCell subcellin = new PdfPCell(new Phrase("Amount.(Rs)",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcellin.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcellin);

					PdfPCell subcellin1 = new PdfPCell(new Phrase("Arrears ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcellin1.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcellin1);

					PdfPCell subcellin2 = new PdfPCell(new Phrase("Total ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcellin2.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcellin2);

					tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellout1 = new PdfPCell(new Phrase("Deductions ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcellout1.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout1);

					tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellout2 = new PdfPCell(new Phrase("Amount.(Rs) ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcellout2.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout2);

					tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellout3 = new PdfPCell(new Phrase("Arrears ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcellout3.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout3);

					tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellout4 = new PdfPCell(new Phrase("Total ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcellout4.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout4);


					for(TranBean trbn1 : trblist )
					{
						if(trbn1.getTRNCD()<199 && trbn1.getTRNCD()!=127  )
						{
							String CDdesc="";
							if(trbn1.getTRNCD()==139){
								CDdesc="CLOSING ALLOWANCE";
							}
							else if(trbn1.getTRNCD()==140){
								CDdesc="ARREARS";
							}
							else if(trbn1.getTRNCD()==141){
								CDdesc="ARREARS IN ALLOWANCE";
							}
							
							tab5.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							
							if(trbn1.getTRNCD()==139 || trbn1.getTRNCD()==140 || trbn1.getTRNCD()==141){
								PdfPCell subcells = new PdfPCell(new Phrase(""+CDdesc,new Font(Font.TIMES_ROMAN,6,Font.BOLD)));
								subcells.setHorizontalAlignment(Element.ALIGN_LEFT);
								tab5.addCell(subcells);
							}else{
							PdfPCell subcells = new PdfPCell(new Phrase(""+CodeMasterHandler.getCDesc(trbn1.getTRNCD()),new Font(Font.TIMES_ROMAN,6,Font.BOLD)));
							subcells.setHorizontalAlignment(Element.ALIGN_LEFT);
							tab5.addCell(subcells);
							}
							

							tab5.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells1 = new PdfPCell(new Phrase(""+trbn1.getCAL_AMT(),new Font(Font.TIMES_ROMAN,7,Font.NORMAL)));
							subcells1.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab5.addCell(subcells1);

							tab5.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells2 = new PdfPCell(new Phrase(""+trbn1.getARR_AMT(),new Font(Font.TIMES_ROMAN,7,Font.NORMAL)));
							subcells2.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab5.addCell(subcells2);

							tab5.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells3 = new PdfPCell(new Phrase(""+trbn1.getNET_AMT(),new Font(Font.TIMES_ROMAN,7,Font.NORMAL)));
							subcells3.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab5.addCell(subcells3);

							total_amntIN = total_amntIN + trbn1.getCAL_AMT() ;
							total_arrIN = total_arrIN + trbn1.getARR_AMT();
							total_totIN = total_totIN + trbn1.getNET_AMT();

						}

						else if(300 > trbn1.getTRNCD() && trbn1.getTRNCD()>200 )
						{

							tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells = new PdfPCell(new Phrase(""+CodeMasterHandler.getCDesc(trbn1.getTRNCD()),new Font(Font.TIMES_ROMAN,6,Font.BOLD)));
							subcells.setHorizontalAlignment(Element.ALIGN_LEFT);
							tab6.addCell(subcells);

							tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells1 = new PdfPCell(new Phrase(""+trbn1.getCAL_AMT(),new Font(Font.TIMES_ROMAN,7,Font.NORMAL)));
							subcells1.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab6.addCell(subcells1);

							tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells2 = new PdfPCell(new Phrase(""+trbn1.getARR_AMT(),new Font(Font.TIMES_ROMAN,7,Font.NORMAL)));
							subcells2.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab6.addCell(subcells2);

							tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells3 = new PdfPCell(new Phrase(""+trbn1.getNET_AMT(),new Font(Font.TIMES_ROMAN,7,Font.NORMAL)));
							subcells3.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab6.addCell(subcells3);

							total_amntDED = total_amntDED + trbn1.getCAL_AMT();
							total_arrDED = total_arrDED + trbn1.getARR_AMT();
							total_totDED = total_totDED + trbn1.getNET_AMT();
						}
						if(trbn1.getTRNCD()==301)
						{
							absent = trbn1.getCAL_AMT();
							paiddays =paiddays-absent;
						}
						if(trbn1.getTRNCD()==199)
						{
							gross = trbn1.getINP_AMT();
						}


						monthygross = (int)gross-Math.round(((gross/nodays)*absent));

					}
					tab7.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltin = new PdfPCell(new Phrase("Gross Salary",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltin.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin);

					tab7.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltin1 = new PdfPCell(new Phrase(""+total_amntIN,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltin1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin1);

					tab7.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltin2 = new PdfPCell(new Phrase(""+total_arrIN,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltin2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin2);

					tab7.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltin3 = new PdfPCell(new Phrase(""+total_totIN,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltin3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin3);

					tab8.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltded = new PdfPCell(new Phrase("TOTAL DEDUCTION",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltded.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded);

					tab8.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltded1 = new PdfPCell(new Phrase(""+total_amntDED,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltded1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded1);

					tab8.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltded2 = new PdfPCell(new Phrase(""+total_arrDED,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltded2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded2);

					tab8.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltded3 = new PdfPCell(new Phrase(""+total_totDED,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltded3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded3);

					tab9.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellts = new PdfPCell(new Phrase("Net Salary",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcellts.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab9.addCell(subcellts);

					tab9.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellts1 = new PdfPCell(new Phrase(""+( total_totIN-total_totDED),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcellts1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab9.addCell(subcellts1);

					tab9.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellts2 = new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcellts2.setColspan(2);
					subcellts2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab9.addCell(subcellts2);

					tab10.setWidthPercentage(new float[]{50,50},new Rectangle(100,100));
					PdfPCell subcellt = new PdfPCell(new Phrase("Net Salary In Words :- "+originalNumToLetter.getInWords(""+(int)(total_totIN - total_totDED)),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcellt.setHorizontalAlignment(Element.ALIGN_LEFT);
					subcellt.setColspan(2);
					tab10.addCell(subcellt);


					tab1.setWidthPercentage(new float[]{25,25,25,25},new Rectangle(100,100));
					PdfPCell subcell = new PdfPCell(new Phrase("Employee Code ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""+trbn.getEMPCODE(),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Employee Name ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);


					subcell = new PdfPCell(new Phrase(""+trbn.getEmpname(),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Department/Branch ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""+rs3.getString("DEPARTMENT")+"/"+rs3.getString("SITE_NAME"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Designation ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("DESIG", trbn.getDesg()),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Bank Name ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""+rs3.getString("BANKNAME"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Salary AC/No. ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""+rs3.getString("ACNO"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Uan Number. ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""+rs3.getString("IDENTY"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("PAN No. ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""+trbn.getPanno(),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("ESI No. ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);


					//String lesql="SELECT SUM(TOTDR) AS TOTDED,LEAVECD FROM LEAVEBAL WHERE BALDT BETWEEN '"+ReportDAO.BOM(slrydt)+"' AND '"+ReportDAO.EOM(slrydt)+"' AND LEAVECD=1 AND EMPNO="+rs3.getInt("EMPNO")+" GROUP BY LEAVECD";
					stt = Cn.createStatement();
					ResultSet rsbal= stt.executeQuery("SELECT DISTINCT(LEAVECD)as leavecd FROM LEAVEBAL WHERE EMPNO="+rs3.getInt("EMPNO")+" ORDER BY LEAVECD");
					cl=0;
					pl=0;
					sl=0;
					ml=0;
					while(rsbal.next())
					{
						String currdaysdate=dt.substring(0,8);
						String currdaysdatecurrmonth=currdaysdate+"25";
						
						String lesql="select top 1 l.bal,l.leavecd,lk.LKP_DISC as leavetype from leavebal l,LOOKUP lk WHERE  l.empno="+rs3.getInt("EMPNO")+" AND  l.LEAVECD="+rsbal.getInt("leavecd")+" AND l.LEAVECD=lk.LKP_SRNO AND lk.LKP_CODE='leave' AND l.BALDT<='"+currdaysdatecurrmonth+"'  ORDER BY BALDT DESC,SRNO DESC";
				
						ResultSet rsleave = st1.executeQuery(lesql);
						//String leave = new LookupHandler().getLKP_Desc("LEAVE",rsleave.getInt(2));
						if(rsleave.next()){
							String leave	=	rsleave.getString("leavetype");
							if(leave.equalsIgnoreCase("PL")){
								pl = rsleave.getInt("bal");
							}
							if(leave.equalsIgnoreCase("CL")){
								cl = rsleave.getInt("bal");
							}
							if(leave.equalsIgnoreCase("SL")){
								sl = rsleave.getInt("bal");
							}
							if(leave.equalsIgnoreCase("ML")){
								ml = rsleave.getInt("bal");
								}
						}
			}

					
					
					stt = Cn.createStatement();
					//ResultSet rsbal= stt.executeQuery("SELECT DISTINCT(LEAVECD)as leavecd FROM LEAVEBAL WHERE EMPNO="+rs3.getInt("EMPNO")+" ORDER BY LEAVECD");
					ResultSet rscurrdays= stt.executeQuery("SELECT DISTINCT(LEAVECD)as leavecd FROM LEAVEBAL WHERE EMPNO="+rs3.getInt("EMPNO")+" ORDER BY LEAVECD");
					currmonth_cl=0;
					currmonth_pl=0;
					currmonth_sl=0;
					currmonth_ml=0;
					while(rscurrdays.next())
					{
						System.out.println("dt : "+dt);
						String currdaysdate=dt.substring(0,8);
						String currdaysmonth=dt.substring(5, 7);
						System.out.println("currdaysmonth : "+currdaysmonth);
						String currdaysyear=dt.substring(0,4);
						
						int monthdays=0;
						monthdays=Integer.parseInt(currdaysmonth);
					
						System.out.println("monthdays : "+monthdays);
						
						if(monthdays==1)
						{
							monthdays = 12;
						}
						else
						{
							monthdays=monthdays-1;
						}
						
						//monthdays=monthdays-1;
						
						
						System.out.println("monthdays1 : "+monthdays);
						
						String currdaysdatecurrmonth=currdaysdate+"25";
						//String currdaysdatelastmonth=currdaysyear+"-0"+monthdays+"-26";
						String currdaysdatelastmonth=currdaysyear+"-"+monthdays+"-26";
						
						System.out.println("currdaysdatecurrmonth : "+currdaysdatecurrmonth);
						System.out.println("currdaysdatelastmonth : "+currdaysdatelastmonth);
						
						
						String lesqlcurrdays="SELECT SUM(L.DAYS) AS DAYS, L.LEAVECD, LK.LKP_DISC AS leavetype FROM LEAVETRAN L, LOOKUP LK "
								+ "WHERE L.LEAVECD=LK.LKP_SRNO AND LK.LKP_CODE='LEAVE' AND EMPNO="+rs3.getInt("EMPNO")+" AND L.LEAVECD="+rscurrdays.getInt("leavecd")
								+ "AND L.FRMDT>='"+currdaysdatelastmonth+"' AND L.TODT<='"+currdaysdatecurrmonth+"' AND L.STATUS='SANCTION' AND L.TRNTYPE='D'"
								+ "GROUP BY L.LEAVECD, LK.LKP_DISC";

						
						
						System.out.println("lesqlcurrdays : "+lesqlcurrdays);
						
						ResultSet rsleavecurrdays = st1.executeQuery(lesqlcurrdays);
						//String leave = new LookupHandler().getLKP_Desc("LEAVE",rsleave.getInt(2));
						if(rsleavecurrdays.next()){
							String leave	=	rsleavecurrdays.getString("leavetype");
							if(leave.equalsIgnoreCase("PL")){
								currmonth_pl = rsleavecurrdays.getInt("DAYS");
							}
							if(leave.equalsIgnoreCase("CL")){
								currmonth_cl = rsleavecurrdays.getInt("DAYS");
							}
							if(leave.equalsIgnoreCase("SL")){
								currmonth_sl = rsleavecurrdays.getInt("DAYS");
							}
							if(leave.equalsIgnoreCase("ML")){
								currmonth_ml = rsleavecurrdays.getInt("DAYS");
								}
						}
			}

	
/******************************************PRASAD WORK START***********************************************************************************************************************/							
					tab2.setWidthPercentage(new float[]{25,25,25,15,10},new Rectangle(100,100));
					
					
					PdfPCell subcell2 = new PdfPCell(new Phrase("Date Of Joining ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+trbn.getDOJ(),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);
					
					
					subcell2 = new PdfPCell(new Phrase("Leave Type ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Month Taken Leave",new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);
					
					subcell2 = new PdfPCell(new Phrase("Balance",new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);
					

					subcell2 = new PdfPCell(new Phrase("Gross Amount / Rate (Day)",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+gross,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);


					subcell2 = new PdfPCell(new Phrase("Sick Leave",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+currmonth_sl,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);
					
					subcell2 = new PdfPCell(new Phrase(""+sl,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);
					
					
					subcell2 = new PdfPCell(new Phrase("Absent days",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+absent,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);


					subcell2 = new PdfPCell(new Phrase("Priviledge Leave",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+currmonth_pl,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);
					
					subcell2 = new PdfPCell(new Phrase(""+pl,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					
					subcell2 = new PdfPCell(new Phrase("Monthly Net Payable Amount",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+( total_totIN-total_totDED),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);


					subcell2 = new PdfPCell(new Phrase("Casual Leave",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+currmonth_cl,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);
					
					subcell2 = new PdfPCell(new Phrase(""+cl,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					
					
					subcell2 = new PdfPCell(new Phrase("Paid Days",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+paiddays,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);


					subcell2 = new PdfPCell(new Phrase("Maternity Leave",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+currmonth_ml,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);
					
					subcell2 = new PdfPCell(new Phrase(""+ml,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);
					
					
/******************************************PRASAD WORK END***********************************************************************************************************************/
					tab1.addCell(subcell);
					cell.addElement(tab1);
					tab.addCell(cell);

					tab2.addCell(subcell2);
					cellt.addElement(tab2);
					tabt.addCell(cellt);

					cell3.addElement(tab3);
					cell3.addElement(tab5);
					cell5.addElement(tab7);
					cell5.addElement(tab9);
					cell7.addElement(tab10);
					cell7.setColspan(2);


					cell4.addElement(tab4);
					cell4.addElement(tab6);
					cell6.addElement(tab8);

					tabsec.addCell(cell3);
					tabsec.addCell(cell4);
					tabsec.addCell(cell5);
					tabsec.addCell(cell6);
					tabsec.addCell(cell7);

					doc.add(tab);
					doc.add(tabt);
					doc.add(tabsec);

					doc.add(Chunk.NEWLINE);

					if(!(BirthdayMessage.equals("")) ||BirthdayMessage!=null )
					{
						doc.add(parab);
					}
					if(!(MarrdMessage.equals("")) ||MarrdMessage!=null )
					{
						doc.add(param);
					}

					if(!(WorkMssage.equals("")) ||WorkMssage!=null )
					{
						doc.add(paraw);
					}

					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);




					para = new Paragraph(new Phrase("NOTE:-  1. This is system generated PaySlip, Sign & Stamp not Required.",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(0);
					doc.add(para);
					para = new Paragraph(new Phrase("               "+" "+"2. In Case of Any Descripancy in Salary, Please Contact to Salary Section Immediatly.",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(0);
					doc.add(para);
					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);

				}
				doc.newPage();
				dt=slrydt;
			}
			doc.close();

			Cn.close();

		}
		catch(Exception e) 
		{
			e.printStackTrace();
		}
	
	}
	
	
	public static void PaySlip_OnePage(String dt,String empList,String filepath, String imagepath)
	{


		System.out.println("Welcome in PaySlip_OnePage");

		RepoartBean repBean  = new RepoartBean();
		Statement mst = null;
		try
		{
			Connection Cn = null;
			ReportDAO.OpenCon("", "", "",repBean);
			Cn = repBean.getCn();

			ResultSet rs = null;
			ResultSet rs1 = null;
			ResultSet brs=null;
			ResultSet mrs=null;
			ResultSet wrs=null;

			String EmpSql = "";

			float total_amntIN = 0.0f;
			float total_arrIN = 0.0f;
			float total_totIN = 0.0f;
			float total_amntDED = 0.0f;
			float total_arrDED = 0.0f;
			float total_totDED = 0.0f;
			float absent = 0.0f;
			float gross = 0.0f;
			float nodays = 0.0f;
			float paiddays = 0.0f;
			float monthygross = 0.0f;
			float cl = 0;
			float pl = 0;
			float sl = 0;
			float ml = 0;
			float currmonth_cl = 0;
			float currmonth_pl = 0;
			float currmonth_sl = 0;
			float currmonth_ml = 0;
			SimpleDateFormat sdf=new SimpleDateFormat("dd-MMM-yyyy");
			SimpleDateFormat sdf1=new SimpleDateFormat("dd-MMM-yyyy");
			Date date=sdf.parse(dt);
			String slrydt=dt;
			String dt1="";
			String dtmonth="";

			Statement st3 = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);

			EmpSql = "SELECT emp.*,t.ACNO,t.BRANCH,t.GRADE,ps.SITE_NAME,l.LKP_DISC as DEPARTMENT,(select LKP_DISC  from LOOKUP l1 where l1.LKP_CODE='BANK' and l1.LKP_SRNO=t.BANK_NAME)as BANKNAME FROM EMPMAST emp,EMPTRAN t,LOOKUP L,Project_Sites ps WHERE emp.EMPNO = t.EMPNO" +
					" AND emp.EMPNO in ("+empList+") AND t.SRNO=(SELECT MAX(SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO=emp.EMPNO) AND t.DEPT=l.LKP_SRNO AND l.LKP_CODE='DEPT' AND ps.SITE_ID=t.PRJ_SRNO ORDER BY emp.EMPNO";
			ResultSet rs3 = st3.executeQuery(EmpSql);
			System.out.println(EmpSql);
			if(!rs3.next()){
				System.out.println("Recordset EMpty");
			}

			Document doc = new Document();
			PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
			UtilityDAO dao = new UtilityDAO();
			UtilityDAO.lable1 = "Payslip date : ";
			Footer ftr = dao.new Footer(lable1);
			writer.setPageEvent(ftr);
			doc.open();
			doc.setPageSize(PageSize.A4);

			rs3.beforeFirst();
			while(rs3.next())
			{

				total_amntIN = 0.0f;
				total_arrIN = 0.0f;
				total_totIN = 0.0f;
				total_amntDED = 0.0f;
				total_arrDED = 0.0f;
				total_totDED = 0.0f;
				absent = 0.0f;
				gross = 0;
				nodays = 0.0f;
				paiddays = 0.0f;
				monthygross = 0;
				nodays = Calculate.getDays(dt);
				paiddays = nodays;

				String WorkMssage="";
				String BirthdayMessage="";
				String MarrdMessage="";
				String mssgdate="";

				Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 327.5f, 450, 55);

				Image image1 = Image.getInstance(imagepath);

				Properties prop = new Properties();
				try {

					ClassLoader classLoader = Thread.currentThread().getContextClassLoader();
					InputStream stream = classLoader.getResourceAsStream("constant.properties");
					prop.load(stream);
				} catch (Exception e) {
					System.out.println("Error in constant properties Manager " + e);
				}
		
				
				Phrase title = new Phrase(prop.getProperty("bankName2") ,new Font(FONT.TIMES_ROMAN,10,Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);

				Paragraph parab = new Paragraph(title);
				Paragraph param = new Paragraph(title);
				Paragraph paraw = new Paragraph(title);

				image1.scaleAbsolute(70f, 70f);
				image1.setAbsolutePosition(40f, 730f);

				doc.add(image1);
				doc.add(para);


				para = new Paragraph(new Phrase(prop.getProperty("addressForReport"),new Font(Font.TIMES_ROMAN,10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				
				
				doc.add(para);
				para = new Paragraph(new Phrase(prop.getProperty("contactForReport"),new Font(Font.TIMES_ROMAN,10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(prop.getProperty("mailForReport"),new Font(Font.TIMES_ROMAN,10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Pay Slip For the month  "+slrydt.substring(3),new Font(Font.TIMES_ROMAN,10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(15);

				doc.add(para);
				sdf=new SimpleDateFormat("yyyy-MM-dd");
				dt=sdf.format(date);
				
				System.out.println("DATE 4 :"+dt);
				
				String qery="SELECT e.empno,e.fname,e.dob FROM empmast e WHERE MONTH(e.dob) = MONTH('"+dt+"') and e.empno="+rs3.getInt("empno");
				mst=Cn.createStatement();

				brs = mst.executeQuery(qery);
				while(brs.next())
				{

			//		BirthdayMessage = ReportDAO.getWishMessage("BIRTHDAY", Cn);
			//		BirthdayMessage="***"+BirthdayMessage+"( "+sdf1.format(brs.getDate("dob"))+" ) !!!";
				}
				brs.close();


				mrs = mst.executeQuery("SELECT e.empno,e.fname,e.MARRIEDDT FROM empmast e WHERE MONTH(e.MARRIEDDT) = MONTH('"+dt+"') and e.empno="+rs3.getInt("empno"));
				while(mrs.next())
				{
		//			MarrdMessage = ReportDAO.getWishMessage("WEDDING", Cn);
		//			MarrdMessage="***"+MarrdMessage+"( "+sdf1.format(mrs.getDate("MARRIEDDT"))+" )  !!!";
				}
				mrs.close();

				wrs = mst.executeQuery("SELECT e.empno,e.fname,e.doj FROM empmast e WHERE MONTH(e.doj) = MONTH('"+dt+"') and e.empno="+rs3.getInt("empno"));
				while(wrs.next())
				{
		//			WorkMssage = ReportDAO.getWishMessage("WORK", Cn);
		//			WorkMssage="***"+WorkMssage+"( "+sdf1.format(wrs.getDate("doj"))+" ) !!!";

				}
				wrs.close();


				parab = new Paragraph(new Phrase(""+BirthdayMessage,new Font(Font.TIMES_ROMAN,10,FONT.BOLDITALIC)));
				parab.setAlignment(Element.ALIGN_LEFT);
				param = new Paragraph(new Phrase(""+MarrdMessage,new Font(Font.TIMES_ROMAN,10,FONT.BOLDITALIC)));
				param.setAlignment(Element.ALIGN_LEFT);
				paraw = new Paragraph(new Phrase(""+WorkMssage,new Font(Font.TIMES_ROMAN,10,FONT.BOLDITALIC)));
				paraw.setAlignment(Element.ALIGN_LEFT);

 
				Rectangle rec = new  Rectangle(100,100);

				PdfPTable tab = new PdfPTable(1);
				tab.setSpacingBefore(10);
				tab.setWidthPercentage(new float[]{100}, rec);
				tab.setHorizontalAlignment(Element.ALIGN_LEFT);


				PdfPTable tabt = new PdfPTable(1);
				tabt.setWidthPercentage(new float[]{100}, rec);
				tabt.setHorizontalAlignment(Element.ALIGN_LEFT);

				PdfPTable tabsec = new PdfPTable(2);
				tabsec.setWidthPercentage(new float[]{50,50}, new Rectangle(100,100));
				tabsec.setHorizontalAlignment(Element.ALIGN_LEFT);


				PdfPCell cell = new PdfPCell();
				PdfPCell cellt = new PdfPCell();

				PdfPTable tab1 = new PdfPTable(4);
				PdfPTable tab2 = new PdfPTable(5);
				PdfPTable tab3 = new PdfPTable(2);
				PdfPTable tab4 = new PdfPTable(2);
				PdfPTable tab5 = new PdfPTable(4);
				PdfPTable tab6 = new PdfPTable(4);
				PdfPTable tab7 = new PdfPTable(4);
				PdfPTable tab8 = new PdfPTable(4);
				PdfPTable tab9 = new PdfPTable(4);
				PdfPTable tab10 = new PdfPTable(2);


				PdfPCell cell3 = new PdfPCell();
				PdfPCell cell4 = new PdfPCell();
				PdfPCell cell5 = new PdfPCell();
				PdfPCell cell6 = new PdfPCell();
				PdfPCell cell7 = new PdfPCell();
				//PdfPCell cell8 = new PdfPCell();

				Statement st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
				Statement st1 = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
				Statement stt = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);

				boolean isRecord = false;	
				String frmTable = "";
				rs = st.executeQuery("select trndt  from PAYTRAN where empno="+rs3.getInt("EMPNO")+" and TRNDT  LIKE '"+dt.substring(0,7)+"%' order by trncd");

				if(rs.next())
				{
					frmTable = "PAYTRAN";
					isRecord = true;
					dt1=rs.getString("TRNDT");
					//rs1 = st1.executeQuery("select distinct(trncd)  from PAYTRAN where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' order by trncd");
	//				rs1 = st1.executeQuery("select distinct(pay.trncd)  from PAYTRAN pay,cdmast cd where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by trncd");
					rs1 = st1.executeQuery("select distinct(pay.trncd),cd.PRNTSEQNCE  from PAYTRAN pay,cdmast cd where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by cd.PRNTSEQNCE, pay.trncd");

				}
				else
				{
					rs = st.executeQuery("select trndt  from YTDTRAN where empno="+rs3.getInt("EMPNO")+" and TRNDT  LIKE '"+dt.substring(0,7)+"%' order by trncd");
					if(rs.next())
					{
						frmTable = "YTDTRAN";
						isRecord = true;
						dt1=rs.getString("TRNDT");
						//rs1 = st1.executeQuery("select distinct(trncd)  from YTDTRAN where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' order by trncd");
			//			rs1 = st1.executeQuery("select distinct(pay.trncd)  from YTDTRAN pay,cdmast cd where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by trncd");
						rs1 = st1.executeQuery("select distinct(pay.trncd),cd.PRNTSEQNCE  from YTDTRAN pay,cdmast cd where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by cd.PRNTSEQNCE,pay.trncd");
						System.out.println("AJ...  select distinct(pay.trncd),cd.PRNTSEQNCE  from PAYTRAN_STAGE pay,cdmast cd where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by cd.PRNTSEQNCE,pay.trncd");
					}
					else
					{
						rs = st.executeQuery("select trndt  from PAYTRAN_STAGE where empno="+rs3.getInt("EMPNO")+" and TRNDT  LIKE '"+dt.substring(0,7)+"%' order by trncd");
						if(rs.next())
							frmTable = "PAYTRAN_STAGE";
						isRecord = true;
						dt1=rs.getString("TRNDT");
		//				rs1 = st1.executeQuery("select distinct(pay.trncd)  from PAYTRAN_STAGE pay,cdmast cd where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by trncd");
						rs1 = st1.executeQuery("select distinct(pay.trncd),cd.PRNTSEQNCE  from PAYTRAN_STAGE pay,cdmast cd where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by cd.PRNTSEQNCE,pay.trncd");
						
					}

				}


				ArrayList<TranBean> trblist= new ArrayList<TranBean>();
				TranBean tb;
				TranHandler th = new TranHandler();
				TransactionBean trbn = new EmpOffHandler().getInfoEmpTran(rs3.getString("EMPNO"));

				if(isRecord){
					while(rs1.next())
					{
						tb = new TranBean();
						tb=th.getPaySlipTran(rs3.getInt("EMPNO"), rs1.getInt(1), 0, dt1,frmTable);
						trblist.add(tb);
					}

					SimpleDateFormat from = new SimpleDateFormat("yyyy-MM-dd");
					SimpleDateFormat to = new SimpleDateFormat("dd-MMM-yyyy");
					Date d = from.parse(dt);
					String monthDate = to.format(d);
					//	System.out.println(monthDate);

					ResultSet rs7 = null;
					Statement statement = repBean.getCn().createStatement();
					rs7=statement.executeQuery("select "+Calculate.getDays(monthDate)+" - DAY(DOJ)+1 from empmast where empno ="+rs3.getInt("EMPNO")+" and doj between cast('"+ReportDAO.BOM(monthDate)+"' as DATE) and cast('"+ReportDAO.EOM(monthDate)+"' as DATE)");
					if(rs7.next())
					{
						paiddays = rs7.getFloat(1);
					}
					//=== For Date of Leaving in same Month 
					rs7=statement.executeQuery("select "+paiddays+" - (DAY(cast('"+ReportDAO.EOM(monthDate)+"' as DATE))- DAY(DOL)) from empmast where empno ="+rs3.getInt("EMPNO")+" and dol between cast('"+ReportDAO.BOM(monthDate)+"' as DATE) and cast('"+ReportDAO.EOM(monthDate)+"' as DATE)");
					if(rs7.next())
					{
						/*int day = rs7.getInt(1);
				paiddays = day;*/
						paiddays = rs7.getFloat(1);
					}

					tab3.setWidthPercentage(new float[]{50,50},new Rectangle(100,100));
					PdfPCell subcell3 = new PdfPCell(new Phrase("INCOME ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell3.setColspan(2);
					subcell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab3.addCell(subcell3);

					tab4.setWidthPercentage(new float[]{50,50},new Rectangle(100,100));
					PdfPCell subcell5 = new PdfPCell(new Phrase("DEDUCTIONS ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcell5.setColspan(2);
					subcell5.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab4.addCell(subcell5);

					tab5.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcell4 = new PdfPCell(new Phrase("Salary & Allowances ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcell4);

					PdfPCell subcellin = new PdfPCell(new Phrase("Amount.(Rs)",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcellin.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcellin);

					PdfPCell subcellin1 = new PdfPCell(new Phrase("Arrears ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcellin1.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcellin1);

					PdfPCell subcellin2 = new PdfPCell(new Phrase("Total ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcellin2.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcellin2);

					tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellout1 = new PdfPCell(new Phrase("Deductions ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcellout1.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout1);

					tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellout2 = new PdfPCell(new Phrase("Amount.(Rs) ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcellout2.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout2);

					tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellout3 = new PdfPCell(new Phrase("Arrears ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcellout3.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout3);

					tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellout4 = new PdfPCell(new Phrase("Total ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcellout4.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout4);


					for(TranBean trbn1 : trblist )
					{
						if(trbn1.getTRNCD()<199 && trbn1.getTRNCD()!=127  )
						{
							String CDdesc="";
							if(trbn1.getTRNCD()==139){
								CDdesc="CLOSING ALLOWANCE";
							}
							else if(trbn1.getTRNCD()==140){
								CDdesc="ARREARS";
							}
							else if(trbn1.getTRNCD()==141){
								CDdesc="ARREARS IN ALLOWANCE";
							}
							
							tab5.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							
							if(trbn1.getTRNCD()==139 || trbn1.getTRNCD()==140 || trbn1.getTRNCD()==141){
								PdfPCell subcells = new PdfPCell(new Phrase(""+CDdesc,new Font(Font.TIMES_ROMAN,6,Font.BOLD)));
								subcells.setHorizontalAlignment(Element.ALIGN_LEFT);
								tab5.addCell(subcells);
							}else{
							PdfPCell subcells = new PdfPCell(new Phrase(""+CodeMasterHandler.getCDesc(trbn1.getTRNCD()),new Font(Font.TIMES_ROMAN,6,Font.BOLD)));
							subcells.setHorizontalAlignment(Element.ALIGN_LEFT);
							tab5.addCell(subcells);
							}
							

							tab5.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells1 = new PdfPCell(new Phrase(""+trbn1.getCAL_AMT(),new Font(Font.TIMES_ROMAN,7,Font.NORMAL)));
							subcells1.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab5.addCell(subcells1);

							tab5.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells2 = new PdfPCell(new Phrase(""+trbn1.getARR_AMT(),new Font(Font.TIMES_ROMAN,7,Font.NORMAL)));
							subcells2.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab5.addCell(subcells2);

							tab5.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells3 = new PdfPCell(new Phrase(""+trbn1.getNET_AMT(),new Font(Font.TIMES_ROMAN,7,Font.NORMAL)));
							subcells3.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab5.addCell(subcells3);

							total_amntIN = total_amntIN + trbn1.getCAL_AMT() ;
							total_arrIN = total_arrIN + trbn1.getARR_AMT();
							total_totIN = total_totIN + trbn1.getNET_AMT();

						}

						else if(300 > trbn1.getTRNCD() && trbn1.getTRNCD()>200 )
						{

							tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells = new PdfPCell(new Phrase(""+CodeMasterHandler.getCDesc(trbn1.getTRNCD()),new Font(Font.TIMES_ROMAN,6,Font.BOLD)));
							subcells.setHorizontalAlignment(Element.ALIGN_LEFT);
							tab6.addCell(subcells);

							tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells1 = new PdfPCell(new Phrase(""+trbn1.getCAL_AMT(),new Font(Font.TIMES_ROMAN,7,Font.NORMAL)));
							subcells1.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab6.addCell(subcells1);

							tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells2 = new PdfPCell(new Phrase(""+trbn1.getARR_AMT(),new Font(Font.TIMES_ROMAN,7,Font.NORMAL)));
							subcells2.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab6.addCell(subcells2);

							tab6.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells3 = new PdfPCell(new Phrase(""+trbn1.getNET_AMT(),new Font(Font.TIMES_ROMAN,7,Font.NORMAL)));
							subcells3.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab6.addCell(subcells3);

							total_amntDED = total_amntDED + trbn1.getCAL_AMT();
							total_arrDED = total_arrDED + trbn1.getARR_AMT();
							total_totDED = total_totDED + trbn1.getNET_AMT();
						}
						if(trbn1.getTRNCD()==301)
						{
							absent = trbn1.getCAL_AMT();
							paiddays =paiddays-absent;
						}
						if(trbn1.getTRNCD()==199)
						{
							gross = trbn1.getINP_AMT();
						}


						monthygross = (int)gross-Math.round(((gross/nodays)*absent));

					}
					tab7.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltin = new PdfPCell(new Phrase("Gross Salary",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltin.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin);

					tab7.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltin1 = new PdfPCell(new Phrase(""+total_amntIN,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltin1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin1);

					tab7.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltin2 = new PdfPCell(new Phrase(""+total_arrIN,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltin2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin2);

					tab7.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltin3 = new PdfPCell(new Phrase(""+total_totIN,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltin3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin3);

					tab8.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltded = new PdfPCell(new Phrase("TOTAL DEDUCTION",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltded.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded);

					tab8.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltded1 = new PdfPCell(new Phrase(""+total_amntDED,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltded1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded1);

					tab8.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltded2 = new PdfPCell(new Phrase(""+total_arrDED,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltded2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded2);

					tab8.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcelltded3 = new PdfPCell(new Phrase(""+total_totDED,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcelltded3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded3);

					tab9.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellts = new PdfPCell(new Phrase("Net Salary",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcellts.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab9.addCell(subcellts);

					tab9.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellts1 = new PdfPCell(new Phrase(""+( total_totIN-total_totDED),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcellts1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab9.addCell(subcellts1);

					tab9.setWidthPercentage(new float[]{55,15,15,15},new Rectangle(100,100));
					PdfPCell subcellts2 = new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcellts2.setColspan(2);
					subcellts2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab9.addCell(subcellts2);

					tab10.setWidthPercentage(new float[]{50,50},new Rectangle(100,100));
					PdfPCell subcellt = new PdfPCell(new Phrase("Net Salary In Words :- "+originalNumToLetter.getInWords(""+(int)(total_totIN - total_totDED)),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					subcellt.setHorizontalAlignment(Element.ALIGN_LEFT);
					subcellt.setColspan(2);
					tab10.addCell(subcellt);


					tab1.setWidthPercentage(new float[]{25,25,25,25},new Rectangle(100,100));
					PdfPCell subcell = new PdfPCell(new Phrase("Employee Code ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""+trbn.getEMPCODE(),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Employee Name ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);


					subcell = new PdfPCell(new Phrase(""+trbn.getEmpname(),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Department/Branch ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""+rs3.getString("DEPARTMENT")+"/"+rs3.getString("SITE_NAME"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Designation ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("DESIG", trbn.getDesg()),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Bank Name ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""+rs3.getString("BANKNAME"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Salary AC/No. ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""+rs3.getString("ACNO"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Uan Number. ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""+rs3.getString("IDENTY"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("PAN No. ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""+trbn.getPanno(),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("ESI No. ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);


					//String lesql="SELECT SUM(TOTDR) AS TOTDED,LEAVECD FROM LEAVEBAL WHERE BALDT BETWEEN '"+ReportDAO.BOM(slrydt)+"' AND '"+ReportDAO.EOM(slrydt)+"' AND LEAVECD=1 AND EMPNO="+rs3.getInt("EMPNO")+" GROUP BY LEAVECD";
					stt = Cn.createStatement();
					ResultSet rsbal= stt.executeQuery("SELECT DISTINCT(LEAVECD)as leavecd FROM LEAVEBAL WHERE EMPNO="+rs3.getInt("EMPNO")+" ORDER BY LEAVECD");
					cl=0;
					pl=0;
					sl=0;
					ml=0;
					while(rsbal.next())
					{
						String currdaysdate=dt.substring(0,8);
						String currdaysdatecurrmonth=currdaysdate+"25";
						
						String lesql="select top 1 l.bal,l.leavecd,lk.LKP_DISC as leavetype from leavebal l,LOOKUP lk WHERE  l.empno="+rs3.getInt("EMPNO")+" AND  l.LEAVECD="+rsbal.getInt("leavecd")+" AND l.LEAVECD=lk.LKP_SRNO AND lk.LKP_CODE='leave' AND l.BALDT<='"+currdaysdatecurrmonth+"'  ORDER BY BALDT DESC,SRNO DESC";
				
						ResultSet rsleave = st1.executeQuery(lesql);
						//String leave = new LookupHandler().getLKP_Desc("LEAVE",rsleave.getInt(2));
						if(rsleave.next()){
							String leave	=	rsleave.getString("leavetype");
							if(leave.equalsIgnoreCase("PL")){
								pl = rsleave.getInt("bal");
							}
							if(leave.equalsIgnoreCase("CL")){
								cl = rsleave.getInt("bal");
							}
							if(leave.equalsIgnoreCase("SL")){
								sl = rsleave.getInt("bal");
							}
							if(leave.equalsIgnoreCase("ML")){
								ml = rsleave.getInt("bal");
								}
						}
			}

					
					
					stt = Cn.createStatement();
					//ResultSet rsbal= stt.executeQuery("SELECT DISTINCT(LEAVECD)as leavecd FROM LEAVEBAL WHERE EMPNO="+rs3.getInt("EMPNO")+" ORDER BY LEAVECD");
					ResultSet rscurrdays= stt.executeQuery("SELECT DISTINCT(LEAVECD)as leavecd FROM LEAVEBAL WHERE EMPNO="+rs3.getInt("EMPNO")+" ORDER BY LEAVECD");
					currmonth_cl=0;
					currmonth_pl=0;
					currmonth_sl=0;
					currmonth_ml=0;
					while(rscurrdays.next())
					{
						System.out.println("dt : "+dt);
						String currdaysdate=dt.substring(0,8);
						String currdaysmonth=dt.substring(5, 7);
						System.out.println("currdaysmonth : "+currdaysmonth);
						String currdaysyear=dt.substring(0,4);
						
						int monthdays=0;
						monthdays=Integer.parseInt(currdaysmonth);
					
						System.out.println("monthdays : "+monthdays);
						
						if(monthdays==1)
						{
							monthdays = 12;
						}
						else
						{
							monthdays=monthdays-1;
						}
						
						//monthdays=monthdays-1;
						
						
						System.out.println("monthdays1 : "+monthdays);
						
						String currdaysdatecurrmonth=currdaysdate+"25";
						//String currdaysdatelastmonth=currdaysyear+"-0"+monthdays+"-26";
						String currdaysdatelastmonth=currdaysyear+"-"+monthdays+"-26";
						
						System.out.println("currdaysdatecurrmonth : "+currdaysdatecurrmonth);
						System.out.println("currdaysdatelastmonth : "+currdaysdatelastmonth);
						
						
						String lesqlcurrdays="SELECT SUM(L.DAYS) AS DAYS, L.LEAVECD, LK.LKP_DISC AS leavetype FROM LEAVETRAN L, LOOKUP LK "
								+ "WHERE L.LEAVECD=LK.LKP_SRNO AND LK.LKP_CODE='LEAVE' AND EMPNO="+rs3.getInt("EMPNO")+" AND L.LEAVECD="+rscurrdays.getInt("leavecd")
								+ "AND L.FRMDT>='"+currdaysdatelastmonth+"' AND L.TODT<='"+currdaysdatecurrmonth+"' AND L.STATUS='SANCTION' AND L.TRNTYPE='D'"
								+ "GROUP BY L.LEAVECD, LK.LKP_DISC";

						
						
						System.out.println("lesqlcurrdays : "+lesqlcurrdays);
						
						ResultSet rsleavecurrdays = st1.executeQuery(lesqlcurrdays);
						//String leave = new LookupHandler().getLKP_Desc("LEAVE",rsleave.getInt(2));
						if(rsleavecurrdays.next()){
							String leave	=	rsleavecurrdays.getString("leavetype");
							if(leave.equalsIgnoreCase("PL")){
								currmonth_pl = rsleavecurrdays.getInt("DAYS");
							}
							if(leave.equalsIgnoreCase("CL")){
								currmonth_cl = rsleavecurrdays.getInt("DAYS");
							}
							if(leave.equalsIgnoreCase("SL")){
								currmonth_sl = rsleavecurrdays.getInt("DAYS");
							}
							if(leave.equalsIgnoreCase("ML")){
								currmonth_ml = rsleavecurrdays.getInt("DAYS");
								}
						}
			}

	
/******************************************PRASAD WORK START***********************************************************************************************************************/							
					tab2.setWidthPercentage(new float[]{25,25,25,15,10},new Rectangle(100,100));
					
					
					PdfPCell subcell2 = new PdfPCell(new Phrase("Date Of Joining ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+trbn.getDOJ(),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);
					
					
					subcell2 = new PdfPCell(new Phrase("Leave Type ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Month Taken Leave",new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);
					
					subcell2 = new PdfPCell(new Phrase("Balance",new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);
					

					subcell2 = new PdfPCell(new Phrase("Gross Amount / Rate (Day)",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+gross,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);


					subcell2 = new PdfPCell(new Phrase("Sick Leave",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+currmonth_sl,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);
					
					subcell2 = new PdfPCell(new Phrase(""+sl,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);
					
					
					subcell2 = new PdfPCell(new Phrase("Absent days",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+absent,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);


					subcell2 = new PdfPCell(new Phrase("Priviledge Leave",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+currmonth_pl,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);
					
					subcell2 = new PdfPCell(new Phrase(""+pl,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					
					subcell2 = new PdfPCell(new Phrase("Monthly Net Payable Amount",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+( total_totIN-total_totDED),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);


					subcell2 = new PdfPCell(new Phrase("Casual Leave",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+currmonth_cl,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);
					
					subcell2 = new PdfPCell(new Phrase(""+cl,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					
					
					subcell2 = new PdfPCell(new Phrase("Paid Days",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+paiddays,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);


					subcell2 = new PdfPCell(new Phrase("Maternity Leave",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""+currmonth_ml,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);
					
					subcell2 = new PdfPCell(new Phrase(""+ml,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);
					
					
/******************************************PRASAD WORK END***********************************************************************************************************************/
					tab1.addCell(subcell);
					cell.addElement(tab1);
					tab.addCell(cell);

					tab2.addCell(subcell2);
					cellt.addElement(tab2);
					tabt.addCell(cellt);

					cell3.addElement(tab3);
					cell3.addElement(tab5);
					cell5.addElement(tab7);
					cell5.addElement(tab9);
					cell7.addElement(tab10);
					cell7.setColspan(2);


					cell4.addElement(tab4);
					cell4.addElement(tab6);
					cell6.addElement(tab8);

					tabsec.addCell(cell3);
					tabsec.addCell(cell4);
					tabsec.addCell(cell5);
					tabsec.addCell(cell6);
					tabsec.addCell(cell7);

					doc.add(tab);
					doc.add(tabt);
					doc.add(tabsec);

					doc.add(Chunk.NEWLINE);

					if(!(BirthdayMessage.equals("")) ||BirthdayMessage!=null )
					{
						doc.add(parab);
					}
					if(!(MarrdMessage.equals("")) ||MarrdMessage!=null )
					{
						doc.add(param);
					}

					if(!(WorkMssage.equals("")) ||WorkMssage!=null )
					{
						doc.add(paraw);
					}

					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);
			
					para = new Paragraph(new Phrase("NOTE:-  1. This is system generated PaySlip, Sign & Stamp not Required.",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(0);
					doc.add(para);
					para = new Paragraph(new Phrase("               "+" "+"2. In Case of Any Descripancy in Salary, Please Contact to Salary Section Immediatly.",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(0);
					doc.add(para);
					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);

				}
				
				
				doc.newPage();
				dt=slrydt;
			}
			doc.close();

			Cn.close();

		}
		catch(Exception e) 
		{
			e.printStackTrace();
		}
		
	}
	
	
	public static void PaySlip_OnePage_Test(String dt,String empList,String filepath, String imagepath)
	{
		System.out.println("Welcome in PaySlip_OnePage_Test");

		RepoartBean repBean  = new RepoartBean();
		try
		{
			Connection Cn = null;
			ReportDAO.OpenCon("", "", "",repBean);
			Cn = repBean.getCn();

			ResultSet rs = null;
			ResultSet rs1 = null;
			String EmpSql = "";

			SimpleDateFormat sdf=new SimpleDateFormat("dd-MMM-yyyy");
			Date date=sdf.parse(dt);
			String slrydt=dt;
			String dt1="";

			Statement st3 = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
			

			EmpSql = "SELECT emp.*,t.ACNO,t.BRANCH,t.GRADE,ps.SITE_NAME,l.LKP_DISC as DEPARTMENT,(select LKP_DISC  from LOOKUP l1 where l1.LKP_CODE='BANK' and l1.LKP_SRNO=t.BANK_NAME)as BANKNAME FROM EMPMAST emp,EMPTRAN t,LOOKUP L,Project_Sites ps WHERE emp.EMPNO = t.EMPNO" +
					" AND emp.EMPNO in ("+empList+") AND t.SRNO=(SELECT MAX(SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO=emp.EMPNO) AND t.DEPT=l.LKP_SRNO AND l.LKP_CODE='DEPT' AND ps.SITE_ID=t.PRJ_SRNO ORDER BY emp.EMPNO";
			ResultSet rs3 = st3.executeQuery(EmpSql);
			System.out.println(EmpSql);
			if(!rs3.next()){
				System.out.println("Recordset EMpty");
			}

			Document doc = new Document();
			PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
			doc.open();
			doc.setPageSize(PageSize.A4);

			rs3.beforeFirst();
			while(rs3.next())
			{

				Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 327.5f, 450, 55);
											
				Paragraph para = new Paragraph();
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);

				doc.add(para);

				para = new Paragraph(new Phrase("Pay Slip For the month  "+slrydt.substring(3),new Font(Font.TIMES_ROMAN,10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(15);

				doc.add(para);
				sdf=new SimpleDateFormat("yyyy-MM-dd");
				dt=sdf.format(date);
				
				Rectangle rec = new  Rectangle(100,100);

				PdfPTable tab = new PdfPTable(1);
				tab.setSpacingBefore(10);
				tab.setWidthPercentage(new float[]{100}, rec);
				tab.setHorizontalAlignment(Element.ALIGN_LEFT);


				PdfPCell cell = new PdfPCell();

				PdfPTable tab1 = new PdfPTable(4);
				Statement st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
				Statement st1 = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);

				boolean isRecord = false;	
				String frmTable = "";
			
				rs = st.executeQuery("select trndt  from PAYTRAN_STAGE where empno="+rs3.getInt("EMPNO")+" and TRNDT  LIKE '"+dt.substring(0,7)+"%' order by trncd");
						if(rs.next())
							frmTable = "PAYTRAN_STAGE";
						isRecord = true;
						dt1=rs.getString("TRNDT");
						rs1 = st1.executeQuery("select distinct(pay.trncd),cd.PRNTSEQNCE  from PAYTRAN_STAGE pay,cdmast cd where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by cd.PRNTSEQNCE,pay.trncd");
						
				ArrayList<TranBean> trblist= new ArrayList<TranBean>();
				TranBean tb;
				TranHandler th = new TranHandler();
				TransactionBean trbn = new EmpOffHandler().getInfoEmpTran(rs3.getString("EMPNO"));

				if(isRecord){
					while(rs1.next())
					{
						tb = new TranBean();
						tb=th.getPaySlipTran(rs3.getInt("EMPNO"), rs1.getInt(1), 0, dt1,frmTable);
						trblist.add(tb);
					}
					
					tab1.setWidthPercentage(new float[]{25,25,25,25},new Rectangle(100,100));
					PdfPCell subcell = new PdfPCell(new Phrase("Employee Code ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					tab1.addCell(subcell);
					subcell = new PdfPCell(new Phrase(""+trbn.getEMPCODE(),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					tab1.addCell(subcell);
					subcell = new PdfPCell(new Phrase("Employee Name ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					tab1.addCell(subcell);
					subcell = new PdfPCell(new Phrase(""+trbn.getEmpname(),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
					tab1.addCell(subcell);

					cell.addElement(tab1);
					tab.addCell(cell);

				
					doc.add(tab);
			
					para = new Paragraph(new Phrase("NOTE:-  1. This is system generated PaySlip, Sign & Stamp not Required.",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(0);
					doc.add(para);
				}
				
				doc.newPage();
				dt=slrydt;
			}
			doc.close();
			Cn.close();

		}
		catch(Exception e) 
		{
			e.printStackTrace();
		}
	}
	

	public static void paysliptxt(String Payslipdt,String empList,String  filepath)
	{
		RepoartBean repBean  = new RepoartBean();
		int[] Icoded = new int[41];
		int[] Ecoded = new int[41];
		int CP = 0;
		String[] Idesc = new String[41];
		String[] Edesc = new String[41];
		int[] INCamt = new int[200];
		int[] DEDamt = new int[301];
		String EmpSql = "";
		int LP = 0;
		String lSql = "";
		ResultSet TmpRs = null;
		int aCtr = 0;
		int lCtr = 0;
		Connection Cn = null;
		String[] LPRN = new String[4];
		int[] aINCamt = new int[200];
		int[] aDEDamt = new int[301];
		String CmDSQL = "";
		int TotNetPay = 0;
		int[] TotGross = new int[4];
		int[] TotDed = new int[4];
		String dtrsql = "";
		ResultSet CDM = null;
		ResultSet DTR = null;
		ResultSet emp = null;
		int LOPDays = 0;
		String Str1 = "";
		String SLINE = "";
		String sLine1  = "";
		FileWriter Fp;
		boolean DtrFind = false;

		ReportDAO.inithead(repBean);
		//Initvar                       *****already variable are initialised  not need of initvar
		ReportDAO.make_prn_file(filepath,repBean);
		//ReportDAO.println(String.valueOf((char)18), 0, 1, false, "BANK");//          ***** P H PATIL Sir
		ReportDAO.println("                                     THE NASIK MARCHANT'S CO-OP BANK LTD, NASIK", 0, 1, false, "BANK",repBean);
		repBean.setHdg1("Salary Slip for the Month of : "+Payslipdt.substring(3, 6) + "-" + Payslipdt.substring(7, 11));
		SLINE = stringOfSize(80, '-');
		sLine1 = stringOfSize(132, '-');
		repBean.setPageNo(1);
		repBean.setLineLen(80);
		repBean.setPageLen(65);
		repBean.setLnCount(0);
		dtrsql = "SELECT * FROM PAYTRAN WHERE TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' AND '"+ReportDAO.EOM(Payslipdt)+"'";
		CmDSQL = "SELECT * FROM CDMAST WHERE PSLIPYN = 'Y' AND TRNCD <= 293 AND " +
				"TRNCD IN (SELECT TRNCD FROM CDMAST INTERSECT (SELECT DISTINCT(TRNCD) FROM PAYTRAN" +
				" WHERE TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' AND '"+ReportDAO.EOM(Payslipdt)+"')) ORDER BY TRNCD";

		//DoEvents              
		ReportDAO.OpenCon("", "", "",repBean);
		Cn = repBean.getCn();
		try
		{
			Statement st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
			DTR = st.executeQuery(dtrsql);
			if(!DTR.next())
			{
				DtrFind = false;
				dtrsql = "SELECT * FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' AND '"+ReportDAO.EOM(Payslipdt)+"'";
				CmDSQL = "SELECT * FROM CDMAST WHERE PSLIPYN = 'Y' AND TRNCD <= 293 AND " +
						"TRNCD IN (SELECT TRNCD FROM CDMAST INTERSECT (SELECT DISTINCT(TRNCD) FROM PAYTRAN_STAGE " +
						" WHERE TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' AND '"+ReportDAO.EOM(Payslipdt)+"')) ORDER BY TRNCD";

			}
			EmpSql = "SELECT emp.*,t.ACNO,t.prj_srno,t.desig,t.GRADE FROM EMPMAST emp,EMPTRAN t WHERE t.EMPNO = emp.EMPNO" +
					" AND emp.EMPNO in ("+empList+") AND t.EFFDATE = (SELECT MAX(E2.EFFDATE) FROM EMPTRAN E2 " +
					" WHERE E2.EMPNO = emp.EMPNO AND E2.EFFDATE <= '"+ReportDAO.EOM(Payslipdt)+"') ORDER BY emp.EMPNO";

			DTR = st.executeQuery(dtrsql);
			if(!DTR.next())
			{
				dtrsql = "SELECT * FROM PAYTRAN WHERE TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' AND '"+ReportDAO.EOM(Payslipdt)+"'";
				DTR = st.executeQuery(dtrsql);
				if(!DTR.next())
				{
					System.out.println("TRANSACTION NOT FOUND");
					Fp = repBean.getFp();
					Fp.close();
					return;
				}
			}
			DTR.beforeFirst();
			CDM = st.executeQuery(CmDSQL);
			if(!CDM.next())
			{
				CDM = null;
				CmDSQL = "SELECT * FROM CDMAST WHERE TRNCD <= 293 AND TRNCD IN (SELECT TRNCD FROM CDMAST INTERSECT " +
						" (SELECT DISTINCT(TRNCD) FROM PAYTRAN" +
						" WHERE TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' AND '"+ReportDAO.EOM(Payslipdt)+"')) ORDER BY TRNCD";

				//System.out.println(CmDSQL);	////======
				CDM = st.executeQuery(CmDSQL);

				if(!CDM.next())
				{
					System.out.print("NO ANY CODE TO PRINT");
					Fp = repBean.getFp();
					Fp.close();
					return;
				}
			}
			CDM.beforeFirst();
			while (CDM.next()) 
			{
				if(CDM.getInt("TRNCD") <= 200 && (CDM.getInt("TRNCD")!=198 || CDM.getInt("TRNCD")!=199) )
				{
					aCtr = aCtr + 1;
					Idesc[aCtr] =  CDM.getString("SDESC") == null ? "" : CDM.getString("SDESC").trim();
					Icoded[aCtr] = CDM.getInt("TRNCD");

				}
				else
				{
					lCtr = lCtr + 1;
					Edesc[lCtr] = CDM.getString("SDESC") == null ? "" : CDM.getString("SDESC").trim();
					Ecoded[lCtr] = CDM.getInt("TRNCD");
				}

			}
			Statement st1 = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
			emp = st1.executeQuery(EmpSql);

			if(!emp.next())
			{
				System.out.println("Employee Recordset is empty");
				Fp = repBean.getFp();
				Fp.close();
				return;
			}
			//doevents                      
			String pBranch = "";
			String Arr1 = "";
			int i = 0;
			int ctr = 0;
			emp.beforeFirst();   //Commented after exception

			while(emp.next())
			{
				//doevents
				int empNum = emp.getInt("EMPNO");
				DTR = null;
				if(!DtrFind)
				{
					dtrsql = "SELECT * FROM PAYTRAN_STAGE Y,CDMAST C WHERE " +
							"(Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293) AND " +
							"Y.EMPNO = "+emp.getInt("EMPNO")+" AND Y.TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' " +
							"AND '"+ReportDAO.EOM(Payslipdt)+"' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y' ORDER BY Y.TRNCD ";
				}
				else
				{
					dtrsql = "SELECT * FROM PAYTRAN_STAGE Y,CDMAST C WHERE " +
							"(Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293) AND " +
							"Y.EMPNO = "+emp.getInt("EMPNO")+" AND Y.TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' " +
							"AND '"+ReportDAO.EOM(Payslipdt)+"' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y' UNION SELECT * FROM PAYTRAN Y," +
							" CDMAST C WHERE " +
							"(Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293) AND " +
							"Y.EMPNO = "+emp.getInt("EMPNO")+" AND Y.TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' " +
							" AND '"+ReportDAO.EOM(Payslipdt)+"' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y' ORDER BY 3";
				}
				lCtr = 0;
				LOPDays = 0;
				//System.out.println(emp.getInt("EMPNO"));
				//System.out.println(dtrsql);
				DTR = st.executeQuery(dtrsql);
				if(!DTR.next())
				{
					dtrsql = "SELECT * FROM PAYTRAN Y,CDMAST C WHERE (Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293) AND Y.EMPNO = "+empNum+" AND Y.TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' " +
							" AND '"+ReportDAO.EOM(Payslipdt)+"' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y' ORDER BY Y.TRNCD ";
					//System.out.println(dtrsql);
					DTR = null;
					DTR = st.executeQuery(dtrsql);
					if(!DTR.next())
					{
						System.out.println("TRANSACTION IS NOT FOUND FOR THIS EMPLOYEE "+empNum);
					}
				}
				for(int j=1; j< 200; j++ )
				{
					INCamt[j] = 0;
					aINCamt[j] = 0;
				}
				for(int j=200; j<301; j++ )
				{
					DEDamt[j] = 0;
					aDEDamt[j] = 0;
				}
				DTR.beforeFirst();
				if(DTR.next())
				{  //get chk by PHPATIL SIR
					ctr = ctr + 1;
					repBean.setBrnNo(1);  //emp.getInt("BRANCH");
					ReportDAO.println("", 0, 1, false, "BANK",repBean);
					ReportDAO.page_head(repBean.getBrnNo(),repBean.getHdg1(),repBean.getHdg2(), repBean.getHdg3(), repBean.getHdg4(), repBean.getHdg5(), repBean.getHdg6(), repBean.getHdg7(),repBean);	//added values for hdg 1 and 2
					pBranch = "BRANCH";//emp.getString("BRANCH");
					//DTR.beforeFirst();
					DTR = st.executeQuery(dtrsql);
					while(DTR.next())
					{

						if(DTR.getInt("TRNCD") <= 200 && DTR.getInt("TRNCD") != 198 && DTR.getInt("TRNCD") != 199)
						{
							INCamt[DTR.getInt("TRNCD")] = DTR.getString("NET_AMT") == null?0:DTR.getInt("NET_AMT"); //*******CHECK OTHER WISE IT WILL CAUSE ARRAYOUTBOUND EXCEP ********************** 
							aINCamt[DTR.getInt("TRNCD")] = DTR.getString("ARR_AMT") == null?0:DTR.getInt("ARR_AMT");//*******CHECK OTHER WISE IT WILL CAUSE ARRAYOUTBOUND EXCEP **********************
							System.out.println(DTR.getInt("TRNCD")+"\t"+DTR.getString("NET_AMT"));
						}
						else if(DTR.getInt("TRNCD") <= 293)
						{
							DEDamt[DTR.getInt("TRNCD")] = DTR.getString("NET_AMT") == null?0:DTR.getInt("NET_AMT"); //*******CHECK OTHER WISE IT WILL CAUSE ARRAYOUTBOUND EXCEP **********************
							aDEDamt[DTR.getInt("TRNCD")] = DTR.getString("ARR_AMT") == null?0:DTR.getInt("ARR_AMT");//*******CHECK OTHER WISE IT WILL CAUSE ARRAYOUTBOUND EXCEP **********************
							System.out.println(DTR.getInt("TRNCD")+"\t"+DTR.getString("NET_AMT"));
						}
						if(DTR.getInt("TRNCD") == 301)
						{
							LOPDays = DTR.getInt("INP_AMT");
						}
					}
					Str1 = "Emp.Code: "+FixStr(String.valueOf(emp.getString("EMPCODE")), 16, 1)+"| Name  : "+FixStr(FixStr(emp.getString("LNAME").trim()+"  "+emp.getString("FNAME").trim()+ "  "+emp.getString("MNAME").trim(), 42, 1), 50, 1);
					ReportDAO.println(Str1, 0, 1, false, "BANK",repBean);
					Str1 = "P.F. No : "+FixStr(String.valueOf(emp.getString("PFNO")==null?"N/A":emp.getString("PFNO")), 16, 1)+"| Desig.: "+new LookupHandler().getLKP_Desc("DESIG",emp.getInt("DESIG"));
					ReportDAO.println(Str1, 0, 1, false, "BANK",repBean);
					BranchDAO bd= new BranchDAO();
					BranchBean bbean=bd.getParticularBranchDetails(emp.getInt("PRJ_SRNO"));
					Str1 = "SB A/C  : "+FixStr(String.valueOf(emp.getString("ACNO")==null?"":emp.getString("ACNO")), 16, 1)+"| Branch: "+(bbean.getBranchName()==null?"":bbean.getBranchName());
					ReportDAO.println(Str1, 0, 1, false, "BANK",repBean);
					Str1 = "LOP Days: "+FixStr(String.valueOf(LOPDays), 12, 1)+"    |";
					ReportDAO.println(Str1, 0, 1, false, "BANK",repBean);
					ReportDAO.println((char)15+sLine1, 0, 1, false, "BANK",repBean);  //*********Ask P h patil sir  Chr()
					ReportDAO.println("    Salary & Allowances   | Amount.(Rs.)| Arrears  |   Total     |       Deductions          | Amount.(Rs.)| Arrears  |   Total     |", 0, 1, false, "BANK",repBean);
					ReportDAO.println((char)15+sLine1, 0, 1, false, "BANK",repBean);//*********Ask P h patil sir  Chr()

					for(i = 1 ; i <= 40 ; i++)
					{
						if(Icoded[i] != 0 && Ecoded[i] != 0)
						{
							Str1 = FixStr(Idesc[i], 25, 1) + " | " + trans(INCamt[Icoded[i]], "99,99,999.99", "", false, false) +  "| "+trans(aINCamt[Icoded[i]], "99,999.99", "", false, false) + "| "+ trans(INCamt[Icoded[i]]+aINCamt[Icoded[i]], "99,99,999.99", "", false, false) + "| ";
							Str1 = Str1 + FixStr(Edesc[i], 25, 1) + " | " + trans(DEDamt[Ecoded[i]], "99,99,999.99", "", false, false) +  "| "+trans(aDEDamt[Ecoded[i]], "99,999.99", "", false, false) + "| "+ trans(DEDamt[Ecoded[i]]+aDEDamt[Ecoded[i]], "99,99,999.99", "", false, false);
							TotGross[1] = TotGross[1] + INCamt[Icoded[i]];
							TotGross[2] = TotGross[2] + aINCamt[Icoded[i]];
							TotGross[3] = TotGross[3] + aINCamt[Icoded[i]] + INCamt[Icoded[i]];
							TotDed[1] = TotDed[1] + DEDamt[Ecoded[i]];
							TotDed[2] = TotDed[2] + aDEDamt[Ecoded[i]];
							TotDed[3] = TotDed[3] + DEDamt[Ecoded[i]] + aDEDamt[Ecoded[i]];
						}
						else if(Icoded[i] != 0)
						{
							Str1 = FixStr(Idesc[i], 25, 1) + " | " + trans(INCamt[Icoded[i]], "99,99,999.99", "", false, false) +  "| "+trans(aINCamt[Icoded[i]], "99,999.99", "", false, false) + "| "+ trans(INCamt[Icoded[i]]+aINCamt[Icoded[i]], "99,99,999.99", "", false, false) + "| ";
							Str1 = Str1 + ReportDAO.addSpaces("", 25) + " | " + ReportDAO.addSpaces("", 12) + "| " + ReportDAO.addSpaces("", 9) + "| " + ReportDAO.addSpaces("", 12);
							TotGross[1] = TotGross[1] + INCamt[Icoded[i]];
							TotGross[2] = TotGross[2] + aINCamt[Icoded[i]];
							TotGross[3] = TotGross[3] + aINCamt[Icoded[i]] + INCamt[Icoded[i]];
						}
						else if(Ecoded[i] != 0)
						{
							Str1 = ReportDAO.addSpaces("", 25) + " | " + ReportDAO.addSpaces("", 12) + "| " + ReportDAO.addSpaces("", 9) + "| " + ReportDAO.addSpaces("", 12) + "| ";
							Str1 = Str1 + FixStr(Edesc[i], 25, 1) + " | " + trans(DEDamt[Ecoded[i]], "99,99,999.99", "", false, false) +  "| "+trans(aDEDamt[Ecoded[i]], "99,999.99", "", false, false) + "| "+ trans(DEDamt[Ecoded[i]]+aDEDamt[Ecoded[i]], "99,99,999.99", "", false, false);
							TotDed[1] = TotDed[1] + DEDamt[Ecoded[i]];
							TotDed[2] = TotDed[2] + aDEDamt[Ecoded[i]];
							TotDed[3] = TotDed[3] + DEDamt[Ecoded[i]] + aDEDamt[Ecoded[i]];

						}
						else
						{
							break;
						}
						ReportDAO.println(Str1, 0, 1, false, "BANK",repBean);
					}
					ReportDAO.println(String.valueOf((char)15)+sLine1, 0, 1, false, "BANK",repBean); //*********Ask P h patil sir  Chr()
					Str1 = "           Gross Salary:->| "+trans(TotGross[1], "99,99,999.99", "", false, false) + "| " + trans(TotGross[2], "99,999.99", "", false, false) + "| " + trans(TotGross[1]+TotGross[2], "99,99,999.99", "", false, false) + "| ";
					Str1 = Str1 + FixStr("Total Deductions:->", 25, 1) + " | " + trans(TotDed[1], "99,99,999.99", "", false, false) + "| " + trans(TotDed[2], "99,999.99", "", false, false) + "| " + trans(TotDed[1]+TotDed[2], "99,99,999.99", "", false, false);
					ReportDAO.println(Str1, 0, 1, false, "BANK",repBean); 
					Str1 = "            Net Salary :->| "+trans(TotGross[3]-TotDed[3], "99,99,999.99", "", false, false) + "|-------------------------------------------------------------------------------------------";
					ReportDAO.println(Str1, 0, 1, false, "BANK",repBean);
					/*if(TotDed[3] != 0)
					{
						Str1 = "%Of Net Salary With Gross |"+ trans((TotGross[3]-TotDed[3]) / TotGross[3] * 100,"99,99,999.99", "", false, false) + " |"; //*** Convert (TOTGroass[3]-TotDed[3]) to words         remain*********
					}
					else
					{
						Str1 = "0%";
					}
					ReportDAO.println(Str1, 0, 1, false, "BANK",repBean);*/
					ReportDAO.println(sLine1, 0, 1, false, "BANK",repBean);
					Str1 = "Deductions              | Amount      | Cumultive Balance |        Leave Balance       |";
					lSql = "SELECT MAX(L1.BAL),L1.LEAVECD FROM LEAVEBAL L1 WHERE L1.EMPNO = "+emp.getInt("EMPNO")+" AND (L1.srno) IN (SELECT MAX(srno) FROM LEAVEBAL L2 WHERE BALDT <='"+ReportDAO.EOM(Payslipdt)+"' AND L2.EMPNO = "+emp.getInt("EMPNO")+" and L2.LEAVECD = L1.LEAVECD ) GROUP BY L1.LEAVECD";
					//lSql = "SELECT leavecd,max(bal) bal from LEAVEBAL a where a.EMPNO= = "+emp.getInt("EMPNO")+"  AND BALDT=(select max(BALDT) from LEAVEBAL b where EMPNO= a.EMPNO AND LEAVECD= a.LEAVECD and BALDT <='22-Aug-2013' )  group by LEAVECD";			
					System.out.println("@@@@@@@@"+lSql);
					Statement st2 = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
					TmpRs = st2.executeQuery(lSql);
					if(TmpRs.next())
					{
						Str1 = "                          |             |                    |   CL    |   PL    |   SL    |   ML    |";
						ReportDAO.println(Str1, 0, 1, false, "BANK",repBean);
						Str1 = "                          |             |                    |---------------------------------------|";
						ReportDAO.println(Str1, 0, 1, false, "BANK",repBean);
						lSql = "Leave Bal upto "+ReportDAO.EOM(Payslipdt)+"|                                  |";
						Str1 = "";
						for(LP = 1;LP <= 3;LP++)
						{
							LPRN[LP] = "";
						}

						CP = 1;
						TmpRs.beforeFirst();
						while(TmpRs.next())
						{
							for(LP = 1;LP <= 3;LP++)
							{
								if(LPRN[LP].equals(TmpRs.getString(2)))
								{
									continue;
								}
							}
							if(TmpRs.getString(2).equals("3") || TmpRs.getString(2).equals("1") || TmpRs.getString(2).equals("2")|| TmpRs.getString(2).equals("4"))
							{
								Str1 = Str1 + FixStr(String.valueOf(TmpRs.getInt(1)), 9, 2) + "|";
								//System.out.println("str1 = " +Str1);

							}
							LPRN[CP] = TmpRs.getString(2);
							CP =CP + 1;
						}
						lSql = lSql + Str1;
						ReportDAO.println(lSql, 0, 0, false, "BANK",repBean);
						//Str1 = "                          |             |                    |-----------------------------|";
						ReportDAO.println(Str1, 0, 1, false, "BANK",repBean);
					}
					else
					{
						Str1 = "                          |             |                    |   CL    |   PL    |   SL    |   ML    |";
						ReportDAO.println(Str1, 0, 1, false, "BANK",repBean);
						Str1 = "                          |             |                    |---------------------------------------|";
						ReportDAO.println(Str1, 0, 1, false, "BANK",repBean);
						lSql = "Leave Bal upto "+Payslipdt+"|                                  |";
						ReportDAO.println(lSql, 0, 1, false, "BANK",repBean);
					}
					ReportDAO.println(sLine1, 0, 4, false, "BANK",repBean);
					ReportDAO.println("AUTHORISED SIGNATORY", 60, 1, false, "BANK",repBean);
					ReportDAO.println("P&A Dept. H.O", 60, 1, false, "BANK",repBean);
					//*****print(Chr(12));
					ReportDAO.println(String.valueOf((char)12), 0, 1, false, "BANK",repBean);
					repBean.setLnCount(0);

					//ReportDAO.println(String.valueOf((char)18), 0, 1, false, "BANK"); //***********Remain CHr()
				}
				for(i = 0;i <= 3 ; i++)
				{
					TotDed[i] = 0;
					TotGross[i] = 0;

				}
			}

			//*******************CHk by PH patil sir
			//Print (Fp, Chr(12));
			//  Print (Fp, Chr(18);
			//  Close (Fp);
			//FileName = "c:\\payslip.prn";
			//  Load (printfrm);
			// printfrm.Show vbModal;

			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
		} catch (Exception e)
		{
			e.printStackTrace();
			// TODO: handle exception
		}



	}

	public static void payreg(String PAYREGDT,String Desgn,String filepath,String Branch,String designation)
	{
		RepoartBean repBean  = new RepoartBean();
		ResultSet CDM = null;
		ResultSet DTR = null;
		ResultSet emp = null;
		//ResultSet arrrec = null;
		
		float Days = Calculate.getDays(PAYREGDT); 
		LookupHandler lkp=new LookupHandler();
		
		
		FileWriter Fp;
		int aCtr = 0;
		int lCtr = 0;
		int ctr = 0;
		int printBasic = 0;
		int printNet = 0;
		int printGross = 0;
		int printTotDed = 0;
		int LOPDays = 0;
		String BomDt = "";
		String EomDt = "";
		boolean DtrFind = false;
		String lBomDt = "";
		String lEomDt = "";
		int i = 0;
		int j = 0;
		String dtrsql = "";
		String CdmSql = "";
		String EmpSql = "";
		String[] pdet = new String[7];
		String Str1 = "";
		String Str2 = "";
		String Str3 = "";
		String Str4 = "";
		int Str2Ctr = 0;
		int Str4Ctr = 0;
		int Str1Ctr = 0;
		int Arr1Ctr = 0;
		int Arr2Ctr = 0;
		int count = 1;
		String sLOPDTr = "";
		ResultSet LOPDTr = null;
		ReportDAO.inithead(repBean);
		//Initvar                       *****already variable are initialised  not need of initvar
	    ReportDAO.make_prn_file(filepath,repBean);
	    
	    Connection Cn = null;
	    ReportDAO.OpenCon("", "", "",repBean);
	    Cn = repBean.getCn();
		int Hdg6Ctr = 0;
		int Hdg4Ctr = 0;
		int HdgArr1 = 0;
		int HdgArr2 = 0;
		boolean Barr1 = false;
		boolean Barr2 =false;
		boolean fnd = false;
		String Arr1 = "";
		String Arr2 = "";
		String nm = "";
		String pBranch = "";
		String SLINE = "";
		String prj_name ="";
		int page=0;
		
		repBean.setbCode(0);
		SimpleDateFormat outputFormat = new SimpleDateFormat("dd-MMM-yyyy");
		SimpleDateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd"); //
		
	/*	for(i = 1; i<= 26 ;i++)
		{
			repBean.setIcode(0, i);
			repBean.setEcode(0, i);
		}
		for(j = 1; j<= 20 ;j++)
		{
			for(i = 100; i<= 200 ;i++)
			{
			repBean.setbInc(0, j, i);
			}			
		}
		for(i = 100; i<= 199 ;i++)
		{
			repBean.setInc(0, i);
		}
		for(i = 200; i<= 300 ;i++)
		{
			repBean.setDed(0, i);
		}
		for(j = 1; j<= 20 ;j++)
		{
			for(i = 200; i<= 300 ;i++)
			{
			   repBean.setbDed(0, j, i);
			}
		}
		for(i = 1; i<= 4 ;i++)
		{
			repBean.setTotBngd(0, i);
			repBean.setRepTotBNGD(0, i);
		}
		for(i = 1; i<= 20 ;i++)
		{
			for(j = 1; j<= 4 ;j++)
			{
				repBean.setBtotBngd(0, i, j);
			}
		}*/
		
		
	    
	    repBean.setLnCount(0);
		repBean.setPayrep(true);
		repBean.setPageNo(1);
	    repBean.setLineLen(231);
	    repBean.setPageLen(65);
	    repBean.setLineSpace(10);
		BomDt = ReportDAO.BOM(PAYREGDT);
		repBean.setFoot_Fl(true);
		
		 
		
		
		EomDt = ReportDAO.EOM(PAYREGDT);
		lBomDt =  ReportDAO.BOM(ReportDAO.DateAdd('m', -1, PAYREGDT));
		lEomDt = ReportDAO.EOM(lBomDt);
		ReportDAO.make_prn_file(filepath,repBean);
		String temp = PAYREGDT.substring(3);
	
	
		

		repBean.setHdg1("Salary Sheet For The Month Of :- "+temp);

		SLINE = stringOfSize(231, '-');
		String str2 = "";
		
		if(!Desgn.equalsIgnoreCase("0")){
			Str2 = "AND T.DESIG = "+Desgn;
		}
			
		dtrsql = "SELECT * FROM PAYTRAN WHERE TRNDT BETWEEN '" + BomDt + "' AND '" + EomDt + "'";
		try
		{
			Statement st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
			DTR = st.executeQuery(dtrsql);
			if(!DTR.next())
			{
				dtrsql = "SELECT * FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '" + lBomDt + "' AND '" + EomDt + "'";
			}
			else
			{
				DtrFind = true;
				dtrsql = "SELECT * FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '" + lBomDt + "' AND '" + EomDt + "'";
				dtrsql = dtrsql + "UNION SELECT * FROM PAYTRAN WHERE TRNDT BETWEEN '" + lBomDt + "' AND '" + EomDt + "'";
			}
			
			//-----CHanged By PHP Sir
			
			CdmSql = "SELECT * FROM CDMAST WHERE PSLIPYN = 'Y' AND TRNCD <= 293 AND TRNCD IN (SELECT TRNCD FROM CDMAST INTERSECT SELECT DISTINCT(TRNCD) FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '" + BomDt + "' AND '" + EomDt + "') ORDER BY  PRNTSEQNCE , TRNCD ";
			
			//selection of employee for selected month salry..
			if(Desgn.equalsIgnoreCase("1"))// For branchwise 
			{	
				EmpSql = "SELECT EMP.*, T.ACNO, T.PRJ_SRNO, T.DESIG,T.DEPT  FROM EMPMAST EMP, EMPTRAN T WHERE T.EMPNO = EMP.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = EMP.EMPNO AND E2.EFFDATE <= '"+EomDt+"')" +
						" AND (( EMP.STATUS='A' AND EMP.DOJ <= '"+EomDt+"')  or (EMP.STATUS ='N' And  EMP.DOL>='"+BomDt+"' ))  and T.PRJ_SRNO='"+Branch+"'  ORDER BY T.PRJ_SRNO, T.DESIG";
			System.out.println("EmpSql  is "+EmpSql);
			}
			else {
				
				if(Desgn.equalsIgnoreCase("2")) // For Designation Wise
				{
					EmpSql = "SELECT EMP.*, T.ACNO, T.PRJ_SRNO, T.DESIG,T.DEPT FROM EMPMAST EMP, EMPTRAN T WHERE T.EMPNO = EMP.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = EMP.EMPNO AND E2.EFFDATE <= '"+EomDt+"')" +
							" AND (( EMP.STATUS='A' AND EMP.DOJ <= '"+EomDt+"')  or (EMP.STATUS ='N' And  EMP.DOL>='"+BomDt+"' )) And T.DESIG ='"+designation+"' ORDER BY T.PRJ_SRNO, T.DESIG";
					
					System.out.println("For Designation Wise:: "+EmpSql);
				}
				else //For All Branches
			  {
					EmpSql = "SELECT EMP.*, T.ACNO, T.PRJ_SRNO, T.DESIG,T.DEPT FROM EMPMAST EMP, EMPTRAN T WHERE T.EMPNO = EMP.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = EMP.EMPNO AND E2.EFFDATE <= '"+EomDt+"')" +
							" AND (( EMP.STATUS='A' AND EMP.DOJ <= '"+EomDt+"')  or (EMP.STATUS ='N' And  EMP.DOL>='"+BomDt+"' )) "+Str2+" ORDER BY T.PRJ_SRNO, T.DESIG";
				System.out.println("For All Branches:: "+EmpSql);
			  }
			}
			
			DTR = st.executeQuery(dtrsql);
			if(!DTR.next())
			{
				dtrsql = "SELECT * FROM PAYTRAN WHERE TRNDT BETWEEN '" + lBomDt + "' AND '" + EomDt + "'";
				DTR = st.executeQuery(dtrsql);
				if(!DTR.next())
				{
					System.out.println("Transactions not found");
					Fp = repBean.getFp();
					Fp.close();
					return;
				}
				
			}
			Barr1 = false;
			Barr2 = false;
			DTR.beforeFirst();
			while(DTR.next())
			{
				if(DTR.getInt("TRNCD") <= 200)
				{
					if((DTR.getString("ARR_AMT")==null?0:DTR.getInt("ARR_AMT"))!=0)
					{
						Barr1 = true;
					}
					
				}
				else 
				{
					if(DTR.getInt("TRNCD") >= 201 && DTR.getInt("TRNCD") <= 293)
					{
						if((DTR.getString("ARR_AMT")==null?0:DTR.getInt("ARR_AMT"))!=0)
						{
							Barr2 = true;
						}
						
					}
				}
			}
			System.out.println("code selection 111---"+CdmSql);
			CDM = st.executeQuery(CdmSql);
			if(!CDM.next())
			{
				CdmSql = "SELECT * FROM CDMAST WHERE TRNCD <= 293 AND TRNCD IN (SELECT TRNCD FROM CDMAST INTERSECT SELECT DISTINCT (TRNCD) FROM PAYTRAN WHERE TRNDT BETWEEN '" + lBomDt + "' AND '" + EomDt + "')  and PSLIPYN='Y'  ORDER BY  PRNTSEQNCE , TRNCD";
				CDM = st.executeQuery(CdmSql);
				if(!CDM.next())
				{
					System.out.println("No any Code to print");
					Fp = repBean.getFp();
					Fp.close();
					return;
				}
			}
			CDM.beforeFirst();
			repBean.setHdg2("Empcode| Employee Name      |P-Day | Allowances:->|");
			repBean.setHdg3("       |                                Arrears:->|");
			repBean.setHdg4("       | SB.A/c No.| Desig. | Dept.               |");
			repBean.setHdg5("Sr.No. | Original Basic     LOP Days Deductions:->|");
			repBean.setHdg6("       |                                Arrears:->|");
			repBean.setHdg7("       | Gross Pay.     Total Ded.   Net Pay      |");
			
			while(CDM.next())
			{
				if(CDM.getInt("TRNCD") <= 200)
				{
					aCtr = aCtr + 1;
					if(aCtr <= 12)
					{
						repBean.setHdg2(repBean.getHdg2() +  FixStr(CDM.getString("SDESC"), 14, 2) + "|");
						repBean.setIcode(CDM.getInt("TRNCD"), aCtr);
					}
					else
					{
						repBean.setHdg4(repBean.getHdg4() + FixStr(CDM.getString("SDESC"), 14, 2) + "|");
						repBean.setIcode(CDM.getInt("TRNCD"), aCtr);
						Hdg4Ctr = Hdg4Ctr + 1;
					}
				}
				else
				{
					lCtr = lCtr + 1;
					if(lCtr <= 12)
					{
						repBean.setHdg5(repBean.getHdg5() + FixStr(CDM.getString("SDESC"), 14, 2) + "|");
						repBean.setEcode(CDM.getInt("TRNCD"), lCtr);
					}
					else
					{
						repBean.setHdg7(repBean.getHdg7() + FixStr(CDM.getString("SDESC"), 14, 2) + "|");
						repBean.setEcode(CDM.getInt("TRNCD"), lCtr);
						Hdg6Ctr = Hdg6Ctr + 1;
					}
				}
			}
			
			for(i = 1; i <= 12; i++)
			{
				repBean.setHdg3(repBean.getHdg3() + ReportDAO.addSpaces("", 14) + "|");
				repBean.setHdg6(repBean.getHdg6() + ReportDAO.addSpaces("", 14) + "|");
			}
			for(i = Hdg4Ctr + 1; i <= 12; i++)
			{
				repBean.setHdg4(repBean.getHdg4() + ReportDAO.addSpaces("", 14) + "|");
			}
			for(j = Hdg6Ctr + 1; j <= 12; j++)
			{
				repBean.setHdg7(repBean.getHdg7() + ReportDAO.addSpaces("", 14) + "|");
			}
			Statement st1 = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
			emp = st1.executeQuery(EmpSql);
			
			if(!emp.next())
			{
				System.out.println("Employee Recordset is Empty");
				Fp = repBean.getFp();
				Fp.close();
				return;
			}
			//pBranch = "";
			emp.beforeFirst();
			while(emp.next())
			{
				if(!DtrFind)
				{
					dtrsql = "SELECT * FROM PAYTRAN_STAGE Y,CDMAST C WHERE (Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293 ) AND Y.EMPNO = '"+emp.getInt("EMPNO")+"' AND Y.TRNDT BETWEEN '"+lBomDt+"' AND '"+EomDt+"' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y' ORDER BY C.PRNTSEQNCE , C.TRNCD ";
				}
				else
				{
					dtrsql = "SELECT * FROM PAYTRAN_STAGE Y,CDMAST C WHERE (Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293 ) AND Y.EMPNO = '"+emp.getInt("EMPNO")+"' AND Y.TRNDT BETWEEN '"+lBomDt+"' AND '"+EomDt+"' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y'";
					dtrsql = dtrsql + " UNION SELECT * FROM PAYTRAN Y ,CDMAST C WHERE ( Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293 ) AND Y.EMPNO = '"+emp.getInt("EMPNO")+"' AND Y.TRNDT BETWEEN '"+lBomDt+"' AND '"+EomDt+"' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y'  ORDER BY C.PRNTSEQNCE , C.TRNCD ";
				}
				
				
				Str1 = "";
			        Str2 = "";
			        Str3 = "";
			        Str4 = "";
			        Arr1 = "";
			        Arr2 = "";
			        nm = "";
			        aCtr = 0;
			        Str2Ctr = 0;
			        Str1Ctr = 0;
			        Arr1Ctr = 0;
			        Arr2Ctr = 0;
			        lCtr = 0;
			        LOPDays = 0;
				DTR = st.executeQuery(dtrsql);
				if(!DTR.next())
				{
					dtrsql = "SELECT * FROM PAYTRAN Y,CDMAST C WHERE (Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293 ) AND Y.EMPNO = '"+emp.getInt("EMPNO")+"' AND Y.TRNDT BETWEEN '"+lBomDt+"' AND '"+EomDt+"' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y'  ORDER BY C.PRNTSEQNCE , C.TRNCD  ";
					DTR = st.executeQuery(dtrsql);
					if(!DTR.next())
					{
						//System.out.println("Transaction not found for this Employee "+emp.getInt("EMPNO"));
						//System.out.println("Branch name is thissss"+emp.getString("BRANCH"));
					}
				
				}
				
				
				// for printing the branch name when the branch is changed
				
				if(!pBranch.equalsIgnoreCase(emp.getString("PRJ_SRNO")))
				{
					repBean.setBrnNo(emp.getInt("PRJ_SRNO"));
					
					
					//if(!repBean.isPayrep())
					{	Connection conn = ConnectionManager.getConnectionTech();
						Statement stmt = conn.createStatement();
						
						
						// getting the name of branch
						String prjquery = "select Site_Name from Project_Sites where SITE_ID = '"+emp.getString("PRJ_SRNO")+"'";
						ResultSet prj = stmt.executeQuery(prjquery);
						if(prj.next()){
							prj_name = prj.getString("Site_Name");
							//prj_code = prj.getString("Project_Code");
						}
						prj.close();
				    	 stmt.close();
				    	 conn.close();
				    	
				    	 // for the first page heading
				    	 if(page==0){
				         ReportDAO.println(String.valueOf((char)15), 0, 0, false, "",repBean);
				     		 
						 ReportDAO.println("THE BUSINESS CO.OP BANK LTD., Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101.", 105, 2, false, "",repBean);	 
				    	 ReportDAO.println(SLINE, 10, 1, false, "BANK",repBean);
				    	 }
				    	 
				    	 else{
				    		 
				    		// ReportDAO.println(String.valueOf((char)15), 0, 0, false, "BANK",repBean);
				    		 
				    		 // branch total footer
					    	 ReportDAO.println(SLINE, 10, 1, false, "",repBean);
								PrintFootLines(repBean.getObjBRepTotINC(), repBean.getObjBRepTotDED(), repBean.getObjBRepTotBNGD(), "TOTAL->" + "|" + " Grand Total This BRANCH  Current Month : "+ "|",repBean);
								 ReportDAO.println(SLINE, 10, 1, true, "",repBean);
					    	 ReportDAO.println("", 10, 5, false, "",repBean);

				    	 }
				    	 
							
				    	 // name of the next branch 
						ReportDAO.println("BRANCH NAME :- "+prj_name+"", 17, 1, false, "BANK",repBean);
						ReportDAO.println(SLINE, 10, 1, false, "BANK",repBean);
					}	
					repBean.setNoEmp(0);
					ctr = 1;
					
				
					
					repBean.setPayrep(false);
					repBean.setBar1(Barr1);
					repBean.setBar2(Barr2);
					
					if(Barr1 && Barr2)
					{
						ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),repBean.getHdg2(),repBean.getHdg3(),repBean.getHdg4(),repBean.getHdg5(),repBean.getHdg6(),repBean.getHdg7(),repBean);
						
					}
					else
					{
						if(Barr1)
						{
							ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),repBean.getHdg2(),repBean.getHdg3(),repBean.getHdg4(),repBean.getHdg5(),"",repBean.getHdg7(),repBean);
						}
						else if(Barr2)
						{
							ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),repBean.getHdg2(),"",repBean.getHdg4(),repBean.getHdg5(),repBean.getHdg6(),repBean.getHdg7(),repBean);
						}
						else
						{
							ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),repBean.getHdg2(),"",repBean.getHdg4(),repBean.getHdg5(),"",repBean.getHdg7(),repBean);
						}
					}
					pBranch = emp.getString("PRJ_SRNO");
					
					
					// seeting all value to zero for the next branch
					for(i = 100; i <= 200; i++){
						repBean.setBRepTotINC(Math.abs(repBean.getBRepTotINC(i) - repBean.getBRepTotINC(i)),i);
					}
					for(i = 200; i <= 300; i++){
						repBean.setBRepTotDED(Math.abs(repBean.getBRepTotDED(i) - repBean.getBRepTotDED(i)),i);
					}
					for(i = 1; i <= 4; i++){
						repBean.setBRepTotBNGD(Math.abs(repBean.getBRepTotBNGD(i) - repBean.getBRepTotBNGD(i)),i);
					}
					
					page++;
					//for srno by branch wise employee
					count=1;
					
					
					
					
				}
				else
				{
					//ReportDAO.println(String.valueOf((char)15), 0, 0, true, "BANK",repBean);
					//ReportDAO.println("", 0, 1, true, "BANK",repBean);
				}
				//System.out.println(dtrsql);
				
				
				if(DTR.next())
				{
					
					ctr = ctr + 1;
					
					
					
					
					DTR.beforeFirst();
					
					while(DTR.next())
					{
						// for previous month salary total
						if(compareDate(outputFormat.format(inputFormat.parse(DTR.getString("TRNDT"))),lBomDt) && compareDate(lEomDt,outputFormat.format(inputFormat.parse(DTR.getString("TRNDT")))))	// Changed 
						{
							if(DTR.getInt("TRNCD") <= 200)
							{
								
								repBean.setPInc(repBean.getPInc(DTR.getInt("TRNCD")) + (DTR.getString("NET_AMT")==null?0:DTR.getInt("NET_AMT")) + (DTR.getString("ARR_AMT")==null?0:DTR.getInt("ARR_AMT")), DTR.getInt("TRNCD"));
								repBean.setPRepTotINC(repBean.getPRepTotINC(DTR.getInt("TRNCD")) + (DTR.getString("NET_AMT")==null?0:DTR.getInt("NET_AMT")) + (DTR.getString("ARR_AMT")==null?0:DTR.getInt("ARR_AMT")), DTR.getInt("TRNCD"));
								
							}
							else if( DTR.getInt("TRNCD") >= 201 && DTR.getInt("TRNCD") <= 293)
							{
								repBean.setPDed(repBean.getPDed(DTR.getInt("TRNCD")) + (DTR.getString("NET_AMT")==null?0:DTR.getInt("NET_AMT")) + (DTR.getString("ARR_AMT")==null?0:DTR.getInt("ARR_AMT")), DTR.getInt("TRNCD"));
								repBean.setPRepTotDED(repBean.getPRepTotDED(DTR.getInt("TRNCD")) + (DTR.getString("NET_AMT")==null?0:DTR.getInt("NET_AMT")) + (DTR.getString("ARR_AMT")==null?0:DTR.getInt("ARR_AMT")), DTR.getInt("TRNCD"));
								
							}
							if(DTR.getInt("TRNCD") == 101)
							{
								repBean.setPTotBNGD(repBean.getPTotBNGD(1) + (DTR.getString("INP_AMT")==null?0:DTR.getInt("INP_AMT")), 1);
								repBean.setPRepTotBNGD(repBean.getPRepTotBNGD(1) + (DTR.getString("INP_AMT")==null?0:DTR.getInt("INP_AMT")),1);
							}
							if(DTR.getInt("TRNCD") == 999)
							{
								repBean.setPTotBNGD(repBean.getPTotBNGD(2) + (DTR.getString("NET_AMT")==null?0:DTR.getInt("NET_AMT")),2);
								repBean.setPTotBNGD(repBean.getPTotBNGD(3) + (DTR.getString("INP_AMT")==null?0:DTR.getInt("INP_AMT")),3);
								repBean.setPTotBNGD(repBean.getPTotBNGD(4) + (DTR.getString("CAL_AMT")==null?0:DTR.getInt("CAL_AMT")),4);
								repBean.setPRepTotBNGD(repBean.getPRepTotBNGD(2) + (DTR.getString("NET_AMT")==null?0:DTR.getInt("NET_AMT")),2);
								repBean.setPRepTotBNGD(repBean.getPRepTotBNGD(3) + (DTR.getString("INP_AMT")==null?0:DTR.getInt("INP_AMT")),3);
								repBean.setPRepTotBNGD(repBean.getPRepTotBNGD(4) + (DTR.getString("CAL_AMT")==null?0:DTR.getInt("CAL_AMT")),4);
							}
						}
						else
						{
							if(DTR.getInt("TRNCD") <= 200)
							{
								aCtr = aCtr + 1;
								if(aCtr <= 12)
								{
									if(repBean.getIcode(aCtr) != DTR.getInt("TRNCD"))
									{
										while(repBean.getIcode(aCtr) != DTR.getInt("TRNCD"))
										{
											if(aCtr <= 12)
											{
												Str1 = Str1 + ReportDAO.addSpaces("", 14) + "|";
											}
											else 
											{
												Str2 = Str2 + ReportDAO.addSpaces("", 14) + "|";
												Str2Ctr = Str2Ctr + 1;
											}
											aCtr = aCtr + 1;
											if(aCtr > 24)
											{
												break;
											}
										}
										if(aCtr > 12)
										{
											Str2 = Str2 + FixStr(trans((DTR.getString("NET_AMT")==null?0:DTR.getInt("NET_AMT")), "999,99,999.99", "", false, false), 14, 3) + "|";
											Str2Ctr = Str2Ctr + 1;
										}
									}
									if(aCtr <= 12)
									{
										Str1 = Str1 + FixStr(trans((DTR.getString("NET_AMT")==null?0:DTR.getInt("NET_AMT")), "999,99,999.99", "", false, false), 14, 3) + "|";
																				
										if((DTR.getString("ARR_AMT")==null?0:DTR.getInt("ARR_AMT"))!=0)
										{
											Arr1 = Arr1 +FixStr(trans((DTR.getString("NET_AMT")==null?0:DTR.getInt("NET_AMT")), "999,99,999.99", "", false, false), 14, 3) + "|";
											Arr1Ctr = Arr1Ctr + 1;
										}
									}
								}
								else 
								{
									if(aCtr < 24 )
									{
									//System.out.println("Trncd is "+DTR.getInt("TRNCD"));
									if(repBean.getIcode(aCtr) != DTR.getInt("TRNCD"))
									{
										while(repBean.getIcode(aCtr) != DTR.getInt("TRNCD"))
										{
											Str2 = Str2 + ReportDAO.addSpaces("", 14) + "|";
											Str2Ctr = Str2Ctr + 1;
											aCtr = aCtr + 1;
											if(aCtr > 24)//Added by nakul patil for arrayindexofboundsexception
											{
												break;
											}
										}
									}
									}
									Str2 = Str2 + FixStr(trans((DTR.getString("NET_AMT")==null?0:DTR.getInt("NET_AMT")), "999,99,999.99", "", false, false), 14, 3) + "|";
									Str2Ctr = Str2Ctr + 1;
									
								}
								repBean.setInc(repBean.getInc(DTR.getInt("TRNCD")) + (DTR.getString("NET_AMT")==null?0:DTR.getInt("NET_AMT")) + (DTR.getString("ARR_AMT")==null?0:DTR.getInt("ARR_AMT")),DTR.getInt("TRNCD"));
								repBean.setRepTotINC(repBean.getRepTotINC(DTR.getInt("TRNCD")) + (DTR.getString("NET_AMT")==null?0:DTR.getInt("NET_AMT")) + (DTR.getString("ARR_AMT")==null?0:DTR.getInt("ARR_AMT")),DTR.getInt("TRNCD"));
								repBean.setBRepTotINC(repBean.getBRepTotINC(DTR.getInt("TRNCD")) + (DTR.getString("NET_AMT")==null?0:DTR.getInt("NET_AMT")) + (DTR.getString("ARR_AMT")==null?0:DTR.getInt("ARR_AMT")),DTR.getInt("TRNCD"));

							}
							else
							{
								if(DTR.getInt("TRNCD") >= 201 && DTR.getInt("TRNCD") <= 293)
								{
									lCtr = lCtr + 1;
									if(lCtr <= 12)
									{
										if(repBean.getEcode(lCtr) != DTR.getInt("TRNCD")){
											while(repBean.getEcode(lCtr) != DTR.getInt("TRNCD"))
											{
												if(lCtr <= 12)
												{
													Str3 = Str3 + ReportDAO.addSpaces("", 14) + "|";
												}
												else 
												{
													Str4 =Str4 + FixStr(trans((DTR.getString("NET_AMT")==null?0:DTR.getInt("NET_AMT")), "999,99,999.99", "", false, false), 14, 3) + "|";
													Str4Ctr = Str4Ctr + 1;
													
												}
												lCtr =lCtr + 1;
												if(lCtr > 24)
												{
													break;
												}
												
											}
											if(lCtr > 12)
											{
												Str4 =Str4 + FixStr(trans((DTR.getString("NET_AMT")==null?0:DTR.getInt("NET_AMT")), "999,99,999.99", "", false, false), 14, 3) + "|";
												Str4Ctr = Str4Ctr + 1;
											}
											
										}
										if(lCtr <= 12)
										{
											Str3 =Str3 + FixStr(trans((DTR.getString("NET_AMT")==null?0:DTR.getInt("NET_AMT")), "999,99,999.99", "", false, false), 14, 3) + "|";
											
											if((DTR.getString("ARR_AMT")==null?0:DTR.getInt("ARR_AMT"))!=0)
											{
												Arr2 = Arr2 + FixStr(trans((DTR.getString("ARR_AMT")==null?0:DTR.getInt("ARR_AMT")), "999,99,999.99", "", false, false), 14, 3) + "|";
											    Arr2Ctr = Arr2Ctr + 1;	
											}
										}
									}
									else
									{
										if(lCtr < 24 )
										{
											if(repBean.getEcode(lCtr) != DTR.getInt("TRNCD"))
											{
												while(repBean.getEcode(lCtr) != DTR.getInt("TRNCD"))
												{
													Str4 = Str4 + ReportDAO.addSpaces("", 14) + "|";
													lCtr = lCtr + 1;
													if(lCtr > 24)
													{
														break; 
													 }
												}
											}
										}
										Str4 = Str4 + FixStr(trans((DTR.getString("NET_AMT")==null?0:DTR.getInt("NET_AMT")), "999,99,999.99", "", false, false), 14, 3) + "|";
										Str4Ctr = Str4Ctr + 1;
										
									}
									repBean.setDed(repBean.getDed(DTR.getInt("TRNCD")) + (DTR.getString("NET_AMT")==null?0:DTR.getInt("NET_AMT")) + (DTR.getString("ARR_AMT")==null?0:DTR.getInt("ARR_AMT")),DTR.getInt("TRNCD"));
									repBean.setRepTotDED(repBean.getRepTotDED(DTR.getInt("TRNCD")) +  (DTR.getString("NET_AMT")==null?0:DTR.getInt("NET_AMT")) + (DTR.getString("ARR_AMT")==null?0:DTR.getInt("ARR_AMT")),DTR.getInt("TRNCD"));
									repBean.setBRepTotDED(repBean.getBRepTotDED(DTR.getInt("TRNCD")) +  (DTR.getString("NET_AMT")==null?0:DTR.getInt("NET_AMT")) + (DTR.getString("ARR_AMT")==null?0:DTR.getInt("ARR_AMT")),DTR.getInt("TRNCD"));

								}
							}
							if(DTR.getInt("TRNCD") == 101)
							{
								printBasic = DTR.getString("INP_AMT") == null?0:DTR.getInt("INP_AMT");
								repBean.setTotBngd(repBean.getTotBngd(1)  + printBasic,1);
								repBean.setRepTotBNGD(repBean.getRepTotBNGD(1)  + printBasic,1);
								repBean.setBRepTotBNGD(repBean.getBRepTotBNGD(1)  + printBasic,1);
							}
							if(DTR.getInt("TRNCD") == 999)
							{
								printNet = DTR.getString("NET_AMT") == null?0:DTR.getInt("NET_AMT");
								printGross = DTR.getString("INP_AMT") == null?0:DTR.getInt("INP_AMT");
								printTotDed = DTR.getString("CAL_AMT") == null?0:DTR.getInt("CAL_AMT");
								repBean.setTotBngd(repBean.getTotBngd(2) + printNet,2);
								repBean.setTotBngd(repBean.getTotBngd(3) + printGross,3);
								repBean.setTotBngd(repBean.getTotBngd(4) + printTotDed,4);
								repBean.setRepTotBNGD(repBean.getRepTotBNGD(2) + printNet,2);
								
								repBean.setBRepTotBNGD(repBean.getBRepTotBNGD(2) + printNet,2);
								repBean.setRepTotBNGD(repBean.getRepTotBNGD(3) + printGross,3);
								repBean.setBRepTotBNGD(repBean.getBRepTotBNGD(3) + printGross,3);
								repBean.setRepTotBNGD(repBean.getRepTotBNGD(4) + printTotDed,4);
								repBean.setBRepTotBNGD(repBean.getBRepTotBNGD(4) + printTotDed,4);
							}
							if(DTR.getInt("TRNCD") == 301)
							{
								LOPDays = DTR.getInt("INP_AMT");
							}
						}
					}
					
					
					for(i = Arr1Ctr + 1; i <= 12 ;i++)
					{
						Arr1 = Arr1 + ReportDAO.addSpaces("", 14) + "|";
					}
					for(i = Arr2Ctr + 1; i <= 12 ;i++)
					{
						Arr2 = Arr2 + ReportDAO.addSpaces("", 14) + "|";
					}
					for(i = aCtr + 1; i <= 12 ;i++)
					{
						Str1 = Str1 + ReportDAO.addSpaces("", 14) + "|";
					}
					for(j = lCtr + 1; j <= 12 ;j++)
					{
						Str3 = Str3 + ReportDAO.addSpaces("", 14) + "|";
					}
					for(i = Str2Ctr + 1; i <= 12 ;i++)
					{
						Str2 = Str2 + ReportDAO.addSpaces("", 14) + "|";
					}
					for(j = Str4Ctr + 1; j <= 12 ;j++)
					{
						Str4 = Str4 + ReportDAO.addSpaces("", 14) + "|";
					}    
					nm = ltrim(FixStr(" "+emp.getString("LNAME").trim() +"  " + emp.getString("FNAME").trim()+"  "+emp.getString("MNAME").trim()+" | "+(Days-LOPDays), 42, 1));
					Str1 = FixStr(String.valueOf(emp.getString("EMPCODE")), 7, 1).substring(0, 7)+ "|"+ nm +"|"+ Str1;
//					Str2 = "|" + FixStr(String.valueOf(emp.getString("ACNO")), 16, 1) +FixStr(String.valueOf(lkp.getLKP_Desc("DESIG",emp.getInt("DESIG"))),26,1)+ "|" + Str2;
					Str2 = "|" + FixStr(String.valueOf(emp.getString("ACNO")), 9, 1)+" | " +FixStr(String.valueOf(lkp.getLKP_Desc("DESIG",emp.getInt("DESIG"))),17,1)+ "| " +FixStr(lkp.getLKP_Dept("DEPT",emp.getString("DEPT")==null?"0":emp.getString("DEPT")), 11, 1)+"|"+ Str2;
					Str3 = FixStr(String.valueOf(count++), 7, 1) + "|" + FixStr(trans(printBasic, "99,99,999.99", "", false, false), 14, 3) + FixStr(trans(LOPDays, "999", "", false, false),14,3) + ReportDAO.addSpaces("",14) + "|" + Str3;
					Str4 = "|" + FixStr(trans(printGross, "99,99,999.99", "", false, false), 14, 3) + FixStr(trans(printTotDed, "99,99,999.99", "", false, false), 14, 3) + FixStr(trans(printNet, "99,99,999.99", "", false, false), 14, 3) + "|" + Str4;
					if(printNet < 0)
					{
						System.out.println("THIS EMPLOYEE SALARY GOES -VE PLEASE CHECK IT AND PROCESS PAYCAL AGAIN");
						return;
					}
					Arr1 = "|" + ReportDAO.addSpaces("", 42) + "|" + Arr1;
		            Arr2 = "|" + ReportDAO.addSpaces("", 42) + "|" + Arr2;
		            ReportDAO.println(SLINE, 10, 1, false, "BANK",repBean); 
		            

		            ReportDAO.println(Str1, 10, 1, false, "BANK",repBean);
		            if(Barr1){
		            	ReportDAO.println(Arr1, 17, 1, false, "BANK",repBean);
		            }
		            ReportDAO.println(Str2, 17, 1, false, "BANK",repBean);
		            ReportDAO.println(Str3, 10, 1, false, "BANK",repBean);
		            if(Barr2){
		            	ReportDAO.println(Arr2, 17, 1, false, "BANK",repBean);
		            }
		            ReportDAO.println(Str4, 17, 1, false, "BANK",repBean);
		           PrintBlankLine(repBean);
		            
				}
				printBasic = 0;
		        printNet = 0;
		        printGross = 0;
		        printTotDed = 0;
		        repBean.setNoEmp(repBean.getNoEmp() + 1);
		        repBean.setBNoEmp(repBean.getBNoEmp() + 1);
				
			}
			if(!repBean.isPayrep()){
				
				// for the last branch total footer
				ReportDAO.println(SLINE, 10, 1, false, "BANK",repBean);
			
				PrintFootLines(repBean.getObjBRepTotINC(), repBean.getObjBRepTotDED(), repBean.getObjBRepTotBNGD(), "TOTAL->" + "|" + " Grand Total This BRANCH  Current Month : "+ "|",repBean);

				ReportDAO.println(SLINE, 10, 1, false, "BANK",repBean);
			}
			
			
			
			repBean.setNoEmp(repBean.getBNoEmp());
			/*for(i = 100; i <= 200; i++){
				repBean.setBRepTotINC(repBean.getBRepTotINC(i),i);
			}
			for(i = 200; i <= 300; i++){
				repBean.setBRepTotDED(repBean.getBRepTotDED(i),i);
			}
			for(i = 1; i <= 4; i++){
				repBean.setBRepTotBNGD(repBean.getBRepTotBNGD(i),i);
			}*/
			
			if(Desgn.equalsIgnoreCase("0")||Desgn.equalsIgnoreCase("2")) // For All Branch
			{	
			ReportDAO.println(SLINE, 10, 4, true, "",repBean);
			PrintFootLines(repBean.getObjRepTotINC(), repBean.getObjRepTotDED(), repBean.getObjRepTotBNGD(), "TOTAL->" + "|" + " Grand Total BRANCHES Current Month : "+ "|",repBean);
			
			PrintFootLines(repBean.getObjPRepTotINC(), repBean.getObjPRepTotDED(), repBean.getObjPRepTotBNGD(),  "       " + "|" + " Grand Total  BRANCHES Previous Month :"+ "|",repBean);
		    
			for(i = 100; i <= 200; i++){
				repBean.setRepTotINC(Math.abs(repBean.getRepTotINC(i) - repBean.getPRepTotINC(i)),i);
			}
			for(i = 200; i <= 300; i++){
				repBean.setRepTotDED(Math.abs(repBean.getRepTotDED(i) - repBean.getPRepTotDED(i)),i);
			}
			for(i = 1; i <= 4; i++){
				repBean.setRepTotBNGD(Math.abs(repBean.getRepTotBNGD(i) - repBean.getPRepTotBNGD(i)),i);
			}
			PrintFootLines(repBean.getObjRepTotINC(), repBean.getObjRepTotDED(), repBean.getObjRepTotBNGD(),  "       " + "|" + " Variance In SAL. OF ALL BRANCHES     :-> " + "|",repBean);
			
			
			
			ReportDAO.println(SLINE, 10, 4, false, "BANK",repBean);
			ReportDAO.println("Passed For Payment", 206, 2, false, "BANK",repBean);
			ReportDAO.println("THE BUSINESS CO.OP BANK LTD, Nashik", 193, 2, false, "BANK",repBean);
		
			ReportDAO.println(String.valueOf((char)15), 10, 4, false, "BANK",repBean); //***********Remain CHr()

			
			ReportDAO.println("C.E.O. / GENERAL MANAGER / MANAGER", 200, 2, false, "BANK",repBean);
			ReportDAO.println("Note: Net Salary will be credited to Dhan Br. SB A/C on "+ReportDAO.EOM(PAYREGDT)+" ", 17, 2, false, "BANK",repBean);
			ReportDAO.println("Please Check PL/HO voucher entries in ABBPTR batch ", 17, 2, false, "BANK",repBean);

			

			//Print #fp Chr(12)
			//Print #fp Chr(18)
			 repBean.setLnCount(0);
			 repBean.setBrnNo(999);
			 repBean.setPageNo(1);
			 ReportDAO.println(String.valueOf((char)15), 10, 4, false, "",repBean); //***********Remain CHr()
			temp = PAYREGDT.substring(3);
			repBean.setHdg1("Summary Of Salary Sheet For The Month Of :- " +temp);
			ReportDAO.println("", 10, 1, false, "",repBean);
			repBean.setPayrep(false);
			/*if(Barr1 && Barr2)
			{
				ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),repBean.getHdg2(),repBean.getHdg3(),repBean.getHdg4(),repBean.getHdg5(),repBean.getHdg6(),repBean.getHdg7(),repBean);
			}
			else
			{
				if(Barr1)
				{
					ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),repBean.getHdg2(),repBean.getHdg3(),repBean.getHdg4(),repBean.getHdg5(),"",repBean.getHdg7(),repBean);
				}
				else if(Barr2)
				{
					ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),repBean.getHdg2(),"",repBean.getHdg4(),repBean.getHdg5(),repBean.getHdg6(),repBean.getHdg7(),repBean);
				}
				else
				{
					ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),repBean.getHdg2(),"",repBean.getHdg4(),repBean.getHdg5(),"",repBean.getHdg7(),repBean);
				}
			}*/
		
			for (int Kk = 1; Kk <= repBean.getbCode(); Kk++) {
				PaySummary(Kk,repBean);
			}
			//ReportDAO.println(SLINE, 10, 1, false, "",repBean);
			//PrintFootLines(repBean.getObjRepTotINC(), repBean.getObjRepTotDED(), repBean.getObjRepTotBNGD(), "TOTAL->" + "|" + " Grand Total ALL BRANCHES Current Month : "+ "|",repBean);

			//PrintFootLines(repBean.getObjRepTotINC(), repBean.getObjRepTotDED(), repBean.getObjRepTotBNGD(), "TOTAL->" + "|" + " Grand Total ALL BRANCHES Current Month : " + "|",repBean);
			
			//ReportDAO.println(SLINE, 10, 1, false, "",repBean);
			
			
			}
			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
			return;
		}
		catch (Exception e)
		{
			e.printStackTrace();
		}
		
	}

	
	
	
	//payreg according to namco in txt foramt bY Hrishi starts here
	public static void payregWithBranchTotal(String PAYREGDT, String Desgn, String filepath)
	{


		System.out.println("frfrre.rerlvrellrerl.vrl.cvl.rl.vcl.r ");

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		RepoartBean repBean = new RepoartBean();
		ResultSet CDM = null;
		ResultSet DTR = null;
		ResultSet emp = null;
		ResultSet arrrec = null;

		float Days = Calculate.getDays(PAYREGDT);
		LookupHandler lkp = new LookupHandler();

		FileWriter Fp;
		int aCtr = 0;
		int lCtr = 0;
		int ctr = 0;
		int printBasic = 0;
		int printNet = 0;
		int printGross = 0;
		int printTotDed = 0;
		int LOPDays = 0;
		String BomDt = "";
		String EomDt = "";
		boolean DtrFind = false;
		String lBomDt = "";
		String lEomDt = "";
		int i = 0;
		int j = 0;
		String dtrsql = "";
		String CdmSql = "";
		String EmpSql = "";
		String[] pdet = new String[7];
		String Str1 = "";
		String Str2 = "";
		String Str3 = "";
		String Str4 = "";
		int Str2Ctr = 0;
		int Str4Ctr = 0;
		int Str1Ctr = 0;
		int Arr1Ctr = 0;
		int Arr2Ctr = 0;
		int count = 1;
		int countTotal = 1;
		String sLOPDTr = "";
		ResultSet LOPDTr = null;
		ReportDAO.inithead(repBean);
		// Initvar *****already variable are initialised not need of initvar
		ReportDAO.make_prn_file(filepath, repBean);

		Connection Cn = null;
		ReportDAO.OpenCon("", "", "", repBean);
		Cn = repBean.getCn();
		int Hdg6Ctr = 0;
		int Hdg4Ctr = 0;
		int HdgArr1 = 0;
		int HdgArr2 = 0;
		boolean Barr1 = false;
		boolean Barr2 = false;
		boolean fnd = false;
		String Arr1 = "";
		String Arr2 = "";
		String nm = "";
		String pBranch = "";
		String SLINE = "";
		String prj_name = "";
		int page = 0;

		// total as per branch incomes ,deduction

		int totalGross = 0;
		int totalDed = 0;
		int totalNet = 0;
		int totalBasic = 0;
		int gross = 0;
		int ded = 0;
		int net = 0;
		int originalbasic = 0;

		// total as per branch incomes related
		int empTotalBasic = 0;
		int empCurrentDa = 0;
		int empVda = 0;
		int empHra = 0;
		int empOcash = 0;
		int empConve = 0;
		int empMininsurance = 0;
		int empCol = 0;
		int empSpecial = 0;
		int empEdu = 0;
		int empMed = 0;
		int empArrears = 0;
		int empCLSG = 0;
		int empAREABDV = 0;
		int empEarning1 = 0;
		int empearning2 = 0;
		int empAREAALL = 0;
		int empGROSS = 0;

		// total as per branch deduction related

		int empPF = 0;
		int empPT = 0;

		int empmobile = 0;
		int empArrPF = 0;
		int empESIC = 0;
		int empAdv = 0;

		int empOther = 0;
		int empTDS = 0;
		int empRF = 0;
		int empNET = 0;

		int empGRPINSU = 0;
		int empOTHERLOAN = 0;
		int empSOCDED = 0;
		int empUNIONSUB = 0;
		int empLWPAamount = 0;
		int empMLWFDED = 0;

		int empHSGLOANINST = 0;
		int empVEHLOANINST = 0;
		int empFESTLOANINST = 0;
		int empADVANCEINST = 0;
		int empBANKINST = 0;
		int empOTHERINST = 0;
		int empSTAMP = 0;
		int empLICINST = 0;

		repBean.setbCode(0);
		SimpleDateFormat outputFormat = new SimpleDateFormat("dd-MMM-yyyy");
		SimpleDateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd"); // Added
																			// by
																			// nakul
																			// for
																			// campareDate
																			// fun()

		for (i = 1; i <= 26; i++) {
			repBean.setIcode(0, i);
			repBean.setEcode(0, i);
		}
		for (j = 1; j <= 20; j++) {
			for (i = 100; i <= 200; i++) {
				repBean.setbInc(0, j, i);
			}
		}
		for (i = 100; i <= 199; i++) {
			repBean.setInc(0, i);
		}
		for (i = 200; i <= 300; i++) {
			repBean.setDed(0, i);
		}
		for (j = 1; j <= 20; j++) {
			for (i = 200; i <= 300; i++) {
				repBean.setbDed(0, j, i);
			}
		}
		for (i = 1; i <= 4; i++) {
			repBean.setTotBngd(0, i);
			repBean.setRepTotBNGD(0, i);
		}
		for (i = 1; i <= 20; i++) {
			for (j = 1; j <= 4; j++) {
				repBean.setBtotBngd(0, i, j);
			}
		}

		repBean.setLnCount(0);
		repBean.setPayrep(true);
		repBean.setPageNo(1);
		repBean.setLineLen(231);
		repBean.setPageLen(65);
		repBean.setLineSpace(10);
		BomDt = ReportDAO.BOM(PAYREGDT);
		repBean.setFoot_Fl(true);

		EomDt = ReportDAO.EOM(PAYREGDT);
		lBomDt = ReportDAO.BOM(ReportDAO.DateAdd('m', -1, PAYREGDT));
		lEomDt = ReportDAO.EOM(lBomDt);
		ReportDAO.make_prn_file(filepath, repBean);
		String temp = PAYREGDT.substring(3);

		repBean.setHdg1("Salary Sheet For The Month Of :- " + temp);

		SLINE = stringOfSize(231, '-');
		String str2 = "";

		if (!Desgn.equalsIgnoreCase("0")) {
			Str2 = "AND T.DESIG = " + Desgn;
		}

		dtrsql = "SELECT * FROM PAYTRAN WHERE TRNDT BETWEEN '" + BomDt
				+ "' AND '" + EomDt + "'";
		try {
			Statement st = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);

			DTR = st.executeQuery(dtrsql);
			if (!DTR.next()) {
				dtrsql = "SELECT * FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '"
						+ lBomDt + "' AND '" + lEomDt + "'";
			} else {
				DtrFind = true;
				dtrsql = "SELECT * FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '"
						+ lBomDt + "' AND '" + lEomDt + "'";
				dtrsql = dtrsql
						+ "UNION SELECT * FROM PAYTRAN WHERE TRNDT BETWEEN '"
						+ lBomDt + "' AND '" + lEomDt + "'";
			}

			// -----CHanged By PHP Sir

			CdmSql = "SELECT * FROM CDMAST WHERE PSLIPYN = 'Y' AND TRNCD <= 293 AND TRNCD IN (SELECT TRNCD FROM CDMAST INTERSECT SELECT DISTINCT(TRNCD) FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '"
					+ BomDt + "' AND '" + EomDt + "') ORDER BY   TRNCD ";
			EmpSql = "SELECT EMP.*, T.ACNO, T.PRJ_SRNO, T.DESIG FROM EMPMAST EMP, EMPTRAN T WHERE T.EMPNO = EMP.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = EMP.EMPNO AND E2.EFFDATE <= '"
					+ (ReportDAO.EOM(PAYREGDT))
					+ "') AND   "
					+ " (( EMP.STATUS='A' AND	EMP.DOJ <= '"
					+ ReportDAO.EOM(PAYREGDT)
					+ "') or "
					+ " (EMP.STATUS ='N' And EMP.DOL>='"
					+ ReportDAO.BOM(PAYREGDT)
					+ "')) "
					+ Str2
					+ " "
					+ " ORDER BY T.PRJ_SRNO, EMP.EMPNO , EMP.EMPCODE";

			System.out.println(EmpSql);

			DTR = st.executeQuery(dtrsql);
			if (!DTR.next()) {
				dtrsql = "SELECT * FROM PAYTRAN WHERE TRNDT BETWEEN '" + lBomDt
						+ "' AND '" + EomDt + "'";

				DTR = st.executeQuery(dtrsql);
				if (!DTR.next()) {
					System.out.println("Transactions not found");
					Fp = repBean.getFp();
					Fp.close();
					return;
				}

			}
			Barr1 = false;
			Barr2 = false;
			DTR.beforeFirst();
			while (DTR.next()) {
				if (DTR.getInt("TRNCD") <= 200) {
					if ((DTR.getString("ARR_AMT") == null ? 0 : DTR
							.getInt("ARR_AMT")) != 0) {
						Barr1 = true;
					}

				} else {
					if (DTR.getInt("TRNCD") >= 201
							&& DTR.getInt("TRNCD") <= 293) {
						if ((DTR.getString("ARR_AMT") == null ? 0 : DTR
								.getInt("ARR_AMT")) != 0) {
							Barr2 = true;
						}

					}
				}
			}
			// System.out.println("code selection 111---"+CdmSql);
			CDM = st.executeQuery(CdmSql);
			if (!CDM.next()) {
				CdmSql = "SELECT * FROM CDMAST WHERE TRNCD <= 293 AND TRNCD IN (SELECT TRNCD FROM CDMAST INTERSECT SELECT DISTINCT (TRNCD) FROM PAYTRAN WHERE TRNDT BETWEEN '"
						+ lBomDt
						+ "' AND '"
						+ EomDt
						+ "')  and PSLIPYN='Y'  ORDER BY   TRNCD";
				CDM = st.executeQuery(CdmSql);
				if (!CDM.next()) {
					System.out.println("No any Code to print");
					Fp = repBean.getFp();
					Fp.close();
					return;
				}
			}
			CDM.beforeFirst();
			repBean.setHdg2("EmpCode| Employee Name      |P-Day | Allowances:->|");
			repBean.setHdg3("       |                                Arrears:->|");
			repBean.setHdg4("       | SB.A/c No.         |Desg.                |");
			repBean.setHdg5("Sr.No. | Original Basic     LOP Days Deductions:->|");
			repBean.setHdg6("       |                                Arrears:->|");
			repBean.setHdg7("       | Gross Pay.     Total Ded.   Net Pay      |");

			while (CDM.next()) {
				if (CDM.getInt("TRNCD") <= 200) {
					aCtr = aCtr + 1;
					if (aCtr <= 12) {
						repBean.setHdg2(repBean.getHdg2()
								+ FixStr(CDM.getString("SDESC"), 14, 2) + "|");
						repBean.setIcode(CDM.getInt("TRNCD"), aCtr);
					} else {
						repBean.setHdg4(repBean.getHdg4()
								+ FixStr(CDM.getString("SDESC"), 14, 2) + "|");
						repBean.setIcode(CDM.getInt("TRNCD"), aCtr);
						Hdg4Ctr = Hdg4Ctr + 1;
					}
				} else {
					lCtr = lCtr + 1;
					if (lCtr <= 12) {
						repBean.setHdg5(repBean.getHdg5()
								+ FixStr(CDM.getString("SDESC"), 14, 2) + "|");
						repBean.setEcode(CDM.getInt("TRNCD"), lCtr);
					} else {
						repBean.setHdg7(repBean.getHdg7()
								+ FixStr(CDM.getString("SDESC"), 14, 2) + "|");
						repBean.setEcode(CDM.getInt("TRNCD"), lCtr);
						Hdg6Ctr = Hdg6Ctr + 1;
					}
				}
			}

			for (i = 1; i <= 12; i++) {
				repBean.setHdg3(repBean.getHdg3() + ReportDAO.addSpaces("", 14)
						+ "|");
				repBean.setHdg6(repBean.getHdg6() + ReportDAO.addSpaces("", 14)
						+ "|");
			}
			for (i = Hdg4Ctr + 1; i <= 12; i++) {
				repBean.setHdg4(repBean.getHdg4() + ReportDAO.addSpaces("", 14)
						+ "|");
			}
			for (j = Hdg6Ctr + 1; j <= 12; j++) {
				repBean.setHdg7(repBean.getHdg7() + ReportDAO.addSpaces("", 14)
						+ "|");
			}
			Statement st1 = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			emp = st1.executeQuery(EmpSql);

			if (!emp.next()) {
				System.out.println("Employee Recordset is Empty");
				Fp = repBean.getFp();
				Fp.close();
				return;
			}
			// pBranch = "";
			emp.beforeFirst();
			while (emp.next()) {
				if (!DtrFind) {
					dtrsql = "SELECT * FROM PAYTRAN_STAGE Y,CDMAST C WHERE (Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293 ) AND Y.EMPNO = '"
							+ emp.getInt("EMPNO")
							+ "' AND Y.TRNDT BETWEEN '"
							+ lBomDt
							+ "' AND '"
							+ EomDt
							+ "' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y' ORDER BY  C.TRNCD ";

				} else {
					dtrsql = "SELECT * FROM PAYTRAN_STAGE Y,CDMAST C WHERE (Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293 ) AND Y.EMPNO = '"
							+ emp.getInt("EMPNO")
							+ "' AND Y.TRNDT BETWEEN '"
							+ lBomDt
							+ "' AND '"
							+ EomDt
							+ "' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y'";
					dtrsql = dtrsql
							+ " UNION SELECT * FROM PAYTRAN Y ,CDMAST C WHERE ( Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293 ) AND Y.EMPNO = '"
							+ emp.getInt("EMPNO")
							+ "' AND Y.TRNDT BETWEEN '"
							+ lBomDt
							+ "' AND '"
							+ EomDt
							+ "' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y'  ORDER BY  C.TRNCD ";
				}

				Str1 = "";
				Str2 = "";
				Str3 = "";
				Str4 = "";
				Arr1 = "";
				Arr2 = "";
				nm = "";
				aCtr = 0;
				Str2Ctr = 0;
				Str1Ctr = 0;
				Arr1Ctr = 0;
				Arr2Ctr = 0;
				lCtr = 0;
				LOPDays = 0;

				DTR = st.executeQuery(dtrsql);
				if (!DTR.next()) {
					dtrsql = "SELECT * FROM PAYTRAN Y,CDMAST C WHERE (Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293 ) AND Y.EMPNO = '"
							+ emp.getInt("EMPNO")
							+ "' AND Y.TRNDT BETWEEN '"
							+ lBomDt
							+ "' AND '"
							+ EomDt
							+ "' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y'  ORDER BY  C.TRNCD  ";

					DTR = st.executeQuery(dtrsql);
					if (!DTR.next()) {
						// System.out.println("Transaction not found for this Employee "+emp.getInt("EMPNO"));
						// System.out.println("Branch name is thissss"+emp.getString("BRANCH"));
					}

				}

				// System.out.println(dtrsql);

				// ReportDAO.println(String.valueOf((char)15), 0, 0, false,
				// "",repBean);
				if (DTR.next()) {

					ctr = ctr + 1;

					DTR.beforeFirst();

					while (DTR.next()) {

						// System.out.println("pbranch "+pBranch+" database emp branch "+emp.getString("PRJ_SRNO"));

						if (!pBranch
								.equalsIgnoreCase(emp.getString("PRJ_SRNO"))) {
							repBean.setBrnNo(emp.getInt("PRJ_SRNO"));

							// if(!repBean.isPayrep())
							{
								Connection conn = ConnectionManager
										.getConnectionTech();
								Statement stmt = conn.createStatement();

								// Branch_footer function

								String prjquery = "select Site_Name from Project_Sites where SITE_ID = '"
										+ emp.getString("PRJ_SRNO") + "'";
								ResultSet prj = stmt.executeQuery(prjquery);
								if (prj.next()) {
									prj_name = prj.getString("Site_Name");
									// prj_code = prj.getString("Project_Code");
								}
								prj.close();
								stmt.close();
								conn.close();

								if (page == 0) {
									ReportDAO.println(
											String.valueOf((char) 15), 0, 0,
											false, "", repBean);

									ReportDAO.println(
											prop.getProperty("companyName"),
											105, 2, false, "", repBean);
									ReportDAO.println(SLINE, 10, 1, false,
											"BANK", repBean);
								}

								else {

									ReportDAO.println(SLINE, 10, 1, false, "",
											repBean);

									// String ToPrintOriginalbasic="";
									String ToPrintEmpTotalIncome = "";

									String TotalDeduction = "";
									String TotalDeduction1 = "";

									// String ToPrintOriginalbasic ="";
									// ToPrintOriginalbasic =
									// ToPrintOriginalbasic +
									// FixStr(trans(totalBasic, "999,99,999.99",
									// "", false, false), 14, 3) + "|";

									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empTotalBasic,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empHra,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empMed,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empEdu,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empOcash,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empConve,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empMininsurance,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empCol,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empEarning1,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empearning2,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									// ToPrintEmpTotalIncome
									// =ToPrintEmpTotalIncome +
									// FixStr(trans(empAREAALL, "999,99,999.99",
									// "", false, false), 14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empGROSS,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";

									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empPF,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empPT,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empMLWFDED,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empOther,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empArrPF,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empESIC,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empmobile,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empAdv,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empOTHERLOAN,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empTDS,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empRF,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empNET,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";

									// TotalDeduction1 =TotalDeduction1 +
									// FixStr(trans(empADVANCEINST,
									// "999,99,999.99", "", false, false), 14,
									// 3) + "|";
									// TotalDeduction1 =TotalDeduction1 +
									// FixStr(trans(empBANKINST,
									// "999,99,999.99", "", false, false), 14,
									// 3) + "|";
									// TotalDeduction1 =TotalDeduction1 +
									// FixStr(trans(empOTHERINST,
									// "999,99,999.99", "", false, false), 14,
									// 3) + "|";
									// TotalDeduction1 =TotalDeduction1 +
									// FixStr(trans(empSTAMP, "999,99,999.99",
									// "", false, false), 14, 3) + "|";
									// TotalDeduction1 =TotalDeduction1 +
									// FixStr(trans(empLICINST, "999,99,999.99",
									// "", false, false), 14, 3) + "|";

									String TotalIncome = "Total:-|"
											+ FixStr(
													transString("",
															"99,99,999.99", "",
															false, false), 14,
													3)
											+ FixStr(
													transString("",
															"99,99,999.99", "",
															false, false), 14,
													3)
											+ FixStr(
													transString("",
															"99,99,999.99", "",
															false, false), 14,
													3) + "|"
											+ ToPrintEmpTotalIncome;
									// String TotalIncome1= "       |" +
									// FixStr(transString("", "99,99,999.99",
									// "", false, false), 14, 3) +
									// FixStr(transString("", "99,99,999.99",
									// "", false, false), 14, 3) +
									// FixStr(transString("", "99,99,999.99",
									// "", false, false), 14, 3) + "|" ;

									String Deduction = "       |"
											+ FixStr(
													trans(totalBasic,
															"99,99,999.99", "",
															false, false), 14,
													3)
											+ FixStr(
													transString("",
															"99,99,999.99", "",
															false, false), 14,
													3)
											+ FixStr(
													transString("",
															"99,99,999.99", "",
															false, false), 14,
													3) + "|" + TotalDeduction;
									String Deduction1 = FixStr(
											String.valueOf(count - 1), 7, 1)
											+ "|"
											+ FixStr(
													trans(totalGross,
															"99,99,999.99", "",
															false, false), 14,
													3)
											+ FixStr(
													trans(totalDed,
															"99,99,999.99", "",
															false, false), 14,
													3)
											+ FixStr(
													trans(totalNet,
															"99,99,999.99", "",
															false, false), 14,
													3) + "|" + TotalDeduction1;

									ReportDAO.println(TotalIncome, 10, 1,
											false, "BANK", repBean);

									// ReportDAO.println(TotalIncome1, 10, 1,
									// false, "BANK",repBean);
									PrintBlankLine(repBean);
									ReportDAO.println(Deduction, 10, 1, false,
											"BANK", repBean);
									ReportDAO.println(Deduction1, 10, 1, false,
											"BANK", repBean);

									count = 1;
									// income set to zero
									totalGross = 0;
									totalDed = 0;
									totalNet = 0;
									totalBasic = 0;
									printBasic = 0;
									printNet = 0;
									printGross = 0;
									printTotDed = 0;

									originalbasic = 0;
									empTotalBasic = 0;
									empCurrentDa = 0;
									empVda = 0;
									empHra = 0;
									empSpecial = 0;
									empEdu = 0;
									empMed = 0;
									empArrears = 0;
									empCLSG = 0;
									empAREABDV = 0;
									empAREAALL = 0;
									empGROSS = 0;

									empOcash = 0;
									empConve = 0;
									empMininsurance = 0;
									empCol = 0;
									empearning2 = 0;
									empEarning1 = 0;

									// deduction set to zero
									empPF = 0;
									empPT = 0;
									empGRPINSU = 0;
									empOTHERLOAN = 0;
									empSOCDED = 0;
									empUNIONSUB = 0;
									empLWPAamount = 0;
									empMLWFDED = 0;
									empTDS = 0;
									empHSGLOANINST = 0;
									empVEHLOANINST = 0;
									empFESTLOANINST = 0;
									empADVANCEINST = 0;
									empBANKINST = 0;
									empOTHERINST = 0;
									empSTAMP = 0;
									empLICINST = 0;

									empmobile = 0;
									empArrPF = 0;
									empESIC = 0;
									empAdv = 0;

									empOther = 0;
									empTDS = 0;
									empRF = 0;
									empNET = 0;

									// ReportDAO.println(String.valueOf((char)15),
									// 0, 0, false, "BANK",repBean);

									ReportDAO.println(SLINE, 10, 1, true, "",
											repBean);
									ReportDAO.println("", 10, 5, false, "",
											repBean);

								}

								ReportDAO.println("BRANCH NAME :- " + prj_name
										+ "", 17, 1, false, "BANK", repBean);
								ReportDAO.println(SLINE, 10, 1, false, "BANK",
										repBean);
							}
							repBean.setNoEmp(0);
							ctr = 1;

							// ReportDAO.println(String.valueOf((char)15), 0, 0,
							// false, "BANK",repBean);
							// ReportDAO.println("", 0, 1, false,
							// "BANK",repBean);

							// ReportDAO.println(SLINE, 0, 1, false,
							// "BANK",repBean);
							// ReportDAO.println("Branch Name :- add branch name here",
							// 10, 2, false, "BANK",repBean);
							// ReportDAO.println(SLINE, 0, 1, false,
							// "BANK",repBean);

							repBean.setPayrep(false);
							repBean.setBar1(Barr1);
							repBean.setBar2(Barr2);

							if (Barr1 && Barr2) {
								ReportDAO.page_head(repBean.getBrnNo(),
										repBean.getHdg1(), repBean.getHdg2(),
										repBean.getHdg3(), repBean.getHdg4(),
										repBean.getHdg5(), repBean.getHdg6(),
										repBean.getHdg7(), repBean);

							} else {
								if (Barr1) {
									ReportDAO.page_head(repBean.getBrnNo(),
											repBean.getHdg1(),
											repBean.getHdg2(),
											repBean.getHdg3(),
											repBean.getHdg4(),
											repBean.getHdg5(), "",
											repBean.getHdg7(), repBean);
								} else if (Barr2) {
									ReportDAO.page_head(repBean.getBrnNo(),
											repBean.getHdg1(),
											repBean.getHdg2(), "",
											repBean.getHdg4(),
											repBean.getHdg5(),
											repBean.getHdg6(),
											repBean.getHdg7(), repBean);
								} else {
									ReportDAO.page_head(repBean.getBrnNo(),
											repBean.getHdg1(),
											repBean.getHdg2(), "",
											repBean.getHdg4(),
											repBean.getHdg5(), "",
											repBean.getHdg7(), repBean);
								}
							}
							// pBranch = emp.getString("PRJ_SRNO");
							// page++;
						} else {
							// ReportDAO.println(String.valueOf((char)15), 0, 0,
							// true, "BANK",repBean);
							// ReportDAO.println("", 0, 1, true,
							// "BANK",repBean);
						}

						pBranch = emp.getString("PRJ_SRNO");
						page++;

						if (compareDate(outputFormat.format(inputFormat
								.parse(DTR.getString("TRNDT"))), lBomDt)
								&& compareDate(lEomDt,
										outputFormat.format(inputFormat
												.parse(DTR.getString("TRNDT"))))) // Changed
						{
							if (DTR.getInt("TRNCD") <= 200) {

								repBean.setPInc(
										repBean.getPInc(DTR.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));
								repBean.setPRepTotINC(
										repBean.getPRepTotINC(DTR
												.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));

							} else if (DTR.getInt("TRNCD") >= 201
									&& DTR.getInt("TRNCD") <= 293) {
								repBean.setPDed(
										repBean.getPDed(DTR.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));
								repBean.setPRepTotDED(
										repBean.getPRepTotDED(DTR
												.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));

							}
							if (DTR.getInt("TRNCD") == 101) {
								repBean.setPTotBNGD(repBean.getPTotBNGD(1)
										+ (DTR.getString("INP_AMT") == null ? 0
												: DTR.getInt("INP_AMT")), 1);
								repBean.setPRepTotBNGD(
										repBean.getPRepTotBNGD(1)
												+ (DTR.getString("INP_AMT") == null ? 0
														: DTR.getInt("INP_AMT")),
										1);
							}
							if (DTR.getInt("TRNCD") == 999) {
								repBean.setPTotBNGD(repBean.getPTotBNGD(2)
										+ (DTR.getString("NET_AMT") == null ? 0
												: DTR.getInt("NET_AMT")), 2);
								repBean.setPTotBNGD(repBean.getPTotBNGD(3)
										+ (DTR.getString("INP_AMT") == null ? 0
												: DTR.getInt("INP_AMT")), 3);
								repBean.setPTotBNGD(repBean.getPTotBNGD(4)
										+ (DTR.getString("CAL_AMT") == null ? 0
												: DTR.getInt("CAL_AMT")), 4);
								repBean.setPRepTotBNGD(
										repBean.getPRepTotBNGD(2)
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT")),
										2);
								repBean.setPRepTotBNGD(
										repBean.getPRepTotBNGD(3)
												+ (DTR.getString("INP_AMT") == null ? 0
														: DTR.getInt("INP_AMT")),
										3);
								repBean.setPRepTotBNGD(
										repBean.getPRepTotBNGD(4)
												+ (DTR.getString("CAL_AMT") == null ? 0
														: DTR.getInt("CAL_AMT")),
										4);

								net = net + DTR.getString("NET_AMT") == null ? 0
										: DTR.getInt("NET_AMT");
								gross = gross + DTR.getString("INP_AMT") == null ? 0
										: DTR.getInt("INP_AMT");
								ded = ded + DTR.getString("CAL_AMT") == null ? 0
										: DTR.getInt("CAL_AMT");

							}
						} else {
							if (DTR.getInt("TRNCD") <= 200) {
								aCtr = aCtr + 1;
								if (aCtr <= 12) {
									if (repBean.getIcode(aCtr) != DTR
											.getInt("TRNCD")) {
										while (repBean.getIcode(aCtr) != DTR
												.getInt("TRNCD")) {
											if (aCtr <= 12) {
												Str1 = Str1
														+ ReportDAO.addSpaces(
																"", 14) + "|";
											} else {
												Str2 = Str2
														+ ReportDAO.addSpaces(
																"", 14) + "|";
												Str2Ctr = Str2Ctr + 1;
											}
											aCtr = aCtr + 1;
											if (aCtr > 24) {
												break;
											}
										}
										if (aCtr > 12) {
											Str2 = Str2
													+ FixStr(
															trans((DTR
																	.getString("NET_AMT") == null ? 0
																	: DTR.getInt("NET_AMT")),
																	"999,99,999.99",
																	"", false,
																	false), 14,
															3) + "|";
											Str2Ctr = Str2Ctr + 1;
										}
									}
									if (aCtr <= 12) {
										// for printing the income
										if (DTR.getInt("TRNCD") == 101) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empTotalBasic = empTotalBasic
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 102) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empCurrentDa = empCurrentDa
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 138) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empVda = empVda
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 103) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empHra = empHra
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 129) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empSpecial = empSpecial
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 105) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empEdu = empEdu
													+ DTR.getInt("NET_AMT");
										}
										if (DTR.getInt("TRNCD") == 104) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empMed = empMed
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 107) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empOcash = empOcash
													+ DTR.getInt("NET_AMT");
										}
										if (DTR.getInt("TRNCD") == 108) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empConve = empConve
													+ DTR.getInt("NET_AMT");
										}
										if (DTR.getInt("TRNCD") == 126) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empMininsurance = empMininsurance
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 128) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empCol = empCol
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 130) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empEarning1 = empEarning1
													+ DTR.getInt("NET_AMT");
										}
										if (DTR.getInt("TRNCD") == 131) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empearning2 = empearning2
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 142) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empArrears = empArrears
													+ DTR.getInt("NET_AMT");
										}
										if (DTR.getInt("TRNCD") == 139) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empCLSG = empCLSG
													+ DTR.getInt("NET_AMT");
										}
										if (DTR.getInt("TRNCD") == 140) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empAREABDV = empAREABDV
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 140) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empAREABDV = empAREABDV
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 141) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empAREAALL = empAREAALL
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 199) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empGROSS = empGROSS
													+ DTR.getInt("NET_AMT");
										}

										Str1 = Str1
												+ FixStr(
														trans((DTR
																.getString("NET_AMT") == null ? 0
																: DTR.getInt("NET_AMT")),
																"999,99,999.99",
																"", false,
																false), 14, 3)
												+ "|";

										if ((DTR.getString("ARR_AMT") == null ? 0
												: DTR.getInt("ARR_AMT")) != 0) {
											Arr1 = Arr1
													+ FixStr(
															trans((DTR
																	.getString("NET_AMT") == null ? 0
																	: DTR.getInt("NET_AMT")),
																	"999,99,999.99",
																	"", false,
																	false), 14,
															3) + "|";
											Arr1Ctr = Arr1Ctr + 1;
										}
									}
								} else {
									if (aCtr < 24) {
										// System.out.println("Trncd is "+DTR.getInt("TRNCD"));
										if (repBean.getIcode(aCtr) != DTR
												.getInt("TRNCD")) {
											while (repBean.getIcode(aCtr) != DTR
													.getInt("TRNCD")) {
												Str2 = Str2
														+ ReportDAO.addSpaces(
																"", 14) + "|";
												Str2Ctr = Str2Ctr + 1;
												aCtr = aCtr + 1;
												if (aCtr > 24)// Added by nakul
																// patil for
																// arrayindexofboundsexception
												{
													break;
												}
											}
										}
									}
									Str2 = Str2
											+ FixStr(
													trans((DTR
															.getString("NET_AMT") == null ? 0
															: DTR.getInt("NET_AMT")),
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									Str2Ctr = Str2Ctr + 1;

								}
								repBean.setInc(
										repBean.getInc(DTR.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));
								repBean.setRepTotINC(
										repBean.getRepTotINC(DTR
												.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));

							} else {
								if (DTR.getInt("TRNCD") >= 201
										&& DTR.getInt("TRNCD") <= 293) {

									if (DTR.getInt("TRNCD") == 201) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empPF = empPF + DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 202) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empPT = empPT + DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 212) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empOther = empOther
												+ DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 226) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empOTHERLOAN = empOTHERLOAN
												+ DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 217) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empArrPF = empArrPF
												+ DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 221) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empESIC = empESIC
												+ DTR.getInt("NET_AMT");
									}
									if (DTR.getInt("TRNCD") == 223) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empmobile = empmobile
												+ DTR.getInt("NET_AMT");
									}
									if (DTR.getInt("TRNCD") == 211) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empMLWFDED = empMLWFDED
												+ DTR.getInt("NET_AMT");
									}
									if (DTR.getInt("TRNCD") == 228) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empTDS = empTDS + DTR.getInt("NET_AMT");
									}
									if (DTR.getInt("TRNCD") == 225) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empAdv = empAdv + DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 229) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empRF = empRF + DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 230) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empNET = empNET + DTR.getInt("NET_AMT");
									}

									lCtr = lCtr + 1;
									if (lCtr <= 12) {
										if (repBean.getEcode(lCtr) != DTR
												.getInt("TRNCD")) {
											while (repBean.getEcode(lCtr) != DTR
													.getInt("TRNCD")) {
												if (lCtr <= 12) {
													Str3 = Str3
															+ ReportDAO
																	.addSpaces(
																			"",
																			14)
															+ "|";
												} else {
													Str4 = Str4
															+ FixStr(
																	trans((DTR
																			.getString("NET_AMT") == null ? 0
																			: DTR.getInt("NET_AMT")),
																			"999,99,999.99",
																			"",
																			false,
																			false),
																	14, 3)
															+ "|";
													Str4Ctr = Str4Ctr + 1;

												}
												lCtr = lCtr + 1;
												if (lCtr > 24) {
													break;
												}

											}
											if (lCtr > 12) {
												Str4 = Str4
														+ FixStr(
																trans((DTR
																		.getString("NET_AMT") == null ? 0
																		: DTR.getInt("NET_AMT")),
																		"999,99,999.99",
																		"",
																		false,
																		false),
																14, 3) + "|";
												Str4Ctr = Str4Ctr + 1;
											}

										}
										if (lCtr <= 12) {
											Str3 = Str3
													+ FixStr(
															trans((DTR
																	.getString("NET_AMT") == null ? 0
																	: DTR.getInt("NET_AMT")),
																	"999,99,999.99",
																	"", false,
																	false), 14,
															3) + "|";

											if ((DTR.getString("ARR_AMT") == null ? 0
													: DTR.getInt("ARR_AMT")) != 0) {
												Arr2 = Arr2
														+ FixStr(
																trans((DTR
																		.getString("ARR_AMT") == null ? 0
																		: DTR.getInt("ARR_AMT")),
																		"999,99,999.99",
																		"",
																		false,
																		false),
																14, 3) + "|";
												Arr2Ctr = Arr2Ctr + 1;
											}
										}
									} else {
										if (lCtr < 24) {
											if (repBean.getEcode(lCtr) != DTR
													.getInt("TRNCD")) {
												while (repBean.getEcode(lCtr) != DTR
														.getInt("TRNCD")) {
													Str4 = Str4
															+ ReportDAO
																	.addSpaces(
																			"",
																			14)
															+ "|";
													lCtr = lCtr + 1;
													if (lCtr > 24) {
														break;
													}
												}
											}
										}
										Str4 = Str4
												+ FixStr(
														trans((DTR
																.getString("NET_AMT") == null ? 0
																: DTR.getInt("NET_AMT")),
																"999,99,999.99",
																"", false,
																false), 14, 3)
												+ "|";
										Str4Ctr = Str4Ctr + 1;

									}
									repBean.setDed(
											repBean.getDed(DTR.getInt("TRNCD"))
													+ (DTR.getString("NET_AMT") == null ? 0
															: DTR.getInt("NET_AMT"))
													+ (DTR.getString("ARR_AMT") == null ? 0
															: DTR.getInt("ARR_AMT")),
											DTR.getInt("TRNCD"));
									repBean.setRepTotDED(
											repBean.getRepTotDED(DTR
													.getInt("TRNCD"))
													+ (DTR.getString("NET_AMT") == null ? 0
															: DTR.getInt("NET_AMT"))
													+ (DTR.getString("ARR_AMT") == null ? 0
															: DTR.getInt("ARR_AMT")),
											DTR.getInt("TRNCD"));
								}
							}

							if (DTR.getInt("TRNCD") == 101) {
								printBasic = DTR.getString("INP_AMT") == null ? 0
										: DTR.getInt("INP_AMT");
								repBean.setTotBngd(repBean.getTotBngd(1)
										+ printBasic, 1);
								repBean.setRepTotBNGD(repBean.getRepTotBNGD(1)
										+ printBasic, 1);

								originalbasic = originalbasic
										+ DTR.getString("INP_AMT") == null ? 0
										: DTR.getInt("INP_AMT");

							}
							if (DTR.getInt("TRNCD") == 999) {
								printNet = DTR.getString("NET_AMT") == null ? 0
										: DTR.getInt("NET_AMT");
								printGross = DTR.getString("INP_AMT") == null ? 0
										: DTR.getInt("INP_AMT");
								printTotDed = DTR.getString("CAL_AMT") == null ? 0
										: DTR.getInt("CAL_AMT");
								repBean.setTotBngd(repBean.getTotBngd(2)
										+ printNet, 2);
								repBean.setTotBngd(repBean.getTotBngd(3)
										+ printGross, 3);
								repBean.setTotBngd(repBean.getTotBngd(4)
										+ printTotDed, 4);
								repBean.setRepTotBNGD(repBean.getRepTotBNGD(2)
										+ printNet, 2);
								repBean.setRepTotBNGD(repBean.getRepTotBNGD(3)
										+ printGross, 3);
								repBean.setRepTotBNGD(repBean.getRepTotBNGD(4)
										+ printTotDed, 4);

								net = net + DTR.getString("NET_AMT") == null ? 0
										: DTR.getInt("NET_AMT");

								gross = gross + DTR.getString("INP_AMT") == null ? 0
										: DTR.getInt("INP_AMT");
								ded = ded + DTR.getString("CAL_AMT") == null ? 0
										: DTR.getInt("CAL_AMT");
							}
							if (DTR.getInt("TRNCD") == 301) {
								LOPDays = DTR.getInt("INP_AMT");
							}
						}
					}
					for (i = Arr1Ctr + 1; i <= 12; i++) {
						Arr1 = Arr1 + ReportDAO.addSpaces("", 14) + "|";
					}
					for (i = Arr2Ctr + 1; i <= 12; i++) {
						Arr2 = Arr2 + ReportDAO.addSpaces("", 14) + "|";
					}
					for (i = aCtr + 1; i <= 12; i++) {
						Str1 = Str1 + ReportDAO.addSpaces("", 14) + "|";
					}
					for (j = lCtr + 1; j <= 12; j++) {
						Str3 = Str3 + ReportDAO.addSpaces("", 14) + "|";
					}
					for (i = Str2Ctr + 1; i <= 12; i++) {
						Str2 = Str2 + ReportDAO.addSpaces("", 14) + "|";
					}
					for (j = Str4Ctr + 1; j <= 12; j++) {
						Str4 = Str4 + ReportDAO.addSpaces("", 14) + "|";
					}

					nm = ltrim(FixStr(" " + emp.getString("LNAME").trim()
							+ "  " + emp.getString("FNAME").trim() + "  "
							+ emp.getString("MNAME").trim() + " | " + Days, 42,
							1));
					Str1 = FixStr(String.valueOf(emp.getInt("EMPCODE")), 7, 1)
							.substring(0, 7) + "|" + nm + "|" + Str1;
					Str2 = "|"
							+ FixStr(String.valueOf(emp.getString("ACNO")), 16,
									1)
							+ FixStr(
									String.valueOf(lkp.getLKP_Desc("DESIG",
											emp.getInt("DESIG"))), 26, 1) + "|"
							+ Str2;
					Str3 = FixStr(String.valueOf(count++), 7, 1)
							+ "|"
							+ FixStr(
									trans(printBasic, "99,99,999.99", "",
											false, false), 14, 3)
							+ FixStr(trans(LOPDays, "999", "", false, false),
									14, 3) + ReportDAO.addSpaces("", 14) + "|"
							+ Str3;
					Str4 = "|"
							+ FixStr(
									trans(printGross, "99,99,999.99", "",
											false, false), 14, 3)
							+ FixStr(
									trans(printTotDed, "99,99,999.99", "",
											false, false), 14, 3)
							+ FixStr(
									trans(printNet, "99,99,999.99", "", false,
											false), 14, 3) + "|" + Str4;

					countTotal++;

					totalGross = totalGross + gross;
					totalDed = totalDed + ded;
					totalNet = totalNet + net;
					totalBasic = totalBasic + originalbasic;

					/*
					 * if(printNet < 0) { System.out.println(
					 * "THIS EMPLOYEE SALARY GOES -VE PLEASE CHECK IT AND PROCESS PAYCAL AGAIN"
					 * ); return; }
					 */
					Arr1 = "|" + ReportDAO.addSpaces("", 42) + "|" + Arr1;
					Arr2 = "|" + ReportDAO.addSpaces("", 42) + "|" + Arr2;
					ReportDAO.println(SLINE, 10, 1, false, "BANK", repBean);

					ReportDAO.println(Str1, 10, 1, false, "BANK", repBean);
					if (Barr1) {
						ReportDAO.println(Arr1, 17, 1, false, "BANK", repBean);
					}
					ReportDAO.println(Str2, 17, 1, false, "BANK", repBean);
					ReportDAO.println(Str3, 10, 1, false, "BANK", repBean);
					if (Barr2) {
						ReportDAO.println(Arr2, 17, 1, false, "BANK", repBean);
					}
					ReportDAO.println(Str4, 17, 1, false, "BANK", repBean);
					// PrintBlankLine(repBean);

				}

				repBean.setNoEmp(repBean.getNoEmp() + 1);
				// repBean.setNoEmp(countTotal - 1);
				repBean.setBNoEmp(repBean.getBNoEmp() + 1);

			}

			// only for the last branch
			if (!repBean.isPayrep()) {
				ReportDAO.println(SLINE, 10, 1, false, "BANK", repBean);

				String ToPrintEmpTotalIncome = "";

				String TotalDeduction = "";
				String TotalDeduction1 = "";

				// String ToPrintOriginalbasic ="";
				// ToPrintOriginalbasic = ToPrintOriginalbasic +
				// FixStr(trans(totalBasic, "999,99,999.99", "", false, false),
				// 14, 3) + "|";

				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empTotalBasic, "999,99,999.99", "",
										false, false), 14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empHra, "999,99,999.99", "", false, false),
								14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empMed, "999,99,999.99", "", false, false),
								14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empEdu, "999,99,999.99", "", false, false),
								14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empOcash, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empConve, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empMininsurance, "999,99,999.99", "",
										false, false), 14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empCol, "999,99,999.99", "", false, false),
								14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empEarning1, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empearning2, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				// ToPrintEmpTotalIncome =ToPrintEmpTotalIncome +
				// FixStr(trans(empAREAALL, "999,99,999.99", "", false, false),
				// 14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empGROSS, "999,99,999.99", "", false,
										false), 14, 3) + "|";

				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empPF, "999,99,999.99", "", false, false),
								14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empPT, "999,99,999.99", "", false, false),
								14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empMLWFDED, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empOther, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empArrPF, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empESIC, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empmobile, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empAdv, "999,99,999.99", "", false, false),
								14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empOTHERLOAN, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empTDS, "999,99,999.99", "", false, false),
								14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empRF, "999,99,999.99", "", false, false),
								14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empNET, "999,99,999.99", "", false, false),
								14, 3) + "|";

				// TotalDeduction1 =TotalDeduction1 +
				// FixStr(trans(empADVANCEINST, "999,99,999.99", "", false,
				// false), 14, 3) + "|";
				// TotalDeduction1 =TotalDeduction1 + FixStr(trans(empBANKINST,
				// "999,99,999.99", "", false, false), 14, 3) + "|";
				// TotalDeduction1 =TotalDeduction1 + FixStr(trans(empOTHERINST,
				// "999,99,999.99", "", false, false), 14, 3) + "|";
				// TotalDeduction1 =TotalDeduction1 + FixStr(trans(empSTAMP,
				// "999,99,999.99", "", false, false), 14, 3) + "|";
				// TotalDeduction1 =TotalDeduction1 + FixStr(trans(empLICINST,
				// "999,99,999.99", "", false, false), 14, 3) + "|";

				String TotalIncome = "Total:-|"
						+ FixStr(
								transString("", "99,99,999.99", "", false,
										false), 14, 3)
						+ FixStr(
								transString("", "99,99,999.99", "", false,
										false), 14, 3)
						+ FixStr(
								transString("", "99,99,999.99", "", false,
										false), 14, 3) + "|"
						+ ToPrintEmpTotalIncome;
				// String TotalIncome1= "       |" + FixStr(transString("",
				// "99,99,999.99", "", false, false), 14, 3) +
				// FixStr(transString("", "99,99,999.99", "", false, false), 14,
				// 3) + FixStr(transString("", "99,99,999.99", "", false,
				// false), 14, 3) + "|" ;

				String Deduction = "       |"
						+ FixStr(
								trans(totalBasic, "99,99,999.99", "", false,
										false), 14, 3)
						+ FixStr(
								transString("", "99,99,999.99", "", false,
										false), 14, 3)
						+ FixStr(
								transString("", "99,99,999.99", "", false,
										false), 14, 3) + "|" + TotalDeduction;
				String Deduction1 = FixStr(String.valueOf(count - 1), 7, 1)
						+ "|"
						+ FixStr(
								trans(totalGross, "99,99,999.99", "", false,
										false), 14, 3)
						+ FixStr(
								trans(totalDed, "99,99,999.99", "", false,
										false), 14, 3)
						+ FixStr(
								trans(totalNet, "99,99,999.99", "", false,
										false), 14, 3) + "|" + TotalDeduction1;

				ReportDAO.println(TotalIncome, 10, 1, false, "BANK", repBean);

				// ReportDAO.println(TotalIncome1, 10, 1, false,
				// "BANK",repBean);
				PrintBlankLine(repBean);
				ReportDAO.println(Deduction, 10, 1, false, "BANK", repBean);
				ReportDAO.println(Deduction1, 10, 1, false, "BANK", repBean);

				// BrachFooter remaining
				ReportDAO.println(SLINE, 10, 1, false, "BANK", repBean);
			}

			// repBean.setNoEmp(repBean.getBNoEmp());
			repBean.setNoEmp(countTotal - 1);
			for (i = 100; i <= 200; i++) {
				repBean.setBRepTotINC(repBean.getRepTotINC(i), i);
			}
			for (i = 200; i <= 300; i++) {
				repBean.setBRepTotDED(repBean.getRepTotDED(i), i);
			}
			for (i = 1; i <= 4; i++) {
				repBean.setBRepTotBNGD(repBean.getRepTotBNGD(i), i);
			}
			// FOR BRANCH TOTAL FOOTER

			ReportDAO.println(SLINE, 10, 7, true, "", repBean);

			PrintFootLines(repBean.getObjRepTotINC(),
					repBean.getObjRepTotDED(), repBean.getObjRepTotBNGD(),
					"TOTAL->" + "|"
							+ " Grand Total ALL BRANCHES Current Month : "
							+ "|", repBean);
			// System.out.println("total   : "+countTotal);
			PrintFootLines(repBean.getObjPRepTotINC(),
					repBean.getObjPRepTotDED(), repBean.getObjPRepTotBNGD(),
					"       " + "|"
							+ " Grand Total ALL BRANCHES Previous Month :"
							+ "|", repBean);

			for (i = 100; i <= 200; i++) {
				repBean.setRepTotINC(
						Math.abs(repBean.getRepTotINC(i)
								- repBean.getPRepTotINC(i)), i);
			}
			for (i = 200; i <= 300; i++) {
				repBean.setRepTotDED(
						Math.abs(repBean.getRepTotDED(i)
								- repBean.getPRepTotDED(i)), i);
			}
			for (i = 1; i <= 4; i++) {
				repBean.setRepTotBNGD(
						Math.abs(repBean.getRepTotBNGD(i)
								- repBean.getPRepTotBNGD(i)), i);
			}
			PrintFootLines(repBean.getObjRepTotINC(),
					repBean.getObjRepTotDED(), repBean.getObjRepTotBNGD(),
					"       " + "|"
							+ " Variance In SAL. OF ALL BRANCHES     :-> "
							+ "|", repBean);
			// PrintFootLines RepTotINC, RepTotDED, RepTotBNGD, "       " & "|"
			// & " Variance In Sal. Of ALL BRANCHES      :-> " & "|"
			ReportDAO.println(SLINE, 10, 4, false, "BANK", repBean);
			// ReportDAO.println("Passed For Payment", 206, 2, false,
			// "BANK",repBean);
			// ReportDAO.println("THE BUSINESS CO.OP BANK LTD, Nashik",
			// 193, 2, false, "BANK",repBean);

			// ReportDAO.println(String.valueOf((char)15), 10, 4, false,
			// "BANK",repBean); //***********Remain CHr()

			/*
			 * ReportDAO.println("C.E.O. / GENERAL MANAGER / MANAGER", 200, 2,
			 * false, "BANK",repBean); ReportDAO.println(
			 * "Note: Net Salary will be credited to Dhan Br. SB A/C on "
			 * +ReportDAO.EOM(PAYREGDT)+" ", 17, 2, false, "BANK",repBean);
			 * ReportDAO
			 * .println("Please Check PL/HO voucher entries in ABBPTR batch ",
			 * 17, 2, false, "BANK",repBean);
			 */

			// Print #fp Chr(12)
			// Print #fp Chr(18)
			repBean.setLnCount(0);
			repBean.setBrnNo(999);
			repBean.setPageNo(1);
			ReportDAO.println(String.valueOf((char) 15), 10, 4, false, "",
					repBean); // ***********Remain CHr()
			temp = PAYREGDT.substring(3);
			repBean.setHdg1("Summary Of Salary Sheet For The Month Of :- "
					+ temp);
			ReportDAO.println("", 10, 1, false, "", repBean);
			repBean.setPayrep(false);
			if (Barr1 && Barr2) {
				ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
						repBean.getHdg2(), repBean.getHdg3(),
						repBean.getHdg4(), repBean.getHdg5(),
						repBean.getHdg6(), repBean.getHdg7(), repBean);
			} else {
				if (Barr1) {
					ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
							repBean.getHdg2(), repBean.getHdg3(),
							repBean.getHdg4(), repBean.getHdg5(), "",
							repBean.getHdg7(), repBean);
				} else if (Barr2) {
					ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
							repBean.getHdg2(), "", repBean.getHdg4(),
							repBean.getHdg5(), repBean.getHdg6(),
							repBean.getHdg7(), repBean);
				} else {
					ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
							repBean.getHdg2(), "", repBean.getHdg4(),
							repBean.getHdg5(), "", repBean.getHdg7(), repBean);
				}
			}

			for (int Kk = 1; Kk <= repBean.getbCode(); Kk++) {
				PaySummary(Kk, repBean);
			}
			ReportDAO.println(SLINE, 10, 1, false, "", repBean);
			PrintFootLines(repBean.getObjBRepTotINC(),
					repBean.getObjBRepTotDED(), repBean.getObjBRepTotBNGD(),
					"TOTAL->" + "|"
							+ " Grand Total ALL BRANCHES Current Month : "
							+ "|", repBean);

			ReportDAO.println(SLINE, 10, 1, false, "", repBean);

			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
			return;
		} catch (Exception e) {
			e.printStackTrace();
		}

	
	
	}	//payreg according to namco in txt foramt bY Hrishi Ends here
	
	
	public static void PfList(String rdt,String filepath){

		RepoartBean repBean  = new RepoartBean();
		String SLINE = "";
		int arrcal = 0;
		Connection Cn = null;
		FileWriter Fp;
		ResultSet DTR = null;
		ResultSet emp = null;
		String EmpSql = "";
		int PBRCD = 0;
		int gross = 0;
		int brtot[] = new int[8];
		int ALLbrtot[] = new int[8];
		int pfchk = 0;
		ReportDAO.inithead(repBean);
		repBean.setLnCount(0);
		repBean.setPageNo(1);
		repBean.setLineLen(132);
		repBean.setPageLen(65);
		repBean.setFoot_Fl(true);
		ReportDAO.make_prn_file(filepath,repBean);
		repBean.setBrnNo(999);
		ReportDAO.println(String.valueOf((char)15), 1, 1, false, "BANK",repBean);
		ReportDAO.OpenCon("", "", "",repBean);
		Cn = repBean.getCn();

		/*EmpSql = " select emp.empno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name " +
	        ", t.branch,s.brname,t.grade,g.alfacd ,b.cal_amt , b.arr_amt , t1.net_amt basic,t2.net_amt+t3.net_amt+t4.net_amt  totda,t5.net_amt pf" +
	        " from empmast emp, emptran t ,PAYTRAN b  , branch s ,grade g,PAYTRAN t1,PAYTRAN t2,PAYTRAN t3,PAYTRAN t4 ,PAYTRAN t5 " +
	        "  Where t.empno = Emp.empno And g.postcd = t.grade And t1.empno = Emp.empno And t1.trncd = 101 " +
	        " and t2.empno = emp.empno and t2.trncd = 102 " +
	        " and t5.empno = emp.empno and t5.trncd = 201 " +
	        " and t3.empno = emp.empno and t3.trncd = 113 " +
	        " and t4.empno = emp.empno and t4.trncd = 114 " +
	        " and t.effdate = ( SELECT MAX(E2.EFFDATE) FROM EMPTRAN E2 " +
	        " WHERE e2.empno = emp.empno and  E2.EFFDATE <= '"+rdt+"' ) " +
	        " and emp.status = 'A' and b.empno = emp.empno and b.trncd = 201 and s.brcd = t.branch AND EMP.DA_SCHEME = 2 " +
	        " Union " +
	        " select emp.empno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name" +
	        ", t.branch,s.brname,t.grade,g.alfacd ,b.cal_amt,b.arr_amt, t1.net_amt basic,t2.net_amt  totda ,t3.net_amt pf" +
	        " from empmast emp, emptran t ,PAYTRAN b  , branch s ,grade g,PAYTRAN t1,PAYTRAN t2 , PAYTRAN t3 " +
	        " Where t.empno = Emp.empno And g.postcd = t.grade And t1.empno = Emp.empno And t1.trncd = 101 " +
	        "  and t2.empno = emp.empno and t2.trncd = 102" +
	        "  and t3.empno = emp.empno and t3.trncd = 201" +
	        " and t.effdate = ( SELECT MAX(E2.EFFDATE)" +
	        " FROM EMPTRAN E2 " +
	        " wHERE e2.empno = emp.empno and " +
	        " E2.EFFDATE <= '"+rdt+"'  ) " +
	        " and emp.status = 'A' and b.empno = emp.empno and b.trncd = 201 and s.brcd = t.branch AND EMP.DA_SCHEME <> 2" +
	        " order by branch,empno";*/

		EmpSql = "select e.salute , e.empno,e.fname,e.mname,e.lname,e.pfno,p.prj_name,p.prj_srno, (select net_amt from ytdtran where trncd=101 and empno=e.empno and trndt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"') basic," +
				"(select net_amt from ytdtran where trncd=201 and empno=e.empno and trndt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"') as pf," +
				"(select net_amt from ytdtran where trncd=102 and empno=e.empno and trndt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"') da," +
				"(select net_amt from ytdtran where trncd=199 and empno=e.empno and upddt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"') ctc," +
				"(select arr_amt from ytdtran where trncd=201 and empno=e.empno and upddt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"') arr_amt " +
				"from empmast e, prj p,emptran t where e.status = 'A' and t.empno= e.empno and t.prj_srno=p.prj_srno order by p.prj_srno,e.empno";


		SLINE = stringOfSize(132, '-');
		//System.out.println("pf query"+EmpSql);
		Statement st;
		try {
			st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
			emp = st.executeQuery(EmpSql);
			//System.out.println(EmpSql);
			if(!emp.next()){
				System.out.println("No Any Record Found");
				Fp = repBean.getFp();
				Fp.close();
				return;
			}
			repBean.setHdg1("Project Wise Provident Fund List");
			repBean.setHdg2("For The Month Of :-" + rdt.substring(3,11));
			repBean.setHdg3("empno NAME OF EMPLOYEE                       PFNO       Basic         DA             Gross      PF           @8.33%       @3.67%    ");
			repBean.setHdg4("                                                                                         Arrears                           ");
			ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),repBean.getHdg2(), repBean.getHdg3(), repBean.getHdg4(),repBean.getHdg5(),repBean.getHdg6(),repBean.getHdg7(),repBean);
			int i;
			for(i = 1; i <= 7; i++){
				ALLbrtot[i] = 0;
			}
			emp.previous();
			while(emp.next()){
				for(i = 1; i <= 7; i++){
					brtot[i] = 0;
				}

				ReportDAO.println(emp.getString("prj_name"), 1, 1, false, "BANK",repBean);
				ReportDAO.println("", 0, 1, false, "BANK",repBean);
				PBRCD = emp.getInt("prj_srno");
				while(PBRCD == emp.getInt("prj_srno")){
					//System.out.println(""+emp.getInt("EMPNO"));
					if(emp.getInt("EMPNO")<10)
					{
						ReportDAO.println("0"+emp.getInt("EMPNO") , 1, 0, false, "BANK",repBean);	
					}
					else
					{
						ReportDAO.println(String.valueOf(emp.getInt("EMPNO")) , 1, 0, false, "BANK",repBean);
					}
					String salute=new LookupHandler().getLKP_Desc("SALUTE",Integer.parseInt(emp.getString("SALUTE")) );

					if(emp.getString("MNAME").equals(null) || emp.getString("MNAME").equals(""))
					{
						ReportDAO.println(FixStr(salute+emp.getString("FNAME")+" "+emp.getString("MNAME")+" "+emp.getString("LNAME"), 30, 1), 7, 0, false, "BANK",repBean);
					}
					else
					{


						ReportDAO.println(FixStr(salute+emp.getString("FNAME")+" "+emp.getString("MNAME").charAt(0)+". "+emp.getString("LNAME"), 30, 1), 7, 0, false, "BANK",repBean);	
					}

					ReportDAO.println(FixStr(emp.getString("PFNO"), 15, 1), 38, 0, false, "BANK",repBean);
					ReportDAO.println(trans(emp.getInt("BASIC"), "999,999.99", "", false, false), 55, 0, false, "BANK",repBean);
					brtot[1] = brtot[1] + Math.round(emp.getInt("BASIC"));
					ReportDAO.println(trans(emp.getInt("DA"), "999,999.99", "", false, false), 66, 0, false, "BANK",repBean);
					brtot[2] = brtot[2] + Math.round(emp.getInt("DA"));
					gross = (emp.getString("BASIC")!= null?0:emp.getInt("BASIC")) + (emp.getString("DA")!= null?0:emp.getInt("DA"));
					if(gross >= 6500){
						gross = 6500;
					}
					brtot[3]  = brtot[3] + gross;
					ReportDAO.println(trans(gross, "999,999.99", "", false, false), 79, 0, false, "BANK",repBean);
					ReportDAO.println(trans(emp.getInt("PF"), "999,999.99", "", false, false), 92, 0, false, "BANK",repBean);
					brtot[4] =  brtot[4] + emp.getInt("PF");
					pfchk = (int) (Math.round(gross*0.0367) + Math.round(gross*0.0833));
					if(pfchk < emp.getInt("PF")){
						pfchk = emp.getInt("PF") - pfchk;
					}else if(emp.getInt("PF") < pfchk){
						pfchk = emp.getInt("PF") - pfchk;
					}else
						pfchk = 0;
					ReportDAO.println(trans((int)Math.round(gross * 0.0833) + pfchk, "999,999.99", "", false, false), 105, 0, false,	"BANK",repBean);
					brtot[5]  =  (brtot[5] + (int)(Math.round(gross * 0.0833)) + pfchk);
					ReportDAO.println(trans((int)Math.round(gross * 0.0367), "999,999.99", "", false, false), 118, 1, false,"BANK",repBean);
					brtot[6]  =  brtot[6] + (int)(Math.round(gross * 0.0367));
					if(!(emp.getString("ARR_AMT")==null)){
						if(emp.getInt("ARR_AMT") != 0){
							ReportDAO.println(trans(emp.getInt("ARR_AMT"), "999,999.99", "", false, false), 92, 0, false,"BANK",repBean);
							brtot[4]  =  brtot[4] + emp.getInt("ARR_AMT");
							arrcal = (int) Math.round(emp.getInt("ARR_AMT") * 8.33 / 12);
							brtot[5] = brtot[5] + arrcal;
							arrcal = emp.getInt("ARR_AMT") - arrcal;
							ReportDAO.println(trans((int)(arrcal*8.33), "999,999.99", "", false, false), 118, 0, false, "BANK",repBean);
							brtot[6] = brtot[6] + arrcal;

						}
					}
					if(!emp.next()){
						break;
					}
					if(PBRCD != emp.getInt("prj_srno")){
						emp.previous();
						break;
					}
				}
				ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
				ReportDAO.println("Project Total", 0, 0, false, "BANK",repBean);
				ReportDAO.println(trans(brtot[1], "999,999.99", "", false, false), 55, 0, false, "BANK",repBean);
				ALLbrtot[1] = ALLbrtot[1] + brtot[1];
				ReportDAO.println(trans(brtot[2], "999,999.99", "", false, false), 66, 0, false, "BANK",repBean);
				ALLbrtot[2] = ALLbrtot[2] + brtot[2];
				ReportDAO.println(trans(brtot[3], "999,999.99", "", false, false), 79, 0, false, "BANK",repBean);
				ALLbrtot[3] = ALLbrtot[3] + brtot[3];
				ReportDAO.println(trans(brtot[4], "999,999.99", "", false, false), 92, 0, false, "BANK",repBean);
				ALLbrtot[4] = ALLbrtot[4] + brtot[4];
				ReportDAO.println(trans(brtot[5], "999,999.99", "", false, false), 105, 0, false, "BANK",repBean);
				ALLbrtot[5] = ALLbrtot[5] + brtot[5];
				ReportDAO.println(trans(brtot[6], "999,999.99", "", false, false), 118, 1, false, "BANK",repBean);
				ALLbrtot[6] = ALLbrtot[6] + brtot[6];
				ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);

			}
			ReportDAO.println("All Branch Total :  ", 0, 0, false, "BANK",repBean);
			ReportDAO.println(trans(ALLbrtot[1], "99,99,999.99", "", false, false), 50, 0, false, "BANK",repBean);
			ReportDAO.println(trans(ALLbrtot[2], "99,99,999.99", "", false, false), 63, 0, false, "BANK",repBean);
			ReportDAO.println(trans(ALLbrtot[3], "99,99,999.99", "", false, false), 76, 0, false, "BANK",repBean);
			ReportDAO.println(trans(ALLbrtot[4], "99,99,999.99", "", false, false), 89, 0, false, "BANK",repBean);
			ReportDAO.println(trans(ALLbrtot[5], "99,99,999.99", "", false, false), 102, 0, false, "BANK",repBean);
			ReportDAO.println(trans(ALLbrtot[6], "99,99,999.99", "", false, false), 115, 0, false, "BANK",repBean);
			ReportDAO.println(SLINE, 0, 4, false, "BANK",repBean);

			ReportDAO.println("AUTHORISED SIGNATORY", 80, 2, false, "BANK",repBean);
			//Print #fp Chr(12)
			//Print #fp Chr(18)
			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
			return;

		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

	}

	public static void EMPLIST(String rdt,String rdt1, String EMPBRN,String filepath, String imagepath) 
	{
		RepoartBean repBean  = new RepoartBean();
		FileWriter Fp;
		Connection Cn = null;
		String SLINE = "";

		ResultSet emp = null;
		String EmpSql = "";

		int tot_no_emp = 0;
		int br_tot_no_emp = 0;
		int alltot = 0;
		int PBRCD = 0;
		String pBrcd1 = "";
		int gross = 0;
		ReportDAO.OpenCon("", "", "",repBean);
		Cn = repBean.getCn();
		if(!(EMPBRN.equalsIgnoreCase("J")))
		{
			ReportDAO.inithead(repBean);
			repBean.setLnCount(0);
			repBean.setPageNo(1);
			repBean.setLineLen(80);
			repBean.setPageLen(65);
			repBean.setFoot_Fl(true);
			ReportDAO.make_prn_file(filepath,repBean);
			repBean.setBrnNo(999);

		}

		SimpleDateFormat outputFormat = new SimpleDateFormat("dd/MM/yyyy");
		SimpleDateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd");

		if(EMPBRN.equalsIgnoreCase("A"))
		{
			/*EmpSql =" select emp.empno,emp.empcode,emp.salute,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) " +
	    			" name ,EMP.DOB,EMP.DOJ,DATEDIFF(YEAR,EMP.DOB,GETDATE()) as Age from empmast emp" +
	    			" where emp.status = 'A' order by age desc ";*/
			EmpSql =" select emp.empcode,emp.salute,rtrim(emp.fname)+' '+rtrim(emp.mname)+' '+rtrim(emp.lname) " +
					" name ,EMP.DOB,EMP.DOJ,DATEDIFF(YEAR,EMP.DOB,GETDATE()) as Age from empmast emp" +
					" where emp.status = 'A' order by age desc,emp.empcode ";
			//repBean.setHdg1("Age Wise Employee List For :-" + rdt.substring(3, 11));
		}else if (EMPBRN.equals("B")) 
		{
			/*EmpSql = " select emp.empno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name ,EMP.DOB,EMP.DOJ, t.branch ,s.brname ,t.grade,t.acno"
					+ " from empmast emp, emptran t , branch s , grade g "
					+ " Where EMP.EMPNO = T.EMPNO and t.effdate = ( SELECT MAX(E2.EFFDATE)  FROM EMPTRAN E2 "
					+ " WHERE e2.empno = emp.empno and e2.EFFDATE <=  '"
					+ rdt
					+ "'  ) "
					+ " and emp.status = 'A' and s.brcd = t.branch "
					+ " order by t.branch,emp.empno ";*/
			/*EmpSql = " select emp.empno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name ,EMP.DOB,EMP.DOJ, t.prj_srno ,s.prj_name,t.DESIG ,t.acno"
					+ " from empmast emp, emptran t , prj s"
					+ " Where EMP.EMPNO = T.EMPNO and t.effdate = ( SELECT MAX(E2.EFFDATE)  FROM EMPTRAN E2 "
					+ " WHERE e2.empno = emp.empno and e2.EFFDATE <=  '"
					+ rdt
					+ "'  ) "
					+ " and emp.status = 'A' and s.prj_srno = t.prj_srno "
					+ " order by t.prj_srno,emp.empno ";*/
			EmpSql = " select emp.empcode,emp.salute,rtrim(emp.fname)+' '+rtrim(emp.mname)+' '+rtrim(emp.lname) name ,EMP.DOB,EMP.DOJ, t.branch ,s.brname ,t.DESIG,t.acno"
					+ " from empmast emp, emptran t , branch s "
					+ " Where EMP.EMPNO = T.EMPNO and t.effdate = ( SELECT MAX(E2.EFFDATE)  FROM EMPTRAN E2 "
					+ " WHERE e2.empno = emp.empno and e2.EFFDATE <=  '"
					+ rdt
					+ "'  ) "
					+ " and emp.status = 'A' and s.brcd = t.branch "
					+ " order by t.branch,emp.empcode ";



			//repBean.setHdg1("Branch Wise List For :-" + rdt.substring(3, 11));
		}
		else if(EMPBRN.equalsIgnoreCase("J"))
		{
			/*EmpSql="SELECT E.EMPNO ,E.SALUTE ,E.FNAME,E.MNAME,E.LNAME,E.DOJ,T.DESIG FROM EMPMAST E,EMPTRAN T  " +
	    			"WHERE E.EMPNO=T.EMPNO and E.DOJ BETWEEN  '"+ReportDAO.BOM(rdt)+"' AND '"+ReportDAO.EOM(rdt)+"' ORDER BY E.DOJ,E.EMPNO";*/
			EmpSql="SELECT E.EMPNO,E.EMPCODE ,E.SALUTE ,E.FNAME,E.MNAME,E.LNAME,E.DOJ FROM EMPMAST E " +
					"WHERE E.DOJ BETWEEN  '"+ReportDAO.BOM(rdt)+"' AND '"+ReportDAO.EOM(rdt1)+"' ORDER BY E.DOJ,E.EMPNO";
			//System.out.println(EmpSql);
		}
		else if(EMPBRN.equalsIgnoreCase("L"))//here check status ='n' and dol 
		{
			/*EmpSql="SELECT E.EMPNO ,E.SALUTE ,E.FNAME,E.MNAME,E.LNAME,E.DOJ,E.DOL,T.DESIG FROM EMPMAST E,EMPTRAN T  " +
	    			"WHERE E.EMPNO=T.EMPNO and E.STATUS='N' AND E.DOL BETWEEN  '"+ReportDAO.BOM(rdt)+"' AND '"+ReportDAO.EOM(rdt)+"' ORDER BY E.DOJ,E.EMPNO";*/
			EmpSql="SELECT E.EMPNO,E.EMPCODE ,E.SALUTE ,E.FNAME,E.MNAME,E.LNAME,E.DOJ,E.DOL FROM EMPMAST E " +
					"WHERE E.STATUS='N' AND E.DOL BETWEEN  '"+ReportDAO.BOM(rdt)+"' AND '"+ReportDAO.EOM(rdt1)+"'ORDER BY E.DOJ,E.EMPNO";
			//System.out.println(EmpSql);

		}
		else if(EMPBRN.equalsIgnoreCase("An")) 
		{
			EmpSql="SELECT E.EMPNO,E.EMPCODE ,E.SALUTE ,E.FNAME,E.MNAME,E.LNAME,E.DOJ,E.DOB,DATEADD(YEAR,60,DOB) as Ann " +
					"FROM EMPMAST E WHERE STATUS = 'A' " +
					//"and DATEPART(MM,DOB)BETWEEN datepart(mm,'"+ReportDAO.BOM(rdt)+"') and datepart(mm,'"+ReportDAO.EOM(rdt1)+"') and " +
					//"DATEPART(YEAR,dateadd(YEAR,60,DOB)) BETWEEN datepart(YEAR,'"+ReportDAO.BOM(rdt)+"') and datepart(YEAR,'"+ReportDAO.EOM(rdt1)+"') " +
					"and dateadd(YEAR,60,DOB) >='"+ReportDAO.BOM(rdt)+"' and  dateadd(YEAR,60,DOB) <='"+ReportDAO.EOM(rdt1)+"' " +
					"ORDER BY E.DOB,E.EMPNO";
			//System.out.println(EmpSql);

		}
		else if(EMPBRN.equalsIgnoreCase("C"))
		{
			EmpSql="SELECT E.EMPNO,E.EMPCODE ,E.SALUTE ,E.FNAME,E.MNAME,E.LNAME,E.DOJ,E.DOL,E.STATUS FROM EMPMAST E  ORDER BY E.STATUS, E.EMPNO";
		}
		else if(EMPBRN.equalsIgnoreCase("G"))
		{
			EmpSql="select * from LOOKUP where LKP_CODE = 'gd' and LKP_SRNO <> 0";

		}

		else if(EMPBRN.equalsIgnoreCase("P"))
		{
			EmpSql = "  select emp.empcode,emp.salute,emp.empno,rtrim(emp.fname)+' '+rtrim(emp.mname)+' '+rtrim(emp.lname) name ," +
					" EMP.DOB,EMP.DOJ,t.DESIG,t.PRJ_SRNO " + 
					" from empmast emp,emptran t where emp.status = 'A' AND t.EFFDATE = (SELECT MAX(E2.EFFDATE) FROM EMPTRAN E2 " +
					" WHERE E2.EMPNO = emp.EMPNO AND E2.EFFDATE <= '"+rdt+"')  and emp.empno = t.empno order by t.PRJ_SRNO,emp.empcode"; 
		}
		else if(EMPBRN.equalsIgnoreCase("S"))
		{
			EmpSql = "select emp.empcode,emp.empno,emp.salute,emp.empno,rtrim(emp.fname)+' '+rtrim(emp.mname)+' '+rtrim(emp.lname) name ," +
					"EMP.DOJ,t.DESIG,t.PRJ_SRNO from empmast emp,emptran t where emp.status = 'A' AND " +
					"t.EFFDATE = (SELECT MAX(E2.EFFDATE) FROM EMPTRAN E2 WHERE E2.EMPNO = emp.EMPNO AND E2.EFFDATE <= '"+rdt+"')  " +
					"and emp.empno = t.empno order by t.PRJ_SRNO,t.DESIG,emp.empcode"; 
		}

		else {

			/*EmpSql = "  select emp.empno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name ," +
			/*EmpSql = "  select emp.empno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name ," +
					" EMP.DOB,EMP.DOJ,t.DESIG " + 
                    " from empmast emp,emptran t   where emp.status = 'A'  and emp.empno = t.empno order by t.DESIG";*/
			/*   	EmpSql = "  select emp.empcode,emp.salute,emp.empno,rtrim(emp.fname)+' '+rtrim(emp.mname)+' '+rtrim(emp.lname) name ," +

					" EMP.DOB,EMP.DOJ,t.DESIG " + 

                    " from empmast emp,emptran t   where emp.status = 'A'  and emp.empno = t.empno order by t.DESIG";*/
			EmpSql = "  select emp.empcode,emp.salute,emp.empno,rtrim(emp.fname)+' '+rtrim(emp.mname)+' '+rtrim(emp.lname) name ," +
					" EMP.DOB,EMP.DOJ,t.DESIG, t.DEPT " + 
					" from empmast emp,emptran t where emp.status = 'A'  and emp.empno = t.empno AND t.EFFDATE = (SELECT MAX(E2.EFFDATE) FROM EMPTRAN E2 " +
					" WHERE E2.EMPNO = emp.EMPNO AND E2.EFFDATE <= '"+rdt+"') order by t.dept,emp.empcode" ;
			//repBean.setHdg1("Desig'n Wise Employee List For :-" + rdt.substring(3, 11));

			/* " from empmast emp,emptran t where emp.status = 'A'  and emp.empno = t.empno order by t.desig,emp.empcode" ;*/
			//repBean.setHdg1("Desig'n Wise Employee List For :-" + rdt.substring(3, 11));

		}
		//SLINE = stringOfSize(80, '-');
		//System.out.println("-------------===="+EmpSql);
		Statement st;
		try {
			st = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);

			if(!(EMPBRN.equalsIgnoreCase("J")||EMPBRN.equalsIgnoreCase("L")||EMPBRN.equalsIgnoreCase("C")))
			{

				emp = st.executeQuery(EmpSql);
				//System.out.println(EmpSql+"empsql");
				if (!emp.next()) {
					System.out.println("No Any Record Found");
					//Fp = repBean.getFp();
					//Fp.close();
					//return;
				}
				alltot = 0;

				emp.beforeFirst();
			}



			if(EMPBRN.equals("A")){


				try
				{

					Document doc = new Document();
					PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
					doc.open();
					doc.setPageSize(PageSize.A4);

					Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
					ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f,50f);
					image1.setAbsolutePosition(40f, 750f);

					doc.add(image1);
					doc.add(para);


					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Tel : 0253-2406100, 2469545",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
//					para = new Paragraph(new Phrase("Email :hrd@namcobank.in",new Font(Font.TIMES_ROMAN,8)));
//					para.setAlignment(Element.ALIGN_CENTER);
//					para.setSpacingAfter(0);
//
//					doc.add(para);

					para = new Paragraph(new Phrase("Age Wise Employee List For :-" + rdt.substring(3, 11),new Font(Font.TIMES_ROMAN,10)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);

					Rectangle rec = new  Rectangle(100,100);
					PdfPTable headtab = null;

					headtab= new PdfPTable(5);	
					headtab.setSpacingBefore(5);
					headtab.setWidthPercentage(new float[]{10,50,10,15,15}, rec);

					headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
					System.out.println("hi"+EmpSql);
					emp = st.executeQuery(EmpSql);
					LookupHandler lkhp = new LookupHandler();
					if(emp.next())
					{
						emp.beforeFirst();
						headtab.setSpacingBefore(10);
						PdfPCell c1 = new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
						headtab.addCell(c1);
						PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c2);
						PdfPCell c3 = new PdfPCell(new Phrase("Age",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c3);
						PdfPCell c4 = new PdfPCell(new Phrase("Date of Birth",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c4);
						PdfPCell c5 = new PdfPCell(new Phrase("Date of Joining",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c5);

						doc.add(headtab);

						PdfPTable datatab;
						tot_no_emp = 0;
						while(emp.next())
						{
							pBrcd1 = emp.getString("Age");
							br_tot_no_emp = 0;
							para = new Paragraph(new Phrase("Employee's List for Age : "+emp.getString("Age"),new Font(Font.TIMES_ROMAN,10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(4);
							doc.add(para);

							while (pBrcd1.equals(emp.getString("Age")))
							{
								datatab = new PdfPTable(5);
								datatab.setWidthPercentage(new float[]{10,50,10,15,15}, rec);
								datatab.setHorizontalAlignment(Element.ALIGN_LEFT); 
								PdfPCell cell1 = new PdfPCell(new Phrase(""+emp.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));  
								datatab.addCell(cell1);
								PdfPCell cell2 = new PdfPCell(new Phrase(""+lkhp.getLKP_Desc("SALUTE", emp.getInt("SALUTE"))+" "+emp.getString("name"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell2);
								PdfPCell cell3 = new PdfPCell(new Phrase(""+emp.getString("Age"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell3);
								PdfPCell cell4 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(emp.getDate("DOB")) ,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell4);
								PdfPCell cell5 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(emp.getDate("DOJ")),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell5);

								doc.add(datatab);


								tot_no_emp = tot_no_emp + 1;
								br_tot_no_emp = br_tot_no_emp + 1;
								if (!emp.next()) {
									break;
								}
								if(!pBrcd1.equals(emp.getString("Age"))){
									emp.previous();
									break;
								}
							}
							para = new Paragraph(new Phrase("No Of Employee :- "+br_tot_no_emp,new Font(Font.TIMES_ROMAN,10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(10);
							doc.add(para);


						}
						para = new Paragraph(new Phrase("Total No Of Employee :- "+tot_no_emp,new Font(Font.TIMES_ROMAN,10)));
						para.setAlignment(Element.ALIGN_LEFT);
						para.setSpacingAfter(10);
						doc.add(para);
					}



					else
					{
						System.out.println("no record found");
						PdfPCell c1 = new PdfPCell(new Phrase("Record is Not found for the Month "+rdt.substring(3),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  


						c1.setColspan(5);

						headtab.setSpacingBefore(40);
						headtab.addCell(c1);
						doc.add(headtab);

					}





					doc.close();
				}
				catch(Exception e)
				{
					e.printStackTrace();
				}


				/*repBean.setHdg3("Empno Name Of Employee                         Age            DOB           DOJ");
				ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
						repBean.getHdg2(), repBean.getHdg3(), "", "", "", "",repBean);
				tot_no_emp = 0;
				while (emp.next()) {
					ReportDAO.println("", 0, 1, false, "BANK",repBean);
					ReportDAO.println("Age :- ", 0, 0, false, "BANK",repBean);
					ReportDAO.println(emp.getString("Age"), 14, 1, false,
							"BANK",repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);

					pBrcd1 = emp.getString("Age");
					br_tot_no_emp = 0;
					while (pBrcd1.equals(emp.getString("Age"))) {
						ReportDAO.println(emp.getString("EMPNO"), 0, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("NAME"), 35, 1),
								7, 0, false, "BANK",repBean);
						ReportDAO.println(
								FixStr(emp.getString("Age"), 10, 1), 45, 0,
								false, "BANK",repBean);
						ReportDAO.println(
								FixStr(outputFormat.format(inputFormat
										.parse(emp.getString("dob"))), 10, 1),
								57, 0, false, "BANK",repBean);
						ReportDAO.println(
								FixStr(outputFormat.format(inputFormat
										.parse(emp.getString("doj"))), 10, 1),
								70, 1, false, "BANK",repBean);
						tot_no_emp = tot_no_emp + 1;
						br_tot_no_emp = br_tot_no_emp + 1;
						if (!emp.next()) {
							break;
						}
						if(!pBrcd1.equals(emp.getString("Age"))){
						   	emp.previous();
						   	break;
					    }
					}
					ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
					ReportDAO.println("No Of Emp :", 0, 0, false, "BANK",repBean);
					ReportDAO.println(""+br_tot_no_emp,42, 0, false, "BANK",repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
					alltot = alltot + gross;
					gross = 0;
				}*/
			}else if (EMPBRN.equals("B")) {

				try
				{

					Document doc = new Document();
					PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
					doc.open();
					doc.setPageSize(PageSize.A4);

					Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
					ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f,50f);
					image1.setAbsolutePosition(40f, 750f);

					doc.add(image1);
					doc.add(para);


					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);

					para = new Paragraph(new Phrase("Branch Wise List For :-" + rdt.substring(3, 11),new Font(Font.TIMES_ROMAN,10)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);

					Rectangle rec = new  Rectangle(100,100);
					PdfPTable headtab = null;

					headtab= new PdfPTable(5);	
					headtab.setSpacingBefore(5);
					headtab.setWidthPercentage(new float[]{10,35,25,15,15}, rec);

					headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
					//System.out.println(EmpSql);
					LookupHandler lkhp = new LookupHandler();
					emp = st.executeQuery(EmpSql);

					if(emp.next())
					{
						emp.beforeFirst();
						headtab.setSpacingBefore(10);
						PdfPCell c1 = new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
						headtab.addCell(c1);
						PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c2);
						PdfPCell c3 = new PdfPCell(new Phrase("Designation",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c3);
						PdfPCell c4 = new PdfPCell(new Phrase("Date of Birth",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c4);
						PdfPCell c5 = new PdfPCell(new Phrase("Date of Joining",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c5);

						doc.add(headtab);

						PdfPTable datatab;
						tot_no_emp = 0;
						LookupHandler lkph = new LookupHandler();
						while(emp.next())
						{
							PBRCD = emp.getInt("branch");
							br_tot_no_emp = 0;
							para = new Paragraph(new Phrase("Employee's List Of Branch : "+emp.getString("brname"),new Font(Font.TIMES_ROMAN,10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(4);
							doc.add(para);

							while (PBRCD == emp.getInt("branch"))
							{
								datatab = new PdfPTable(5);
								datatab.setWidthPercentage(new float[]{10,35,25,15,15}, rec);
								datatab.setHorizontalAlignment(Element.ALIGN_LEFT); 
								PdfPCell cell1 = new PdfPCell(new Phrase(""+emp.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));  
								datatab.addCell(cell1);
								PdfPCell cell2 = new PdfPCell(new Phrase(""+lkhp.getLKP_Desc("SALUTE", emp.getInt("SALUTE"))+" "+emp.getString("name"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell2);
								String desc = lkph.getLKP_Desc("DESIG", emp.getInt("DESIG"));
								PdfPCell cell3 = new PdfPCell(new Phrase(""+desc,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell3);
								PdfPCell cell4 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(emp.getDate("DOB")) ,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell4);
								PdfPCell cell5 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(emp.getDate("DOJ")),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell5);

								doc.add(datatab);


								tot_no_emp = tot_no_emp + 1;
								br_tot_no_emp = br_tot_no_emp + 1;
								if (!emp.next()) {
									break;
								}
								if(PBRCD != emp.getInt("branch")){
									emp.previous();
									break;
								}
							}
							para = new Paragraph(new Phrase("No Of Employee :- "+br_tot_no_emp,new Font(Font.TIMES_ROMAN,10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(10);
							doc.add(para);


						}
						para = new Paragraph(new Phrase("Total No Of Employee :- "+tot_no_emp,new Font(Font.TIMES_ROMAN,10)));
						para.setAlignment(Element.ALIGN_LEFT);
						para.setSpacingAfter(10);
						doc.add(para);
					}



					else
					{
						System.out.println("no record found");
						PdfPCell c1 = new PdfPCell(new Phrase("Record is Not found for the Month "+rdt.substring(3),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  


						c1.setColspan(5);

						headtab.setSpacingBefore(40);
						headtab.addCell(c1);
						doc.add(headtab);

					}





					doc.close();
				}
				catch(Exception e)
				{
					e.printStackTrace();
				}


				/*repBean.setHdg3("Empno  Name Of Employee                      Desig            DOB           DOJ");
				ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
						repBean.getHdg2(), repBean.getHdg3(), "", "", "", "",repBean);
				LookupHandler lkph = new LookupHandler();
				while (emp.next()) {
					ReportDAO.println("", 0, 1, false, "BANK",repBean);
					ReportDAO.println("Branch :- ", 0, 0, false, "BANK",repBean);
					ReportDAO.println(emp.getString("prj_name"), 14, 1, false,
							"BANK",repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
					PBRCD = emp.getInt("PRJ_SRNO");
					br_tot_no_emp = 0;
					while (PBRCD == emp.getInt("PRJ_SRNO")) {
						ReportDAO.println(emp.getString("EMPNO"), 0, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("NAME"), 35, 1),
								7, 0, false, "BANK",repBean);
						String desc = lkph.getLKP_Desc("DESIG", emp.getInt("DESIG"));
						ReportDAO.println(FixStr(desc, 10, 1),
								45, 0, false, "BANK",repBean);
						ReportDAO.println(
								FixStr(outputFormat.format(inputFormat
										.parse(emp.getString("dob"))), 10, 1),
								57, 0, false, "BANK",repBean);
						ReportDAO.println(
								FixStr(outputFormat.format(inputFormat
										.parse(emp.getString("doj"))), 10, 1),
								70, 1, false, "BANK",repBean);
						br_tot_no_emp = br_tot_no_emp + 1;
						tot_no_emp = tot_no_emp + 1;
						if (!emp.next()) {
							break;
						}
						if(PBRCD != emp.getInt("PRJ_SRNO")){
						   	emp.previous();
						   	break;
					    }
					}
					ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
					ReportDAO.println("No Of Emp :", 0, 0, false, "BANK",repBean);
					ReportDAO.println(""+br_tot_no_emp,42, 0, false, "BANK",repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
					alltot = alltot + gross;

					gross = 0;
					// Remaining......................................***********

					// * If frmrpt.pgbrk.Value = vbChecked Then LnCount = 66
					 //* PageNo = 0 println "", 0, Fp, 1 End If


				}*/
			}
			else if (EMPBRN.equals("P")) {

				try
				{

					Document doc = new Document();
					PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
					doc.open();
					doc.setPageSize(PageSize.A4);

					Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
					ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f,50f);
					image1.setAbsolutePosition(40f, 750f);

					doc.add(image1);
					doc.add(para);


					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);

					para = new Paragraph(new Phrase("Employees List According To Project Sites "+rdt.substring(3, 11),new Font(Font.TIMES_ROMAN,10)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);

					Rectangle rec = new  Rectangle(100,100);
					PdfPTable headtab = null;

					headtab= new PdfPTable(5);	
					headtab.setSpacingBefore(5);
					headtab.setWidthPercentage(new float[]{10,35,25,15,15}, rec);

					headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
					//System.out.println(EmpSql);
					LookupHandler lkhp = new LookupHandler();
					emp = st.executeQuery(EmpSql);

					if(emp.next())
					{
						emp.beforeFirst();
						headtab.setSpacingBefore(10);
						PdfPCell c1 = new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
						headtab.addCell(c1);
						PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c2);
						PdfPCell c3 = new PdfPCell(new Phrase("Project",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c3);
						PdfPCell c4 = new PdfPCell(new Phrase("Date of Birth",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c4);
						PdfPCell c5 = new PdfPCell(new Phrase("Date of Joining",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c5);

						doc.add(headtab);

						PdfPTable datatab;
						tot_no_emp = 0;

						while(emp.next())
						{
							String prj_name = null;
							String prj_Code = null;
							Connection conn = ConnectionManager.getConnectionTech();
							Statement stmt = conn.createStatement();
							String prjquery = "select Site_Name,Project_Code from Project_Sites where Site_ID = '"+emp.getString("PRJ_SRNO")+"'";
							//System.out.println(prjquery);
							ResultSet prj = stmt.executeQuery(prjquery);
							if(prj.next()){
								prj_name = prj.getString("Site_Name");
								prj_Code=prj.getString("Project_Code");
							}
							pBrcd1 = emp.getString("PRJ_SRNO");
							br_tot_no_emp = 0;
							para = new Paragraph(new Phrase("Employee's List Of Project Site Wise : "+prj_name+ " ("+prj_Code+")",new Font(Font.TIMES_ROMAN,10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(4);
							doc.add(para);
							prj.close();
							stmt.close();
							conn.close();
							while (pBrcd1.equals(emp.getString("PRJ_SRNO")))
							{
								datatab = new PdfPTable(5);
								datatab.setWidthPercentage(new float[]{10,35,25,15,15}, rec);
								datatab.setHorizontalAlignment(Element.ALIGN_LEFT); 
								PdfPCell cell1 = new PdfPCell(new Phrase(""+emp.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));  
								datatab.addCell(cell1);
								PdfPCell cell2 = new PdfPCell(new Phrase(""+lkhp.getLKP_Desc("SALUTE", emp.getInt("SALUTE"))+" "+emp.getString("name"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell2);
								PdfPCell cell3 = new PdfPCell(new Phrase(""+prj_Code ,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell3);
								PdfPCell cell4 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(emp.getDate("DOB")) ,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell4);
								PdfPCell cell5 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(emp.getDate("DOJ")),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell5);

								doc.add(datatab);


								tot_no_emp = tot_no_emp + 1;
								br_tot_no_emp = br_tot_no_emp + 1;
								if (!emp.next()) {
									break;
								}
								if(!pBrcd1.equals(emp.getString("PRJ_SRNO"))){
									emp.previous();
									break;
								}
							}
							para = new Paragraph(new Phrase("No Of Employee :- "+br_tot_no_emp,new Font(Font.TIMES_ROMAN,10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(10);
							doc.add(para);


						}
						para = new Paragraph(new Phrase("Total No Of Employee :- "+tot_no_emp,new Font(Font.TIMES_ROMAN,10)));
						para.setAlignment(Element.ALIGN_LEFT);
						para.setSpacingAfter(10);
						doc.add(para);
					}



					else
					{
						System.out.println("no record found");
						PdfPCell c1 = new PdfPCell(new Phrase("Record is Not found for the Month "+rdt.substring(3),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
						c1.setColspan(5);
						headtab.setSpacingBefore(40);
						headtab.addCell(c1);
						doc.add(headtab);

					}





					doc.close();
				}
				catch(Exception e)
				{
					e.printStackTrace();
				}
			}
			else if(EMPBRN.equals("G")){

				try
				{
					Document doc = new Document();
					PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));

					/*HeaderFooter footer = new HeaderFooter( new Phrase("", new Font(Font.TIMES_ROMAN,10)), true);
					footer.setBorder(Rectangle.NO_BORDER);
		            footer.setAlignment(Element.ALIGN_RIGHT);
		            doc.setFooter(footer);*/

					doc.open();
					doc.setPageSize(PageSize.A4);

					Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
					ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f,50f);
					image1.setAbsolutePosition(40f, 750f);

					doc.add(image1);
					doc.add(para);


					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);

					para = new Paragraph(new Phrase("Grade  Wise Employee List For : "+rdt.substring(3, 11),new Font(Font.TIMES_ROMAN,10)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(10);
					doc.add(para);

					Rectangle rec = new  Rectangle(100,100);
					PdfPTable headtab = null;

					headtab= new PdfPTable(5);	
					headtab.setSpacingBefore(5);
					headtab.setWidthPercentage(new float[]{10,35,25,15,15}, rec);

					headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
					//System.out.println(EmpSql);

					emp = st.executeQuery(EmpSql);
					if(emp.next())
					{
						emp.beforeFirst();
						headtab.setSpacingBefore(10);
						PdfPCell c1 = new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
						headtab.addCell(c1);
						PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c2);
						PdfPCell c3 = new PdfPCell(new Phrase("Designation",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c3);
						PdfPCell c4 = new PdfPCell(new Phrase("Date of Birth",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c4);
						PdfPCell c5 = new PdfPCell(new Phrase("Date of Joining",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c5);

						doc.add(headtab);

						PdfPTable datatab;
						tot_no_emp = 0;
						int desig = 0;


						while(emp.next())
						{
							LookupHandler lkhp = new LookupHandler();
							String desc = lkhp.getLKP_Desc("GD", emp.getInt("LKP_SRNO"));
							//int j = emp.getInt("LKP_SRNO");
							para = new Paragraph(new Phrase("Employee's List For Grade : "+desc,new Font(Font.TIMES_ROMAN,10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(4);
							doc.add(para);
							br_tot_no_emp = 0;
							String EmpSql2 = "select lkp_srno from LOOKUP where LKP_CODE = 'desig' and LKP_RECR = "+emp.getInt("LKP_SRNO");
							Statement stmt = Cn.createStatement();
							ResultSet rst = stmt.executeQuery(EmpSql2);
							while(rst.next()){

								String EmpSql3 = "  select emp.empcode,emp.salute,emp.empno,rtrim(emp.fname)+' '+rtrim(emp.mname)+' '+rtrim(emp.lname) name ," +
										" EMP.DOB,EMP.DOJ,t.DESIG, t.DEPT " + 
										" from empmast emp,emptran t where emp.status = 'A'  and emp.empno = t.empno and t.desig ="+rst.getInt("LKP_SRNO")+"  and emp.empno = t.empno AND t.EFFDATE = (SELECT MAX(E2.EFFDATE) FROM EMPTRAN E2 " +
										" WHERE E2.EMPNO = emp.EMPNO AND E2.EFFDATE <= '"+rdt+"') order by t.desig,emp.empcode" ;

								Statement stmt1 = Cn.createStatement();
								ResultSet rst1 = stmt1.executeQuery(EmpSql3);

								while(rst1.next()){
									datatab = new PdfPTable(5);
									datatab.setWidthPercentage(new float[]{10,35,25,15,15}, rec);
									datatab.setHorizontalAlignment(Element.ALIGN_LEFT); 
									PdfPCell cell1 = new PdfPCell(new Phrase(""+rst1.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));  
									datatab.addCell(cell1);
									PdfPCell cell2 = new PdfPCell(new Phrase(""+lkhp.getLKP_Desc("SALUTE", rst1.getInt("SALUTE"))+" "+rst1.getString("name"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
									datatab.addCell(cell2);
									PdfPCell cell3 = new PdfPCell(new Phrase(""+lkhp.getLKP_Desc("DESIG", rst.getInt("LKP_SRNO")),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
									datatab.addCell(cell3);
									PdfPCell cell4 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(rst1.getDate("DOB")) ,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
									datatab.addCell(cell4);
									PdfPCell cell5 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(rst1.getDate("DOJ")),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
									datatab.addCell(cell5);

									doc.add(datatab);


									tot_no_emp = tot_no_emp + 1;
									br_tot_no_emp = br_tot_no_emp + 1;

								}


							}	     
							para = new Paragraph(new Phrase("No Of Employee's : "+br_tot_no_emp,new Font(Font.TIMES_ROMAN,10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(10);
							doc.add(para);


						}
						para = new Paragraph(new Phrase("Total No Of Employee's : "+tot_no_emp,new Font(Font.TIMES_ROMAN,10)));
						para.setAlignment(Element.ALIGN_LEFT);
						para.setSpacingAfter(10);
						doc.add(para);

					}		    	 


					else
					{
						System.out.println("no record found");
						PdfPCell c1 = new PdfPCell(new Phrase("Record is Not found for the Month "+rdt.substring(3),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  


						c1.setColspan(5);

						headtab.setSpacingBefore(40);
						headtab.addCell(c1);
						doc.add(headtab);

					}

					doc.close();
				}
				catch(Exception e)
				{
					e.printStackTrace();
				}
			}
			else if(EMPBRN.equals("S")){

				try
				{

					Document doc = new Document();
					PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
					doc.open();
					doc.setPageSize(PageSize.A4);

					Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
					ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f,50f);
					image1.setAbsolutePosition(40f, 750f);

					doc.add(image1);
					doc.add(para);


					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);

					para = new Paragraph(new Phrase("Employees List "+rdt.substring(3, 11),new Font(Font.TIMES_ROMAN,10)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);

					Rectangle rec = new  Rectangle(100,100);
					PdfPTable headtab = null;

					headtab= new PdfPTable(7);	
					headtab.setSpacingBefore(5);
					headtab.setWidthPercentage(new float[]{4,5,30,10,18,25,8}, rec);

					headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
					//System.out.println(EmpSql);
					LookupHandler lkhp = new LookupHandler();
					emp = st.executeQuery(EmpSql);

					if(emp.next())
					{
						emp.beforeFirst();
						//headtab.setSpacingBefore(10);
						PdfPCell c0 = new PdfPCell(new Phrase("SR NO",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
						headtab.addCell(c0);
						PdfPCell c1 = new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
						headtab.addCell(c1);
						PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c2);
						PdfPCell c3 = new PdfPCell(new Phrase("Date of Joining",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c3);
						PdfPCell c4 = new PdfPCell(new Phrase("Designation",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c4);
						PdfPCell c5 = new PdfPCell(new Phrase("Qualification",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c5);
						PdfPCell c6 = new PdfPCell(new Phrase("Monthly CTC",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c6);


						PdfPTable datatab;
						tot_no_emp = 0;
						int srno = 1;

						while(emp.next())
						{
							String prj_name = null;
							String prj_Code = null;
							Connection conn = ConnectionManager.getConnectionTech();
							Statement stmt = conn.createStatement();
							String prjquery = "select Site_Name,Project_Code from Project_Sites where Site_ID = '"+emp.getString("PRJ_SRNO")+"'";
							//System.out.println(prjquery);
							ResultSet prj = stmt.executeQuery(prjquery);
							if(prj.next()){
								prj_name = prj.getString("Site_Name");
								prj_Code=prj.getString("Project_Code");
							}
							pBrcd1 = emp.getString("PRJ_SRNO");
							br_tot_no_emp = 0;
							para = new Paragraph(new Phrase("Project Name : "+prj_name+ " ("+prj_Code+")",new Font(Font.TIMES_ROMAN,10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingBefore(5);
							doc.add(para);
							doc.add(headtab);
							prj.close();
							stmt.close();
							conn.close();
							int desig = 0;
							while (pBrcd1.equals(emp.getString("PRJ_SRNO")))
							{
								datatab = new PdfPTable(7);
								datatab.setWidthPercentage(new float[]{4,5,30,10,18,25,8}, rec);
								datatab.setHorizontalAlignment(Element.ALIGN_LEFT); 
								PdfPCell cell0 = new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));  
								datatab.addCell(cell0);
								PdfPCell cell1 = new PdfPCell(new Phrase(""+emp.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));  
								datatab.addCell(cell1);
								PdfPCell cell2 = new PdfPCell(new Phrase(""+lkhp.getLKP_Desc("SALUTE", emp.getInt("SALUTE"))+" "+emp.getString("name"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell2);
								PdfPCell cell3 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(emp.getDate("DOJ")) ,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell3);
								PdfPCell cell4 = new PdfPCell(new Phrase(""+lkhp.getLKP_Desc("DESIG", emp.getInt("DESIG")),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell4);
								Statement ss = Cn.createStatement();
								String edu = "SELECT DEGREE FROM QUAL WHERE EMPNO ="+emp.getInt("EMPNO")+"order by srno";
								ResultSet qul = ss.executeQuery(edu);
								String disp_edu = "";
								String disp = "";
								while(qul.next()){
									disp_edu = lkhp.getLKP_Desc("ED",qul.getInt("DEGREE"));
									disp = disp+disp_edu+" ,";
								}
								if(disp.endsWith(","))
								{
									disp = disp.substring(0,disp.length() - 1);
								}
								PdfPCell cell5 = new PdfPCell(new Phrase(""+disp ,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell5);

								String ctc = "select sum(inp_amt) from ctcdisplay where empno="+emp.getInt("EMPNO");
								ResultSet ctcrs = ss.executeQuery(ctc);
								PdfPCell cell6;
								if(ctcrs.next()) 
									cell6 = new PdfPCell(new Phrase(""+ctcrs.getFloat(1) ,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								else
									cell6 = new PdfPCell(new Phrase("--" ,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell6);


								doc.add(datatab);

								tot_no_emp = tot_no_emp + 1;
								srno=srno+1;
								br_tot_no_emp = br_tot_no_emp + 1;
								if (!emp.next()) {
									break;
								}
								if(!pBrcd1.equals(emp.getString("PRJ_SRNO"))){
									emp.previous();
									break;
								}

							}
							para = new Paragraph(new Phrase("No Of Employee :- "+br_tot_no_emp,new Font(Font.TIMES_ROMAN,10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(10);
							doc.add(para);


						}
						para = new Paragraph(new Phrase("Total No Of Employee :- "+tot_no_emp,new Font(Font.TIMES_ROMAN,10)));
						para.setAlignment(Element.ALIGN_LEFT);
						para.setSpacingAfter(10);
						doc.add(para);
					}



					else
					{
						System.out.println("no record found");
						PdfPCell c1 = new PdfPCell(new Phrase("Record is Not found for the Month "+rdt.substring(3),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
						c1.setColspan(5);
						headtab.setSpacingBefore(40);
						headtab.addCell(c1);
						doc.add(headtab);

					}





					doc.close();
				}
				catch(Exception e)
				{
					e.printStackTrace();
				}


			}
			else if(EMPBRN.equals("J") || EMPBRN.equalsIgnoreCase("L")||EMPBRN.equalsIgnoreCase("C")|| EMPBRN.equalsIgnoreCase("An"))
			{
				try
				{


					Document doc = new Document();
					PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
					doc.open();
					doc.setPageSize(PageSize.A4);

					Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
					ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f, 50f);
					image1.setAbsolutePosition(40f, 740f);

					doc.add(image1);
					doc.add(para);


					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);


					if(EMPBRN.equalsIgnoreCase("J"))
					{

						//para = new Paragraph(new Phrase("Employees List According to Date Of joining for Month -"+rdt.substring(3),new Font(Font.TIMES_ROMAN,10)));
						para = new Paragraph(new Phrase("Employees List According to Date Of joining from "+rdt.substring(3)+" To "+rdt1.substring(3),new Font(Font.TIMES_ROMAN,10)));

					}
					else if(EMPBRN.equalsIgnoreCase("L"))
					{
						//para = new Paragraph(new Phrase("Employees List According to Date Of Leaving "+rdt.substring(3),new Font(Font.TIMES_ROMAN,10)));
						para = new Paragraph(new Phrase("Employees List According to Date Of Leaving from "+rdt.substring(3)+" To "+rdt1.substring(3),new Font(Font.TIMES_ROMAN,10)));
					}
					else if(EMPBRN.equalsIgnoreCase("An"))
					{
						//para = new Paragraph(new Phrase("Employees List According to Date Of Leaving "+rdt.substring(3),new Font(Font.TIMES_ROMAN,10)));
						para = new Paragraph(new Phrase("Employees List According to Date Of Anotation from "+rdt.substring(3)+" To "+rdt1.substring(3),new Font(Font.TIMES_ROMAN,10)));
					}
					else 
					{
						para = new Paragraph(new Phrase("All Employees List ",new Font(Font.TIMES_ROMAN,10)));
					}
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					Rectangle rec = new  Rectangle(100,100);
					PdfPTable headtab = null;
					if(EMPBRN.equals("L")||EMPBRN.equals("An"))
					{
						headtab= new PdfPTable(5);	
						headtab.setWidthPercentage(new float[]{10,10,50,15,15}, rec);
					}
					else if (EMPBRN.equalsIgnoreCase("C"))
					{
						headtab= new PdfPTable(5);
						headtab.setWidthPercentage(new float[]{10,10,40,20,20}, rec);
					}
					else
					{
						headtab= new PdfPTable(4);
						headtab.setWidthPercentage(new float[]{10,10,50,30}, rec);
					}
					headtab.setSpacingBefore(10);

					headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
					//System.out.println(EmpSql);
					emp = st.executeQuery(EmpSql);
					if(emp.next())
					{
						emp.beforeFirst();
						PdfPCell c1 = new PdfPCell(new Phrase("Sr.No",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));  
						headtab.addCell(c1);
						PdfPCell c2 = new PdfPCell(new Phrase("Emp Code",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c2);
						PdfPCell c3 = new PdfPCell(new Phrase("Employee Name",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c3);
						PdfPCell c4 = new PdfPCell(new Phrase("Date of Joining",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c4);
						if(EMPBRN.equalsIgnoreCase("L"))
						{
							PdfPCell c5 = new PdfPCell(new Phrase("Date of Leaving",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
							headtab.addCell(c5);
						}
						if(EMPBRN.equalsIgnoreCase("An"))
						{
							PdfPCell c5 = new PdfPCell(new Phrase("Date of Anotation",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
							headtab.addCell(c5);
						}
						if(EMPBRN.equalsIgnoreCase("C"))
						{
							PdfPCell c5 = new PdfPCell(new Phrase("Status",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
							headtab.addCell(c5);
						}

						doc.add(headtab);

						int j=0;
						LookupHandler lkhp = new LookupHandler();


						while(emp.next())
						{
							j++;

							PdfPTable datatab;
							if(EMPBRN.equalsIgnoreCase("L")||EMPBRN.equalsIgnoreCase("An"))
							{
								datatab = new PdfPTable(5);
								datatab.setWidthPercentage(new float[]{10,10,50,15,15}, rec);

							}
							else if (EMPBRN.equalsIgnoreCase("C")){
								datatab = new PdfPTable(5);
								datatab.setWidthPercentage(new float[]{10,10,40,20,20}, rec);

							}
							else
							{
								datatab = new PdfPTable(4);
								datatab.setWidthPercentage(new float[]{10,10,50,30}, rec);	
							}

							//System.out.println(""+j);

							datatab.setHorizontalAlignment(Element.ALIGN_LEFT); 
							PdfPCell cell1 = new PdfPCell(new Phrase(""+j,new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));  
							datatab.addCell(cell1);
							PdfPCell cell2 = new PdfPCell(new Phrase(""+emp.getString("EMPCODE"),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
							datatab.addCell(cell2);
							PdfPCell cell3 = new PdfPCell(new Phrase(new Phrase(""+lkhp.getLKP_Desc("SALUTE", emp.getInt("SALUTE"))+" "+" "+emp.getString("FNAME")+" "+emp.getString("MNAME")+" "+emp.getString("LNAME"),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL))));
							datatab.addCell(cell3);
							PdfPCell cell4 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(emp.getDate("DOJ")) ,new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
							datatab.addCell(cell4);

							if(EMPBRN.equalsIgnoreCase("L"))
							{
								PdfPCell cell5 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(emp.getDate("DOL")),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell5);
							}
							if(EMPBRN.equalsIgnoreCase("An"))
							{
								PdfPCell cell5 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(emp.getDate("Ann")),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell5);
							}
							if(EMPBRN.equalsIgnoreCase("C"))
							{
								PdfPCell cell5 = new PdfPCell(new Phrase(""+((emp.getString("status")).equalsIgnoreCase("a")?"ACTIVE":"NON-ACTIVE"),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell5);
							}
							doc.add(datatab);



						}


					}
					else
					{
						System.out.println("no record found");
						PdfPCell c1 = new PdfPCell(new Phrase("No Record found for the Duration "+rdt.substring(3)+" To "+rdt1.substring(3),new Font(FONT.TIMES_ROMAN,10,Font.BOLD)));  
						if(EMPBRN.equalsIgnoreCase("L")||EMPBRN.equalsIgnoreCase("An"))
						{
							c1.setColspan(5);	
						}
						else
						{
							c1.setColspan(4);
						}
						headtab.setSpacingBefore(40);
						headtab.addCell(c1);
						doc.add(headtab);

					}


					doc.close();
				}catch(Exception e){e.printStackTrace();}
			}


			else if(EMPBRN.equals("D")){


				try
				{

					Document doc = new Document();
					PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
					doc.open();
					doc.setPageSize(PageSize.A4);

					Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
					ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f,50f);
					image1.setAbsolutePosition(40f, 750f);

					doc.add(image1);
					doc.add(para);


					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);

					para = new Paragraph(new Phrase("Designation  Wise Employee List For :- "+rdt.substring(3, 11),new Font(Font.TIMES_ROMAN,10)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(10);
					doc.add(para);

					Rectangle rec = new  Rectangle(100,100);
					PdfPTable headtab = null;

					headtab= new PdfPTable(5);	
					headtab.setSpacingBefore(5);
					headtab.setWidthPercentage(new float[]{10,35,25,15,15}, rec);

					headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
					//System.out.println(EmpSql);

					emp = st.executeQuery(EmpSql);
					if(emp.next())
					{
						emp.beforeFirst();
						headtab.setSpacingBefore(10);
						PdfPCell c1 = new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
						headtab.addCell(c1);
						PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c2);
						PdfPCell c3 = new PdfPCell(new Phrase("Designation",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c3);
						PdfPCell c4 = new PdfPCell(new Phrase("Date of Birth",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c4);
						PdfPCell c5 = new PdfPCell(new Phrase("Date of Joining",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c5);

						doc.add(headtab);

						PdfPTable datatab;
						tot_no_emp = 0;
						int desig = 0;


						while(emp.next())
						{
							LookupHandler lkhp = new LookupHandler();
							String desc = lkhp.getLKP_Desc("DESIG", emp.getInt("DESIG"));
							desig = emp.getInt("DESIG");
							br_tot_no_emp = 0;
							para = new Paragraph(new Phrase("Employee's List For Designation : "+desc,new Font(Font.TIMES_ROMAN,10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(4);
							doc.add(para);

							while (desig == emp.getInt("DESIG"))
							{
								datatab = new PdfPTable(5);
								datatab.setWidthPercentage(new float[]{10,35,25,15,15}, rec);
								datatab.setHorizontalAlignment(Element.ALIGN_LEFT); 
								PdfPCell cell1 = new PdfPCell(new Phrase(""+emp.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));  
								datatab.addCell(cell1);
								PdfPCell cell2 = new PdfPCell(new Phrase(""+lkhp.getLKP_Desc("SALUTE", emp.getInt("SALUTE"))+" "+emp.getString("name"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell2);
								PdfPCell cell3 = new PdfPCell(new Phrase(""+desc,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell3);
								PdfPCell cell4 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(emp.getDate("DOB")) ,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell4);
								PdfPCell cell5 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(emp.getDate("DOJ")),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell5);

								doc.add(datatab);


								tot_no_emp = tot_no_emp + 1;
								br_tot_no_emp = br_tot_no_emp + 1;
								if (!emp.next()) {
									break;
								}
								if(desig != emp.getInt("DESIG")){
									emp.previous();
									break;
								}
							}
							para = new Paragraph(new Phrase("No Of Employee :- "+br_tot_no_emp,new Font(Font.TIMES_ROMAN,10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(10);
							doc.add(para);


						}
						para = new Paragraph(new Phrase("Total No Of Employee :- "+tot_no_emp,new Font(Font.TIMES_ROMAN,10)));
						para.setAlignment(Element.ALIGN_LEFT);
						para.setSpacingAfter(10);
						doc.add(para);
					}



					else
					{
						System.out.println("no record found");
						PdfPCell c1 = new PdfPCell(new Phrase("Record is Not found for the Month "+rdt.substring(3),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  


						c1.setColspan(5);

						headtab.setSpacingBefore(40);
						headtab.addCell(c1);
						doc.add(headtab);

					}





					doc.close();
				}
				catch(Exception e)
				{
					e.printStackTrace();
				}


				/*repBean.setHdg3("Empno Name Of Employee                         Desig            DOB           DOJ");

			else {


				try
				{

					Document doc = new Document();
					PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
					doc.open();
					doc.setPageSize(PageSize.A4);

					Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
					ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("HARSH CONSTRUCTION",FONT), 297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase("HARSH CONSTRUCTION PVT.LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f,50f);
					image1.setAbsolutePosition(40f, 750f);

					doc.add(image1);
					doc.add(para);


					para = new Paragraph(new Phrase("1 Sanskruti Apartment Murkute Lane, New Pandit Coloney,Gangapur Road,Nashik -422005",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Tel : 0253-2317143,Fax : 0253-2317621",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Email : info@hcplnsk.com",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);

					para = new Paragraph(new Phrase("Designation  Wise Employee List For :- "+rdt.substring(3, 11),new Font(Font.TIMES_ROMAN,10)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(10);
					doc.add(para);

					Rectangle rec = new  Rectangle(100,100);
					PdfPTable headtab = null;

					headtab= new PdfPTable(5);	
					headtab.setSpacingBefore(5);
					headtab.setWidthPercentage(new float[]{10,35,25,15,15}, rec);

					headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
					//System.out.println(EmpSql);

					emp = st.executeQuery(EmpSql);
					if(emp.next())
					{
						 emp.beforeFirst();
						 headtab.setSpacingBefore(10);
							 PdfPCell c1 = new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
							 headtab.addCell(c1);
						     PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						     headtab.addCell(c2);
						     PdfPCell c3 = new PdfPCell(new Phrase("Designation",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						     headtab.addCell(c3);
						     PdfPCell c4 = new PdfPCell(new Phrase("Date of Birth",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						     headtab.addCell(c4);
						     PdfPCell c5 = new PdfPCell(new Phrase("Date of Joining",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						     headtab.addCell(c5);

						     doc.add(headtab);

						     PdfPTable datatab;
						     tot_no_emp = 0;
						     int desig = 0;


						     while(emp.next())
								{
						    	 LookupHandler lkhp = new LookupHandler();
							     String desc = lkhp.getLKP_Desc("DESIG", emp.getInt("DESIG"));
							     desig = emp.getInt("DESIG");
						    	 br_tot_no_emp = 0;
						    	para = new Paragraph(new Phrase("Employee's List For Designation : "+desc,new Font(Font.TIMES_ROMAN,10)));
								para.setAlignment(Element.ALIGN_LEFT);
								para.setSpacingAfter(4);
								doc.add(para);

						    	 while (desig == emp.getInt("DESIG"))
						    	 {
						    	 datatab = new PdfPTable(5);
						    	 datatab.setWidthPercentage(new float[]{10,35,25,15,15}, rec);
						    	 datatab.setHorizontalAlignment(Element.ALIGN_LEFT); 
					    		 PdfPCell cell1 = new PdfPCell(new Phrase(""+emp.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));  
					    		 datatab.addCell(cell1);
							     PdfPCell cell2 = new PdfPCell(new Phrase(""+lkhp.getLKP_Desc("SALUTE", emp.getInt("SALUTE"))+" "+emp.getString("name"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
							     datatab.addCell(cell2);
							     PdfPCell cell3 = new PdfPCell(new Phrase(""+desc,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
							     datatab.addCell(cell3);
							     PdfPCell cell4 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(emp.getDate("DOB")) ,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
							     datatab.addCell(cell4);
							     PdfPCell cell5 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(emp.getDate("DOJ")),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
							     datatab.addCell(cell5);

							     doc.add(datatab);


						    	 tot_no_emp = tot_no_emp + 1;
									br_tot_no_emp = br_tot_no_emp + 1;
									if (!emp.next()) {
										break;
									}
									if(desig != emp.getInt("DESIG")){
									   	emp.previous();
									   	break;
								    }
					            }
						   para = new Paragraph(new Phrase("No Of Employee :- "+br_tot_no_emp,new Font(Font.TIMES_ROMAN,10)));
						   para.setAlignment(Element.ALIGN_LEFT);
						   para.setSpacingAfter(10);
						   doc.add(para);


							}
						     para = new Paragraph(new Phrase("Total No Of Employee :- "+tot_no_emp,new Font(Font.TIMES_ROMAN,10)));
							 para.setAlignment(Element.ALIGN_LEFT);
							 para.setSpacingAfter(10);
							 doc.add(para);
					}



					else
					{
						System.out.println("no record found");
						PdfPCell c1 = new PdfPCell(new Phrase("Record is Not found for the Month "+rdt.substring(3),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  


							c1.setColspan(5);

						 headtab.setSpacingBefore(40);
						 headtab.addCell(c1);
						 doc.add(headtab);

					}





				doc.close();
				}
				catch(Exception e)
				{
					e.printStackTrace();
				}


				/*repBean.setHdg3("Empno Name Of Employee                         Desig            DOB           DOJ");

				ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
						repBean.getHdg2(), repBean.getHdg3(), "", "", "", "",repBean);
				tot_no_emp = 0;
				int desig = 0;
				while (emp.next()) {

					LookupHandler lkph = new LookupHandler();
					String desc = lkph.getLKP_Desc("DESIG", emp.getInt("DESIG"));
					ReportDAO.println("", 0, 1, false, "BANK",repBean);
					ReportDAO.println("Desig :- ", 0, 0, false, "BANK",repBean);
					ReportDAO.println(desc, 14, 1, false,
							"BANK",repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
					desig = emp.getInt("DESIG");
					br_tot_no_emp = 0;
					while (desig == emp.getInt("DESIG")) {
						ReportDAO.println(emp.getString("EMPNO"), 0, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("NAME"), 35, 1),
								7, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(desc, 10, 1), 45, 0,false, "BANK",repBean);
						ReportDAO.println(
								FixStr(outputFormat.format(inputFormat
										.parse(emp.getString("dob"))), 10, 1),
								57, 0, false, "BANK",repBean);
						ReportDAO.println(
								FixStr(outputFormat.format(inputFormat
										.parse(emp.getString("doj"))), 10, 1),
								70, 1, false, "BANK",repBean);
						tot_no_emp = tot_no_emp + 1;
						br_tot_no_emp = br_tot_no_emp + 1;
						if (!emp.next()) {
							break;
						}
						if(desig != emp.getInt("DESIG")){
						   	emp.previous();
						   	break;
					    }
					}
					ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
					ReportDAO.println("No Of Emp :", 0, 0, false, "BANK",repBean);
					ReportDAO.println(""+br_tot_no_emp,42, 0, false, "BANK",repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
					alltot = alltot + gross;
					gross = 0;
					// Remaining......................................************//** If frmrpt.pgbrk.Value = vbChecked 
					//Then LnCount = 66* PageNo = 0 println "", 0, Fp, 1 End If*//*

				}*/
			}


			else  {

				try
				{

					Document doc = new Document();
					PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
					doc.open();
					doc.setPageSize(PageSize.A4);

					Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
					ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f,50f);
					image1.setAbsolutePosition(40f, 750f);

					doc.add(image1);
					doc.add(para);


					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);

					para = new Paragraph(new Phrase("Department  Wise Employee List For :- "+rdt.substring(3, 11),new Font(Font.TIMES_ROMAN,10)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(10);
					doc.add(para);

					Rectangle rec = new  Rectangle(100,100);
					PdfPTable headtab = null;

					headtab= new PdfPTable(5);	
					headtab.setSpacingBefore(5);
					headtab.setWidthPercentage(new float[]{10,35,25,15,15}, rec);

					headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
					//System.out.println(EmpSql);

					emp = st.executeQuery(EmpSql);
					if(emp.next())
					{
						emp.beforeFirst();
						headtab.setSpacingBefore(10);
						PdfPCell c1 = new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
						headtab.addCell(c1);
						PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c2);
						PdfPCell c3 = new PdfPCell(new Phrase("Department",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c3);
						PdfPCell c4 = new PdfPCell(new Phrase("Date of Birth",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c4);
						PdfPCell c5 = new PdfPCell(new Phrase("Date of Joining",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c5);

						doc.add(headtab);

						PdfPTable datatab;
						tot_no_emp = 0;
						int deptr = 0;


						while(emp.next())
						{
							LookupHandler lkhp = new LookupHandler();
							String desc = lkhp.getLKP_Desc("DEPT", emp.getInt("DEPT"));
							deptr = emp.getInt("DEPT");
							br_tot_no_emp = 0;
							para = new Paragraph(new Phrase("Employee's List For Department : "+desc,new Font(Font.TIMES_ROMAN,10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(4);
							doc.add(para);

							while (deptr == emp.getInt("DEPT"))
							{
								datatab = new PdfPTable(5);
								datatab.setWidthPercentage(new float[]{10,35,25,15,15}, rec);
								datatab.setHorizontalAlignment(Element.ALIGN_LEFT); 
								PdfPCell cell1 = new PdfPCell(new Phrase(""+emp.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));  
								datatab.addCell(cell1);
								PdfPCell cell2 = new PdfPCell(new Phrase(""+lkhp.getLKP_Desc("SALUTE", emp.getInt("SALUTE"))+" "+emp.getString("name"),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell2);
								PdfPCell cell3 = new PdfPCell(new Phrase(""+desc,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell3);
								PdfPCell cell4 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(emp.getDate("DOB")) ,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell4);
								PdfPCell cell5 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(emp.getDate("DOJ")),new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
								datatab.addCell(cell5);

								doc.add(datatab);


								tot_no_emp = tot_no_emp + 1;
								br_tot_no_emp = br_tot_no_emp + 1;
								if (!emp.next()) {
									break;
								}
								if(deptr != emp.getInt("DEPT")){
									emp.previous();
									break;
								}
							}
							para = new Paragraph(new Phrase("No Of Employee :- "+br_tot_no_emp,new Font(Font.TIMES_ROMAN,10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(10);
							doc.add(para);


						}
						para = new Paragraph(new Phrase("Total No Of Employee :- "+tot_no_emp,new Font(Font.TIMES_ROMAN,10)));
						para.setAlignment(Element.ALIGN_LEFT);
						para.setSpacingAfter(10);
						doc.add(para);
					}



					else
					{
						System.out.println("no record found");
						PdfPCell c1 = new PdfPCell(new Phrase("Record is Not found for the Month "+rdt.substring(3),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
						c1.setColspan(5);

						headtab.setSpacingBefore(40);
						headtab.addCell(c1);
						doc.add(headtab);

					}





					doc.close();
				}
				catch(Exception e)
				{
					e.printStackTrace();
				}
			}
			/*if(!(EMPBRN.equalsIgnoreCase("J") || EMPBRN.equalsIgnoreCase("L")||EMPBRN.equalsIgnoreCase("C")))

		/*if(!(EMPBRN.equalsIgnoreCase("J") || EMPBRN.equalsIgnoreCase("L")||EMPBRN.equalsIgnoreCase("C")))

		{
			ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
			ReportDAO.println(
					"TOTAL NO OF EMPLOYEES = " + String.valueOf(tot_no_emp),
					10, 1, false, "BANK",repBean);
			ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
			ReportDAO.println("AUTHORISED SIGNATORY", 55, 2, false, "BANK",repBean);
			// Print #fp Chr(12)
			// Print #fp Chr(18)
			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
			return;

		}*/




		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} 
	}

	public static void Leave_report(String Fdt, String TDT, String EMPBRN, int days, String filepath)
	{

		RepoartBean repBean  = new RepoartBean();
		FileWriter Fp;
		Connection Cn = null;	
		String SLINE = "";
		String dtrsql  = "";

		ResultSet emp = null;

		String EmpSql  = "";
		int Pempno = 0;
		int tot_no_emp = 0;     
		int br_tot_no_emp = 0;
		int alltot  = 0;
		int PBRCD= 0;


		ReportDAO.inithead(repBean);
		repBean.setLnCount(0);
		repBean.setPageNo(1);
		repBean.setLineLen(80);
		repBean.setPageLen(65);
		repBean.setFoot_Fl(true);
		ReportDAO.make_prn_file(filepath,repBean);
		repBean.setBrnNo(999);
		ReportDAO.OpenCon("", "", "",repBean);
		Cn = repBean.getCn();


		SimpleDateFormat outputFormat = new SimpleDateFormat("dd/MM/yyyy");
		SimpleDateFormat inputFormat = new SimpleDateFormat("MM/dd/yyyy");


		EmpSql = " select emp.empno,rtrim(emp.lname)+' '+substring(rtrim(emp.fname),1,1)+'. '+substring(rtrim(emp.mname),1,1) as  name ,"  +
				" leavecd,leavepurp,brcdch,l.lkp_disc disc,Frmdt,todt,DATEDIFF(day,todt,FRMDT) + 1 nodays , trndate,leavepurp " +
				",EMP.DOB,EMP.DOJ, t.branch ,s.brname ,t.grade,t.acno,LT.STATUS,TRNTYPE " +
				" from leavetran lt,empmast emp, emptran t , branch s , grade g , lookup l " +
				" where l.lkp_code = 'LPURP' and l.lkp_srno = lt.leavepurp and LT.STATUS <> 98 AND TRNTYPE = 'D' AND lreason <> 'AUTO CR' " +
				" and frmdt between '"+Fdt+"' and '"+TDT +"' " +
				" and leavepurp not in (4,1) and (DATEDIFF(day,todt,FRMDT) + 1) >= " + days + " " +
				" and lt.empno = emp.empno " +
				" and EMP.EMPNO = T.EMPNO AND g.postcd = t.grade and t.effdate = " +
				" ( SELECT MAX(E2.EFFDATE)  FROM EMPTRAN E2 " +
				" WHERE e2.empno = emp.empno and e2.EFFDATE <= '"+TDT +"' )" +
				" and emp.status = 'A' and s.brcd = t.branch " +
				" order by t.branch,emp.empno ";
		// System.out.println(EmpSql);
		//  repBean.setHdg1("Branch Wise Leave Report From :- " + Fdt.substring(3, 11) + " To " + TDT.substring(3, 11));
		SLINE = stringOfSize(80, '-');
		Statement st;
		try {
			st = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			emp = st.executeQuery(EmpSql);

			if (!emp.next()) {
				System.out.println("No Any Record Found");
				Fp = repBean.getFp();
				Fp.close();
				return;
			}
			alltot = 0;
			Pempno = 0;
			tot_no_emp = 0;
			br_tot_no_emp = 0;
			repBean.setHdg2("Empno| Name Of Employee      |Branch |Leave|From Date | To_date  |No.Days|Total  ");
			ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
					repBean.getHdg2(), "", "", "", "", "",repBean);
			if (EMPBRN.equals("8")) {
				emp.beforeFirst();
				while (emp.next()) {
					br_tot_no_emp = 0;
					ReportDAO.println("Branch :- ", 0, 0, false, "BANK",repBean);
					ReportDAO.println(emp.getString("BRNAME"), 14, 0, false,"BANK",repBean);
					ReportDAO.println("----------------------------------------------", 0, 1,false, "BANK",repBean);
					PBRCD = emp.getInt("BRANCH");
					alltot = 0;
					Pempno = emp.getInt("EMPNO");
					System.out.println(emp.getInt("EMPNO"));
					while (PBRCD == emp.getInt("BRANCH")) {
						ReportDAO.println(emp.getString("EMPNO"), 0, 0, false, "BANK",repBean);
						ReportDAO.println("|", 6, 0, false, "BANK",repBean);
						String st45 = emp.getString("NAME");
						ReportDAO.println(FixStr(emp.getString("NAME").substring(0, emp.getString("NAME").length()), 21, 1),7, 0, false, "BANK",repBean);
						ReportDAO.println("|", 29, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("BRCDCH"), 7, 1), 32, 0,	false, "BANK",repBean);
						ReportDAO.println("|", 37, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("LEAVECD"), 2, 1), 39, 0,false, "BANK",repBean);
						ReportDAO.println("|", 43, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(outputFormat.format(inputFormat.parse(emp.getString("frmdt"))), 10, 1),44, 0, false, "BANK",repBean);
						ReportDAO.println("|", 54, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(outputFormat.format(inputFormat.parse(emp.getString("todt"))), 10, 1),55, 0, false, "BANK",repBean);
						ReportDAO.println("|", 65, 0, false, "BANK",repBean);
						ReportDAO.println(emp.getString("nodays"), 66, 0, false,"BANK",repBean);
						alltot = alltot + emp.getInt("nodays");
						ReportDAO.println("|", 73, 0, false, "BANK",repBean);
						tot_no_emp = tot_no_emp + 1;
						br_tot_no_emp = br_tot_no_emp + 1;

						if(!emp.next()){
							ReportDAO.println(String.valueOf(alltot), 74, 1, false,"BANK",repBean);
							break;
						}

						if(PBRCD != emp.getInt("BRANCH")){
							emp.previous();
							ReportDAO.println(String.valueOf(alltot), 74, 1, false,"BANK",repBean);
							System.out.println("in emp previous"+emp.getInt("EMPNO"));
							break;
						}
						if(Pempno != emp.getInt("EMPNO")){
							ReportDAO.println(String.valueOf(alltot), 74, 1, false,"BANK",repBean);
							alltot = 0;
						}else{
							ReportDAO.println("", 75, 1, false, "BANK",repBean);
						}
						Pempno = emp.getInt("EMPNO");

					}
					ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
					ReportDAO.println("No Of Emp :", 0, 0, false, "BANK",repBean);
					ReportDAO.println(String.valueOf(br_tot_no_emp),42, 0, false, "BANK",repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);



				}
				ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
				ReportDAO.println("Total No Of Emp :", 0, 0, false, "BANK",repBean);
				ReportDAO.println(String.valueOf(tot_no_emp),42, 0, false, "BANK",repBean);
				ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
			}
			ReportDAO.println("AUTHORISED SIGNATORY", 55, 2, false, "BANK",repBean);
			// Print #fp Chr(12)
			// Print #fp Chr(18)
			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
			return;

		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} 

	}
	//............Hemant Bhavsar..............EMPLIST_with_edu, caste_cate_EMPLIST,LeaveRep

	
	
	
	public static void Leave_Ledger_ReportText(int feno1,int teno1,String Fdt,String TDT,String filepath)
	{
		RepoartBean repBean  = new RepoartBean();
		FileWriter Fp;
		Connection Cn = null;	
		int feno=0;
		int teno=0;
		String fdate="";
		String tdate="";
		float clbal=0;
		float plbal=0;

		float slbal=0;
		float mlbal =0;
		int nopl =0;
		int nosl =0;
		int nocl =0;
		ResultSet emp =null;
		String Str1 ="";
		String SLINE ="";
		int TCnopl =0;
		int TCnosl =0;
		int TCnocl =0;

		int TDnopl =0;
		int TDnosl =0;
		int TDnocl =0;

		ResultSet trn =null;
		ResultSet bal =null;
		String EmpSql ="";
		String dtrsql ="";

		ReportDAO.inithead(repBean);
		repBean.setLnCount(0);
		repBean.setPageNo(1);
		repBean.setLineLen(80);
		repBean.setPageLen(65);

		ReportDAO.make_prn_file(filepath,repBean);

		ReportDAO.OpenCon("", "", "",repBean);
		Cn = repBean.getCn();


		fdate=Fdt;
		tdate=TDT;

		SLINE=stringOfSize(80,'-');
		repBean.setHdg1("Leave Ledger Printing for the period :-> "+ fdate.substring(3, 11) + " To " + tdate.substring(3, 11));
		repBean.setHdg2(SLINE);
		repBean.setHdg3("Appl.Date | Leave | From Date  |  To Date   |     CL    |     PL    |     SL");
		repBean.setHdg4("          | code  |            |            | DR  | CR  | DR  | CR  | DR  |  CR");

		//SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
		SimpleDateFormat outputFormat = new SimpleDateFormat("dd-MMM-yyyy");
		SimpleDateFormat inputFormat = new SimpleDateFormat("MM/dd/yyyy");

		EmpSql = "select emp.*, t.acno, t.branch, t.grade from empmast emp, emptran t where t.empno = emp.empno and EMP.EMPNO >= "+feno1+" AND EMP.EMPNO <= "+teno1+" AND " 
				+" t.effdate = ( SELECT MAX(E2.EFFDATE) FROM EMPTRAN E2 WHERE e2.empno = emp.empno and E2.EFFDATE <= '"+fdate+"')" 
				+" and emp.status = 'A' order by emp.empno ";
		// System.out.println(EmpSql);
		Statement st;
		try
		{
			st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);

			//System.out.println(EmpSql);
			emp = st.executeQuery(EmpSql);
			if(!emp.next())
			{
				System.out.println("Employee Record Set Is Empty ");
				return;
			}
			ReportDAO.println("", 0, 1, false, "BANK",repBean);
			ReportDAO.page_head(repBean.getBrnNo(),repBean.getHdg1(), repBean.getHdg2(), repBean.getHdg3(), repBean.getHdg4(), "", "", "",repBean);
			emp.beforeFirst();
			while(emp.next())
			{

				clbal = ReportDAO.get_leave_bal(emp.getInt("EMPNO"),3,fdate,tdate, "O",repBean);	//CL
				slbal = ReportDAO.get_leave_bal(emp.getInt("EMPNO"),2,fdate,tdate, "O",repBean);	//SL
				plbal = ReportDAO.get_leave_bal(emp.getInt("EMPNO"), 1,fdate,tdate, "O",repBean);	//PL

				Str1 = "Emp.Code: "+FixStr(emp.getString("empno"), 16, 1)+"  Name  : "+FixStr((FixStr(emp.getString("lname")+ "  " +emp.getString("fname")+"  "+(emp.getString("mname")), 42, 1)), 50, 1);
				ReportDAO.println(Str1, 0, 1, false, "BANK",repBean);
				Str1 = " Desig.: "+GradeHandler.GetGrade(emp.getInt("grade"), "N",repBean)+" Branch: "; //+GetBranch(emp!BRANCH) remaining
				ReportDAO.println(Str1, 0, 1, false, "BANK",repBean);
				Str1 = "                               Opening Bal->|       "+FixStr(""+clbal, 3, 3)+" |       "+FixStr(""+plbal, 3, 3)+" |       "+FixStr(""+slbal, 3, 3);
				ReportDAO.println(Str1, 0, 1, false, "BANK",repBean);
				ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
				Str1 = "SELECT * FROM LEAVETRAN WHERE EMPNO ="+emp.getInt("EMPNO")+" and LEAVETRAN.STATUS <> 98 AND frmdt >= '"+Fdt+"' and todt <= '"+TDT+"'";
				//System.out.println(Str1);
				Statement st1=Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
				trn = st1.executeQuery(Str1);

				if(!trn.next())
				{
					ReportDAO.println("NO ANY TRANSACTIONS FOUND FOR "+emp.getInt("EMPNO"),0 ,1,false,"BANK",repBean);

				}
				trn.beforeFirst();
				while(trn.next())
				{
					Str1 = FixStr(trn.getString("appldt"), 10,3)+"| "+FixStr(trn.getString("leavecd"),5, 3)+" | "+FixStr(trn.getString("frmdt"), 10,3)+" | "+FixStr(trn.getString("todt"), 10,3) + " | ";
					nocl=0;
					nopl=0;
					nosl=0;

					if (trn.getInt("leavecd")==3)	//CL
					{
						//nocl = dateDiff("D",trn.getDate("frmdt"), trn.getDate("todt"));
						nocl = trn.getInt("DAYS");

						if(trn.getString("trntype").trim().equalsIgnoreCase("C"))
						{
							TCnocl = TCnocl + nocl;
						}else{
							TDnocl = TDnocl + nocl;
						}
					}
					else if(trn.getInt("leavecd")==1)	//PL
					{
						//nopl =  dateDiff("D",trn.getDate("frmdt"), trn.getDate("todt"));
						nopl = trn.getInt("DAYS");
						if(trn.getString("trntype").trim().equalsIgnoreCase("C"))
						{
							TCnopl = TCnopl + nopl;
						}else{
							TDnopl = TDnopl + nopl;
						}
					}
					else if(trn.getInt("leavecd")==2)	//SL
					{

						//nosl =  dateDiff("D",trn.getDate("frmdt"), trn.getDate("todt"));
						nosl = trn.getInt("DAYS");

						if(trn.getString("trntype").trim().equalsIgnoreCase("C"))
						{
							TCnosl = TCnosl + nosl;
						}else{
							TDnosl = TDnosl + nosl;
						}
					}



					if(trn.getString("trntype").trim().equalsIgnoreCase("D"))
					{
						Str1 = Str1 + FixStr(""+nocl, 3, 3)+" | "+ReportDAO.addSpaces("",3)+" | "+FixStr(""+nopl, 3, 3)+" | "+ReportDAO.addSpaces("", 3)+" | "+FixStr(""+nosl, 3, 3)+" | "+ReportDAO.addSpaces("", 3)+" | ";
					}
					else
					{
						Str1 = Str1 + ReportDAO.addSpaces("",3)+ " | "+FixStr(""+nocl, 3, 3)+" | "+ReportDAO.addSpaces("", 3)+" | "+FixStr(""+nopl, 3, 3)+" | "+ReportDAO.addSpaces("", 3)+" | "+FixStr(""+nosl, 3, 3)+" | ";
					}

					ReportDAO.println(Str1, 0, 1, false, "BANK", repBean);

				}
				clbal = clbal + TCnocl-TDnocl;
				slbal = slbal + TCnosl - TDnosl;
				plbal = plbal + TCnopl - TDnopl;
				ReportDAO.println(SLINE, 0, 1,false,"BANK",repBean);
				ReportDAO.println("Closing Bal->|       "+FixStr(""+clbal, 3, 3)+" |      "+FixStr(""+plbal, 3, 3)+"  |       "+FixStr(""+slbal, 3, 3), 31, 1,false,"BANK",repBean);
				// println "Closing Bal->|      " & FixStr(Str(clbal), 3, 3) & " |      " & FixStr(Str(plbal), 3, 3) & "  |       " & FixStr(Str(slbal), 3, 3), 32, Fp, 1

				ReportDAO.println(SLINE,0, 1, false,"BANK",repBean);
				clbal = 0;
				plbal = 0;
				slbal = 0;
				TCnocl = 0;
				TCnopl = 0;
				TCnosl = 0;
				TDnocl = 0;
				TDnopl = 0;
				TDnosl = 0;


			}


			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
			return;
		}catch(Exception e)
		{
			e.printStackTrace();
		}



	}
	public static void Leave_Ledger_ReportPDF(String list,String Fdt,String TDT,String filepath,String imgpath)
	{

		RepoartBean repBean  = new RepoartBean();
		Connection con =null;
		String EmpSql="";
		Statement st;
		ResultSet rsemp;
		ResultSet trn;
		float clbal=0;
		float plbal=0;

		float slbal=0;
		int mlbal =0;
		int nopl =0;
		int nosl =0;
		int nocl =0;


		int TCnopl =0;
		int TCnosl =0;
		int TCnocl =0;

		int TDnopl =0;
		int TDnosl =0;
		int TDnocl =0;
		try
		{
			ReportDAO.OpenCon("", "", "",repBean);
			con = repBean.getCn();	

			SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");//yyyy-MM-dd'T'HH:mm:ss
			SimpleDateFormat output = new SimpleDateFormat("dd/MM/yyyy");


			LookupHandler lh = new LookupHandler();
			Document doc = new Document();
			PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
			doc.open();
			doc.setPageSize(PageSize.A4);

			Font FONT = new Font(Font.HELVETICA, 32, Font.NORMAL, new GrayColor(0.75f));
			ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);

			Image image1 = Image.getInstance(imgpath);

			Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);

			image1.scaleAbsolute(80f, 80f);
			image1.setAbsolutePosition(40f, 730f);

			doc.add(image1);
			doc.add(para);
			//PdfPCell cell = new PdfPCell();

			PdfPTable emptab1 = new PdfPTable(4);
			PdfPTable empleavetab = new PdfPTable(8);
			PdfPTable optab = new PdfPTable(2);
			PdfPTable clostab = new PdfPTable(1);
			PdfPTable headtab = new PdfPTable(7);
			PdfPTable notrantab = new PdfPTable(1);

			PdfPCell c1;

			para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase("Leave Ledger Report From "+Fdt +" To "+TDT,new Font(Font.TIMES_ROMAN,10)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);

			EmpSql = "select emp.*, t.acno, t.prj_code, t.desig from empmast emp, emptran t where t.empno = emp.empno and EMP.EMPNO IN ("+list+")  AND " 
					+" t.effdate = ( SELECT MAX(E2.EFFDATE) FROM EMPTRAN E2 WHERE e2.empno = emp.empno and E2.EFFDATE <= '"+Fdt+"')" 
					+" and emp.status = 'A' order by emp.empno ";
			// System.out.println(EmpSql);

			st = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);


			rsemp = st.executeQuery(EmpSql);
			Rectangle rec = new  Rectangle(100,100);
			PdfPTable maintab = new PdfPTable(1);
			//	PdfPTable Leavetab = new PdfPTable(1);

			maintab.setSpacingBefore(10);
			//	Leavetab.setSpacingBefore(10);


			emptab1.setWidthPercentage(new float[]{20,10,15,55}, rec);
			emptab1.setHorizontalAlignment(Element.ALIGN_LEFT);

			empleavetab.setWidthPercentage(new float[]{10,20,20,10,10,10,10,10}, rec);
			empleavetab.setHorizontalAlignment(Element.ALIGN_LEFT);

			while(rsemp.next())
			{
				maintab = new PdfPTable(1);
				boolean flag=false;

				clbal = ReportDAO.get_leave_bal(rsemp.getInt("EMPNO"),3,Fdt,TDT, "O",repBean);// 3 for cl
				slbal = ReportDAO.get_leave_bal(rsemp.getInt("EMPNO"),2,Fdt, TDT,"O",repBean); //2 for sl
				plbal = ReportDAO.get_leave_bal(rsemp.getInt("EMPNO"), 1,Fdt,TDT, "O",repBean);// 1 for pl

				maintab = new PdfPTable(1);
				maintab.setSpacingBefore(10);
				//Leavetab = new PdfPTable(1);

				emptab1 = new PdfPTable(4);
				emptab1.setWidthPercentage(new float[]{20,10,15,55}, rec);
				emptab1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
				headtab = new PdfPTable(8);
				headtab.setWidthPercentage(new float[]{10,20,20,10,10,10,10,10}, rec);


				c1 = new PdfPCell(new Phrase("Employee Number",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));  
				emptab1.addCell(c1);
				c1 = new PdfPCell(new Phrase(""+rsemp.getString("EMPNO"),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
				emptab1.addCell(c1);
				c1 = new PdfPCell(new Phrase("Employee Name",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
				emptab1.addCell(c1);
				c1 = new PdfPCell(new Phrase(""+rsemp.getString("FNAME")+" "+rsemp.getString("LNAME"),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
				emptab1.addCell(c1);
				c1 = new PdfPCell(new Phrase("Project Code ",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));  
				emptab1.addCell(c1);
				c1 = new PdfPCell(new Phrase(""+rsemp.getString("prj_code"),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
				emptab1.addCell(c1);
				c1 = new PdfPCell(new Phrase("Designation",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
				emptab1.addCell(c1);
				c1 = new PdfPCell(new Phrase(""+lh.getLKP_Desc("DESIG", rsemp.getInt("desig")),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
				emptab1.addCell(c1);
				maintab.addCell(emptab1);
				// doc.add(maintab);

				c1 = new PdfPCell(new Phrase("App.Date",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));  
				c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
				headtab.addCell(c1);
				c1 = new PdfPCell(new Phrase("From Date",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
				c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
				headtab.addCell(c1);
				c1 = new PdfPCell(new Phrase("TO Date",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
				c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
				headtab.addCell(c1);
				c1 = new PdfPCell(new Phrase("Purpose",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
				c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
				headtab.addCell(c1);
				c1 = new PdfPCell(new Phrase("Tran Type",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
				c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
				headtab.addCell(c1);
				c1 = new PdfPCell(new Phrase("Days",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
				c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
				headtab.addCell(c1);
				c1 = new PdfPCell(new Phrase("Total CR ",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
				c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
				headtab.addCell(c1);
				c1 = new PdfPCell(new Phrase("Total DB ",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
				c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
				headtab.addCell(c1);





				String Str1 = "SELECT T.*,B.totcr,B.totdr FROM LEAVETRAN T, LEAVEBAL B WHERE T.empno=B.empno  AND T.leavecd = B.leavecd AND T.EMPNO ="+rsemp.getInt("EMPNO")+"  AND T.STATUS='SANCTION' AND T.frmdt >= '"+Fdt+"' and T.todt <= '"+TDT+"' AND B.baldt =(SELECT MAX(B1.BALDT) FROM LEAVEBAL B1 WHERE B1.BALDT <= T.TODT AND B1.LEAVECD = T.LEAVECD) order by T.LEAVECD";
				Statement st1=con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);

				trn = st1.executeQuery(Str1);

				if(!trn.next())
				{
					//	ReportDAO.println("NO ANY TRANSACTIONS FOUND FOR "+rsemp.getInt("EMPNO"),0 ,1,false,"BANK",repBean);
					notrantab = new PdfPTable(1);
					c1 = new PdfPCell(new Phrase("NO ANY TRANSACTIONS FOUND FOR EMPLOYEE NUMBER "+rsemp.getString("EMPNO"),new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
					notrantab.addCell(c1);
					maintab.addCell(notrantab);

				}
				else
				{
					maintab.addCell(headtab);
				}
				trn.beforeFirst();
				int leavecd=0;
				boolean clflag=false;
				boolean plflag=false;
				boolean slflag=false;
				int i=2;
				int chkcd=0;

				while(trn.next())
				{
					empleavetab = new PdfPTable(8);
					empleavetab.setWidthPercentage(new float[]{10,20,20,10,10,10,10,10}, rec);
					nocl=0;
					nopl=0;
					nosl=0;
					leavecd=trn.getInt("leavecd");

					if(i==2)
					{
						if(leavecd==3)//cl
							clflag=true;
						if(leavecd==2)//sl
							slflag=true;
						if(leavecd==1)//pl
							plflag=true;

						chkcd=leavecd;
					}
					i++;
					if(chkcd!=leavecd)
					{
						clostab= new PdfPTable(1);

						if(chkcd==3)
						{

							clbal = clbal + TCnocl-TDnocl;
							c1 = new PdfPCell(new Phrase("CL Closing Balance => "+clbal,new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));

							clbal=0;
						}
						if(chkcd==2)
						{
							slbal = slbal + TCnosl - TDnosl;
							c1 = new PdfPCell(new Phrase("SL Closing Balance => "+slbal,new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
							slbal=0;
						}
						if(chkcd==1)
						{

							plbal = plbal + TCnopl - TDnopl;
							c1 = new PdfPCell(new Phrase("PL Closing Balance => "+plbal,new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));

							plbal=0;

						}
						TCnocl=0;
						TDnopl=0;
						c1.setHorizontalAlignment(Chunk.ALIGN_RIGHT);
						c1.setPaddingRight(40);
						c1.setBorder(0);
						clostab.addCell(c1);
						maintab.addCell(clostab);
						chkcd=leavecd;
					}


					if(leavecd==3 && clflag==true) 
					{
						optab=new PdfPTable(2);
						c1 = new PdfPCell(new Phrase("Casual Leave",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
						c1.setHorizontalAlignment(Chunk.ALIGN_LEFT);
						c1.setBorder(0);
						optab.addCell(c1);

						c1 = new PdfPCell(new Phrase("CL Opening Balance => "+clbal,new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
						c1.setHorizontalAlignment(Chunk.ALIGN_RIGHT);
						c1.setPaddingRight(40);
						c1.setBorder(0);
						optab.addCell(c1);
						clflag=false;
						plflag=true;
						slflag=true;
						maintab.addCell(optab);
					}
					else if(leavecd==2 && slflag==true)
					{
						optab=new PdfPTable(2);
						c1 = new PdfPCell(new Phrase("Sick Leave",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
						c1.setHorizontalAlignment(Chunk.ALIGN_LEFT);
						c1.setBorder(0);
						optab.addCell(c1);

						c1 = new PdfPCell(new Phrase("SL Opening Balance => "+slbal,new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
						c1.setHorizontalAlignment(Chunk.ALIGN_RIGHT);
						c1.setPaddingRight(40);
						c1.setBorder(0);
						optab.addCell(c1);
						plflag=true;
						clflag=true;
						slflag=false;

						maintab.addCell(optab);
					}
					else if(leavecd==1 && plflag==true)
					{
						//System.out.println("plflag is "+plflag);
						optab=new PdfPTable(2);
						c1 = new PdfPCell(new Phrase("Paid Leave",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
						c1.setHorizontalAlignment(Chunk.ALIGN_LEFT);
						c1.setBorder(0);
						optab.addCell(c1);

						c1 = new PdfPCell(new Phrase("PL Opening Balance = "+plbal,new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
						c1.setHorizontalAlignment(Chunk.ALIGN_RIGHT);
						c1.setPaddingRight(40);
						c1.setBorder(0);
						optab.addCell(c1);
						slflag=true;
						plflag=false;
						clflag=true;
						maintab.addCell(optab);
					}





					if (trn.getInt("leavecd")==3 )	//CL
					{
						nocl = trn.getInt("DAYS");// dateDiff("D",trn.getDate("frmdt"), trn.getDate("todt"));
						if(trn.getString("trntype").trim().equalsIgnoreCase("C"))
						{
							TCnocl = TCnocl + nocl;
						}else{
							TDnocl = TDnocl + nocl;
						}

					}
					else if(trn.getInt("leavecd")==1)	//PL
					{
						nopl =trn.getInt("DAYS");//  dateDiff("D",trn.getDate("frmdt"), trn.getDate("todt"));
						if(trn.getString("trntype").trim().equalsIgnoreCase("C"))
						{
							TCnopl = TCnopl + nopl;
						}else{
							TDnopl = TDnopl + nopl;
						}


					}
					else if(trn.getInt("leavecd")==2)	//SL
					{

						nosl = trn.getInt("DAYS");// dateDiff("D",trn.getDate("frmdt"), trn.getDate("todt"));
						if(trn.getString("trntype").trim().equalsIgnoreCase("C"))
						{
							TCnosl = TCnosl + nosl;
						}else{
							TDnosl = TDnosl + nosl;
						}
					}



					c1 = new PdfPCell(new Phrase(""+output.format(sdf.parse(trn.getString("appldt")))  ,new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));  
					c1.setBorderWidthLeft(0);
					c1.setBorderWidthBottom(0);
					c1.setBorderWidthTop(0);

					// c1.setBorderWidthRight(1);
					c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
					empleavetab.addCell(c1);
					c1 = new PdfPCell(new Phrase(""+output.format(sdf.parse(trn.getString("frmdt"))),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
					c1.setBorderWidthLeft(0);
					c1.setBorderWidthBottom(0);
					c1.setBorderWidthTop(0);
					c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
					// c1.setBorderWidthRight(1);
					empleavetab.addCell(c1);


					c1 = new PdfPCell(new Phrase(""+output.format(sdf.parse(trn.getString("todt"))),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
					c1.setBorderWidthLeft(0);
					c1.setBorderWidthBottom(0);
					c1.setBorderWidthTop(0);
					// c1.setBorderWidthRight(1);
					c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
					empleavetab.addCell(c1);


					c1 = new PdfPCell(new Phrase(""+trn.getString("LEAVEPURP")==null?"":trn.getString("LEAVEPURP"),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
					c1.setBorderWidthLeft(0);
					c1.setBorderWidthBottom(0);
					c1.setBorderWidthTop(0);
					// c1.setBorderWidthRight(1);

					empleavetab.addCell(c1);


					c1 = new PdfPCell(new Phrase(""+trn.getString("trntype"),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
					c1.setBorderWidthLeft(0);
					c1.setBorderWidthBottom(0);
					c1.setBorderWidthTop(0);
					// c1.setBorderWidthRight(1);

					empleavetab.addCell(c1);
					c1 = new PdfPCell(new Phrase(""+trn.getString("Days"),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
					c1.setBorderWidthLeft(0);
					c1.setBorderWidthBottom(0);
					c1.setBorderWidthTop(0);
					// c1.setBorderWidthRight(1);
					empleavetab.addCell(c1);
					PdfPCell c2 = new PdfPCell(new Phrase("0",new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
					c1.setBorderWidthBottom(0);
					c1.setBorderWidthTop(0);
					// c2.setBorderWidthRight(1);

					if(leavecd==3)
					{
						c1 = new PdfPCell(new Phrase(""+trn.getString("totcr"),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
						c1.setBorderWidthLeft(0);
						c1.setBorderWidthBottom(0);
						c1.setBorderWidthTop(0);

						empleavetab.addCell(c1);

						c1 = new PdfPCell(new Phrase(""+trn.getString("totdr"),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
						c1.setBorderWidthLeft(0);
						c1.setBorderWidthBottom(0);
						c1.setBorderWidthTop(0);
						c1.setBorderWidthRight(0);
						empleavetab.addCell(c1);


					}
					else if(leavecd==2)
					{
						c1 = new PdfPCell(new Phrase(""+trn.getString("totcr"),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
						c1.setBorderWidthLeft(0);
						c1.setBorderWidthBottom(0);
						c1.setBorderWidthTop(0);
						empleavetab.addCell(c1);

						c1 = new PdfPCell(new Phrase(""+trn.getString("totdr"),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
						c1.setBorderWidthLeft(0);
						c1.setBorderWidthBottom(0);
						c1.setBorderWidthTop(0);
						c1.setBorderWidthRight(0);
						empleavetab.addCell(c1);
					}
					else if(leavecd==1)
					{
						c1 = new PdfPCell(new Phrase(""+trn.getString("totcr"),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
						c1.setBorderWidthLeft(0);
						c1.setBorderWidthBottom(0);
						c1.setBorderWidthTop(0);

						empleavetab.addCell(c1);

						c1 = new PdfPCell(new Phrase(""+trn.getString("totdr"),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
						c1.setBorderWidthLeft(0);
						c1.setBorderWidthBottom(0);
						c1.setBorderWidthTop(0);
						c1.setBorderWidthRight(0);
						empleavetab.addCell(c1);
					}
					maintab.addCell(empleavetab);


					flag=true;
				}

				if(flag==true)
				{

					clostab= new PdfPTable(1);
					if(leavecd==3)
					{
						clbal = clbal + TCnocl-TDnocl;
						c1 = new PdfPCell(new Phrase("CL Closing Balance => "+clbal,new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));

					}
					if(leavecd==2)
					{
						slbal = slbal + TCnosl - TDnosl;
						c1 = new PdfPCell(new Phrase("SL Closing Balance => "+slbal,new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));

					}
					if(leavecd==1)
					{

						plbal = plbal + TCnopl - TDnopl;
						c1 = new PdfPCell(new Phrase("PL Closing Balance => "+plbal,new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));


					}
					c1.setHorizontalAlignment(Chunk.ALIGN_RIGHT);
					c1.setPaddingRight(40);
					c1.setBorder(0);
					clostab.addCell(c1);
					maintab.addCell(clostab);

				}



				//	ReportDAO.println(SLINE, 0, 1,false,"BANK",repBean);
				//ReportDAO.println("Closing Bal->|       "+FixStr(""+clbal, 3, 3)+" |      "+FixStr(""+plbal, 3, 3)+"  |       "+FixStr(""+slbal, 3, 3), 31, 1,false,"BANK",repBean);
				// println "Closing Bal->|      " & FixStr(Str(clbal), 3, 3) & " |      " & FixStr(Str(plbal), 3, 3) & "  |       " & FixStr(Str(slbal), 3, 3), 32, Fp, 1

				//ReportDAO.println(SLINE,0, 1, false,"BANK",repBean);
				clbal = 0;
				plbal = 0;
				slbal = 0;
				TCnocl = 0;
				TCnopl = 0;
				TCnosl = 0;
				TDnocl = 0;
				TDnopl = 0;
				TDnosl = 0;

				doc.add(maintab);

			}


			con.close();
			doc.close();

		}catch(Exception e){e.printStackTrace();}

	}
	public static void EMPLIST_with_edu(String rdt,String EMPBRN,String filepath)
	{
		RepoartBean repBean  = new RepoartBean();
		FileWriter Fp;
		Connection Cn = null;	

		String SLINE="";
		String dtrsql="";
		ResultSet DTR=null;
		ResultSet emp=null;
		String EmpSql="";
		int Pempno=0;
		int tot_no_emp=0;
		int br_tot_no_emp=0;
		int alltot=0;
		int PBRCD=0;
		String pBrcd1;
		int gross=0;
		ReportDAO.inithead(repBean);
		repBean.setLnCount(0);
		repBean.setPageNo(1);
		repBean.setLineLen(80);
		repBean.setPageLen(65);
		repBean.setBrnNo(999);
		ReportDAO.make_prn_file(filepath,repBean);

		ReportDAO.OpenCon("", "", "",repBean);
		Cn = repBean.getCn();


		SimpleDateFormat outputFormat = new SimpleDateFormat("dd/MM/yyyy");
		SimpleDateFormat inputFormat = new SimpleDateFormat("MM/dd/yyyy");

		if(EMPBRN=="B")
		{
			EmpSql="select emp.empno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name,EMP.DOB,EMP.DOJ,t.branch,s.brname,t.grade,t.acno,g.al";	

			EmpSql = "select emp.empno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name ,EMP.DOB,EMP.DOJ, t.branch ,s.brname ,t.grade,t.acno,g.alfacd,q.*,l.lkp_disc,pl.lkp_disc pldisc,S.OPENDATE,t.effdate,t1.lkp_disc discs ,ISNULL(emp.sbond,'N') sbond1,ISNULL(emp.depamt,0) depamt1" 
					+ " from empmast emp, emptran t , branch s , grade g , qual q ,lookup l ,lookup pl,lookup t1" 
					+" Where t1.lkp_code = 'DESIG' and t1.lkp_srno = t.desig and pl.lkp_code = 'CATE' and pl.lkp_srno = emp.categorycd and emp.empno = q.empno(+) and ( l.lkp_code = 'ED' and l.lkp_srno = ISNULL(q.degree,0) ) and EMP.EMPNO = T.EMPNO AND g.postcd = t.grade and t.effdate = ( SELECT MAX(E2.EFFDATE)  FROM EMPTRAN E2 " 
					+" WHERE e2.empno = emp.empno and e2.EFFDATE <= '"+rdt+"' ) " 
					+ " and emp.status = 'A' and s.brcd = t.branch " 
					+ " order by t.branch,emp.empno ";
			repBean.setHdg1("Branch Wise List For :-"+rdt.substring(3, 11));
		}
		SLINE=stringOfSize(80, '-');
		Statement st;
		try
		{
			st=Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY );

			emp=st.executeQuery(EmpSql);

			if(!emp.next())
			{
				System.out.println("No Any Reord Found");
				//ReportDAO.Fp.close();
				return;
			}
			alltot=0;

			repBean.setHdg2("Empno   Name Of Employee                     Grade            CATEGORY ");
			repBean.setHdg3("      Appo.Date To the Branch      Designation     Security Bond /Deposit  ");
			ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),repBean.getHdg2(), repBean.getHdg3(),"","","","",repBean);
			emp.beforeFirst();
			if(EMPBRN=="B")
			{
				while(emp.next())
				{

					ReportDAO.println("               Degree                        Institution ", 0, 0, false, "BANK",repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
					ReportDAO.println("", 0, 1, false, "BANK",repBean);
					ReportDAO.println("Branch :-", 0, 0, false, "BANK",repBean);
					ReportDAO.println(emp.getString("BRNAME"),14, 0, false,"BANK",repBean);
					ReportDAO.println(outputFormat.format(inputFormat.parse(emp.getString("opendate"))), 40,1, false, "BANK",repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
					PBRCD=emp.getInt("BRANCH");
					Pempno=emp.getInt("BRANCH");
					while(PBRCD==emp.getInt("BRANCH"))
					{

						ReportDAO.println(emp.getString("EMPNO"), 0, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("Name"),35, 1), 12,0, false, "BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("ALFACD"), 10,1), 49, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("pldisc"), 20,1), 61, 1, false, "BANK",repBean);
						ReportDAO.println(FixStr(outputFormat.format(inputFormat.parse(emp.getString("effdate"))), 10, 1), 12, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("sbond1")=="Y"?"YES":"NO", 3, 1), 47,0,false, "BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("depamt1"), 8, 1), 54, 1, false, "BANK",repBean);
						ReportDAO.println(SLINE, 0,1, false, "BANK",repBean);
						tot_no_emp =tot_no_emp+1;
						br_tot_no_emp=br_tot_no_emp+1;
						gross=emp.getInt("empno");
						Pempno =emp.getInt("empno");
						while(PBRCD==emp.getInt("BRANCH") && emp.getInt("empno")==Pempno )
						{
							ReportDAO.println(FixStr((emp.getString("lkp_disc")==null?"":emp.getString("lkp_disc")), 30, 1)+"|", 7, 0, false, "BANK",repBean);
							ReportDAO.println((emp.getString("inst")==null?"":emp.getString("inst")), 39,1, false, "BANK",repBean);
							if (!emp.next()) {
								break;
							}


						}
						ReportDAO.println("", 0,1, false, "BANK",repBean);
						ReportDAO.println(SLINE, 0,1, false, "BANK",repBean);
					}
					ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
					ReportDAO.println("No Of Emp :", 0, 0, false, "BANK",repBean);
					ReportDAO.println(String.valueOf(br_tot_no_emp), 42, 0, false, "BANK",repBean);

					ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
					alltot=alltot+gross;
					if (!emp.next()) {
						break;
					}
					gross=0;
					/*//If frmrpt.pgbrk.Value = vbChecked Then
				            LnCount = 66
				            PageNo = 0
				            println "", 0, Fp, 1
				        End If*/


				}
			}
			else
			{
				while(emp.next())
				{
					ReportDAO.println("", 0, 1, false,"BANK",repBean);
					ReportDAO.println("Grade  :- ", 0, 0, false,"BANK",repBean);
					ReportDAO.println(emp.getString("discs"), 14, 1, false, "BANK",repBean);
					ReportDAO.println("---------------------------------------", 0, 1,false,"BANK",repBean);
					pBrcd1=emp.getString("ALFACD");
					br_tot_no_emp=0;
					while(pBrcd1==emp.getString("ALFACD"))
					{
						ReportDAO.println(trans(emp.getInt("empno"), "99999", "", false, false), 0, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("Name"), 35, 1), 7, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("ALFACD"), 10, 1), 45, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(outputFormat.format(inputFormat.parse(emp.getString("dob"))), 10, 1), 57, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(outputFormat.format(inputFormat.parse(emp.getString("doj"))), 10, 1), 70, 0, false, "BANK",repBean);
						br_tot_no_emp=br_tot_no_emp+1;
						if (!emp.next()) {
							break;
						}


					}
					ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
					ReportDAO.println("No Of Emp :", 0, 0, false, "BANK",repBean);
					ReportDAO.println(String.valueOf(br_tot_no_emp), 42, 0, false, "BANK",repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
					alltot=alltot+gross;
					if (!emp.next()) {
						break;
					}
					tot_no_emp=tot_no_emp+ br_tot_no_emp;
					gross=0;
					/*If frmrpt.pgbrk.Value = vbChecked Then
            			LnCount = 66
            			PageNo = 0
            			println "", 0, Fp, 1
        				End If*/

				}

			}
			ReportDAO.println("AUTHORISED SIGNATORY", 55, 2, false, "BANK",repBean);
			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
			return;
		}catch(Exception e)
		{
			e.printStackTrace();
			//System.out.println("Exception in EMPLIST_EDU "+e);
		}



	}

	public static void caste_cate_EMPLIST(String rdt,String EMPBRN,String filepath)
	{
		RepoartBean repBean  = new RepoartBean();
		FileWriter Fp;
		Connection Cn = null;

		String SLINE="";
		String dtrsql ="";
		ResultSet DTR = null;
		ResultSet emp = null;
		String EmpSql="";
		int tot_no_emp=0;
		int br_tot_no_emp=0;
		int alltot=0;
		int PBRCD =0;
		String pBrcd1="";
		int gross=0;
		ReportDAO.inithead(repBean);
		repBean.setLnCount(0);
		repBean.setPageNo(1);
		repBean.setLineLen(80);
		repBean.setPageLen(65);
		repBean.setBrnNo(999);
		ReportDAO.make_prn_file(filepath,repBean);

		ReportDAO.OpenCon("", "", "",repBean);
		Cn = repBean.getCn();
		if(EMPBRN =="C")
		{
			EmpSql="select S.BRCDCH,emp.empno,rtrim(emp.lname) +' '+rtrim(emp.fname) +' '+rtrim(emp.mname) name ,EMP.DOB,EMP.DOJ, t.branch ,s.brname ,t.grade,t.acno,g.alfacd,l.lkp_disc,ISNULL(emp.categorycd,0) categorycd,l1.lkp_disc DISC1,ISNULL(emp.caStcd,0) caStcd" 
					+" from empmast emp, emptran t , branch s , grade g ,lookup l ,lookup l1 "
					+" Where  l1.lkp_code = 'CASTE' and l1.lkp_srno = ISNULL(emp.castcd,0) and l.lkp_code = 'CATE' and l.lkp_srno = ISNULL(emp.categorycd,0) and EMP.EMPNO = T.EMPNO AND g.postcd = t.grade and t.effdate = ( SELECT MAX(E2.EFFDATE)  FROM EMPTRAN E2 " 
					+" WHERE e2.empno = emp.empno and e2.EFFDATE <= '"+rdt+"' ) "
					+" and emp.status = 'A' and s.brcd = t.branch "
					+" order by emp.categorycd,emp.empno";
			//System.out.println(EmpSql);
			repBean.setHdg1("Category Wise Employee List upto  :-"+rdt.substring(3, 11));
			repBean.setHdg2("Empno Name Of Employee                         Grade    Branch     Cast      ");
		}
		else
		{
			EmpSql = " select s.brcdch,emp.empno,rtrim(emp.lname) +' '+rtrim(emp.fname) +' '+rtrim(emp.mname) name ,EMP.DOB,EMP.DOJ, t.branch ,s.brname ,t.grade,t.acno,g.alfacd,l.lkp_disc,ISNULL(emp.castcd,0) caste,l1.lkp_disc disc1,ISNULL(emp.categorycd,0) categorycd" 
					+ " from empmast emp, emptran t , branch s , grade g ,lookup l,lookup l1  " 
					+ " Where  l1.lkp_code = 'CATE' and l1.lkp_srno = ISNULL(emp.categorycd,0) and l.lkp_code = 'CASTE' and l.lkp_srno = ISNULL(emp.castcd,0) and  EMP.EMPNO = T.EMPNO AND g.postcd = t.grade and t.effdate = ( SELECT MAX(E2.EFFDATE)  FROM EMPTRAN E2 " 
					+" WHERE e2.empno = emp.empno and e2.EFFDATE <= '"+rdt+"' ) " 
					+" and emp.status = 'A' and s.brcd = t.branch " 
					+ " order by emp.castcd,emp.empno";
			//System.out.println(EmpSql);
			repBean.setHdg1("Cast Wise Employee List upto  :-"+rdt.substring(3, 11));
			repBean.setHdg2("Empno   Name Of Employee                       Grade    Branch     Cast      ");
		}
		SLINE=stringOfSize(80,'-');
		Statement st;
		try
		{
			st=Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY );
			//System.out.println(EmpSql);
			emp=st.executeQuery(EmpSql);

			if(!emp.next())
			{
				System.out.println("No Any Reord Found");
				return;
			}
			alltot=0;
			tot_no_emp=0;
			ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),repBean.getHdg2(), repBean.getHdg3(), "","", "", "",repBean);
			emp.beforeFirst();
			if(EMPBRN=="D")
			{

				while(emp.next())
				{
					ReportDAO.println("",0, 1, false, "BANK",repBean);
					ReportDAO.println("Caste :- ",0, 0, false, "BANK",repBean);
					ReportDAO.println(FixStr(emp.getString("caste"), 4, 1), 14, 0, false, "BANK",repBean);
					ReportDAO.println(FixStr(emp.getString("lkp_disc"), 20, 1), 20, 1, false,"BANK",repBean);
					ReportDAO.println("----------------------------------------", 0, 1, false, "BANK",repBean);
					PBRCD=emp.getInt("caste");
					br_tot_no_emp=0;
					while(PBRCD==emp.getInt("caste"))
					{

						ReportDAO.println(emp.getString("empno"), 0, 0,false, "BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("Name"),35, 1), 7, 0, false,"BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("ALFACD"), 10,1), 45, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("BRCDCH"), 4, 1), 57, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("disc1"), 20, 1),62, 1, false, "BANK",repBean);
						br_tot_no_emp=br_tot_no_emp+1;
						tot_no_emp=tot_no_emp+1;
						if(!emp.next())
						{
							break;
						}


						if(PBRCD != emp.getInt("caste")){
							emp.previous();
							break;
						}


					}
					ReportDAO.println(SLINE,0, 1, false, "BANK",repBean);
					ReportDAO.println("No Of Emp :", 0, 0, false,"BANK",repBean);
					ReportDAO.println(""+br_tot_no_emp,42, 0, false, "BANK",repBean);
					ReportDAO.println(SLINE,0, 1, false, "BANK",repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
					alltot = alltot+gross;

					gross=0;
					/* If frmrpt.pgbrk.Value = vbChecked Then
					            LnCount = 66
					            PageNo = 0
					            println "", 0, Fp, 1
					        End If */

				}
			}
			else
			{
				while(emp.next())
				{
					ReportDAO.println("",0, 1, false,"BANK",repBean);
					ReportDAO.println("Category :- ", 0, 0, false, "BANK",repBean);
					ReportDAO.println(FixStr(emp.getString("categorycd"), 4, 1), 14, 0, false, "BANK",repBean);
					ReportDAO.println(FixStr(emp.getString("lkp_disc"),20, 1), 20, 1, false, "BANK",repBean);
					ReportDAO.println("----------------------------------------",0, 1, false,"BANK",repBean);
					PBRCD=emp.getInt("categorycd");
					br_tot_no_emp=0;
					while(PBRCD==emp.getInt("categorycd"))
					{
						ReportDAO.println(emp.getString("empno"), 0, 0, false,"BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("Name"), 35, 1), 7, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("ALFACD"),10,1),45, 0,false, "BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("BRCDCH"), 4, 1), 57, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("disc1"), 20, 1), 62, 1, false, "BANK",repBean);
						br_tot_no_emp=br_tot_no_emp + 1;
						tot_no_emp=tot_no_emp + 1;

						if(!emp.next())
						{
							break;
						}
						if(PBRCD != emp.getInt("categorycd")){
							emp.previous();
							break;
						}

					}
					ReportDAO.println(SLINE,0, 1, false, "BANK",repBean);
					ReportDAO.println("No Of Emp :", 0, 0, false,"BANK",repBean);
					ReportDAO.println(""+br_tot_no_emp,42, 0, false, "BANK",repBean);
					ReportDAO.println(SLINE,0, 1, false, "BANK",repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
					alltot = alltot + gross;

					gross=0;

					/*If frmrpt.pgbrk.Value = vbChecked Then
				            LnCount = 66
				            PageNo = 0
				            println "", 0, Fp, 1
				        End If*/
				}
			}
			ReportDAO.println(SLINE, 0, 1, false,"BANK",repBean);
			ReportDAO.println("TOTAL NO OF EMPLOYEES = "+tot_no_emp, 10, 1, false,"BANK",repBean);
			ReportDAO.println(SLINE, 0, 1, false,"BANK",repBean);
			repBean.setLnCount(66);
			ReportDAO.println("Summary Of Caste/Category Report", 0 ,2,false, "BANK",repBean);
			if(EMPBRN=="C")
			{
				EmpSql="select l.lkp_disc  CATEGORY,count(*) no_of_employee "
						+" from empmast ,lookup l where l.lkp_code = 'CATE' and l.lkp_srno = ISNULL(empmast.categorycd,0)"
						+"  and empmast.status = 'A' group by categorycd,l.lkp_disc ";

			}
			else
			{
				EmpSql = " select l.lkp_disc  CASTCD ,count(*) no_of_employee " 
						+" from empmast ,lookup l where l.lkp_code = 'CASTE' and l.lkp_srno = ISNULL(empmast.caStcd,0)" 
						+"  and empmast.status = 'A' group by castcd,l.lkp_disc ";
			}
			tot_no_emp=0;
			Statement st2=Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY );
			//System.out.println(EmpSql);
			emp = null;
			emp=st2.executeQuery(EmpSql);

			int cn = 1;
			if(emp.next())
			{

				ReportDAO.println("---------------------------------------", 0,1,false, "BANK",repBean);
				ReportDAO.println(" Category /Caste              No.of.Emp  ", 0,1,false, "BANK",repBean);

				ReportDAO.println("---------------------------------------", 0,1,false, "BANK",repBean);
				emp.beforeFirst();

				while(emp.next())
				{

					tot_no_emp=tot_no_emp+emp.getInt(2);
					ReportDAO.println(FixStr(emp.getString(1),20, 1), 1, 0,false, "BANK",repBean);
					ReportDAO.println(""+emp.getInt(2), 23, 1, false, "BANK",repBean);
					cn++;
				}

				ReportDAO.println("---------------------------------------", 0, 1, false,"BANK",repBean);
				ReportDAO.println(""+tot_no_emp, 23,1,false,"BANK",repBean);
				ReportDAO.println("---------------------------------------", 0, 4, false,"BANK",repBean);


			}
			ReportDAO.println("AUTHORISED SIGNATORY", 55, 2, false, "BANK",repBean);
			//System.out.println(cn);
			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
			return;
		}catch(Exception e)
		{
			e.printStackTrace();
		}
	}

	public static void  OtherLIST(String rdt,int ptrancd,String ptrandisc,String EMPBRN,String filepath )
	{
		RepoartBean repBean  = new RepoartBean();
		FileWriter Fp;
		Connection Cn = null;

		String SLINE = "";
		String dtrsql = "";
		ResultSet DTR = null;
		ResultSet emp = null;
		String EmpSql = "";
		int tot_no_emp = 0;
		int br_tot_no_emp = 0;
		int alltot = 0;
		int PBRCD = 0;
		int gross = 0;
		int brtot[][] = new int[401][2];

		ReportDAO.inithead(repBean);
		repBean.setLnCount(0);
		repBean.setPageNo(1);
		repBean.setLineLen(80);
		repBean.setPageLen(65);
		repBean.setBrnNo(999);
		ReportDAO.make_prn_file(filepath,repBean);

		ReportDAO.OpenCon("", "", "",repBean);
		Cn = repBean.getCn();


		if(EMPBRN == "B")
		{
			EmpSql = " select b.trncd,emp.empno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name , t.branch ,s.brname ,b.net_amt,t.grade,t.acno,g.alfacd"
					+" from empmast emp, emptran t ,PAYTRAN b  , branch s , grade g "
					+" Where t.empno = Emp.empno And g.postcd = t.grade and t.effdate = ( SELECT MAX(E2.EFFDATE)  FROM EMPTRAN E2 "
					+" WHERE e2.empno = emp.empno and e2.EFFDATE <= '"+rdt+"' ) "
					+" and emp.status = 'A' and b.empno = emp.empno and b.trncd = "+ptrancd+" and s.brcd = t.branch "
					+" order by t.branch,emp.empno ";

			repBean.setHdg1("Branch Wise "+ptrandisc+" List For The Month Of :-"+rdt.substring(3,11));
		}
		else
		{
			EmpSql = " select b.trncd,emp.empno,rtrim(emp.lname) +' '+rtrim(emp.fname) +' '+rtrim(emp.mname) name , t.branch ,s.brname ,b.net_amt,t.grade,t.acno,g.alfacd"
					+" from empmast emp, emptran t ,PAYTRAN b  , branch s , grade g "
					+" Where t.empno = Emp.empno And g.postcd = t.grade and t.effdate = ( SELECT MAX(E2.EFFDATE)  FROM EMPTRAN E2 "
					+" WHERE e2.empno = emp.empno and e2.EFFDATE <= '"+rdt+"' ) "
					+" and emp.status = 'A' and b.empno = emp.empno and b.trncd = "+ptrancd+" and s.brcd = t.branch "
					+" order by emp.empno ";
			repBean.setHdg1("Employee Wise "+ptrandisc+" List For The Month Of :-"+rdt.substring(3,11));
		}
		SLINE=stringOfSize(80,'-');
		Statement st;
		try
		{
			st = repBean.getCn().createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
			//System.out.println(EmpSql);
			emp = st.executeQuery(EmpSql);
			if(!emp.next())
			{
				Fp = repBean.getFp();
				Fp.close();
				return;
			}
			alltot = 0;
			for(int i=0;i<= 400 ;i++)
			{
				brtot[i][0] = 0;
				brtot[i][1] = 0;

			}
			if(ptrancd == 999 )
			{
				repBean.setHdg3("Empno Name Of Employee                        Desig        Amount     SB-A/C No");

			}
			else
			{
				repBean.setHdg3("Empno Name Of Employee                         Desig        Amount     ");
			}
			ReportDAO.page_head(repBean.getBrnNo(),repBean.getHdg1(),repBean.getHdg2(),repBean.getHdg3(), "","", "", "",repBean);
			if(EMPBRN == "B")
			{
				emp.beforeFirst();
				while(emp.next())
				{
					ReportDAO.println("", 0, 1, false,"BANK",repBean);
					ReportDAO.println("Branch :- ", 0, 1, false,"BANK",repBean);
					ReportDAO.println(emp.getString("BRNAME"), 14,1, false, "BANK",repBean);
					ReportDAO.println("------------------------------", 0, 1, false,"BANK",repBean);
					PBRCD = emp.getInt("BRANCH");
					br_tot_no_emp = 0;

					while(PBRCD == emp.getInt("BRANCH"))
					{
						ReportDAO.println(emp.getString("empno"), 0, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("Name"),35, 1), 7, 0, false, "BANK",repBean);
						ReportDAO.println(FixStr(emp.getString("ALFACD"),10, 1), 45, 0, false, "BANK",repBean);
						//System.out.println("alfacd....."+emp.getString("ALFACD"));
						if(emp.getInt("trncd") == 999)
						{
							ReportDAO.println(emp.getString("NET_AMT"), 58, 0, false, "BANK",repBean);

						}
						else
						{
							ReportDAO.println(emp.getString("NET_AMT"), 58, 1, false, "BANK",repBean);
						}
						gross = gross + emp.getInt("NET_AMT");
						if(emp.getInt("trncd") == 202)
						{
							brtot[emp.getInt("NET_AMT")][0] = brtot[emp.getInt("NET_AMT")][0]+1;
							brtot[emp.getInt("NET_AMT")][1] = brtot[emp.getInt("NET_AMT")][1]+emp.getInt("NET_AMT");
						}
						if(emp.getInt("trncd") == 999)
						{
							ReportDAO.println(emp.getString("acno"), 71, 1, false, "BANK",repBean);

						}
						br_tot_no_emp = br_tot_no_emp + 1;
						if(!emp.next()){
							break;
						}

						if(PBRCD != emp.getInt("BRANCH")){
							emp.previous();
							break;
						}
					}
					ReportDAO.println(SLINE, 0,1, false, "BANK",repBean);
					ReportDAO.println("No Of Emp & Branch Total", 0, 0,false, "BANK",repBean);
					ReportDAO.println(""+br_tot_no_emp, 48, 0, false,"BANK",repBean);
					ReportDAO.println(""+gross, 55, 1, false,"BANK",repBean);
					ReportDAO.println(SLINE, 0,1, false, "BANK",repBean);
					alltot = alltot + gross;
					tot_no_emp = tot_no_emp + br_tot_no_emp;
					gross = 0;
					/*  If frmrpt.pgbrk.Value = vbChecked Then
				            LnCount = 66
				            PageNo = 0
				            println "", 0, Fp, 1
				        End If  */

				}
			}
			else
			{
				emp.beforeFirst();
				while(emp.next())
				{
					ReportDAO.println(emp.getString("empno"), 0, 0, false, "BANK",repBean);
					ReportDAO.println(FixStr(emp.getString("Name"), 35, 1), 7, 0 ,false, "BANK",repBean);
					ReportDAO.println(FixStr(emp.getString("ALFACD"), 10, 1), 45, 0 ,false, "BANK",repBean);
					if(emp.getInt("trncd") == 999)
					{
						ReportDAO.println(emp.getString("NET_AMT"), 58, 0, false, "BANK",repBean);

					}
					else
					{
						ReportDAO.println(emp.getString("NET_AMT"), 58, 1, false, "BANK",repBean);
					}
					gross = gross + emp.getInt("NET_AMT");
					if(emp.getInt("trncd") == 202)
					{
						brtot[emp.getInt("NET_AMT")][0] = brtot[emp.getInt("NET_AMT")][0]+1;
						brtot[emp.getInt("NET_AMT")][1] = brtot[emp.getInt("NET_AMT")][1]+emp.getInt("NET_AMT");
					}
					if(emp.getInt("trncd") == 999)
					{
						ReportDAO.println(emp.getString("acno"), 71, 1, false, "BANK",repBean);

					}
					ReportDAO.println(SLINE, 0,1, false, "BANK",repBean);
					ReportDAO.println("No Of Emp & Branch Total", 0, 0,false, "BANK",repBean);
					ReportDAO.println(""+br_tot_no_emp, 55, 1, false,"BANK",repBean);
					ReportDAO.println(""+gross, 55, 1, false,"BANK",repBean);
					ReportDAO.println(SLINE, 0,1, false, "BANK",repBean);
					alltot = alltot + gross;
					tot_no_emp = tot_no_emp + br_tot_no_emp;
					gross = 0;

				}
			}
			ReportDAO.println(SLINE, 0,1, false, "BANK",repBean);
			ReportDAO.println("Total No. Of Emp. & All Branch Total", 0,0, false, "BANK",repBean);
			ReportDAO.println(""+tot_no_emp, 48,0, false, "BANK",repBean);
			ReportDAO.println(""+alltot, 55,1, false, "BANK",repBean);
			ReportDAO.println(SLINE, 0,4, false, "BANK",repBean);
			gross = 0;
			if(ptrancd == 202)
			{

				ReportDAO.println(" ---------------------------------------------------", 10,1, false, "BANK",repBean);
				ReportDAO.println(" Slab Amount     No.Of. Employee       Tot Amount   ", 10,1, false, "BANK",repBean);
				ReportDAO.println(" ---------------------------------------------------", 10,1, false, "BANK",repBean);
				dtrsql = "select count(*) From EMPMAST  where empno in ( select empno from PAYTRAN where trncd = 101 "
						+" minus     select empno from PAYTRAN where trncd = 202  ) ";
				Statement st1 = repBean.getCn().createStatement();
				DTR = st1.executeQuery(dtrsql) ;
				if(DTR.next())
				{
					brtot[0][0] = DTR.getInt(1);
				}
				for(int i = 0 ;i< 400;i++)
				{
					if(brtot[i][0] != 0)
					{
						ReportDAO.println(FixStr(""+i,7, 3), 10, 0, false,"BANK",repBean);
						ReportDAO.println(FixStr(""+brtot[i][0],12, 3), 22, 0, false,"BANK",repBean);
						ReportDAO.println(""+brtot[i][1], 40, 0, false,"BANK",repBean);
						gross = gross +1; 
					}
				}
				ReportDAO.println(" ---------------------------------------------------", 10, 1,false,"BANK",repBean);
				ReportDAO.println(FixStr(""+gross,12,3),40,1, false, "BANK",repBean);

			}
			ReportDAO.println("AUTHORISED SIGNATORY", 55, 4, false, "BANK",repBean);
			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
			return;

		}catch(Exception e)
		{
			e.printStackTrace();
		}

	}

	public static ArrayList<PFExcelBean> PFExcel(String rdt)/*Hemant....*/
	{	
		//System.out.println("calling pfexcel method");
		PFExcelBean pfbean;
		ArrayList<PFExcelBean> pflist = new ArrayList<PFExcelBean>();
		RepoartBean repBean  = new RepoartBean();
		String SLINE = "";
		int arrcal = 0;
		Connection Cn = null;
		//FileWriter Fp;
		ResultSet DTR = null;
		ResultSet emp = null;
		String EmpSql = "";
		int PBRCD = 0;
		int gross = 0;
		int brtot[] = new int[8];
		int ALLbrtot[] = new int[8];
		int pfchk = 0;
		//ReportDAO.inithead(repBean);
		//repBean.setLnCount(0);
		//repBean.setPageNo(1);
		//repBean.setLineLen(132);
		//repBean.setPageLen(65);
		//repBean.setFoot_Fl(true);
		//ReportDAO.make_prn_file(filepath,repBean);
		//repBean.setBrnNo(999);
		//ReportDAO.println(String.valueOf((char)15), 1, 1, false, "BANK",repBean);
		ReportDAO.OpenCon("", "", "",repBean);
		EmpSql = "select e.salute,e.empno,e.fname,e.mname,e.lname,e.pfno,p.prj_name,p.prj_srno, (select net_amt from paytran where trncd=101 and empno=e.empno and trndt<='"+rdt+"') basic," +
				"(select net_amt from paytran where trncd=201 and empno=e.empno and trndt<='"+rdt+"') as pf," +
				"(select net_amt from paytran where trncd=102 and empno=e.empno and trndt<='"+rdt+"') da," +
				"(select net_amt from paytran where trncd=199 and empno=e.empno and upddt<='"+rdt+"') ctc," +
				"(select arr_amt from paytran where trncd=201 and empno=e.empno and upddt<='"+rdt+"') arr_amt " +
				"from empmast e, prj p,emptran t where e.status = 'A' and t.empno= e.empno and t.prj_srno=p.prj_srno order by p.prj_srno,e.empno";



		/*EmpSql = " select emp.empno,emp.pfno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name " +
	        ", t.branch,s.brname,t.grade,g.alfacd ,b.cal_amt , b.arr_amt , t1.net_amt basic,t2.net_amt+t3.net_amt+t4.net_amt  totda,t5.net_amt pf" +
	        " from empmast emp, emptran t ,PAYTRAN b  , branch s ,grade g,PAYTRAN t1,PAYTRAN t2,PAYTRAN t3,PAYTRAN t4 ,PAYTRAN t5 " +
	        "  Where t.empno = Emp.empno And g.postcd = t.grade And t1.empno = Emp.empno And t1.trncd = 101 " +
	        " and t2.empno = emp.empno and t2.trncd = 102 " +
	        " and t5.empno = emp.empno and t5.trncd = 201 " +
	        " and t3.empno = emp.empno and t3.trncd = 113 " +
	        " and t4.empno = emp.empno and t4.trncd = 114 " +
	        " and t.effdate = ( SELECT MAX(E2.EFFDATE) FROM EMPTRAN E2 " +
	        " WHERE e2.empno = emp.empno and  E2.EFFDATE <= '"+rdt+"' ) " +
	        " and emp.status = 'A' and b.empno = emp.empno and b.trncd = 201 and s.brcd = t.branch AND EMP.DA_SCHEME = 2 " +
	        " Union " +
	        " select emp.empno,emp.pfno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name" +
	        ", t.branch,s.brname,t.grade,g.alfacd ,b.cal_amt,b.arr_amt, t1.net_amt basic,t2.net_amt  totda ,t3.net_amt pf" +
	        " from empmast emp, emptran t ,PAYTRAN b  , branch s ,grade g,PAYTRAN t1,PAYTRAN t2 , PAYTRAN t3 " +
	        " Where t.empno = Emp.empno And g.postcd = t.grade And t1.empno = Emp.empno And t1.trncd = 101 " +
	        "  and t2.empno = emp.empno and t2.trncd = 102" +
	        "  and t3.empno = emp.empno and t3.trncd = 201" +
	        " and t.effdate = ( SELECT MAX(E2.EFFDATE)" +
	        " FROM EMPTRAN E2 " +
	        " wHERE e2.empno = emp.empno and " +
	        " E2.EFFDATE <= '"+rdt+"'  ) " +
	        " and emp.status = 'A' and b.empno = emp.empno and b.trncd = 201 and s.brcd = t.branch AND EMP.DA_SCHEME <> 2" +
	        " order by branch,empno";*/

		//System.out.println(EmpSql);
		SLINE = stringOfSize(132, '-');
		Statement st;
		try {
			Cn = repBean.getCn();
			st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
			emp = st.executeQuery(EmpSql);

			if(!emp.next()){
				System.out.println("No Any Record Found");

			}

			int i;
			for(i = 1; i <= 7; i++){
				ALLbrtot[i] = 0;
			}
			emp.beforeFirst();
			while(emp.next())
			{

				for(i = 1; i <= 7; i++){
					brtot[i] = 0;
				}


				String brname="";
				PBRCD = emp.getInt("PRJ_SRNO");
				while(PBRCD == emp.getInt("PRJ_SRNO"))
				{
					pfbean = new PFExcelBean();
					pfbean.setBRANCH(emp.getString("PRJ_NAME"));

					pfbean.setEMPNo(emp.getString("EMPNO"));
					pfbean.setPFNO(emp.getString("PFNO")==null?"0":emp.getString("PFNO"));
					String salute=new LookupHandler().getLKP_Desc("SALUTE",Integer.parseInt(emp.getString("SALUTE")) );
					if(emp.getString("MNAME").equals(null) || emp.getString("MNAME").equals(""))
					{
						pfbean.setEMPNAME(salute+emp.getString("FNAME")+" "+emp.getString("MNAME")+" "+emp.getString("LNAME"));
					}
					else
					{
						pfbean.setEMPNAME(salute+emp.getString("FNAME")+" "+emp.getString("MNAME").charAt(0)+". "+emp.getString("LNAME"));

					}

					pfbean.setBASIC(emp.getString("BASIC")==null?"0":emp.getString("BASIC"));
					brtot[1] = brtot[1] + Math.round(emp.getInt("BASIC"));
					pfbean.setDA(emp.getString("DA"));
					brtot[2] = brtot[2] + Math.round(emp.getInt("DA"));
					gross = (emp.getString("BASIC")!= null?0:emp.getInt("BASIC")) + (emp.getString("DA")!= null?0:emp.getInt("DA"));
					if(gross >= 6500){
						gross = 6500;
					}
					brtot[3]  = brtot[3] + gross;
					pfbean.setGROSS(String.valueOf(gross));
					pfbean.setPF(emp.getString("PF")==null?"0":emp.getString("PF"));

					brtot[4] =  brtot[4] + emp.getInt("PF");
					pfchk = (int) (Math.round(gross*0.0367) + Math.round(gross*0.0833));
					if(pfchk < emp.getInt("PF")){
						pfchk = emp.getInt("PF") - pfchk;
					}else if(emp.getInt("PF") < pfchk){
						pfchk = emp.getInt("PF") - pfchk;
					}else
						pfchk = 0;
					pfbean.setGROSS8(String.valueOf((int)Math.round(gross * 0.0833) + pfchk));

					brtot[5]  =  (brtot[5] + (int)(Math.round(gross * 0.0833)) + pfchk);
					pfbean.setGROSS3(String.valueOf((int)Math.round(gross * 0.0367)));
					brtot[6]  =  brtot[6] + (int)(Math.round(gross * 0.0367));
					if(!(emp.getString("ARR_AMT")==null)){
						if(emp.getInt("ARR_AMT") != 0){

							brtot[4]  =  brtot[4] + emp.getInt("ARR_AMT");
							arrcal = (int) Math.round(emp.getInt("ARR_AMT") * 8.33 / 12);
							brtot[5] = brtot[5] + arrcal;
							arrcal = emp.getInt("ARR_AMT") - arrcal;

							brtot[6] = brtot[6] + arrcal;

						}
					}

					pflist.add(pfbean);   
					if(!emp.next()){
						pfbean = new PFExcelBean();
						pfbean.setBRANCHTOTAL("PROJECT TOTAL");
						pfbean.setBRANCH("other");
						brname = "other";
						pfbean.setBASICTOTAL(String.valueOf(brtot[1]));
						pfbean.setDATOTAL(String.valueOf(brtot[2]));
						pfbean.setGROSSTOTAL(String.valueOf(brtot[3]));
						pfbean.setPFTOTAL(String.valueOf(brtot[4]));
						pfbean.setGR8TOTAL(String.valueOf(brtot[5]));
						pfbean.setGR3TOTAL(String.valueOf(brtot[6]));
						pflist.add(pfbean);
						break;
					}

					brname = emp.getString("PRJ_NAME");	

					if(PBRCD != emp.getInt("PRJ_SRNO")){
						emp.previous();
						break;
					}

				}
				if(!brname.equalsIgnoreCase("other")){
					pfbean = new PFExcelBean();
					pfbean.setBRANCHTOTAL("PROJECT TOTAL");
					pfbean.setBRANCH(brname);
					pfbean.setBASICTOTAL(String.valueOf(brtot[1]));
					pfbean.setDATOTAL(String.valueOf(brtot[2]));
					pfbean.setGROSSTOTAL(String.valueOf(brtot[3]));
					pfbean.setPFTOTAL(String.valueOf(brtot[4]));
					pfbean.setGR8TOTAL(String.valueOf(brtot[5]));
					pfbean.setGR3TOTAL(String.valueOf(brtot[6]));
					pflist.add(pfbean);
				}

				ALLbrtot[1] = ALLbrtot[1] + brtot[1];
				ALLbrtot[2] = ALLbrtot[2] + brtot[2];
				ALLbrtot[3] = ALLbrtot[3] + brtot[3];
				ALLbrtot[4] = ALLbrtot[4] + brtot[4];
				ALLbrtot[5] = ALLbrtot[5] + brtot[5];
				ALLbrtot[6] = ALLbrtot[6] + brtot[6];


			}

			Cn.close();

		} catch (Exception e) {

			//System.out.println("ERROR is "+e);
			e.printStackTrace();
		} 
		return pflist;


	}


	public static void getChallanTaxStatment(String filePath, String date,String imagepath,String type,String state) throws IOException, SQLException, DocumentException 
	{


		OutputStream file = new FileOutputStream(new File(filePath));
		Document document = new Document();
		String table_name="";
		if(type.equalsIgnoreCase("before")) {
			table_name="PAYTRAN";
		} else {
			table_name="PAYTRAN_STAGE";
		}

		try {

			/*if(states.equalsIgnoreCase("MH")){*/
				PdfWriter.getInstance(document, file);
				document.open();
				Image image1 = Image.getInstance(imagepath);
				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f); 
				document.add(image1);
				Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				document.add(para);

				para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Tel : +91-20 26812190 Email :",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Challan statement",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(new Phrase("For The Month Of "+date.substring(3,11)+""+(type.equalsIgnoreCase("before")?" (Before Finalize)":" ") ,new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				//para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);

				/*PdfPTable table=new PdfPTable(5);
			table.setSpacingBefore(10.0f);
			table.setWidthPercentage(new float[]{6,12,40,19,19},new Rectangle(100,100));
			PdfPCell cell1=new PdfPCell(new Phrase("Sr NO",new Font(Font.TIMES_ROMAN,10)));
        cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
        table.addCell(cell1);
        PdfPCell cell2=new PdfPCell(new Phrase("Employee Code",new Font(Font.TIMES_ROMAN,10)));
        cell2.setHorizontalAlignment(Element.ALIGN_LEFT);
        table.addCell(cell2);
        PdfPCell cell3=new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,10)));
        cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
        table.addCell(cell3);
        PdfPCell cell4=new PdfPCell(new Phrase("Gross salary(Rs)",new Font(Font.TIMES_ROMAN,10)));
        cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
        table.addCell(cell4);
        PdfPCell cell5=new PdfPCell(new Phrase("Tax Amount",new Font(Font.TIMES_ROMAN,10)));
        cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
        table.addCell(cell5);
        table.setHeaderRows(1);*/
				/*select e.salute ,e.empno,e.fname,e.mname,e.lname,(select net_amt from ytdtran where trncd=999 
        		and empno=e.empno and trndt  between '2011-04-01' and '2011-04-30') as basic, 
        						 (select net_amt from ytdtran where trncd=202 and empno=e.empno and trndt  
        						 between '2011-04-01' and '2011-04-30') as pf 
        						 from empmast e,emptran t where e.status = 'A' and t.empno= e.empno  order by e.empno*/


				Connection con=null;
				con=ConnectionManager.getConnection();
				Statement stmt=con.createStatement();
				ResultSet rspt = null;

				/*String sql1/*="select distinct e.salute,e.empno,e.fname,e.mname,e.lname," +
        		" (select distinct net_amt from  "+table_name+" where trncd=199 and empno=e.empno and trndt " +
        		" between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"') basic," +
        		" (select distinct net_amt from "+table_name+" where trncd=202 and empno=e.empno " +
        		" and trndt  between '"+ReportDAO.BOM(date )+"' and '"+ReportDAO.EOM(date)+"') pt " +
        			" from empmast e,emptran t where e.status='A' and t.empno = e.empno  order by e.empno";*/


				String sql1= "select distinct e.dol,e.salute,e.empno,e.fname,e.mname,e.lname," +
						"  y1.cal_amt as CTC," +
						"  y2.cal_amt as pt " +
						"  from  EMPMAST e  left join EMPTRAN eran on e.EMPNO=eran.EMPNO" +
						" left join Project_Sites sitemast" +
						" on sitemast.Site_ID=eran.PRJ_SRNO" +
						"  join "+table_name+" y1 on e.EMPNO = y1.EMPNO " +
						"  join "+table_name+" y2 on (e.EMPNO = y2.EMPNO and y1.TRNCD = 199 " +
						"  and y1.TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"' and y2.TRNCD = 202 " +
						"  and y2.TRNDT  between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"'" +
						" and e.doj <='"+ReportDAO.EOM(date)+"'" +
						"  and e.EMPNO in(select distinct EMPNO from "+table_name+"  where TRNCD=202 and TRNDT  between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"')" +
						"  and y1.CAL_AMT>0 and y2.CAL_AMT>0) and sitemast.Site_State ='"+state+"' " +
						"  and eran.EFFDATE=(select max(effdate) from emptran where empno=e.empno and EFFDATE<='"+ReportDAO.EOM(date)+"' )  order by e.EMPNO";          
				 

				rspt = stmt.executeQuery(sql1);
				int srno=0;
				double totatlpf=0;
				LookupHandler lkp=new LookupHandler();
				int i = 0;
				while(rspt.next())
				{
					if(rspt.getInt("pt")>0){
						i++;
					}
					srno++;
					/* PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,10)));
        cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
        table.addCell(cell1data);

        PdfPCell cell1data2=new PdfPCell(new Phrase(""+rspt.getInt("EMPNO"),new Font(Font.TIMES_ROMAN,10)));
        cell1data2.setHorizontalAlignment(Element.ALIGN_CENTER);
        table.addCell(cell1data2);

        int cd=rspt.getInt("salute");

        String empname=lkp.getLKP_Desc("SALUTE",cd)+""+rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");

        PdfPCell cell1data3=new PdfPCell(new Phrase(""+empname,new Font(Font.TIMES_ROMAN,10)));
        cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
        table.addCell(cell1data3);

        PdfPCell cell1data4=new PdfPCell(new Phrase(""+rspt.getInt("CTC"),new Font(Font.TIMES_ROMAN,10)));

        cell1data4.setHorizontalAlignment(Element.ALIGN_RIGHT);
        table.addCell(cell1data4);

        totatlpf=totatlpf + rspt.getInt("pt");

        PdfPCell cell1data5=new PdfPCell(new Phrase(""+rspt.getInt("pt"),new Font(Font.TIMES_ROMAN,10)));
        cell1data5.setHorizontalAlignment(Element.ALIGN_RIGHT);
        table.addCell(cell1data5);


        PdfPCell totemp = new PdfPCell(new Phrase("Total Employee:",new Font(Font.TIMES_ROMAN,10)));
        totemp.setHorizontalAlignment(Element.ALIGN_RIGHT);
        totemp.setColspan(2);
        table.addCell(totemp);
        PdfPCell totempdisp = new PdfPCell(new Phrase(""+i,new Font(Font.TIMES_ROMAN,10)));
        totemp.setHorizontalAlignment(Element.ALIGN_LEFT);
        table.addCell(totempdisp);
        PdfPCell total=new PdfPCell(new Phrase("Total Profession Tax:",new Font(Font.TIMES_ROMAN,10)));
        total.setHorizontalAlignment(Element.ALIGN_RIGHT);
        //total.setColspan(2);
        table.addCell(total);
        PdfPCell totaldata=new PdfPCell(new Phrase(""+totatlpf,new Font(Font.TIMES_ROMAN,10)));
        totaldata.setHorizontalAlignment(Element.ALIGN_RIGHT);
        table.addCell(totaldata);
        document.add(table);*/
					//////////////////////////////////
				}

				para = new Paragraph(new Phrase("Return-cum-Chalan B.S.T.R.C. No., if any,The Maharashtra State Tax on Professions,",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(10.0f);
				para.setSpacingAfter(0); 
				document.add(para);
				para = new Paragraph(new Phrase("Trades, Callings And Employments, Act, 1975 AND Rule 11,11-A, 11-B, 11-C",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0); 
				document.add(para);
				para = new Paragraph(new Phrase("0028, Other Taxes on Income and ExpenditureTaxes on Professions, Trades ",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);

				para = new Paragraph(new Phrase("Callings and Employments-Taxes on Employments",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER); 
				para.setSpacingAfter(0); 
				document.add(para);
				para = new Paragraph(new Phrase("Trades ,Callings and Employments-Taxes on Employments",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0); 
				document.add(para);

				PdfPTable table1=new PdfPTable(4);
				table1.setSpacingBefore(10.0f);
				table1.setWidthPercentage(new float[]{40,20,20,20},new Rectangle(100, 100));

				PdfPCell cellhead1=new PdfPCell(new Phrase("Employees whose monthly,Salaries, Wages",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(cellhead1);
				PdfPCell cellhead2=new PdfPCell(new Phrase("Rate of Tax per Month",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(cellhead2);
				PdfPCell cellhead3=new PdfPCell(new Phrase("No. of Employees",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(cellhead3);
				PdfPCell cellhead4=new PdfPCell(new Phrase("Amount Of Tax Deducted",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(cellhead4);
				String sqlquery ="select DISTINCT(p.cal_amt) as pt, sum(p.cal_amt) as tot_amt, COUNT(p.empno) as tot_emp" +
						" from "+table_name+" p left join EMPTRAN eran on p.EMPNO=eran.EMPNO" +
						" left join Project_Sites sitemast" +
						"  on sitemast.Site_ID=eran.PRJ_SRNO where p.trncd =  202 and " +
						" p.trndt  between '"+ReportDAO.BOM(date)+"'" +
						" and '"+ReportDAO.EOM(date)+"'  and sitemast.Site_State='"+state+"'" +
						"  and eran.EFFDATE=(select max(effdate) from emptran where empno=p.empno and EFFDATE<='"+ReportDAO.EOM(date)+"') " +
						" GROUP BY cal_amt order by PT";

				//System.out.println("pt query is "+sqlquery);
				Statement stmnt2=con.createStatement();
				ResultSet reslt=null;
				reslt=stmnt2.executeQuery(sqlquery);
				//first row
				int tax_amt = 0;

				while(reslt.next())
				{

					if(reslt.getInt("pt")==0)
					{
						PdfPCell cellhdata1=new PdfPCell(new Phrase("Do not exceed Rs.",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata1);
						PdfPCell cellhdata2=new PdfPCell(new Phrase("NIL",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata2);
						PdfPCell cellhdata3=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata3);
						PdfPCell cellhdata4=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata4);
					}else if(reslt.getInt("pt")==30)
					{
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata01=new PdfPCell(new Phrase(" Exceed Rs. 2,000 but do not exceed Rs. 2,500",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata01);
						PdfPCell cellhdata02=new PdfPCell(new Phrase("Rs. 30 ",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata02);
						PdfPCell cellhdata03=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata03);
						PdfPCell cellhdata04=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata04);
					}else if(reslt.getInt("pt")==60)
					{
						//System.out.println("now in pt 60");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011=new PdfPCell(new Phrase("Exceed Rs. 2,500 but do not exceed Rs. 3,500",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012=new PdfPCell(new Phrase("Rs. 60 ",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata014);
					}else if(reslt.getInt("pt")==120)
					{
						//System.out.println("now in pt 120");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011=new PdfPCell(new Phrase(" Exceed Rs. 3,500 but do not exceed Rs. 5,000",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012=new PdfPCell(new Phrase(" Rs. 120 ",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata014);
					}else if(reslt.getInt("pt") == 175.00)
					{
						//System.out.println("now in pt 175");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						System.out.println("totamt in 175"+reslt.getInt("tot_amt"));
						PdfPCell cellhdata021=new PdfPCell(new Phrase(" Exceed Rs. 5,000 but do not exceed Rs. 10,000",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata021);
						PdfPCell cellhdata022=new PdfPCell(new Phrase("Rs. 175",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata022);
						PdfPCell cellhdata023=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata023);
						PdfPCell cellhdata024=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata024);

					}else if(reslt.getInt("pt")==200.00 || reslt.getInt("pt")==300.00)
					{
						//System.out.println("now in pt 200");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						//System.out.println(""+tax_amt);
						//	System.out.println("totamt in 200"+reslt.getInt("tot_amt")+reslt.getInt("tot_emp"));
						PdfPCell cellhdata031=new PdfPCell(new Phrase("Exceeds Rs. 10,000",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata031);
						PdfPCell cellhdata032=new PdfPCell(new Phrase(" Rs.2,500 per annum \n to be paid in the Follwing manner: \n a)Rs.200 per month exceptin the month of february \n b)Rs.300 per month of february",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata032);
						PdfPCell cellhdata033=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata033);
						PdfPCell cellhdata034=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata034);

					} 
				}

				PdfPCell celtotalhead=new PdfPCell(new Phrase("Tax Amount",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(celtotalhead);
				PdfPCell celtotal=new PdfPCell(new Phrase("Rs."+tax_amt,new Font(Font.TIMES_ROMAN,10)));
				celtotal.setColspan(3);
				table1.addCell(celtotal);

				PdfPCell celtotalhead1=new PdfPCell(new Phrase("Interest Amount",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(celtotalhead1);
				PdfPCell celtotal1=new PdfPCell(new Phrase("Rs.",new Font(Font.TIMES_ROMAN,10)));
				celtotal1.setColspan(3);
				table1.addCell(celtotal1);
				PdfPCell celtotalhead2=new PdfPCell(new Phrase("Year/Quarter/Month ",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(celtotalhead2);
				PdfPCell celtotal2=new PdfPCell(new Phrase("Rs.",new Font(Font.TIMES_ROMAN,10)));
				celtotal2.setColspan(3);
				table1.addCell(celtotal2);

				PdfPCell celtotalhead3=new PdfPCell(new Phrase("Net Amount Payable",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(celtotalhead3);
				PdfPCell celtotal3=new PdfPCell(new Phrase("Rs."+tax_amt,new Font(Font.TIMES_ROMAN,10)));
				celtotal3.setColspan(3);
				table1.addCell(celtotal3);

				PdfPCell celtotalhead4=new PdfPCell(new Phrase("Profession Tax Registration Certificate No.",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(celtotalhead4);
				PdfPCell celtotal4=new PdfPCell(new Phrase("Period From ",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(celtotal4);
				PdfPCell celtotal5=new PdfPCell(new Phrase("Period To",new Font(Font.TIMES_ROMAN,10)));
				celtotal5.setColspan(2);
				table1.addCell(celtotal5);


				PdfPCell celtotalhead6=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(celtotalhead6);
				PdfPCell celtotal7=new PdfPCell(new Phrase(""+ReportDAO.BOM(date),new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(celtotal7);
				PdfPCell celtotal8=new PdfPCell(new Phrase(""+ReportDAO.EOM(date),new Font(Font.TIMES_ROMAN,10)));
				celtotal8.setColspan(2);
				table1.addCell(celtotal8);
				PdfPCell namecell=new PdfPCell(new Phrase("Name and Address: THE BUSINESS CO.OP BANK LTD.,411013  ",new Font(Font.TIMES_ROMAN,10)));
				namecell.setColspan(4);
				table1.addCell(namecell);

				PdfPCell newcell=new PdfPCell(new Phrase(" The above statements are true to the best of my knowledge and belief.",new Font(Font.TIMES_ROMAN,10)));
				newcell.setColspan(4);
				table1.addCell(newcell);


				PdfPTable tab=new PdfPTable(2);
				PdfPCell t1=new PdfPCell(new Phrase("Date:",new Font(Font.TIMES_ROMAN,10)));
				tab.addCell(t1);

				PdfPCell t2=new PdfPCell(new Phrase(" "));
				tab.addCell(t2);

				PdfPCell t3=new PdfPCell(new Phrase("Place:  ",new Font(Font.TIMES_ROMAN,10)));
				tab.addCell(t3);

				PdfPCell t4=new PdfPCell(new Phrase(" "));
				tab.addCell(t4);
				PdfPCell t5=new PdfPCell(new Phrase("Signature:& Designation",new Font(Font.TIMES_ROMAN,10)));
				tab.addCell(t5);

				PdfPCell t6=new PdfPCell(new Phrase(" "));
				tab.addCell(t6);
				PdfPCell t7=new PdfPCell(new Phrase("1. Form III was substituted by G.N. No. TFT-1100/CR-57/Taxation-3 dated 11-10-2000, w.e.f. 1.4.2000. ",new Font(Font.TIMES_ROMAN,10)));
				t7.setColspan(2);
				tab.addCell(t7);
				PdfPCell t8=new PdfPCell(new Phrase("For the Treasury Use Only",new Font(Font.TIMES_ROMAN,10)));
				t8.setColspan(2);
				t8.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab.addCell(t8);



				/*PdfPCell newcell1=new PdfPCell(new Phrase("Date:                         Place:                                  Signature:& Designation                                                                                   1. Form III was substituted by G.N. No. TFT-1100/CR-57/Taxation-3          dated 11-10-2000, w.e.f. 1.4.2000.                   For the Treasury Use Only ",new Font(Font.TIMES_ROMAN,10)));*/
				PdfPCell newcell1=new PdfPCell(tab);
				newcell1.setColspan(4);
				newcell1.setPadding (10.0f); 
				table1.addCell(newcell1);


				PdfPCell newcell2=new PdfPCell(new Phrase("Received Rs. (in Words)",new Font(Font.TIMES_ROMAN,10)));
				newcell2.setColspan(3);
				table1.addCell(newcell2);

				PdfPCell newcell3=new PdfPCell(new Phrase("Rupees (in Figures)",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(newcell3);

				PdfPCell newcell4=new PdfPCell(new Phrase(""+originalNumToLetter.getInWords(""+tax_amt),new Font(Font.TIMES_ROMAN,10)));
				newcell4.setColspan(3);
				table1.addCell(newcell4);

				PdfPCell newcell5=new PdfPCell(new Phrase(""+tax_amt,new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(newcell5);

				PdfPCell newcell6=new PdfPCell(new Phrase("Date of Entry: ",new Font(Font.TIMES_ROMAN,10)));
				newcell6.setColspan(2);
				newcell6.setHorizontalAlignment(Element.ALIGN_LEFT);
				table1.addCell(newcell6);
				PdfPCell newcell7=new PdfPCell(new Phrase("Challan No:",new Font(Font.TIMES_ROMAN,10)));
				newcell7.setHorizontalAlignment(Element.ALIGN_LEFT);
				newcell7.setColspan(2);
				table1.addCell(newcell7);

				PdfPCell newcell9=new PdfPCell(new Phrase("\n \n Treasurer.Officer  ",new Font(Font.TIMES_ROMAN,10)));
				newcell9.setHorizontalAlignment(Element.ALIGN_CENTER);
				//newcell9.setColspan(2);
				table1.addCell(newcell9);

				PdfPCell newcell91=new PdfPCell(new Phrase("\n \n Accountant. ",new Font(Font.TIMES_ROMAN,10)));
				newcell91.setHorizontalAlignment(Element.ALIGN_CENTER);

				table1.addCell(newcell91);
				PdfPCell newcell92=new PdfPCell(new Phrase("\n \n Treasury  Agent or Manager. ",new Font(Font.TIMES_ROMAN,10)));
				newcell92.setColspan(2);
				newcell92.setHorizontalAlignment(Element.ALIGN_CENTER);
				table1.addCell(newcell92);

				document.add(table1);
				document.newPage();            //Opened new page
				document.close();
				file.close();
				con.close();
				// System.out.println("pdf Generated Successfully");
			


				/*}	
			else if(states.equalsIgnoreCase("KT")){

				PdfWriter.getInstance(document, file);
				document.open();
				Image image1 = Image.getInstance(imagepath);
				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f); 
				document.add(image1);
				Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				document.add(para);

				para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Tel : +91-20 26812190 Email :",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Challan statement",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(new Phrase("For The Month Of "+date.substring(3,11)+""+(type.equalsIgnoreCase("before")?" (Before Finalize)":" ") ,new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				//para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);




				Connection con=null;
				con=ConnectionManager.getConnection();
				Statement stmt=con.createStatement();
				ResultSet rspt = null;



				String sql1= "select distinct e.dol,e.salute,e.empno,e.fname,e.mname,e.lname," +
						"  y1.cal_amt as CTC," +
						"  y2.cal_amt as pt " +
						"  from  EMPMAST e  left join EMPTRAN eran on e.EMPNO=eran.EMPNO" +
						" left join [HarshConstruction].[dbo].[Project_Sites] sitemast" +
						" on sitemast.Site_ID=eran.PRJ_SRNO" +
						"  join "+table_name+" y1 on e.EMPNO = y1.EMPNO " +
						"  join "+table_name+" y2 on (e.EMPNO = y2.EMPNO and y1.TRNCD = 199 " +
						"  and y1.TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"' and y2.TRNCD = 202 " +
						"  and y2.TRNDT  between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"'" +
						" and e.doj <='"+ReportDAO.EOM(date)+"'" +
						"  and e.EMPNO in(select distinct EMPNO from "+table_name+"  where TRNCD=202 and TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"')" +
						"  and y1.CAL_AMT>0 and y2.CAL_AMT>0) and sitemast.Site_State Like 'Kar%' " +
						"  and eran.EFFDATE=(select max(effdate) from emptran where empno=e.empno and EFFDATE<='"+ReportDAO.EOM(date)+"')  order by e.EMPNO";;          
						//System.out.println("query is--*****--"+sql1);   

						rspt = stmt.executeQuery(sql1);
						int srno=0;
						double totatlpf=0;
						LookupHandler lkp=new LookupHandler();
						int i = 0;
						while(rspt.next())
						{
							if(rspt.getInt("pt")>0){
								i++;
							}
							srno++;

						}

						para = new Paragraph(new Phrase("Return-cum-Chalan B.S.T.R.C. No., if any,The Maharashtra State Tax on Professions,",new Font(Font.TIMES_ROMAN,9)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingBefore(10.0f);
						para.setSpacingAfter(0); 
						document.add(para);
						para = new Paragraph(new Phrase("Trades, Callings And Employments, Act, 1975 AND Rule 11,11-A, 11-B, 11-C",new Font(Font.TIMES_ROMAN,9)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(0); 
						document.add(para);
						para = new Paragraph(new Phrase("0028, Other Taxes on Income and ExpenditureTaxes on Professions, Trades ",new Font(Font.TIMES_ROMAN,9)));
						para.setAlignment(Element.ALIGN_CENTER);

						para = new Paragraph(new Phrase("Callings and Employments-Taxes on Employments",new Font(Font.TIMES_ROMAN,9)));
						para.setAlignment(Element.ALIGN_CENTER); 
						para.setSpacingAfter(0); 
						document.add(para);
						para = new Paragraph(new Phrase("Trades ,Callings and Employments-Taxes on Employments",new Font(Font.TIMES_ROMAN,9)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(0); 
						document.add(para);

						PdfPTable table1=new PdfPTable(4);
						table1.setSpacingBefore(10.0f);
						table1.setWidthPercentage(new float[]{40,20,20,20},new Rectangle(100, 100));

						PdfPCell cellhead1=new PdfPCell(new Phrase("Employees whose monthly,Salaries, Wages",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhead1);
						PdfPCell cellhead2=new PdfPCell(new Phrase("Rate of Tax per Month",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhead2);
						PdfPCell cellhead3=new PdfPCell(new Phrase("No. of Employees",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhead3);
						PdfPCell cellhead4=new PdfPCell(new Phrase("Amount Of Tax Deducted",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhead4);
						String sqlquery ="select DISTINCT(p.cal_amt) as pt, sum(p.cal_amt) as tot_amt, COUNT(p.empno) as tot_emp" +
								" from "+table_name+" p left join EMPTRAN eran on p.EMPNO=eran.EMPNO" +
								" left join [HarshConstruction].[dbo].[Project_Sites] sitemast" +
								"  on sitemast.Site_ID=eran.PRJ_SRNO where p.trncd =  202 and " +
								" p.trndt  between '"+ReportDAO.BOM(date)+"'" +
								" and '"+ReportDAO.EOM(date)+"'  and sitemast.Site_State Like 'Kar%'" +
								"  and eran.EFFDATE=(select max(effdate) from emptran where empno=p.empno and EFFDATE<='"+ReportDAO.EOM(date)+"') " +
								" GROUP BY cal_amt order by PT";

						//System.out.println("pt query is "+sqlquery);
						Statement stmnt2=con.createStatement();
						ResultSet reslt=null;
						reslt=stmnt2.executeQuery(sqlquery);
						//first row
						int tax_amt = 0;

						while(reslt.next())
						{

							if(reslt.getInt("pt")==0)
							{
								PdfPCell cellhdata1=new PdfPCell(new Phrase("Do not exceed Rs.",new Font(Font.TIMES_ROMAN,10)));
								table1.addCell(cellhdata1);
								PdfPCell cellhdata2=new PdfPCell(new Phrase("NIL",new Font(Font.TIMES_ROMAN,9)));
								table1.addCell(cellhdata2);
								PdfPCell cellhdata3=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
								table1.addCell(cellhdata3);
								PdfPCell cellhdata4=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
								table1.addCell(cellhdata4);
							}else if(reslt.getInt("pt")==30)
							{
								tax_amt = tax_amt + reslt.getInt("tot_amt");
								PdfPCell cellhdata01=new PdfPCell(new Phrase(" Exceed Rs. 2,000 but do not exceed Rs. 2,500",new Font(Font.TIMES_ROMAN,10)));
								table1.addCell(cellhdata01);
								PdfPCell cellhdata02=new PdfPCell(new Phrase("Rs. 30 ",new Font(Font.TIMES_ROMAN,9)));
								table1.addCell(cellhdata02);
								PdfPCell cellhdata03=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
								table1.addCell(cellhdata03);
								PdfPCell cellhdata04=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
								table1.addCell(cellhdata04);
							}else if(reslt.getInt("pt")==60)
							{
								//System.out.println("now in pt 60");
								tax_amt = tax_amt + reslt.getInt("tot_amt");
								PdfPCell cellhdata011=new PdfPCell(new Phrase("Exceed Rs. 2,500 but do not exceed Rs. 3,500",new Font(Font.TIMES_ROMAN,10)));
								table1.addCell(cellhdata011);
								PdfPCell cellhdata012=new PdfPCell(new Phrase("Rs. 60 ",new Font(Font.TIMES_ROMAN,9)));
								table1.addCell(cellhdata012);
								PdfPCell cellhdata013=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
								table1.addCell(cellhdata013);
								PdfPCell cellhdata014=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
								table1.addCell(cellhdata014);
							}else if(reslt.getInt("pt")==120)
							{
								//System.out.println("now in pt 120");
								tax_amt = tax_amt + reslt.getInt("tot_amt");
								PdfPCell cellhdata011=new PdfPCell(new Phrase(" Exceed Rs. 3,500 but do not exceed Rs. 5,000",new Font(Font.TIMES_ROMAN,10)));
								table1.addCell(cellhdata011);
								PdfPCell cellhdata012=new PdfPCell(new Phrase(" Rs. 120 ",new Font(Font.TIMES_ROMAN,9)));
								table1.addCell(cellhdata012);
								PdfPCell cellhdata013=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
								table1.addCell(cellhdata013);
								PdfPCell cellhdata014=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
								table1.addCell(cellhdata014);
							}else if(reslt.getInt("pt") == 175.00)
							{
								//System.out.println("now in pt 175");
								tax_amt = tax_amt + reslt.getInt("tot_amt");
								System.out.println("totamt in 175"+reslt.getInt("tot_amt"));
								PdfPCell cellhdata021=new PdfPCell(new Phrase(" Exceed Rs. 5,000 but do not exceed Rs. 10,000",new Font(Font.TIMES_ROMAN,10)));
								table1.addCell(cellhdata021);
								PdfPCell cellhdata022=new PdfPCell(new Phrase("Rs. 175",new Font(Font.TIMES_ROMAN,9)));
								table1.addCell(cellhdata022);
								PdfPCell cellhdata023=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
								table1.addCell(cellhdata023);
								PdfPCell cellhdata024=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
								table1.addCell(cellhdata024);

							}else if(reslt.getInt("pt")==200.00 || reslt.getInt("pt")==300.00)
							{
								//System.out.println("now in pt 200");
								tax_amt = tax_amt + reslt.getInt("tot_amt");
								//System.out.println(""+tax_amt);
								//	System.out.println("totamt in 200"+reslt.getInt("tot_amt")+reslt.getInt("tot_emp"));
								PdfPCell cellhdata031=new PdfPCell(new Phrase("Exceeds Rs. 10,000",new Font(Font.TIMES_ROMAN,10)));
								table1.addCell(cellhdata031);
								PdfPCell cellhdata032=new PdfPCell(new Phrase(" Rs.2,500 per annum \n to be paid in the Follwing manner: \n a)Rs.200 per month exceptin the month of february \n b)Rs.300 per month of february",new Font(Font.TIMES_ROMAN,9)));
								table1.addCell(cellhdata032);
								PdfPCell cellhdata033=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
								table1.addCell(cellhdata033);
								PdfPCell cellhdata034=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
								table1.addCell(cellhdata034);

							} 
						}

						PdfPCell celtotalhead=new PdfPCell(new Phrase("Tax Amount",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(celtotalhead);
						PdfPCell celtotal=new PdfPCell(new Phrase("Rs."+tax_amt,new Font(Font.TIMES_ROMAN,10)));
						celtotal.setColspan(3);
						table1.addCell(celtotal);

						PdfPCell celtotalhead1=new PdfPCell(new Phrase("Interest Amount",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(celtotalhead1);
						PdfPCell celtotal1=new PdfPCell(new Phrase("Rs.",new Font(Font.TIMES_ROMAN,10)));
						celtotal1.setColspan(3);
						table1.addCell(celtotal1);
						PdfPCell celtotalhead2=new PdfPCell(new Phrase("Year/Quarter/Month ",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(celtotalhead2);
						PdfPCell celtotal2=new PdfPCell(new Phrase("Rs.",new Font(Font.TIMES_ROMAN,10)));
						celtotal2.setColspan(3);
						table1.addCell(celtotal2);

						PdfPCell celtotalhead3=new PdfPCell(new Phrase("Net Amount Payable",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(celtotalhead3);
						PdfPCell celtotal3=new PdfPCell(new Phrase("Rs."+tax_amt,new Font(Font.TIMES_ROMAN,10)));
						celtotal3.setColspan(3);
						table1.addCell(celtotal3);

						PdfPCell celtotalhead4=new PdfPCell(new Phrase("Profession Tax Registration Certificate No.",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(celtotalhead4);
						PdfPCell celtotal4=new PdfPCell(new Phrase("Period From ",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(celtotal4);
						PdfPCell celtotal5=new PdfPCell(new Phrase("Period To",new Font(Font.TIMES_ROMAN,10)));
						celtotal5.setColspan(2);
						table1.addCell(celtotal5);


						PdfPCell celtotalhead6=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(celtotalhead6);
						PdfPCell celtotal7=new PdfPCell(new Phrase(""+ReportDAO.BOM(date),new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(celtotal7);
						PdfPCell celtotal8=new PdfPCell(new Phrase(""+ReportDAO.EOM(date),new Font(Font.TIMES_ROMAN,10)));
						celtotal8.setColspan(2);
						table1.addCell(celtotal8);
						PdfPCell namecell=new PdfPCell(new Phrase("Name and Address: THE BUSINESS CO.OP BANK LTD.,411061  ",new Font(Font.TIMES_ROMAN,10)));
						namecell.setColspan(4);
						table1.addCell(namecell);

						PdfPCell newcell=new PdfPCell(new Phrase(" The above statements are true to the best of my knowledge and belief.",new Font(Font.TIMES_ROMAN,10)));
						newcell.setColspan(4);
						table1.addCell(newcell);


						PdfPTable tab=new PdfPTable(2);
						PdfPCell t1=new PdfPCell(new Phrase("Date:",new Font(Font.TIMES_ROMAN,10)));
						tab.addCell(t1);

						PdfPCell t2=new PdfPCell(new Phrase(" "));
						tab.addCell(t2);

						PdfPCell t3=new PdfPCell(new Phrase("Place:  ",new Font(Font.TIMES_ROMAN,10)));
						tab.addCell(t3);

						PdfPCell t4=new PdfPCell(new Phrase(" "));
						tab.addCell(t4);
						PdfPCell t5=new PdfPCell(new Phrase("Signature:& Designation",new Font(Font.TIMES_ROMAN,10)));
						tab.addCell(t5);

						PdfPCell t6=new PdfPCell(new Phrase(" "));
						tab.addCell(t6);
						PdfPCell t7=new PdfPCell(new Phrase("1. Form III was substituted by G.N. No. TFT-1100/CR-57/Taxation-3 dated 11-10-2000, w.e.f. 1.4.2000. ",new Font(Font.TIMES_ROMAN,10)));
						t7.setColspan(2);
						tab.addCell(t7);
						PdfPCell t8=new PdfPCell(new Phrase("For the Treasury Use Only",new Font(Font.TIMES_ROMAN,10)));
						t8.setColspan(2);
						t8.setHorizontalAlignment(Element.ALIGN_CENTER);
						tab.addCell(t8);



						PdfPCell newcell1=new PdfPCell(new Phrase("Date:                         Place:                                  Signature:& Designation                                                                                   1. Form III was substituted by G.N. No. TFT-1100/CR-57/Taxation-3          dated 11-10-2000, w.e.f. 1.4.2000.                   For the Treasury Use Only ",new Font(Font.TIMES_ROMAN,10)));
						PdfPCell newcell1=new PdfPCell(tab);
						newcell1.setColspan(4);
						newcell1.setPadding (10.0f); 
						table1.addCell(newcell1);


						PdfPCell newcell2=new PdfPCell(new Phrase("Received Rs. (in Words)",new Font(Font.TIMES_ROMAN,10)));
						newcell2.setColspan(3);
						table1.addCell(newcell2);

						PdfPCell newcell3=new PdfPCell(new Phrase("Rupees (in Figures)",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(newcell3);

						PdfPCell newcell4=new PdfPCell(new Phrase(""+originalNumToLetter.getInWords(""+tax_amt),new Font(Font.TIMES_ROMAN,10)));
						newcell4.setColspan(3);
						table1.addCell(newcell4);

						PdfPCell newcell5=new PdfPCell(new Phrase(""+tax_amt,new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(newcell5);

						PdfPCell newcell6=new PdfPCell(new Phrase("Date of Entry: ",new Font(Font.TIMES_ROMAN,10)));
						newcell6.setColspan(2);
						newcell6.setHorizontalAlignment(Element.ALIGN_LEFT);
						table1.addCell(newcell6);
						PdfPCell newcell7=new PdfPCell(new Phrase("Challan No:",new Font(Font.TIMES_ROMAN,10)));
						newcell7.setHorizontalAlignment(Element.ALIGN_LEFT);
						newcell7.setColspan(2);
						table1.addCell(newcell7);

						PdfPCell newcell9=new PdfPCell(new Phrase("\n \n Treasurer.Officer  ",new Font(Font.TIMES_ROMAN,10)));
						newcell9.setHorizontalAlignment(Element.ALIGN_CENTER);
						//newcell9.setColspan(2);
						table1.addCell(newcell9);

						PdfPCell newcell91=new PdfPCell(new Phrase("\n \n Accountant. ",new Font(Font.TIMES_ROMAN,10)));
						newcell91.setHorizontalAlignment(Element.ALIGN_CENTER);

						table1.addCell(newcell91);
						PdfPCell newcell92=new PdfPCell(new Phrase("\n \n Treasury  Agent or Manager. ",new Font(Font.TIMES_ROMAN,10)));
						newcell92.setColspan(2);
						newcell92.setHorizontalAlignment(Element.ALIGN_CENTER);
						table1.addCell(newcell92);

						document.add(table1);
						document.newPage();            //Opened new page
						document.close();
						file.close();
						con.close();
						// System.out.println("pdf Generated Successfully");

			}


			else if(states.equalsIgnoreCase("GA"))
			{

				PdfWriter.getInstance(document, file);
				document.open();
				Image image1 = Image.getInstance(imagepath);
				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f); 
				document.add(image1);
				Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				document.add(para);

				para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Challan statement",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(new Phrase("For The Month Of "+date.substring(3,11)+""+(type.equalsIgnoreCase("before")?" (Before Finalize)":" ") ,new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				//para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);


				Connection con=null;
				con=ConnectionManager.getConnection();
				Statement stmt=con.createStatement();
				ResultSet rspt = null;



				String sql1="select distinct e.dol,e.salute,e.empno,e.fname,e.mname,e.lname," +
						"  y1.cal_amt as CTC," +
						"  y2.cal_amt as pt " +
						"  from  EMPMAST e  left join EMPTRAN eran on e.EMPNO=eran.EMPNO" +
						" left join [HarshConstruction].[dbo].[Project_Sites] sitemast" +
						" on sitemast.Site_ID=eran.PRJ_SRNO" +
						"  join "+table_name+" y1 on e.EMPNO = y1.EMPNO " +
						"  join "+table_name+" y2 on (e.EMPNO = y2.EMPNO and y1.TRNCD = 199 " +
						"  and y1.TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"' and y2.TRNCD = 202 " +
						"  and y2.TRNDT  between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"'" +
						" and e.doj <='"+ReportDAO.EOM(date)+"'" +
						"  and e.EMPNO in(select distinct EMPNO from "+table_name+"  where TRNCD=202 and TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"' )" +
						"  and y1.CAL_AMT>0 and y2.CAL_AMT>0) and sitemast.Site_State Like 'Goa%' " +
						"  and eran.EFFDATE=(select max(effdate) from emptran where empno=e.empno and EFFDATE<='"+ReportDAO.EOM(date)+"')  order by e.EMPNO";          
				//System.out.println("query is--*****--"+sql1);   

				rspt = stmt.executeQuery(sql1);
				int srno=0;
				double totatlpf=0;
				LookupHandler lkp=new LookupHandler();
				int i = 0;
				while(rspt.next())
				{
					if(rspt.getInt("pt")>0){
						i++;
					}
					srno++;

				}

				para = new Paragraph(new Phrase("Return-cum-Chalan B.S.T.R.C. No., if any,The Maharashtra State Tax on Professions,",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(10.0f);
				para.setSpacingAfter(0); 
				document.add(para);
				para = new Paragraph(new Phrase("Trades, Callings And Employments, Act, 1975 AND Rule 11,11-A, 11-B, 11-C",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0); 
				document.add(para);
				para = new Paragraph(new Phrase("0028, Other Taxes on Income and ExpenditureTaxes on Professions, Trades ",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);

				para = new Paragraph(new Phrase("Callings and Employments-Taxes on Employments",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER); 
				para.setSpacingAfter(0); 
				document.add(para);
				para = new Paragraph(new Phrase("Trades ,Callings and Employments-Taxes on Employments",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0); 
				document.add(para);

				PdfPTable table1=new PdfPTable(4);
				table1.setSpacingBefore(10.0f);
				table1.setWidthPercentage(new float[]{40,20,20,20},new Rectangle(100, 100));

				PdfPCell cellhead1=new PdfPCell(new Phrase("Employees whose monthly,Salaries, Wages",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(cellhead1);
				PdfPCell cellhead2=new PdfPCell(new Phrase("Rate of Tax per Month",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(cellhead2);
				PdfPCell cellhead3=new PdfPCell(new Phrase("No. of Employees",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(cellhead3);
				PdfPCell cellhead4=new PdfPCell(new Phrase("Amount Of Tax Deducted",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(cellhead4);
				String sqlquery ="select DISTINCT(p.cal_amt) as pt, sum(p.cal_amt) as tot_amt, COUNT(p.empno) as tot_emp" +
						" from "+table_name+" p left join EMPTRAN eran on p.EMPNO=eran.EMPNO" +
						" left join [HarshConstruction].[dbo].[Project_Sites] sitemast" +
						"  on sitemast.Site_ID=eran.PRJ_SRNO where p.trncd =  202 and " +
						" p.trndt  between '"+ReportDAO.BOM(date)+"'" +
						" and '"+ReportDAO.EOM(date)+"'  and sitemast.Site_State Like 'Goa%'" +
						"  and eran.EFFDATE=(select max(effdate) from emptran where empno=p.empno and EFFDATE<='"+ReportDAO.EOM(date)+"') " +
						" GROUP BY cal_amt order by PT";

				//System.out.println("pt query is "+sqlquery);
				Statement stmnt2=con.createStatement();
				ResultSet reslt=null;
				reslt=stmnt2.executeQuery(sqlquery);
				//first row
				int tax_amt = 0;

				while(reslt.next())
				{

					if(reslt.getInt("pt")==0)
					{
						PdfPCell cellhdata1=new PdfPCell(new Phrase("Do not exceed Rs.",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata1);
						PdfPCell cellhdata2=new PdfPCell(new Phrase("NIL",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata2);
						PdfPCell cellhdata3=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata3);
						PdfPCell cellhdata4=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata4);
					}else if(reslt.getInt("pt")==30)
					{
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata01=new PdfPCell(new Phrase(" Exceed Rs. 2,000 but do not exceed Rs. 2,500",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata01);
						PdfPCell cellhdata02=new PdfPCell(new Phrase("Rs. 30 ",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata02);
						PdfPCell cellhdata03=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata03);
						PdfPCell cellhdata04=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata04);
					}else if(reslt.getInt("pt")==60)
					{
						//System.out.println("now in pt 60");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011=new PdfPCell(new Phrase("Exceed Rs. 2,500 but do not exceed Rs. 3,500",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012=new PdfPCell(new Phrase("Rs. 60 ",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata014);
					}else if(reslt.getInt("pt")==120)
					{
						//System.out.println("now in pt 120");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011=new PdfPCell(new Phrase(" Exceed Rs. 3,500 but do not exceed Rs. 5,000",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012=new PdfPCell(new Phrase(" Rs. 120 ",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata014);
					}else if(reslt.getInt("pt") == 175.00)
					{
						//System.out.println("now in pt 175");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						System.out.println("totamt in 175"+reslt.getInt("tot_amt"));
						PdfPCell cellhdata021=new PdfPCell(new Phrase(" Exceed Rs. 5,000 but do not exceed Rs. 10,000",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata021);
						PdfPCell cellhdata022=new PdfPCell(new Phrase("Rs. 175",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata022);
						PdfPCell cellhdata023=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata023);
						PdfPCell cellhdata024=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata024);

					}else if(reslt.getInt("pt")==200.00 || reslt.getInt("pt")==300.00)
					{
						//System.out.println("now in pt 200");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						//System.out.println(""+tax_amt);
						//	System.out.println("totamt in 200"+reslt.getInt("tot_amt")+reslt.getInt("tot_emp"));
						PdfPCell cellhdata031=new PdfPCell(new Phrase("Exceeds Rs. 10,000",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata031);
						PdfPCell cellhdata032=new PdfPCell(new Phrase(" Rs.2,500 per annum \n to be paid in the Follwing manner: \n a)Rs.200 per month exceptin the month of february \n b)Rs.300 per month of february",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata032);
						PdfPCell cellhdata033=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata033);
						PdfPCell cellhdata034=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata034);

					} 
				}

				PdfPCell celtotalhead=new PdfPCell(new Phrase("Tax Amount",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(celtotalhead);
				PdfPCell celtotal=new PdfPCell(new Phrase("Rs."+tax_amt,new Font(Font.TIMES_ROMAN,10)));
				celtotal.setColspan(3);
				table1.addCell(celtotal);

				PdfPCell celtotalhead1=new PdfPCell(new Phrase("Interest Amount",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(celtotalhead1);
				PdfPCell celtotal1=new PdfPCell(new Phrase("Rs.",new Font(Font.TIMES_ROMAN,10)));
				celtotal1.setColspan(3);
				table1.addCell(celtotal1);
				PdfPCell celtotalhead2=new PdfPCell(new Phrase("Year/Quarter/Month ",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(celtotalhead2);
				PdfPCell celtotal2=new PdfPCell(new Phrase("Rs.",new Font(Font.TIMES_ROMAN,10)));
				celtotal2.setColspan(3);
				table1.addCell(celtotal2);

				PdfPCell celtotalhead3=new PdfPCell(new Phrase("Net Amount Payable",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(celtotalhead3);
				PdfPCell celtotal3=new PdfPCell(new Phrase("Rs."+tax_amt,new Font(Font.TIMES_ROMAN,10)));
				celtotal3.setColspan(3);
				table1.addCell(celtotal3);

				PdfPCell celtotalhead4=new PdfPCell(new Phrase("Profession Tax Registration Certificate No.",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(celtotalhead4);
				PdfPCell celtotal4=new PdfPCell(new Phrase("Period From ",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(celtotal4);
				PdfPCell celtotal5=new PdfPCell(new Phrase("Period To",new Font(Font.TIMES_ROMAN,10)));
				celtotal5.setColspan(2);
				table1.addCell(celtotal5);


				PdfPCell celtotalhead6=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(celtotalhead6);
				PdfPCell celtotal7=new PdfPCell(new Phrase(""+ReportDAO.BOM(date),new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(celtotal7);
				PdfPCell celtotal8=new PdfPCell(new Phrase(""+ReportDAO.EOM(date),new Font(Font.TIMES_ROMAN,10)));
				celtotal8.setColspan(2);
				table1.addCell(celtotal8);
				PdfPCell namecell=new PdfPCell(new Phrase("Name and Address: THE BUSINESS CO.OP BANK LTD.,411061  ",new Font(Font.TIMES_ROMAN,10)));
				namecell.setColspan(4);
				table1.addCell(namecell);

				PdfPCell newcell=new PdfPCell(new Phrase(" The above statements are true to the best of my knowledge and belief.",new Font(Font.TIMES_ROMAN,10)));
				newcell.setColspan(4);
				table1.addCell(newcell);


				PdfPTable tab=new PdfPTable(2);
				PdfPCell t1=new PdfPCell(new Phrase("Date:",new Font(Font.TIMES_ROMAN,10)));
				tab.addCell(t1);

				PdfPCell t2=new PdfPCell(new Phrase(" "));
				tab.addCell(t2);

				PdfPCell t3=new PdfPCell(new Phrase("Place:  ",new Font(Font.TIMES_ROMAN,10)));
				tab.addCell(t3);

				PdfPCell t4=new PdfPCell(new Phrase(" "));
				tab.addCell(t4);
				PdfPCell t5=new PdfPCell(new Phrase("Signature:& Designation",new Font(Font.TIMES_ROMAN,10)));
				tab.addCell(t5);

				PdfPCell t6=new PdfPCell(new Phrase(" "));
				tab.addCell(t6);
				PdfPCell t7=new PdfPCell(new Phrase("1. Form III was substituted by G.N. No. TFT-1100/CR-57/Taxation-3 dated 11-10-2000, w.e.f. 1.4.2000. ",new Font(Font.TIMES_ROMAN,10)));
				t7.setColspan(2);
				tab.addCell(t7);
				PdfPCell t8=new PdfPCell(new Phrase("For the Treasury Use Only",new Font(Font.TIMES_ROMAN,10)));
				t8.setColspan(2);
				t8.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab.addCell(t8);



				PdfPCell newcell1=new PdfPCell(new Phrase("Date:                         Place:                                  Signature:& Designation                                                                                   1. Form III was substituted by G.N. No. TFT-1100/CR-57/Taxation-3          dated 11-10-2000, w.e.f. 1.4.2000.                   For the Treasury Use Only ",new Font(Font.TIMES_ROMAN,10)));
				PdfPCell newcell1=new PdfPCell(tab);
				newcell1.setColspan(4);
				newcell1.setPadding (10.0f); 
				table1.addCell(newcell1);


				PdfPCell newcell2=new PdfPCell(new Phrase("Received Rs. (in Words)",new Font(Font.TIMES_ROMAN,10)));
				newcell2.setColspan(3);
				table1.addCell(newcell2);

				PdfPCell newcell3=new PdfPCell(new Phrase("Rupees (in Figures)",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(newcell3);

				PdfPCell newcell4=new PdfPCell(new Phrase(""+originalNumToLetter.getInWords(""+tax_amt),new Font(Font.TIMES_ROMAN,10)));
				newcell4.setColspan(3);
				table1.addCell(newcell4);

				PdfPCell newcell5=new PdfPCell(new Phrase(""+tax_amt,new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(newcell5);

				PdfPCell newcell6=new PdfPCell(new Phrase("Date of Entry: ",new Font(Font.TIMES_ROMAN,10)));
				newcell6.setColspan(2);
				newcell6.setHorizontalAlignment(Element.ALIGN_LEFT);
				table1.addCell(newcell6);
				PdfPCell newcell7=new PdfPCell(new Phrase("Challan No:",new Font(Font.TIMES_ROMAN,10)));
				newcell7.setHorizontalAlignment(Element.ALIGN_LEFT);
				newcell7.setColspan(2);
				table1.addCell(newcell7);

				PdfPCell newcell9=new PdfPCell(new Phrase("\n \n Treasurer.Officer  ",new Font(Font.TIMES_ROMAN,10)));
				newcell9.setHorizontalAlignment(Element.ALIGN_CENTER);
				//newcell9.setColspan(2);
				table1.addCell(newcell9);

				PdfPCell newcell91=new PdfPCell(new Phrase("\n \n Accountant. ",new Font(Font.TIMES_ROMAN,10)));
				newcell91.setHorizontalAlignment(Element.ALIGN_CENTER);

				table1.addCell(newcell91);
				PdfPCell newcell92=new PdfPCell(new Phrase("\n \n Treasury  Agent or Manager. ",new Font(Font.TIMES_ROMAN,10)));
				newcell92.setColspan(2);
				newcell92.setHorizontalAlignment(Element.ALIGN_CENTER);
				table1.addCell(newcell92);

				document.add(table1);
				document.newPage();            //Opened new page
				document.close();
				file.close();
				con.close();
				// System.out.println("pdf Generated Successfully");



			}*/

		} catch (Exception e)
		{

			e.printStackTrace();
		}
		document.open();	

	}

	public static void getProfessionTaxStatment(String filePath, String date,String imagepath,String type,String state) throws IOException, SQLException, DocumentException 

	{

		OutputStream file = new FileOutputStream(new File(filePath));
		Document document = new Document();
		String table_name="";
		lable1="Report date : ";
		if(type.equalsIgnoreCase("before")) {
			table_name="PAYTRAN";
		} else {
			table_name="PAYTRAN_STAGE";
		}
System.out.println(table_name+"------------------------------"+state);
		try {
			/*if(state.equalsIgnoreCase("M")){*/
				UtilityDAO dao = new UtilityDAO();
				PdfWriter writer =PdfWriter.getInstance(document, new FileOutputStream(filePath));

				Footer ftr = dao.new Footer(lable1);
				writer.setPageEvent(ftr);
				document.open();
				Image image1 = Image.getInstance(imagepath);
				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f); 
				document.add(image1);
				Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				document.add(para);

				para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Tel : +91-20 26812190 Email :",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Profession Tax statement",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(new Phrase("For The Month Of "+date.substring(3,11)+" "+(type.equalsIgnoreCase("before")?" (Before Finalize)":"(After Finalize)"),new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				//para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				PdfPTable table=new PdfPTable(5);
				table.setSpacingBefore(10.0f);
				table.setWidthPercentage(new float[]{6,12,40,19,19},new Rectangle(100,100));
				PdfPCell cell1=new PdfPCell(new Phrase("Sr NO",new Font(Font.TIMES_ROMAN,10)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1);
				PdfPCell cell2=new PdfPCell(new Phrase("Employee Code",new Font(Font.TIMES_ROMAN,10)));
				cell2.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell2);
				PdfPCell cell3=new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,10)));
				cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell3);
				PdfPCell cell4=new PdfPCell(new Phrase("Gross salary(Rs)",new Font(Font.TIMES_ROMAN,10)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell4);
				PdfPCell cell5=new PdfPCell(new Phrase("Tax Amount",new Font(Font.TIMES_ROMAN,10)));
				cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell5);
				table.setHeaderRows(1);
				/*select e.salute ,e.empno,e.fname,e.mname,e.lname,(select net_amt from ytdtran where trncd=999 
            		and empno=e.empno and trndt  between '2011-04-01' and '2011-04-30') as basic, 
            						 (select net_amt from ytdtran where trncd=202 and empno=e.empno and trndt  
            						 between '2011-04-01' and '2011-04-30') as pf 
            						 from empmast e,emptran t where e.status = 'A' and t.empno= e.empno  order by e.empno*/


				Connection con=null;
				con=ConnectionManager.getConnection();
				Statement stmt=con.createStatement();
				ResultSet rspt = null;




				String sql1="select distinct e.dol,e.salute,e.empno,e.fname,e.mname,e.lname,e.empcode," +
						//"  y1.cal_amt as CTC," +
						"  y1.inp_amt as CTC," +
						"  y2.net_amt as pt " +
						"  from  EMPMAST e  left join EMPTRAN eran on e.EMPNO=eran.EMPNO" +
						" left join Project_Sites sitemast" +
						" on sitemast.Site_ID=eran.PRJ_SRNO" +
						"  join "+table_name+" y1 on e.EMPNO = y1.EMPNO " +
						//"  join "+table_name+" y2 on (e.EMPNO = y2.EMPNO and y1.TRNCD = 199 " +
						"  join "+table_name+" y2 on (e.EMPNO = y2.EMPNO and y1.TRNCD = 999 " +
						"  and y1.TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"' and y2.TRNCD = 202 " +
						"  and y2.TRNDT  between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"'" +
						" and e.doj <='"+ReportDAO.EOM(date)+"'" +
						"  and e.EMPNO in(select distinct EMPNO from "+table_name+"  where TRNCD=202 and TRNDT  between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"')" +
						//"  and y1.CAL_AMT>0 and y2.CAL_AMT>0) and sitemast.Site_State Like '"+state+"'" +
						"  and y1.CAL_AMT>0 ) and sitemast.Site_State Like '"+state+"'" +
						"  and eran.EFFDATE=(select max(effdate) from emptran where empno=e.empno and EFFDATE<='"+ReportDAO.EOM(date)+"') order by e.EMPNO";
				System.out.println("query is----"+sql1);   

				rspt = stmt.executeQuery(sql1);
				int srno=0;
				double totatlpf=0;
				LookupHandler lkp=new LookupHandler();
				int i = 0;
				while(rspt.next())
				{
					if(rspt.getInt("pt")>0){
						i++;
					}
					srno++;
					PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,10)));
					cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell1data);

					PdfPCell cell1data2=new PdfPCell(new Phrase(""+rspt.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,10)));
					cell1data2.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell1data2);

					int cd=rspt.getInt("salute");

					String empname=lkp.getLKP_Desc("SALUTE",cd)+""+rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");

					PdfPCell cell1data3=new PdfPCell(new Phrase(""+empname,new Font(Font.TIMES_ROMAN,10)));
					cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
					table.addCell(cell1data3);

					PdfPCell cell1data4=new PdfPCell(new Phrase(""+rspt.getInt("CTC"),new Font(Font.TIMES_ROMAN,10)));

					cell1data4.setHorizontalAlignment(Element.ALIGN_RIGHT);
					table.addCell(cell1data4);

					totatlpf=totatlpf + rspt.getInt("pt");

					PdfPCell cell1data5=new PdfPCell(new Phrase(""+rspt.getInt("pt"),new Font(Font.TIMES_ROMAN,10)));
					cell1data5.setHorizontalAlignment(Element.ALIGN_RIGHT);
					table.addCell(cell1data5);

				}
				PdfPCell totemp = new PdfPCell(new Phrase("Total Employee:",new Font(Font.TIMES_ROMAN,10)));
				totemp.setHorizontalAlignment(Element.ALIGN_RIGHT);
				totemp.setColspan(2);
				table.addCell(totemp);
				PdfPCell totempdisp = new PdfPCell(new Phrase(""+i,new Font(Font.TIMES_ROMAN,10)));
				totemp.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(totempdisp);
				PdfPCell total=new PdfPCell(new Phrase("Total Profession Tax:",new Font(Font.TIMES_ROMAN,10)));
				total.setHorizontalAlignment(Element.ALIGN_RIGHT);
				//total.setColspan(2);
				table.addCell(total);
				PdfPCell totaldata=new PdfPCell(new Phrase(""+totatlpf,new Font(Font.TIMES_ROMAN,10)));
				totaldata.setHorizontalAlignment(Element.ALIGN_RIGHT);
				table.addCell(totaldata);
				document.add(table);

				document.add(para);

				PdfPTable table1=new PdfPTable(4);
				table1.setSpacingBefore(10.0f);
				table1.setWidthPercentage(new float[]{40,20,20,20},new Rectangle(100, 100));

				PdfPCell cellhead1=new PdfPCell(new Phrase("Employees whose monthly,Salaries, Wages",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(cellhead1);
				PdfPCell cellhead2=new PdfPCell(new Phrase("Rate of Tax per Month",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(cellhead2);
				PdfPCell cellhead3=new PdfPCell(new Phrase("No. of Employees",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(cellhead3);
				PdfPCell cellhead4=new PdfPCell(new Phrase("Amount Of Tax Deducted",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(cellhead4);
				String sqlquery ="select DISTINCT(p.cal_amt) as pt, sum(p.cal_amt) as tot_amt, COUNT(p.empno) as tot_emp" +
						" from "+table_name+" p left join EMPTRAN eran on p.EMPNO=eran.EMPNO" +
						" left join Project_Sites sitemast" +
						"  on sitemast.Site_ID=eran.PRJ_SRNO where p.trncd =  202 and " +
						" p.trndt  between '"+ReportDAO.BOM(date)+"'" +
						" and '"+ReportDAO.EOM(date)+"'  and sitemast.Site_State Like '"+state+"'" +
						"  and eran.EFFDATE=(select max(effdate) from emptran where empno=p.empno and EFFDATE<='"+ReportDAO.EOM(date)+"')  " +
						" GROUP BY cal_amt order by PT";



				//System.out.println("pt query is "+sqlquery);
				Statement stmnt2=con.createStatement();
				ResultSet reslt=null;
				reslt=stmnt2.executeQuery(sqlquery);
				//first row
				int tax_amt = 0;

				while(reslt.next())
				{

					if(reslt.getInt("pt")==0)
					{
						PdfPCell cellhdata1=new PdfPCell(new Phrase("Do not exceed Rs.",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata1);
						PdfPCell cellhdata2=new PdfPCell(new Phrase("NIL",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata2);
						PdfPCell cellhdata3=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata3);
						PdfPCell cellhdata4=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata4);
					}else if(reslt.getInt("pt")==30)
					{
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata01=new PdfPCell(new Phrase(" Exceed Rs. 2,000 but do not exceed Rs. 2,500",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata01);
						PdfPCell cellhdata02=new PdfPCell(new Phrase("Rs. 30 ",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata02);
						PdfPCell cellhdata03=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata03);
						PdfPCell cellhdata04=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata04);
					}else if(reslt.getInt("pt")==60)
					{
						//System.out.println("now in pt 60");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011=new PdfPCell(new Phrase("Exceed Rs. 2,500 but do not exceed Rs. 3,500",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012=new PdfPCell(new Phrase("Rs. 60 ",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata014);
					}else if(reslt.getInt("pt")==120)
					{
						//System.out.println("now in pt 120");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011=new PdfPCell(new Phrase(" Exceed Rs. 3,500 but do not exceed Rs. 5,000",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012=new PdfPCell(new Phrase(" Rs. 120 ",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata014);
					}else if(reslt.getInt("pt") == 175.00)
					{
						//System.out.println("now in pt 175");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						System.out.println("totamt in 175"+reslt.getInt("tot_amt"));
						PdfPCell cellhdata021=new PdfPCell(new Phrase(" Exceed Rs. 5,000 but do not exceed Rs. 10,000",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata021);
						PdfPCell cellhdata022=new PdfPCell(new Phrase("Rs. 175",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata022);
						PdfPCell cellhdata023=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata023);
						PdfPCell cellhdata024=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata024);

					}else if(reslt.getInt("pt")==200.00 || reslt.getInt("pt")==300.00)
					{
						//System.out.println("now in pt 200");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						//System.out.println(""+tax_amt);
						//	System.out.println("totamt in 200"+reslt.getInt("tot_amt")+reslt.getInt("tot_emp"));
						PdfPCell cellhdata031=new PdfPCell(new Phrase("Exceeds Rs. 10,000",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata031);
						PdfPCell cellhdata032=new PdfPCell(new Phrase(" Rs.2,500 per annum \n to be paid in the Follwing manner: \n a)Rs.200 per month exceptin the month of february \n b)Rs.300 per month of february",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata032);
						PdfPCell cellhdata033=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata033);
						PdfPCell cellhdata034=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata034);

					} 
				}


				document.add(table1);
				document.newPage();            //Opened new page
				document.close();
				file.close();
				con.close();
			


			/*else if(state.equalsIgnoreCase("K")){

				UtilityDAO dao = new UtilityDAO();
				PdfWriter writer =PdfWriter.getInstance(document, new FileOutputStream(filePath));

				Footer ftr = dao.new Footer(lable1);
				writer.setPageEvent(ftr);
				document.open();
				Image image1 = Image.getInstance(imagepath);
				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f); 
				document.add(image1);
				Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				document.add(para);

				para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Tel : +91-20 26812190 Email :",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Profession Tax statement",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(new Phrase("For The Month Of "+date.substring(3,11)+" "+(type.equalsIgnoreCase("before")?" (Before Finalize)":"(After Finalize)"),new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				//para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				PdfPTable table=new PdfPTable(5);
				table.setSpacingBefore(10.0f);
				table.setWidthPercentage(new float[]{6,12,40,19,19},new Rectangle(100,100));
				PdfPCell cell1=new PdfPCell(new Phrase("Sr NO",new Font(Font.TIMES_ROMAN,10)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1);
				PdfPCell cell2=new PdfPCell(new Phrase("Employee Code",new Font(Font.TIMES_ROMAN,10)));
				cell2.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell2);
				PdfPCell cell3=new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,10)));
				cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell3);
				PdfPCell cell4=new PdfPCell(new Phrase("Gross salary(Rs)",new Font(Font.TIMES_ROMAN,10)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell4);
				PdfPCell cell5=new PdfPCell(new Phrase("Tax Amount",new Font(Font.TIMES_ROMAN,10)));
				cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell5);
				table.setHeaderRows(1);

				Connection con=null;
				con=ConnectionManager.getConnection();
				Statement stmt=con.createStatement();
				ResultSet rspt = null;


				String sql1="select distinct e.dol,e.salute,e.empno,e.fname,e.mname,e.lname," +
						"  y1.cal_amt as CTC," +
						"  y2.cal_amt as pt " +
						"  from  EMPMAST e  left join EMPTRAN eran on e.EMPNO=eran.EMPNO" +
						" left join [HarshConstruction].[dbo].[Project_Sites] sitemast" +
						" on sitemast.Site_ID=eran.PRJ_SRNO" +
						"  join "+table_name+" y1 on e.EMPNO = y1.EMPNO " +
						"  join "+table_name+" y2 on (e.EMPNO = y2.EMPNO and y1.TRNCD = 199 " +
						"  and y1.TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"' and y2.TRNCD = 202 " +
						"  and y2.TRNDT  between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"'" +
						" and e.doj <='"+ReportDAO.EOM(date)+"'" +
						"  and e.EMPNO in(select distinct EMPNO from "+table_name+"  where TRNCD=202 and TRNDT  between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"')" +
						"  and y1.CAL_AMT>0 and y2.CAL_AMT>0) and sitemast.Site_State Like 'Karn%' " +
						"  and eran.EFFDATE=(select max(effdate) from emptran where empno=e.empno and EFFDATE<='"+ReportDAO.EOM(date)+"')  order by e.EMPNO";
				System.out.println("query is----"+sql1);   

				rspt = stmt.executeQuery(sql1);
				int srno=0;
				double totatlpf=0;
				LookupHandler lkp=new LookupHandler();
				int i = 0;
				while(rspt.next())
				{
					if(rspt.getInt("pt")>0){
						i++;
					}
					srno++;
					PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,10)));
					cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell1data);

					PdfPCell cell1data2=new PdfPCell(new Phrase(""+rspt.getInt("EMPNO"),new Font(Font.TIMES_ROMAN,10)));
					cell1data2.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell1data2);

					int cd=rspt.getInt("salute");

					String empname=lkp.getLKP_Desc("SALUTE",cd)+""+rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");

					PdfPCell cell1data3=new PdfPCell(new Phrase(""+empname,new Font(Font.TIMES_ROMAN,10)));
					cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
					table.addCell(cell1data3);

					PdfPCell cell1data4=new PdfPCell(new Phrase(""+rspt.getInt("CTC"),new Font(Font.TIMES_ROMAN,10)));

					cell1data4.setHorizontalAlignment(Element.ALIGN_RIGHT);
					table.addCell(cell1data4);

					totatlpf=totatlpf + rspt.getInt("pt");

					PdfPCell cell1data5=new PdfPCell(new Phrase(""+rspt.getInt("pt"),new Font(Font.TIMES_ROMAN,10)));
					cell1data5.setHorizontalAlignment(Element.ALIGN_RIGHT);
					table.addCell(cell1data5);

				}
				PdfPCell totemp = new PdfPCell(new Phrase("Total Employee:",new Font(Font.TIMES_ROMAN,10)));
				totemp.setHorizontalAlignment(Element.ALIGN_RIGHT);
				totemp.setColspan(2);
				table.addCell(totemp);
				PdfPCell totempdisp = new PdfPCell(new Phrase(""+i,new Font(Font.TIMES_ROMAN,10)));
				totemp.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(totempdisp);
				PdfPCell total=new PdfPCell(new Phrase("Total Profession Tax:",new Font(Font.TIMES_ROMAN,10)));
				total.setHorizontalAlignment(Element.ALIGN_RIGHT);
				//total.setColspan(2);
				table.addCell(total);
				PdfPCell totaldata=new PdfPCell(new Phrase(""+totatlpf,new Font(Font.TIMES_ROMAN,10)));
				totaldata.setHorizontalAlignment(Element.ALIGN_RIGHT);
				table.addCell(totaldata);
				document.add(table);

				document.add(para);

				PdfPTable table1=new PdfPTable(4);
				table1.setSpacingBefore(10.0f);
				table1.setWidthPercentage(new float[]{40,20,20,20},new Rectangle(100, 100));

				PdfPCell cellhead1=new PdfPCell(new Phrase("Employees whose monthly,Salaries, Wages",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(cellhead1);
				PdfPCell cellhead2=new PdfPCell(new Phrase("Rate of Tax per Month",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(cellhead2);
				PdfPCell cellhead3=new PdfPCell(new Phrase("No. of Employees",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(cellhead3);
				PdfPCell cellhead4=new PdfPCell(new Phrase("Amount Of Tax Deducted",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(cellhead4);
				String sqlquery ="select DISTINCT(p.cal_amt) as pt, sum(p.cal_amt) as tot_amt, COUNT(p.empno) as tot_emp" +
						" from "+table_name+" p left join EMPTRAN eran on p.EMPNO=eran.EMPNO" +
						" left join [HarshConstruction].[dbo].[Project_Sites] sitemast" +
						"  on sitemast.Site_ID=eran.PRJ_SRNO where p.trncd =  202 and " +
						" p.trndt  between '"+ReportDAO.BOM(date)+"'" +
						" and '"+ReportDAO.EOM(date)+"'  and sitemast.Site_State Like 'Karn%' " +
						" and eran.EFFDATE=(select max(effdate) from emptran where empno=p.empno and EFFDATE<='"+ReportDAO.EOM(date)+"') " +
						" GROUP BY cal_amt order by PT";

				System.out.println("pt query is "+sqlquery);
				Statement stmnt2=con.createStatement();
				ResultSet reslt=null;
				reslt=stmnt2.executeQuery(sqlquery);
				//first row
				int tax_amt = 0;

				while(reslt.next())
				{

					if(reslt.getInt("pt")==0)
					{
						PdfPCell cellhdata1=new PdfPCell(new Phrase("Do not exceed Rs.",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata1);
						PdfPCell cellhdata2=new PdfPCell(new Phrase("NIL",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata2);
						PdfPCell cellhdata3=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata3);
						PdfPCell cellhdata4=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata4);
					}else if(reslt.getInt("pt")==30)
					{
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata01=new PdfPCell(new Phrase(" Exceed Rs. 2,000 but do not exceed Rs. 2,500",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata01);
						PdfPCell cellhdata02=new PdfPCell(new Phrase("Rs. 30 ",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata02);
						PdfPCell cellhdata03=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata03);
						PdfPCell cellhdata04=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata04);
					}else if(reslt.getInt("pt")==60)
					{
						//System.out.println("now in pt 60");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011=new PdfPCell(new Phrase("Exceed Rs. 2,500 but do not exceed Rs. 3,500",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012=new PdfPCell(new Phrase("Rs. 60 ",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata014);
					}else if(reslt.getInt("pt")==120)
					{
						//System.out.println("now in pt 120");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011=new PdfPCell(new Phrase(" Exceed Rs. 3,500 but do not exceed Rs. 5,000",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012=new PdfPCell(new Phrase(" Rs. 120 ",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata014);
					}else if(reslt.getInt("pt") == 175.00)
					{
						//System.out.println("now in pt 175");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						System.out.println("totamt in 175"+reslt.getInt("tot_amt"));
						PdfPCell cellhdata021=new PdfPCell(new Phrase(" Exceed Rs. 5,000 but do not exceed Rs. 10,000",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata021);
						PdfPCell cellhdata022=new PdfPCell(new Phrase("Rs. 175",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata022);
						PdfPCell cellhdata023=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata023);
						PdfPCell cellhdata024=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata024);

					}else if(reslt.getInt("pt")==200.00 || reslt.getInt("pt")==300.00)
					{
						//System.out.println("now in pt 200");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						//System.out.println(""+tax_amt);
						//	System.out.println("totamt in 200"+reslt.getInt("tot_amt")+reslt.getInt("tot_emp"));
						PdfPCell cellhdata031=new PdfPCell(new Phrase("Exceeds Rs. 10,000",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata031);
						PdfPCell cellhdata032=new PdfPCell(new Phrase(" Rs.2,500 per annum \n to be paid in the Follwing manner: \n a)Rs.200 per month exceptin the month of february \n b)Rs.300 per month of february",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata032);
						PdfPCell cellhdata033=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata033);
						PdfPCell cellhdata034=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata034);

					} 
				}


				document.add(table1);
				document.newPage();            //Opened new page
				document.close();
				file.close();
				con.close();

			}


			else if(state.equalsIgnoreCase("G")){

				UtilityDAO dao = new UtilityDAO();
				PdfWriter writer =PdfWriter.getInstance(document, new FileOutputStream(filePath));

				Footer ftr = dao.new Footer(lable1);
				writer.setPageEvent(ftr);
				document.open();
				Image image1 = Image.getInstance(imagepath);
				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f); 
				document.add(image1);
				Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				document.add(para);

				para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Tel : +91-20 26812190 Email :",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Profession Tax statement",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(new Phrase("For The Month Of "+date.substring(3,11)+" "+(type.equalsIgnoreCase("before")?" (Before Finalize)":"(After Finalize)"),new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				//para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				PdfPTable table=new PdfPTable(5);
				table.setSpacingBefore(10.0f);
				table.setWidthPercentage(new float[]{6,12,40,19,19},new Rectangle(100,100));
				PdfPCell cell1=new PdfPCell(new Phrase("Sr NO",new Font(Font.TIMES_ROMAN,10)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1);
				PdfPCell cell2=new PdfPCell(new Phrase("Employee Code",new Font(Font.TIMES_ROMAN,10)));
				cell2.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell2);
				PdfPCell cell3=new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,10)));
				cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell3);
				PdfPCell cell4=new PdfPCell(new Phrase("Gross salary(Rs)",new Font(Font.TIMES_ROMAN,10)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell4);
				PdfPCell cell5=new PdfPCell(new Phrase("Tax Amount",new Font(Font.TIMES_ROMAN,10)));
				cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell5);
				table.setHeaderRows(1);


				Connection con=null;
				con=ConnectionManager.getConnection();
				Statement stmt=con.createStatement();
				ResultSet rspt = null;

				String sql1="select distinct e.dol,e.salute,e.empno,e.fname,e.mname,e.lname," +
						"  y1.cal_amt as CTC," +
						"  y2.cal_amt as pt " +
						"  from  EMPMAST e  left join EMPTRAN eran on e.EMPNO=eran.EMPNO" +
						" left join [HarshConstruction].[dbo].[Project_Sites] sitemast" +
						" on sitemast.Site_ID=eran.PRJ_SRNO" +
						"  join "+table_name+" y1 on e.EMPNO = y1.EMPNO " +
						"  join "+table_name+" y2 on (e.EMPNO = y2.EMPNO and y1.TRNCD = 199 " +
						"  and y1.TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"' and y2.TRNCD = 202 " +
						"  and y2.TRNDT  between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"'" +
						" and e.doj <='"+ReportDAO.EOM(date)+"'" +
						"  and e.EMPNO in(select distinct EMPNO from "+table_name+"  where TRNCD=202 and TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"')" +
						"  and y1.CAL_AMT>0 and y2.CAL_AMT>0) and sitemast.Site_State Like 'Goa%' " +
						"  and eran.EFFDATE=(select max(effdate) from emptran where empno=e.empno and EFFDATE<='"+ReportDAO.EOM(date)+"')  order by e.EMPNO";
				//System.out.println("query is----"+sql1);   

				rspt = stmt.executeQuery(sql1);
				int srno=0;
				double totatlpf=0;
				LookupHandler lkp=new LookupHandler();
				int i = 0;
				while(rspt.next())
				{
					if(rspt.getInt("pt")>0){
						i++;
					}
					srno++;
					PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,10)));
					cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell1data);

					PdfPCell cell1data2=new PdfPCell(new Phrase(""+rspt.getInt("EMPNO"),new Font(Font.TIMES_ROMAN,10)));
					cell1data2.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell1data2);

					int cd=rspt.getInt("salute");

					String empname=lkp.getLKP_Desc("SALUTE",cd)+""+rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");

					PdfPCell cell1data3=new PdfPCell(new Phrase(""+empname,new Font(Font.TIMES_ROMAN,10)));
					cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
					table.addCell(cell1data3);

					PdfPCell cell1data4=new PdfPCell(new Phrase(""+rspt.getInt("CTC"),new Font(Font.TIMES_ROMAN,10)));

					cell1data4.setHorizontalAlignment(Element.ALIGN_RIGHT);
					table.addCell(cell1data4);

					totatlpf=totatlpf + rspt.getInt("pt");

					PdfPCell cell1data5=new PdfPCell(new Phrase(""+rspt.getInt("pt"),new Font(Font.TIMES_ROMAN,10)));
					cell1data5.setHorizontalAlignment(Element.ALIGN_RIGHT);
					table.addCell(cell1data5);

				}
				PdfPCell totemp = new PdfPCell(new Phrase("Total Employee:",new Font(Font.TIMES_ROMAN,10)));
				totemp.setHorizontalAlignment(Element.ALIGN_RIGHT);
				totemp.setColspan(2);
				table.addCell(totemp);
				PdfPCell totempdisp = new PdfPCell(new Phrase(""+i,new Font(Font.TIMES_ROMAN,10)));
				totemp.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(totempdisp);
				PdfPCell total=new PdfPCell(new Phrase("Total Profession Tax:",new Font(Font.TIMES_ROMAN,10)));
				total.setHorizontalAlignment(Element.ALIGN_RIGHT);
				//total.setColspan(2);
				table.addCell(total);
				PdfPCell totaldata=new PdfPCell(new Phrase(""+totatlpf,new Font(Font.TIMES_ROMAN,10)));
				totaldata.setHorizontalAlignment(Element.ALIGN_RIGHT);
				table.addCell(totaldata);
				document.add(table);

				document.add(para);

				PdfPTable table1=new PdfPTable(4);
				table1.setSpacingBefore(10.0f);
				table1.setWidthPercentage(new float[]{40,20,20,20},new Rectangle(100, 100));

				PdfPCell cellhead1=new PdfPCell(new Phrase("Employees whose monthly,Salaries, Wages",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(cellhead1);
				PdfPCell cellhead2=new PdfPCell(new Phrase("Rate of Tax per Month",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(cellhead2);
				PdfPCell cellhead3=new PdfPCell(new Phrase("No. of Employees",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(cellhead3);
				PdfPCell cellhead4=new PdfPCell(new Phrase("Amount Of Tax Deducted",new Font(Font.TIMES_ROMAN,10)));
				table1.addCell(cellhead4);
				String sqlquery ="select DISTINCT(p.cal_amt) as pt, sum(p.cal_amt) as tot_amt, COUNT(p.empno) as tot_emp" +
						" from "+table_name+" p left join EMPTRAN eran on p.EMPNO=eran.EMPNO" +
						" left join [HarshConstruction].[dbo].[Project_Sites] sitemast" +
						"  on sitemast.Site_ID=eran.PRJ_SRNO where p.trncd =  202 and " +
						" p.trndt  between '"+ReportDAO.BOM(date)+"'" +
						" and '"+ReportDAO.EOM(date)+"'  and sitemast.Site_State Like'Goa%' " +
						" and eran.EFFDATE=(select max(effdate) from emptran where empno=p.empno and EFFDATE<='"+ReportDAO.EOM(date)+"') " +
						" GROUP BY cal_amt order by PT";

				//System.out.println("pt query is "+sqlquery);
				Statement stmnt2=con.createStatement();
				ResultSet reslt=null;
				reslt=stmnt2.executeQuery(sqlquery);
				//first row
				int tax_amt = 0;

				while(reslt.next())
				{

					if(reslt.getInt("pt")==0)
					{
						PdfPCell cellhdata1=new PdfPCell(new Phrase("Do not exceed Rs.",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata1);
						PdfPCell cellhdata2=new PdfPCell(new Phrase("NIL",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata2);
						PdfPCell cellhdata3=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata3);
						PdfPCell cellhdata4=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata4);
					}else if(reslt.getInt("pt")==30)
					{
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata01=new PdfPCell(new Phrase(" Exceed Rs. 2,000 but do not exceed Rs. 2,500",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata01);
						PdfPCell cellhdata02=new PdfPCell(new Phrase("Rs. 30 ",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata02);
						PdfPCell cellhdata03=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata03);
						PdfPCell cellhdata04=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata04);
					}else if(reslt.getInt("pt")==60)
					{
						//System.out.println("now in pt 60");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011=new PdfPCell(new Phrase("Exceed Rs. 2,500 but do not exceed Rs. 3,500",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012=new PdfPCell(new Phrase("Rs. 60 ",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata014);
					}else if(reslt.getInt("pt")==120)
					{
						//System.out.println("now in pt 120");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011=new PdfPCell(new Phrase(" Exceed Rs. 3,500 but do not exceed Rs. 5,000",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012=new PdfPCell(new Phrase(" Rs. 120 ",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata014);
					}else if(reslt.getInt("pt") == 175.00)
					{
						//System.out.println("now in pt 175");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						System.out.println("totamt in 175"+reslt.getInt("tot_amt"));
						PdfPCell cellhdata021=new PdfPCell(new Phrase(" Exceed Rs. 5,000 but do not exceed Rs. 10,000",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata021);
						PdfPCell cellhdata022=new PdfPCell(new Phrase("Rs. 175",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata022);
						PdfPCell cellhdata023=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata023);
						PdfPCell cellhdata024=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata024);

					}else if(reslt.getInt("pt")==200.00 || reslt.getInt("pt")==300.00)
					{
						//System.out.println("now in pt 200");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						//System.out.println(""+tax_amt);
						//	System.out.println("totamt in 200"+reslt.getInt("tot_amt")+reslt.getInt("tot_emp"));
						PdfPCell cellhdata031=new PdfPCell(new Phrase("Exceeds Rs. 10,000",new Font(Font.TIMES_ROMAN,10)));
						table1.addCell(cellhdata031);
						PdfPCell cellhdata032=new PdfPCell(new Phrase(" Rs.2,500 per annum \n to be paid in the Follwing manner: \n a)Rs.200 per month exceptin the month of february \n b)Rs.300 per month of february",new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata032);
						PdfPCell cellhdata033=new PdfPCell(new Phrase(""+reslt.getInt("tot_emp"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata033);
						PdfPCell cellhdata034=new PdfPCell(new Phrase(""+reslt.getInt("tot_amt"),new Font(Font.TIMES_ROMAN,9)));
						table1.addCell(cellhdata034);

					} 
				}


				document.add(table1);
				document.newPage();            //Opened new page
				document.close();
				file.close();
				con.close();



			}*/



		} catch (Exception e)
		{

			e.printStackTrace();
		}
		document.open();	
	}

	public static void getForm10(String filePath, String date, String date1,String imagepath) throws IOException, SQLException, DocumentException 
	{
		OutputStream file = new FileOutputStream(new File(filePath));
		Document document = new Document();

		try {
			PdfWriter.getInstance(document, file);
			document.open();
			//Image image1 = Image.getInstance(imagepath);
			//image1.scaleAbsolute(80f, 80f);
			//image1.setAbsolutePosition(40f, 730f); 
			//document.add(image1);
			Phrase title = new Phrase("FORM-10",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			document.add(para);

			para = new Paragraph(new Phrase("THE EMPLOYEE'S PROVIDENT FUNDS SCHEME, 1952 [Paragraph 36 (2) (a) & (b)]",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);			
			document.add(para);

			para = new Paragraph(new Phrase("AND THE EMPLOYEE'S PENSION SCHEME, 1995 [Para - 20 (2)]",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);
			document.add(para);

			para = new Paragraph(new Phrase("Return of the members leaving service during the month of : "+ date.substring(3,11),new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_LEFT);
			// para.setSpacingBefore(30.0f);
			para.setSpacingAfter(5);
			document.add(para);

			para = new Paragraph(new Phrase("Name and address of the Factory/Estt : THE BUSINESS CO.OP BANK LTD.,                         CODE NO:_________",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);
			para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101                   ",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);
			document.add(para);

			PdfPTable table=new PdfPTable(7);
			table.setSpacingBefore(10.0f);
			table.setWidthPercentage(new float[]{5,13,15,15,9,16,10},new Rectangle(80,100));
			PdfPCell cell1=new PdfPCell(new Phrase("SR NO",new Font(Font.TIMES_ROMAN,10)));
			cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1);
			PdfPCell cell2=new PdfPCell(new Phrase("Account No.",new Font(Font.TIMES_ROMAN,10)));
			cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell2);
			PdfPCell cell3=new PdfPCell(new Phrase("Name of Member (in block letters)",new Font(Font.TIMES_ROMAN,10)));
			cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell3);
			PdfPCell cell4=new PdfPCell(new Phrase("Father's Name (or husband's name in case of married women)",new Font(Font.TIMES_ROMAN,10)));
			cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell4);
			PdfPCell cell5=new PdfPCell(new Phrase("Date of Leaving",new Font(Font.TIMES_ROMAN,10)));
			cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell5);
			PdfPCell cell6=new PdfPCell(new Phrase("Reason for leaving Service",new Font(Font.TIMES_ROMAN,10)));
			cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell6);
			PdfPCell cell7=new PdfPCell(new Phrase("Remarks",new Font(Font.TIMES_ROMAN,10)));
			cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell7);
			table.setHeaderRows(1);

			Connection con=null;
			con=ConnectionManager.getConnection();
			Statement stmt=con.createStatement();
			ResultSet rspt = null;
			LookupHandler lkp = new LookupHandler();

			String sql = "SELECT e.EMPNO, e.SALUTE, e.FNAME, e.MNAME, e.LNAME, e.DOL, t.ACNO FROM EMPMAST e, EMPTRAN t " +
					"WHERE DOL BETWEEN '"+date+"' and '"+date1+"' AND e.EMPNO = t.EMPNO " +
					"AND e.STATUS='N' and t.srno=(select max(srno) from emptran where empno=e.EMPNO) ORDER BY e.EMPNO";
			//System.out.println("********"+sql);
			rspt = stmt.executeQuery(sql);
			int srno = 1;

			if(!rspt.next()){
				PdfPCell cell1data1=new PdfPCell(new Phrase(" No Records Found For The Month "+date+" To "+date1,new Font(Font.TIMES_ROMAN,10)));
				cell1data1.setHorizontalAlignment(Element.ALIGN_LEFT);
				cell1data1.setFixedHeight(18.0f);
				cell1data1.setColspan(7);
				table.addCell(cell1data1);
			}
			while(rspt.next()){

				PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,10)));
				cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data);

				PdfPCell cell1data2=new PdfPCell(new Phrase(""+rspt.getString("ACNO"),new Font(Font.TIMES_ROMAN,10)));
				cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data2);

				String EmpName = lkp.getLKP_Desc("SALUTE",rspt.getInt("salute"))+" "+rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
				PdfPCell cell1data3=new PdfPCell(new Phrase(""+EmpName,new Font(Font.TIMES_ROMAN,10)));
				cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data3);

				String MName = lkp.getLKP_Desc("SALUTE",rspt.getInt("salute"))+" "+rspt.getString("mname")+" "+rspt.getString("lname");
				PdfPCell cell1data4=new PdfPCell(new Phrase(""+MName,new Font(Font.TIMES_ROMAN,10))); 
				cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data4);

				PdfPCell cell1data5=new PdfPCell(new Phrase(""+rspt.getString("DOL"),new Font(Font.TIMES_ROMAN,10)));
				cell1data5.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data5);

				PdfPCell cell1data6=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,10)));
				cell1data6.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data6);

				PdfPCell cell1data7=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,10)));
				cell1data7.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data7);
				srno++;
			}
			table.setSpacingAfter(50.0f);
			document.add(table);

			para = new Paragraph(new Phrase("Signature of the Employer or other authorised officer",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_RIGHT);
			para.setSpacingAfter(10);
			document.add(para);

			para = new Paragraph(new Phrase("Date :______________                                                           " +
					"                                                                          Stamp of the Factory/Estt",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(15);
			document.add(para);

			/*para = new Paragraph(new Phrase("",new Font(Font.TIMES_ROMAN,9)));
 			para.setAlignment(Element.ALIGN_RIGHT);
 			para.setSpacingAfter(15);
 			document.add(para);*/

			para = new Paragraph(new Phrase("*Please state whether the member is (a) retiring according to para (69) (1) (a) or (b) of the scheme (b) leaving India for " +
					"permanent settlement abroad (c) retrenchment (d) Pt. & total disablement due to employment injury (e) discharged (f) " +
					"resigning from or leaving service (g) taking up employment elsewhere (The name & address of the Employers should be " +
					"stated) (h) death. (i) atained the age of 58 years.",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(10);
			document.add(para);

			para = new Paragraph(new Phrase("*Certified that the member mentioned at Serial No_________Shri_______________________________________________________was " +
					"paid/not paid retrenchment compensation of Rs_________________________________________under the industrial Dispute Act. 1947.",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(50);
			document.add(para);

			para = new Paragraph(new Phrase("Signature of the Employer                       ",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_RIGHT);
			para.setSpacingAfter(0);
			document.add(para);

			document.close();
			file.close();

			stmt.close();
			con.close();
		}
		catch (Exception e)
		{
			e.printStackTrace();
		}
		document.open();	
	}

	public static void getESICLIST(String filePath, String date,String imagepath,String type) throws IOException, SQLException, DocumentException 
	{

		OutputStream file = new FileOutputStream(new File(filePath));
		Document document = new Document();
		String table_name="";
		lable1="Report date : ";
		if(type.equalsIgnoreCase("before")){table_name="PAYTRAN";}else{table_name="PAYTRAN_STAGE";}
		try {
			//PdfWriter.getInstance(document, file);
			UtilityDAO dao = new UtilityDAO();
			PdfWriter writer =PdfWriter.getInstance(document, new FileOutputStream(filePath));

			Footer ftr = dao.new Footer(lable1);
			writer.setPageEvent(ftr);
			document.open();
			Image image1 = Image.getInstance(imagepath);
			image1.scaleAbsolute(80f, 80f);
			image1.setAbsolutePosition(40f, 730f); 
			document.add(image1);
			Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			document.add(para);

			para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			document.add(para);
			para = new Paragraph(new Phrase("Tel : +91-20 26812190,Email :",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			document.add(para);
			para = new Paragraph(new Phrase("E.S.I.C List "+(type.equalsIgnoreCase("before")?"":""),new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			// para.setSpacingBefore(30.0f);
			para.setSpacingAfter(0);
			document.add(para);
			para = new Paragraph(new Phrase("For The Month Of "+date.substring(3),new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			//para.setSpacingBefore(30.0f);
			para.setSpacingAfter(0);
			document.add(para);
			PdfPTable table=new PdfPTable(5);
			table.setSpacingBefore(10.0f);
			table.setWidthPercentage(new float[]{6,12,40,19,19},new Rectangle(100,100));
			PdfPCell cell1=new PdfPCell(new Phrase("Sr NO",new Font(Font.TIMES_ROMAN,10)));
			cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
			table.addCell(cell1);
			PdfPCell cell2=new PdfPCell(new Phrase("Employee Code",new Font(Font.TIMES_ROMAN,10)));
			cell2.setHorizontalAlignment(Element.ALIGN_LEFT);
			table.addCell(cell2);
			PdfPCell cell3=new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,10)));
			cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell3);
			PdfPCell cell4=new PdfPCell(new Phrase("Gross salary(Rs)",new Font(Font.TIMES_ROMAN,10)));
			cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell4);
			PdfPCell cell5=new PdfPCell(new Phrase("Esic Amount",new Font(Font.TIMES_ROMAN,10)));
			cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell5);
			table.setHeaderRows(1);

			Connection con=null;
			con=ConnectionManager.getConnection();
			Statement stmt=con.createStatement();
			ResultSet rspt = null;

			/*String sql1="select e.salute,e.empno,e.empcode,e.fname,e.mname,e.lname," +
        		" (select distinct net_amt from ytdtran where trncd=199 and empno=e.empno and trndt " +
        		" between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"') basic," +
        		" (select distinct net_amt from ytdtran where trncd=221 and empno=e.empno " +
        		" and trndt  between '"+ReportDAO.BOM(date )+"' and '"+ReportDAO.EOM(date)+"') esic " +
        			" from empmast e,emptran t where e.status='A' and t.empno = e.empno  order by e.empno";*/
			String sql1 = "select e.salute,e.empno,e.empcode,e.fname,e.mname,e.lname,y1.cal_amt as basic,y2.cal_amt as esic from EMPMAST e join PAYTRAN y1 on e.EMPNO = y1.EMPNO join PAYTRAN y2 on e.EMPNO = y2.EMPNO " +
					"and y1.TRNCD = 198 and y1.TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"' " +
					"and y2.TRNCD = 221 and y2.TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"'  and y2.cal_amt>0 " +
					" UNION "+
					"select e.salute,e.empno,e.empcode,e.fname,e.mname,e.lname,y1.cal_amt as basic,y2.cal_amt as esic from EMPMAST e join PAYTRAN_STAGE y1 on e.EMPNO = y1.EMPNO join PAYTRAN_STAGE y2 on e.EMPNO = y2.EMPNO " +
					"and y1.TRNCD = 198 and y1.TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"' " +
					"and y2.TRNCD = 221 and y2.TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"'   and y2.cal_amt>0  "+
					" UNION "+
					"select e.salute,e.empno,e.empcode,e.fname,e.mname,e.lname,y1.cal_amt as basic,y2.cal_amt as esic from EMPMAST e join YTDTRAN y1 on e.EMPNO = y1.EMPNO join YTDTRAN y2 on e.EMPNO = y2.EMPNO " +
					"and y1.TRNCD = 198 and y1.TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"' " +
					"and y2.TRNCD = 221 and y2.TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"'   and y2.cal_amt>0  ";


			//System.out.println("query is"+sql1);

			rspt = stmt.executeQuery(sql1);
			int srno=0;
			double totatlesic=0;
			LookupHandler lkp=new LookupHandler();
			int i = 0;
			while(rspt.next())
			{
				if(rspt.getInt("esic")>0){
					i++;
				}
				srno++;
				PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,10)));
				cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data);

				PdfPCell cell1data2=new PdfPCell(new Phrase(""+rspt.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,10)));
				cell1data2.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data2);

				int cd=rspt.getInt("salute");

				String empname=lkp.getLKP_Desc("SALUTE",cd)+""+rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");

				PdfPCell cell1data3=new PdfPCell(new Phrase(""+empname,new Font(Font.TIMES_ROMAN,10)));
				cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data3);

				PdfPCell cell1data4=new PdfPCell(new Phrase(""+rspt.getInt("basic"),new Font(Font.TIMES_ROMAN,10)));

				cell1data4.setHorizontalAlignment(Element.ALIGN_RIGHT);
				table.addCell(cell1data4);

				totatlesic=totatlesic + rspt.getInt("esic");

				PdfPCell cell1data5=new PdfPCell(new Phrase(""+rspt.getInt("esic"),new Font(Font.TIMES_ROMAN,10)));
				cell1data5.setHorizontalAlignment(Element.ALIGN_RIGHT);
				table.addCell(cell1data5);

			}
			PdfPCell totemp = new PdfPCell(new Phrase("Total Employee:",new Font(Font.TIMES_ROMAN,10)));
			totemp.setHorizontalAlignment(Element.ALIGN_RIGHT);
			totemp.setColspan(2);
			table.addCell(totemp);
			PdfPCell totempdisp = new PdfPCell(new Phrase(""+i,new Font(Font.TIMES_ROMAN,10)));
			totemp.setHorizontalAlignment(Element.ALIGN_LEFT);
			table.addCell(totempdisp);
			PdfPCell total=new PdfPCell(new Phrase("Total E.S.I.C:",new Font(Font.TIMES_ROMAN,10)));
			total.setHorizontalAlignment(Element.ALIGN_RIGHT);
			//total.setColspan(2);
			table.addCell(total);
			PdfPCell totaldata=new PdfPCell(new Phrase(""+totatlesic,new Font(Font.TIMES_ROMAN,10)));
			totaldata.setHorizontalAlignment(Element.ALIGN_RIGHT);
			table.addCell(totaldata);
			document.add(table);	 
			document.close();
			file.close();
			con.close();
			// System.out.println("pdf Generated Successfully");


		} catch (Exception e)
		{		
			e.printStackTrace();
		}

	}
	/*public PdfPCell createcell(String str, String align)
{
	PdfPCell pdcell=new PdfPCell(new Phrase(""+str,new Font()));

	return null;
	}*/
	public static void PFLISTPDF(String rdt,String filepath,String type)
	{


		RepoartBean repBean  = new RepoartBean();
		Connection Cn = null;
		ResultSet emp = null;
		String EmpSql = "";
		int PBRCD = 0;
		int gross = 0;
		int brtot[] = new int[8];
		int ALLbrtot[] = new int[8];
		int amt15000=0;
		int totamt15000=0;

		int eepf_admin = 0;
		
		SimpleDateFormat output = new SimpleDateFormat("dd/MM/yyyy");
		String table_name=type.equalsIgnoreCase("before")?"PAYTRAN":"PAYTRAN_STAGE";	
		try{

			Document doc = new Document();
			PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
			doc.open();
			doc.setPageSize(PageSize.A4);
			Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
			//ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("HARSH CONSTRUCTION",FONT), 297.5f, 421, 45);

			//	Image image1 = Image.getInstance("/images/BusinessBankLogo.jpg");

			Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			doc.add(para);
			para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase("Provident Fund Statment "+rdt.substring(3)+"  "+(type.equalsIgnoreCase("before")?" (Before Finalize)":"(After Finalize)"),new Font(Font.TIMES_ROMAN,10)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
			doc.add(para);

			PdfPTable tab = new PdfPTable(9);

			tab.setWidthPercentage(new float[]{6,6,16,24,10,10,8,10,10}, new Rectangle(100, 100));
			tab.setSpacingBefore(5);
			tab.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(new Phrase("Sr No",new Font(Font.TIMES_ROMAN,10)));
			tab.addCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,10)));
			tab.addCell(new Phrase("P.F No",new Font(Font.TIMES_ROMAN,10)));
			tab.addCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,10)));
			tab.addCell(new Phrase("Basic Salary(Rs.)",new Font(Font.TIMES_ROMAN,10)));
			tab.addCell(new Phrase("P.F. Amt.",new Font(Font.TIMES_ROMAN,10)));
			tab.addCell(new Phrase("E.P.F",new Font(Font.TIMES_ROMAN,10)));
			tab.addCell(new Phrase("E.P.S",new Font(Font.TIMES_ROMAN,10)));
			tab.addCell(new Phrase("Birth Date",new Font(Font.TIMES_ROMAN,10)));
			tab.setHeaderRows(1);
			ReportDAO.OpenCon("", "", "",repBean);
			Cn = repBean.getCn();
			/*EmpSql = "select e.salute ,e.dob, e.empno,e.fname,e.mname,e.lname,e.pfno,p.prj_name,p.prj_srno, (select net_amt from ytdtran where trncd=101 and empno=e.empno and trndt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"') basic," +
				"(select net_amt from ytdtran where trncd=201 and empno=e.empno and trndt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"') as pf," +
				"(select net_amt from ytdtran where trncd=102 and empno=e.empno and trndt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"') da," +
				"(select net_amt from ytdtran where trncd=199 and empno=e.empno and upddt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"') ctc," +
				"(select arr_amt from ytdtran where trncd=201 and empno=e.empno and upddt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"') arr_amt " +
				"from empmast e, prj p,emptran t where e.status = 'A' and t.empno= e.empno and t.prj_srno=p.prj_srno order by e.pfno,p.prj_srno";
			 */
			/*EmpSql = "select e.salute ,e.dob, e.empno,e.empcode,e.fname,e.mname,e.lname,e.pfno,t.PRJ_SRNO, " +
				"(select cal_amt from "+table_name+" where trncd=136 and empno=e.empno and trndt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"') basic," +
				"(select cal_amt from "+table_name+" where trncd=201 and empno=e.empno and trndt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"') as pf," +
				"(select cal_amt from "+table_name+" where trncd=102 and empno=e.empno and trndt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"') da," +
				"(select cal_amt from "+table_name+" where trncd=199 and empno=e.empno and upddt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"') ctc," +
				"(select cal_amt from "+table_name+" where trncd=231 and empno=e.empno and upddt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"') EPF," +
				"(select cal_amt from "+table_name+" where trncd=232 and empno=e.empno and upddt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"') EPS," +
				"(select arr_amt from "+table_name+" where trncd=201 and empno=e.empno and upddt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"') arr_amt " +
				"from empmast e,emptran t where e.empno=t.empno  and t.SRNO = (select MAX(empt.SRNO) from EMPTRAN empt where empt.empno=e.empno)" +
				"and e.EMPNO in(select distinct EMPNO from "+table_name+" where TRNCD=201) " +
				"and e.EMPNO not in(select distinct EMPNO from "+table_name+" where TRNCD=101 and cal_amt=0) order by t.prj_srno, e.pfno";


			 */
/*			EmpSql ="select e.salute ,e.dob, e.empno,e.empcode,e.fname,e.mname,e.lname,e.pfno,t.PRJ_SRNO," +
					"y1.net_amt as BASIC," +
					"y2.net_amt as PF," +
					"y3.cal_amt as EPF," +
					"y4.cal_amt as EPS, " +
					"y5.net_amt AS DA, " +
				    "y6.net_amt AS VDA, " +
				    "SUM(y7.NET_AMT) AS ARREARS " +
					"from EMPMAST e join EMPTRAN t on e.EMPNO=t.EMPNO " +
					"join "+table_name+" y1 on e.EMPNO = y1.EMPNO " +
					"join "+table_name+" y2 on e.EMPNO = y2.EMPNO  " +
					"join "+table_name+" y3 on e.EMPNO = y3.EMPNO  " +
					"join "+table_name+" y4 on e.EMPNO = y4.EMPNO  " +
					"join "+table_name+" y5 on e.EMPNO = y5.EMPNO  " +
					"join "+table_name+" y6 on e.EMPNO = y6.EMPNO  " +
					"join "+table_name+" y7 on e.EMPNO = y7.EMPNO  " +
					"and y1.TRNCD = 101 and y1.TRNDT between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"' " +
					"and y2.TRNCD = 201 and y2.TRNDT =y1.TRNDT " +
					"and y3.TRNCD = 231 and y3.TRNDT =y1.TRNDT " +
					"and y5.TRNCD = 102 and y5.TRNDT =y1.TRNDT " +
					"and y6.TRNCD = 138 and y6.TRNDT =y1.TRNDT " +
					"and y4.TRNCD = 232 and y4.TRNDT =y1.TRNDT " +
					"and y7.TRNCD IN (select ONAMTCD from ONAMT where TRNCD=136 and ONAMTCD NOT IN (101,102,138,142) )  AND y7.TRNDT =y1.TRNDT " +
					"and t.SRNO=(select max(srno) from EMPTRAN where EMPNO=t.EMPNO)" +
					"and " +
					"y1.cal_amt >0  AND y2.cal_amt <>0  group by e.salute ,e.dob, e.empno,e.empcode,e.fname,e.mname,e.lname,e.pfno,t.PRJ_SRNO,y1.net_amt ,y2.net_amt ,y3.cal_amt ,y4.cal_amt , y5.net_amt ,y6.net_amt     order by   e.pfno";
*/			

			
			EmpSql ="select e.salute ,e.dob, e.empno,e.empcode,e.fname,e.mname,e.lname,e.pfno,t.PRJ_SRNO," +
					"y1.net_amt as BASIC," +
					"y2.net_amt as PF," +
					"y3.cal_amt as EPF," +
					"y4.cal_amt as EPS, " +
					"y5.net_amt AS DA, " +
					"y6.cal_amt AS EEPF_ADMIN, " +
				    "SUM(y7.NET_AMT) AS ARREARS " +
					"from EMPMAST e join EMPTRAN t on e.EMPNO=t.EMPNO " +
					"join "+table_name+" y1 on e.EMPNO = y1.EMPNO " +
					"join "+table_name+" y2 on e.EMPNO = y2.EMPNO  " +
					"join "+table_name+" y3 on e.EMPNO = y3.EMPNO  " +
					"join "+table_name+" y4 on e.EMPNO = y4.EMPNO  " +
					"join "+table_name+" y5 on e.EMPNO = y5.EMPNO  " +
					"join "+table_name+" y6 on e.EMPNO = y6.EMPNO  " +
					"join "+table_name+" y7 on e.EMPNO = y7.EMPNO  " +
					"and y1.TRNCD = 101 and y1.TRNDT between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"' " +
					"and y2.TRNCD = 201 and y2.TRNDT =y1.TRNDT " +
					"and y3.TRNCD = 231 and y3.TRNDT =y1.TRNDT " +
					"and y5.TRNCD = 102 and y5.TRNDT =y1.TRNDT " +
					"and y4.TRNCD = 232 and y4.TRNDT =y1.TRNDT " +
					"and y6.TRNCD = 234 and y6.TRNDT =y1.TRNDT " +
					"and y7.TRNCD IN (select ONAMTCD from ONAMT where TRNCD=136 and ONAMTCD NOT IN (101,102) )  AND y7.TRNDT =y1.TRNDT " +
					"and t.SRNO=(select max(srno) from EMPTRAN where EMPNO=t.EMPNO)" +
					"AND y2.cal_amt <>0  group by e.salute ,e.dob, e.empno,e.empcode,e.fname,e.mname,e.lname,e.pfno,t.PRJ_SRNO,y1.net_amt ,y2.net_amt ,y3.cal_amt ,y4.cal_amt , y5.net_amt, y6.cal_amt    order by   e.pfno";

			Statement st;
			System.out.println(table_name+"----"+EmpSql);
			st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
			emp = st.executeQuery(EmpSql);
			/*if(!emp.next()){
				System.out.println("No Any Record Found");
				return;
			}*/
			int i;
			for(i = 1; i <= 7; i++){
				ALLbrtot[i] = 0;
			}
			int count = 1;
			emp.previous();
			//for(i = 1; i <= 4; i++){
			for(i = 1; i <= 5; i++){
				brtot[i] = 0;
			}
			int k = 0;
			while(emp.next()){

				PBRCD = emp.getInt("prj_srno");
				while(PBRCD == emp.getInt("prj_srno")){
					if(emp.getInt("PF")>0)
						k++;
					int basic=0;
					int da=0;
					int vda=0;
					int eps = 0;
					int epf = 0;
					int arr	= 0;
					

					tab.addCell(new Phrase(""+count++,new Font(Font.TIMES_ROMAN,8)));
					/*if(emp.getInt("EMPNO")<10)
				{
					tab.addCell(new Phrase("0"+emp.getInt("EMPNO"),new Font(Font.TIMES_ROMAN,8)));
				}
				else
				{
					tab.addCell(new Phrase(""+emp.getInt("EMPNO"),new Font(Font.TIMES_ROMAN,8)));
				}*/
					tab.addCell(new Phrase(emp.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8)));


					tab.addCell(new Phrase(""+emp.getString("PFNO"),new Font(Font.TIMES_ROMAN,8)));

					String salute=new LookupHandler().getLKP_Desc("SALUTE",Integer.parseInt(emp.getString("SALUTE")) );
					if(emp.getString("MNAME").equals(null) || emp.getString("MNAME").equals(""))
					{
						tab.addCell(new Phrase(""+FixStr(salute+emp.getString("FNAME")+" "+emp.getString("MNAME")+" "+emp.getString("LNAME"), 30, 1),new Font(Font.TIMES_ROMAN,8)));
					}
					else
					{
						tab.addCell(new Phrase(""+FixStr(salute+emp.getString("FNAME")+" "+emp.getString("MNAME").charAt(0)+". "+emp.getString("LNAME"), 30, 1),new Font(Font.TIMES_ROMAN,8)));

					}
					
					eepf_admin = emp.getString("EEPF_ADMIN")!= null?emp.getInt("EEPF_ADMIN"):0;
					brtot[5] = brtot[5] + Math.round((eepf_admin));
					
					System.out.println("ADMIN CHARGES : "+brtot[5]);
					
					basic=emp.getString("BASIC")!= null?emp.getInt("BASIC"):0;
					da=emp.getString("DA")!= null?emp.getInt("DA"):0;
					//vda=emp.getString("VDA")!= null?emp.getInt("VDA"):0;
					vda=0;
					arr=emp.getString("ARREARS")!=null?emp.getInt("ARREARS"):0;
					if((basic+da+vda+arr)>=15000) {
						amt15000+=((basic+da+vda+arr)-15000);
						totamt15000+=(basic+da+vda+arr);
					}
					tab.addCell(new Phrase(""+trans((basic+da+vda+arr), "999,999.99", "", false, false),new Font(Font.TIMES_ROMAN,8)));

					brtot[1] = brtot[1] + Math.round((basic+da+vda+arr));
					gross = (emp.getString("BASIC")!= null?emp.getInt("BASIC"):0);
					tab.addCell(new Phrase(""+trans(emp.getInt("PF"), "999,999.99", "", false, false),new Font(Font.TIMES_ROMAN,8)));
					brtot[2] = brtot[2] + Math.round(emp.getInt("PF"));
					epf=emp.getString("EPF")!= null?emp.getInt("EPF"):0;
					eps=emp.getString("EPS")!= null?emp.getInt("EPS"):0;
					if(emp.getInt("PF") !=0.00 ){
						brtot[3] = brtot[3] + Math.round(epf);
						brtot[4] = brtot[4] + Math.round(eps);
					}
					tab.addCell(new Phrase(""+epf,new Font(Font.TIMES_ROMAN,8)));
					tab.addCell(new Phrase(""+eps,new Font(Font.TIMES_ROMAN,8)));
					tab.addCell(new Phrase(""+output.format(emp.getDate("DOB")),new Font(Font.TIMES_ROMAN,8)));


					if(!emp.next()){
						break;
					}
					if(PBRCD != emp.getInt("prj_srno")){
						emp.previous();
						break;
					}
				}
			}
			PdfPCell tot = new PdfPCell(new Phrase("Total Employee :",new Font(Font.TIMES_ROMAN,8)));
			tot.setHorizontalAlignment(Element.ALIGN_RIGHT);
			tot.setColspan(2);
			tab.addCell(tot);
			PdfPCell totdisp = new PdfPCell(new Phrase(""+k,new Font(Font.TIMES_ROMAN,8)));
			tot.setHorizontalAlignment(Element.ALIGN_RIGHT);
			tot.setColspan(2);
			tab.addCell(totdisp);
			PdfPCell total=new PdfPCell(new Phrase("Total :",new Font(Font.TIMES_ROMAN,8)));
			total.setHorizontalAlignment(Element.ALIGN_RIGHT);
			tab.addCell(total);
			tab.addCell(new Phrase(""+trans(brtot[1],"","",true,true),new Font(Font.TIMES_ROMAN,8)));
			tab.addCell(new Phrase(""+trans(brtot[2],"","",true,true),new Font(Font.TIMES_ROMAN,8)));

			tab.addCell(new Phrase(""+trans(brtot[3],"","",true,true),new Font(Font.TIMES_ROMAN,8)));
			tab.addCell(new Phrase(""+trans(brtot[4],"","",true,true),new Font(Font.TIMES_ROMAN,8)));
			tab.addCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
			doc.add(tab);
			
			para = new Paragraph(new Phrase("PF SUMMERY "));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(10);
			para.setSpacingAfter(10);
			doc.add(para);

			PdfPTable tab1 = new PdfPTable(3);
			PdfPCell cell;
			tab1.setWidthPercentage(new float[]{10,20,20}, new Rectangle(50, 100));
			cell = new PdfPCell(new Phrase("Form No",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab1.addCell(cell);

			cell = new PdfPCell(new Phrase("Form Details",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab1.addCell(cell);
			cell = new PdfPCell(new Phrase("Ammount",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab1.addCell(cell);
			tab1.setHeaderRows(1);
			String formdetails[]= {"12% + 3.67% ","0.50% of Total","8.33%","0.5% of Total(Total<15000>)","0.01% of Total(Total<15000>)"};
			String formno[]=	 {"1","2","10","21","22"};
			//String amount[] = {String.valueOf(brtot[2]+brtot[3]),String.valueOf((brtot[1]/100)*0.50),String.valueOf(brtot[4]),String.valueOf(((totamt15000-amt15000)/100)*0.5),String.valueOf(((totamt15000-amt15000)/100)*0.01)};
			String amount[] = {String.valueOf(brtot[2]+brtot[3]),String.valueOf((brtot[5])),String.valueOf(brtot[4]),String.valueOf(((totamt15000-amt15000)/100)*0.5),String.valueOf(((totamt15000-amt15000)/100)*0.01)};
			for(i=0;i<5;i++) {
			cell = new PdfPCell(new Phrase(""+formno[i],new Font(Font.TIMES_ROMAN,8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab1.addCell(cell);

			cell = new PdfPCell(new Phrase(""+formdetails[i],new Font(Font.TIMES_ROMAN,8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab1.addCell(cell);
			cell = new PdfPCell(new Phrase(""+trans(Math.round(Float.parseFloat(amount[i])),"","",true,true),new Font(Font.TIMES_ROMAN,8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab1.addCell(cell);
			}
			doc.add(tab1);
			
			
			doc.close();
			Cn.close();
			return;
		}	
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	public static void EcrReport(String rdt,String filepath,String table_name)
	{

		RepoartBean repBean  = new RepoartBean();
		String[] date = rdt.split("-");
		Connection Cn = null;
		ResultSet emp = null;
		String EmpSql = "";
		int epf_total = 0;
		int eps_total = 0;
		int epf_due_total = 0;
		int eps_due_total = 0;
		int diff_due_total = 0;
		int ncp_total = 0;
		int refund_total = 0;
		SimpleDateFormat sdf1 = new SimpleDateFormat("dd-MMM-yyyy");
		SimpleDateFormat output = new SimpleDateFormat("MM/yyyy");
		table_name= table_name.equalsIgnoreCase("after")?"PAYTRAN_STAGE":"PAYTRAN";	



		try{

			Document doc = new Document();
			PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
			doc.open();
			doc.setPageSize(PageSize.A4);
			Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
			Calendar currentMonth = Calendar.getInstance();
			currentMonth.setTime(sdf1.parse(rdt));
			currentMonth.add(Calendar.MONTH, 1);

			Phrase title = new Phrase("EMPLOYEE'S PROVIDENT FUND ORGANISATION, NASHIK",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			doc.add(para);
			para = new Paragraph(new Phrase("ELECTRONIC CHALLAN CUM RETURN (ECR)",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase("FOR THE WAGE MONTH OF ("+output.format(sdf1.parse(rdt))+") AND RETURN MONTH ("+output.format(currentMonth.getTime())+")",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(5);

			doc.add(para);
			para = new Paragraph(new Phrase("ESTABLISHMENT ID                : KDNSK0051492000",new Font(Font.TIMES_ROMAN,7)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase("NAME OF ESTABLISHMENT  : THE BUSINESS CO.OP BANK LTD. 'BUILDER - CONTRACT OR'",new Font(Font.TIMES_ROMAN,7)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase("TRRN                                           : 3141501006505",new Font(Font.TIMES_ROMAN,7)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(8);

			doc.add(para);
			para = new Paragraph(new Phrase("PART A-MEMBER'S WAGE DETAILS",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(5);

			doc.add(para);

			PdfPCell cell;

			PdfPTable tab = new PdfPTable(13);

			tab.setWidthPercentage(new float[]{4,6,17,7,7,8,8,8,8,8,8,4,7}, new Rectangle(100, 100));
			tab.setSpacingBefore(5);
			tab.setHorizontalAlignment(Element.ALIGN_CENTER);

			cell = new PdfPCell(new Phrase("Sr No",new Font(Font.TIMES_ROMAN,8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);

			cell = new PdfPCell(new Phrase("Member Id",new Font(Font.TIMES_ROMAN,8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase("Member Name",new Font(Font.TIMES_ROMAN,8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase("EPF Wages",new Font(Font.TIMES_ROMAN,8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase("EPS Wages",new Font(Font.TIMES_ROMAN,8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase("EPF Contribution (EE Share) due",new Font(Font.TIMES_ROMAN,8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase("EPF Contribution (EE Share) being remitted",new Font(Font.TIMES_ROMAN,8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase("EPS Contribution due",new Font(Font.TIMES_ROMAN,8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase("EPS Contribution being remitted",new Font(Font.TIMES_ROMAN,8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase("Diff EPF and EPS Contribution (ER Share) due",new Font(Font.TIMES_ROMAN,8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase("Diff EPF and EPS Contribution (ER Share) being remitted",new Font(Font.TIMES_ROMAN,8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase("NCP Days",new Font(Font.TIMES_ROMAN,8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase("Refund of Advances",new Font(Font.TIMES_ROMAN,8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);

			tab.setHeaderRows(1);
			ReportDAO.OpenCon("", "", "",repBean);
			Cn = repBean.getCn();

			EmpSql = "select e.salute ,e.doj,e.pfno, e.empno,e.empcode,e.fname,e.mname,e.lname, " +
					"(select isnull((select cal_amt from "+table_name+" where trncd=136 and empno=e.empno and trndt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) basic," +
					"(select isnull((select cal_amt from "+table_name+" where trncd=137 and empno=e.empno and trndt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) EPSWAGES," +
					"(select isnull((select cal_amt from "+table_name+" where trncd=201 and empno=e.empno and trndt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) PF, " +
					"(select isnull((select cal_amt from "+table_name+" where trncd=231 and empno=e.empno and trndt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) EEPF, " +
					"(select isnull((select cal_amt from "+table_name+" where trncd=232 and empno=e.empno and trndt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) EEPS, " +
					"(select isnull((select cal_amt from "+table_name+" where trncd=233 and empno=e.empno and trndt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) EDLI, " +
					"(select isnull((select cal_amt from "+table_name+" where trncd=234 and empno=e.empno and trndt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) EEPFADMIN, " +
					"(select isnull((select cal_amt from "+table_name+" where trncd=235 and empno=e.empno and trndt between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) EDLIADMIN " +
					"from empmast e ,SAL_DETAILS s where s.EMPNO = e.EMPNO  and s.SAL_MONTH = '"+date[1]+"-"+date[2]+"' and e.doj <='"+ReportDAO.EOM(rdt)+"' " +
					"and  e.EMPNO in(select distinct EMPNO from "+table_name+" where TRNCD=201) order by e.empno";
			Statement st;
			st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
			emp = st.executeQuery(EmpSql);
			System.out.println(EmpSql);
			if(!emp.next()){
				cell = new PdfPCell(new Phrase("Salary hasn't been finalized for the month "+date[1]+"-"+date[2],new Font(Font.TIMES_ROMAN,12,Font.BOLD)));
				cell.setColspan(13);
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab.addCell(cell);
				doc.add(tab);
			} else {

				int count = 1;
				emp.previous();
				float ac22=0,ac21=0,ac10=0,ac02=0;
				while(emp.next()){
					if(emp.getInt("basic")<=0)
					{
						continue;
					}
					int epf_wages = emp.getInt("basic");
					int eps_wages =Math.round(emp.getFloat("EPSWAGES"));
					ac02+=Math.round(emp.getFloat("EEPFADMIN"));
					ac10+=Math.round(emp.getFloat("EEPS"));
					ac22+=Math.round(emp.getFloat("EDLIADMIN"));
					ac21+=Math.round(emp.getFloat("EDLI"));

					String []pfno = null;
					tab.addCell(new Phrase(""+count++,new Font(Font.TIMES_ROMAN,8)));
					if(emp.getString("pfno")!=null) {
						//pfno = emp.getString("pfno").split("/");
						tab.addCell(new Phrase("000"+emp.getString("pfno"),new Font(Font.TIMES_ROMAN,8)));
					} else {
						tab.addCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
					}
					if(emp.getString("MNAME").equals(null) || emp.getString("MNAME").equals(""))
					{
						tab.addCell(new Phrase(""+FixStr(emp.getString("FNAME")+" "+emp.getString("MNAME")+" "+emp.getString("LNAME"), 30, 1),new Font(Font.TIMES_ROMAN,8)));
					}
					else
					{
						tab.addCell(new Phrase(""+FixStr(emp.getString("FNAME")+" "+emp.getString("MNAME")+" "+emp.getString("LNAME"), 30, 1),new Font(Font.TIMES_ROMAN,8)));
					}

					cell = new PdfPCell(new Phrase(""+epf_wages,new Font(Font.TIMES_ROMAN,8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(cell);
					epf_total += Math.round(epf_wages); 

					float eps_cont = 0;
					float epf_cont=0;


					eps_cont = Math.round(emp.getFloat("EEPS"));

					//eps_cont = epf_wages <= 15000?Math.round(emp.getFloat("EEPS")): Math.round(15000/100*8.33);
					epf_cont=Math.round(emp.getFloat("PF"));

					cell = new PdfPCell(new Phrase(""+eps_wages,new Font(Font.TIMES_ROMAN,8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(cell);
					eps_total += eps_wages;



					epf_due_total += epf_cont;
					cell = new PdfPCell(new Phrase(""+(int)epf_cont,new Font(Font.TIMES_ROMAN,8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(cell);
					cell = new PdfPCell(new Phrase(""+(int)epf_cont,new Font(Font.TIMES_ROMAN,8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(cell);

					eps_due_total += eps_cont;
					cell = new PdfPCell(new Phrase(""+(int)eps_cont,new Font(Font.TIMES_ROMAN,8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(cell);
					cell = new PdfPCell(new Phrase(""+(int)eps_cont,new Font(Font.TIMES_ROMAN,8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(cell);

					diff_due_total += epf_cont-eps_cont;
					cell = new PdfPCell(new Phrase(""+(int)(epf_cont-eps_cont),new Font(Font.TIMES_ROMAN,8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(cell);
					cell = new PdfPCell(new Phrase(""+(int)(epf_cont-eps_cont),new Font(Font.TIMES_ROMAN,8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(cell);


					cell = new PdfPCell(new Phrase("0",new Font(Font.TIMES_ROMAN,8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(cell);
					cell = new PdfPCell(new Phrase("0",new Font(Font.TIMES_ROMAN,8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(cell);					
				}

				PdfPCell tot = new PdfPCell(new Phrase("Grand Total",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
				tot.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tot.setColspan(3);
				tab.addCell(tot);
				cell = new PdfPCell(new Phrase(""+epf_total,new Font(Font.TIMES_ROMAN,8)));
				cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(cell);
				cell = new PdfPCell(new Phrase(""+eps_total,new Font(Font.TIMES_ROMAN,8)));
				cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(cell);
				cell = new PdfPCell(new Phrase(""+epf_due_total,new Font(Font.TIMES_ROMAN,8)));
				cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(cell);
				cell = new PdfPCell(new Phrase(""+epf_due_total,new Font(Font.TIMES_ROMAN,8)));
				cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(cell);
				cell = new PdfPCell(new Phrase(""+eps_due_total,new Font(Font.TIMES_ROMAN,8)));
				cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(cell);
				cell = new PdfPCell(new Phrase(""+eps_due_total,new Font(Font.TIMES_ROMAN,8)));
				cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(cell);
				cell = new PdfPCell(new Phrase(""+diff_due_total,new Font(Font.TIMES_ROMAN,8)));
				cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(cell);
				cell = new PdfPCell(new Phrase(""+diff_due_total,new Font(Font.TIMES_ROMAN,8)));
				cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(cell);
				cell = new PdfPCell(new Phrase(""+ncp_total,new Font(Font.TIMES_ROMAN,8)));
				cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(cell);
				cell = new PdfPCell(new Phrase(""+refund_total,new Font(Font.TIMES_ROMAN,8)));
				cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(cell);
				doc.add(tab);

				PdfPTable tab1 = new PdfPTable(8);
				PdfPCell cell1;
				tab1.setWidthPercentage(new float[]{28,22,8,6,6,6,6,6}, new Rectangle(100, 100));
				tab1.setSpacingBefore(20);
				tab1.setHorizontalAlignment(Element.ALIGN_LEFT);

				cell1 = new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
				cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab1.addCell(cell1);
				cell1 = new PdfPCell(new Phrase("A/C 01 EE + Refund of Advance",new Font(Font.TIMES_ROMAN,8)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				tab1.addCell(cell1);
				cell1 = new PdfPCell(new Phrase("A/C 01 ER",new Font(Font.TIMES_ROMAN,8)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				tab1.addCell(cell1);
				cell1 = new PdfPCell(new Phrase("A/C 02",new Font(Font.TIMES_ROMAN,8)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				tab1.addCell(cell1);
				cell1 = new PdfPCell(new Phrase("A/C 10",new Font(Font.TIMES_ROMAN,8)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				tab1.addCell(cell1);
				cell1 = new PdfPCell(new Phrase("A/C 21",new Font(Font.TIMES_ROMAN,8)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				tab1.addCell(cell1);
				cell1 = new PdfPCell(new Phrase("A/C 22",new Font(Font.TIMES_ROMAN,8)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				tab1.addCell(cell1);
				cell1 = new PdfPCell(new Phrase("TOTAL",new Font(Font.TIMES_ROMAN,8)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				tab1.addCell(cell1);


				for(int i=0; i<2;i++){
					float total = 0;
					if(i==0) {
						cell1 = new PdfPCell(new Phrase("TOTAL DUES AS PER ECR",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
						tab1.addCell(cell1);
					} else {
						cell1 = new PdfPCell(new Phrase("TOTAL AMOUNT BEING REMITTED",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
						tab1.addCell(cell1);
					}
					cell1 = new PdfPCell(new Phrase(""+epf_due_total,new Font(Font.TIMES_ROMAN,8)));
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab1.addCell(cell1);
					cell1 = new PdfPCell(new Phrase(""+diff_due_total,new Font(Font.TIMES_ROMAN,8)));
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab1.addCell(cell1);
					//ac02 = Math.round(epf_total*1.1/100);//epfadmin chrg
					cell1 = new PdfPCell(new Phrase(""+(int)ac02,new Font(Font.TIMES_ROMAN,8)));
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab1.addCell(cell1);
					cell1 = new PdfPCell(new Phrase(""+(int)ac10,new Font(Font.TIMES_ROMAN,8))); //EPS 
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab1.addCell(cell1);
					// ac21 = Math.round(eps_total*0.50/100); //edli
					cell1 = new PdfPCell(new Phrase(""+(int)ac21,new Font(Font.TIMES_ROMAN,8)));
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab1.addCell(cell1);
					// ac22 = Math.round(eps_total*0.01/100);// edli admin
					if(ac22<200)
					{
						ac22=200;
					}
					cell1 = new PdfPCell(new Phrase(""+(int)ac22,new Font(Font.TIMES_ROMAN,8)));
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab1.addCell(cell1);
					total = epf_due_total+diff_due_total+ac02+eps_due_total+ac21+ac22;
					cell1 = new PdfPCell(new Phrase(""+(int)total,new Font(Font.TIMES_ROMAN,8)));
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab1.addCell(cell1);	
				}
				doc.add(tab1);
				para = new Paragraph(new Phrase("PART B-NEW MEMBER'S DETAILS",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingBefore(15);
				para.setSpacingAfter(10);
				doc.add(para);

				PdfPTable tab2 = new PdfPTable(9);
				PdfPCell cell2;
				tab2.setWidthPercentage(new float[]{4,7,20,14,15,10,8,11,11}, new Rectangle(100, 100));
				tab2.setSpacingAfter(20);
				tab2.setHorizontalAlignment(Element.ALIGN_LEFT);

				cell2 = new PdfPCell(new Phrase("Sr No",new Font(Font.TIMES_ROMAN,8)));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab2.addCell(cell2);
				cell2 = new PdfPCell(new Phrase("Member Id",new Font(Font.TIMES_ROMAN,8)));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab2.addCell(cell2);
				cell2 = new PdfPCell(new Phrase("Member Name",new Font(Font.TIMES_ROMAN,8)));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab2.addCell(cell2);
				cell2 = new PdfPCell(new Phrase("Father's/Spouse Name",new Font(Font.TIMES_ROMAN,8)));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab2.addCell(cell2);
				cell2 = new PdfPCell(new Phrase("Relationship with the Member",new Font(Font.TIMES_ROMAN,8)));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab2.addCell(cell2);
				cell2 = new PdfPCell(new Phrase("Date of Birth",new Font(Font.TIMES_ROMAN,8)));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab2.addCell(cell2);
				cell2 = new PdfPCell(new Phrase("Gender",new Font(Font.TIMES_ROMAN,8)));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab2.addCell(cell2);
				cell2 = new PdfPCell(new Phrase("Date of Joining EPF",new Font(Font.TIMES_ROMAN,8)));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab2.addCell(cell2);
				cell2 = new PdfPCell(new Phrase("Date of Joining EPS",new Font(Font.TIMES_ROMAN,8)));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab2.addCell(cell2);
				tab2.setHeaderRows(1);

				String EmpSql1 = "select e.salute ,e.dob,e.gender,e.pfno, e.empno,e.empcode,e.fname,e.mname,e.lname " +
						"from empmast e where e.status = 'A' and e.doj between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"' order by e.empno";
				Statement st1;
				st1 = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
				ResultSet emp1 = st1.executeQuery(EmpSql1);
				if(!emp1.next()){
					cell = new PdfPCell(new Phrase(" -- NIL -- ",new Font(Font.TIMES_ROMAN,8)));
					cell.setColspan(9);
					cell.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab2.addCell(cell);
				}
				SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
				SimpleDateFormat sdf2 = new SimpleDateFormat("dd-MMM-yyyy");
				SimpleDateFormat format = new SimpleDateFormat("dd-MM-yyyy");
				int count1 = 1;
				emp1.previous();

				while(emp1.next()){

					tab2.addCell(new Phrase(""+count1++,new Font(Font.TIMES_ROMAN,8)));
					String []pfno = null;
					if(!emp1.getString("pfno").equals("") ) {
						//pfno = emp1.getString("pfno").split("/");
						tab2.addCell(new Phrase("0"+emp1.getString("pfno"),new Font(Font.TIMES_ROMAN,8)));
					} else {
						tab2.addCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
					}

					if(emp1.getString("MNAME").equals(null) || emp1.getString("MNAME").equals(""))
					{
						tab2.addCell(new Phrase(""+FixStr(emp1.getString("FNAME")+" "+emp1.getString("MNAME")+" "+emp1.getString("LNAME"), 30, 1),new Font(Font.TIMES_ROMAN,8)));
					}
					else
					{
						tab2.addCell(new Phrase(""+FixStr(emp1.getString("FNAME")+" "+emp1.getString("MNAME")+" "+emp1.getString("LNAME"), 30, 1),new Font(Font.TIMES_ROMAN,8)));
					}

					cell = new PdfPCell(new Phrase(""+emp1.getString("MNAME"),new Font(Font.TIMES_ROMAN,8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab2.addCell(cell);
					if(!emp1.getString("MNAME").equals("")){
						cell = new PdfPCell(new Phrase("Father",new Font(Font.TIMES_ROMAN,8)));
					} else {
						cell = new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
					}
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab2.addCell(cell);
					Date dob = sdf.parse(emp1.getString("dob"));
					cell = new PdfPCell(new Phrase(""+format.format(dob),new Font(Font.TIMES_ROMAN,8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab2.addCell(cell);
					if(emp1.getString("gender").contains("M")){
						cell = new PdfPCell(new Phrase("Male",new Font(Font.TIMES_ROMAN,8)));
					} else {
						cell = new PdfPCell(new Phrase("Female",new Font(Font.TIMES_ROMAN,8)));
					}
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab2.addCell(cell);
					cell = new PdfPCell(new Phrase(""+format.format(sdf2.parse(ReportDAO.BOM(rdt))),new Font(Font.TIMES_ROMAN,8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab2.addCell(cell);
					cell = new PdfPCell(new Phrase(""+format.format(sdf2.parse(ReportDAO.BOM(rdt))),new Font(Font.TIMES_ROMAN,8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab2.addCell(cell);

				}
				doc.add(tab2);

				para = new Paragraph(new Phrase("PART C-EXITING MEMBER'S DETAILS",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingBefore(15);
				para.setSpacingAfter(10);
				doc.add(para);

				PdfPTable tab4 = new PdfPTable(10);
				PdfPCell cell4;
				tab4.setWidthPercentage(new float[]{4,6,19,13,12,9,7,9,9,12}, new Rectangle(100, 100));
				tab4.setSpacingAfter(20);
				tab4.setHorizontalAlignment(Element.ALIGN_LEFT);

				cell4 = new PdfPCell(new Phrase("Sr No",new Font(Font.TIMES_ROMAN,8)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab4.addCell(cell4);
				cell4 = new PdfPCell(new Phrase("Member Id",new Font(Font.TIMES_ROMAN,8)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab4.addCell(cell4);
				cell4 = new PdfPCell(new Phrase("Member Name",new Font(Font.TIMES_ROMAN,8)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab4.addCell(cell4);
				cell4 = new PdfPCell(new Phrase("Father's/Spouse Name",new Font(Font.TIMES_ROMAN,8)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab4.addCell(cell4);
				cell4 = new PdfPCell(new Phrase("Relationship with the Member",new Font(Font.TIMES_ROMAN,8)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab4.addCell(cell4);
				cell4 = new PdfPCell(new Phrase("Date of Birth",new Font(Font.TIMES_ROMAN,8)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab4.addCell(cell4);
				cell4 = new PdfPCell(new Phrase("Gender",new Font(Font.TIMES_ROMAN,8)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab4.addCell(cell4);
				cell4 = new PdfPCell(new Phrase("Date of Exit from EPF",new Font(Font.TIMES_ROMAN,8)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab4.addCell(cell4);
				cell4 = new PdfPCell(new Phrase("Date of Exit from EPS",new Font(Font.TIMES_ROMAN,8)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab4.addCell(cell4);
				cell4 = new PdfPCell(new Phrase("Reason for leaving",new Font(Font.TIMES_ROMAN,8)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab4.addCell(cell4);
				tab4.setHeaderRows(1);

				String EmpSql2 = "select e.salute ,e.dob,e.pfno,e.dol,e.gender, e.empno,e.empcode,e.fname,e.mname,e.lname " +
						"from empmast e where e.dol between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"' order by e.empno";
				Statement st2;
				st2 = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
				ResultSet emp2 = st2.executeQuery(EmpSql2);
				if(!emp2.next()){
					cell = new PdfPCell(new Phrase(" -- NIL -- ",new Font(Font.TIMES_ROMAN,8)));
					cell.setColspan(10);
					cell.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab4.addCell(cell);
				}
				int count2 = 1;
				emp2.previous();

				while(emp2.next()){

					tab4.addCell(new Phrase(""+count2++,new Font(Font.TIMES_ROMAN,8)));
					String []pfno = null;
					if(!emp2.getString("pfno").equals("") ) {
						pfno = emp2.getString("pfno").split("/");
						tab4.addCell(new Phrase("000"+pfno[3],new Font(Font.TIMES_ROMAN,8)));
					} else {
						tab4.addCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
					}			
					if(emp2.getString("MNAME").equals(null) || emp2.getString("MNAME").equals(""))
					{
						tab4.addCell(new Phrase(""+FixStr(emp2.getString("FNAME")+" "+emp2.getString("MNAME")+" "+emp2.getString("LNAME"), 30, 1),new Font(Font.TIMES_ROMAN,8)));
					}
					else
					{
						tab4.addCell(new Phrase(""+FixStr(emp2.getString("FNAME")+" "+emp2.getString("MNAME")+" "+emp2.getString("LNAME"), 30, 1),new Font(Font.TIMES_ROMAN,8)));
					}

					cell = new PdfPCell(new Phrase(""+emp2.getString("MNAME"),new Font(Font.TIMES_ROMAN,8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab4.addCell(cell);
					if(!emp2.getString("MNAME").equals("")){
						cell = new PdfPCell(new Phrase("Father",new Font(Font.TIMES_ROMAN,8)));
					} else {
						cell = new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
					}
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab4.addCell(cell);
					Date dob = sdf.parse(emp2.getString("dob"));
					cell = new PdfPCell(new Phrase(""+format.format(dob),new Font(Font.TIMES_ROMAN,8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab4.addCell(cell);
					if(emp2.getString("gender").contains("M")){
						cell = new PdfPCell(new Phrase("Male",new Font(Font.TIMES_ROMAN,8)));
					} else {
						cell = new PdfPCell(new Phrase("Female",new Font(Font.TIMES_ROMAN,8)));
					}
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab4.addCell(cell);
					Date dol = sdf.parse(emp2.getString("dol"));
					cell = new PdfPCell(new Phrase(""+format.format(dol),new Font(Font.TIMES_ROMAN,8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab4.addCell(cell);
					cell = new PdfPCell(new Phrase(""+format.format(dol),new Font(Font.TIMES_ROMAN,8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab4.addCell(cell);
					cell = new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab4.addCell(cell);

				}
				doc.add(tab4);

				para = new Paragraph(new Phrase("PART D-MEMBER'S ARREAR DETAILS",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingBefore(15);
				para.setSpacingAfter(10);
				doc.add(para);

				PdfPTable tab3 = new PdfPTable(8);
				PdfPCell cell3;
				tab3.setWidthPercentage(new float[]{28,22,8,6,6,6,6,6}, new Rectangle(100, 100));
				tab3.setHorizontalAlignment(Element.ALIGN_LEFT);

				cell3 = new PdfPCell(new Phrase(" -- NIL -- ",new Font(Font.TIMES_ROMAN,8)));
				cell3.setColspan(8);
				cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab3.addCell(cell3);
				doc.add(tab3);
			}
			doc.close();
			Cn.close();
		}	
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}

	public static void BankStatement(String dt,String imgpath,String filepath)
	{
		RepoartBean repBean  = new RepoartBean();
	Connection con =null;
	try
	{
		ReportDAO.OpenCon("", "", "",repBean);
		con = repBean.getCn();	

		SimpleDateFormat sdf=new SimpleDateFormat("dd-MMM-yyyy");
		Date date=sdf.parse(dt);
		String stmntdt=dt;

		Document doc = new Document();
		PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
		doc.open();
		doc.setPageSize(PageSize.A4);

		Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
		ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);



		Image image1 = Image.getInstance(imgpath);


		Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
		Paragraph para = new Paragraph(title);
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingBefore(0);

		image1.scaleAbsolute(80f, 80f);
		image1.setAbsolutePosition(40f, 730f);

		doc.add(image1);
		doc.add(para);


		para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingAfter(0);

		doc.add(para);
		para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingAfter(0);

		doc.add(para);
		para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingAfter(0);

		doc.add(para);
		para = new Paragraph(new Phrase("Banks Statement For The Month of - "+stmntdt.substring(3),new Font(Font.TIMES_ROMAN,10)));
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingAfter(0);

		doc.add(para);
		Rectangle rec = new  Rectangle(100,100);
		//PdfPTable maintab = new PdfPTable(1);
		//maintab.setSpacingBefore(10);
		PdfPCell cell = new PdfPCell();

		PdfPTable headtab = new PdfPTable(5);
		headtab.setSpacingBefore(10);
		headtab.setWidthPercentage(new float[]{7,35,20,20,18}, rec);
		headtab.setHorizontalAlignment(Element.ALIGN_LEFT);

		PdfPCell c1 = new PdfPCell(new Phrase("Sr.No",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));  
		headtab.addCell(c1);
		PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
		headtab.addCell(c2);
		PdfPCell c3 = new PdfPCell(new Phrase("Account No.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
		headtab.addCell(c3);
		PdfPCell c4 = new PdfPCell(new Phrase("I.F.S.C Code.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
		headtab.addCell(c4);
		PdfPCell c5 = new PdfPCell(new Phrase("Payable Amount",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
		headtab.addCell(c5);

		doc.add(headtab);
		// cell.addElement(headtab);
		// maintab.addCell(cell);

		/* sdf=new SimpleDateFormat("yyyy-MM-dd");
		 dt=sdf.format(date);*/

		PdfPCell subcell2; 
		ArrayList<BankStmntBean> bslist = BankStmntHandler.getBankStmntlist(dt, con);
		LookupHandler lkh=new LookupHandler();
		int i=2;
		String bname="";
		int j=0;
		float total=0;
		boolean flag=false;
		float bnks_total=0;
		for(BankStmntBean bsb : bslist)
		{




			PdfPCell datacell = new PdfPCell();

			if(i==2)
			{
				j=1;
				PdfPCell datacell1 = new PdfPCell();
				bname = bsb.getBANK_NAME();

				PdfPTable banktab = new PdfPTable(5);
				banktab.setWidthPercentage(new float[]{7,35,20,20,18}, rec);
				banktab.setHorizontalAlignment(Element.ALIGN_LEFT);

				subcell2 = new PdfPCell(new Phrase(""+lkh.getLKP_Desc("BANK", Integer.parseInt(bsb.getBANK_NAME())),new Font(Font.TIMES_ROMAN,6,Font.BOLD)));
				subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
				subcell2.setColspan(5);
				banktab.addCell(subcell2);
				doc.add(banktab);
				//datacell1.addElement(banktab);

				// maintab.addCell(datacell1);


			}
			if(bname.equalsIgnoreCase(bsb.getBANK_NAME()))
			{
				bname = bsb.getBANK_NAME();
				PdfPTable datatab = new PdfPTable(5);

				datatab.setWidthPercentage(new float[]{7,35,20,20,18}, rec);
				datatab.setHorizontalAlignment(Element.ALIGN_LEFT); 

				PdfPCell cell1 = new PdfPCell(new Phrase(""+j,new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));  
				datatab.addCell(cell1);
				PdfPCell cell2 = new PdfPCell(new Phrase(""+bsb.getEMPNAME(),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
				datatab.addCell(cell2);
				PdfPCell cell3 = new PdfPCell(new Phrase(""+bsb.getACCNO(),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
				datatab.addCell(cell3);
				PdfPCell cell4 = new PdfPCell(new Phrase(""+bsb.getIFSCCODE(),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
				datatab.addCell(cell4);
				PdfPCell cell5 = new PdfPCell(new Phrase(""+trans((int)Float.parseFloat(bsb.getNETPAY()), "", "", false, false),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
				datatab.addCell(cell5);
				doc.add(datatab);
				// datacell.addElement(datatab);
				total=total+Float.parseFloat(bsb.getNETPAY());

				j++;

			}
			else
			{


				PdfPTable totaltab = new PdfPTable(5);
				totaltab.setWidthPercentage(new float[]{7,35,20,20,18}, rec);
				PdfPCell cell1 = new PdfPCell(new Phrase("",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
				totaltab.addCell(cell1);


				PdfPCell cell2 = new PdfPCell(new Phrase(lkh.getLKP_Desc("BANK", Integer.parseInt(bname))+" Total (Rs.)=>",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));  
				cell2.setColspan(3);
				cell2.setHorizontalAlignment(Element.ALIGN_RIGHT);
				totaltab.addCell(cell2);
				PdfPCell cell3 = new PdfPCell(new Phrase(""+trans((int)total, "", "", false, false),new Font(FONT.TIMES_ROMAN,8,Font.BOLD))); 
				totaltab.addCell(cell3);
				doc.add(totaltab);
				//datacell.addElement(totaltab);

				bnks_total=bnks_total+total;

				PdfPTable banktab = new PdfPTable(5);
				banktab.setWidthPercentage(new float[]{7,35,20,20,18}, rec);
				banktab.setHorizontalAlignment(Element.ALIGN_LEFT);

				subcell2 = new PdfPCell(new Phrase(""+lkh.getLKP_Desc("BANK", Integer.parseInt(bsb.getBANK_NAME())),new Font(Font.TIMES_ROMAN,6,Font.BOLD)));
				subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
				subcell2.setColspan(5);
				banktab.addCell(subcell2);
				doc.add(banktab);

				//datacell.addElement(banktab);
				flag=true;

				total=0;
				//bname = bsb.getBANK_NAME();
			}
			if(!(bname.equalsIgnoreCase(bsb.getBANK_NAME())))
			{    
				j=1;
				PdfPTable datatab = new PdfPTable(5);

				datatab.setWidthPercentage(new float[]{7,35,20,20,18}, rec);
				datatab.setHorizontalAlignment(Element.ALIGN_LEFT); 

				PdfPCell cell1 = new PdfPCell(new Phrase(""+j,new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));  
				datatab.addCell(cell1);
				PdfPCell cell2 = new PdfPCell(new Phrase(""+bsb.getEMPNAME(),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
				datatab.addCell(cell2);
				PdfPCell cell3 = new PdfPCell(new Phrase(""+bsb.getACCNO(),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
				datatab.addCell(cell3);
				PdfPCell cell4 = new PdfPCell(new Phrase(""+bsb.getIFSCCODE(),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
				datatab.addCell(cell4);
				PdfPCell cell5 = new PdfPCell(new Phrase(""+trans((int)Float.parseFloat(bsb.getNETPAY()), "", "", false, false),new Font(FONT.TIMES_ROMAN,8,Font.NORMAL)));
				datatab.addCell(cell5);

				doc.add(datatab);
				//datacell.addElement(datatab);
				total=total+Float.parseFloat(bsb.getNETPAY());
				// flag=true;
				bname = bsb.getBANK_NAME();
				j++;
			}

			i++;


			//maintab.addCell(datacell);

		}
		if(flag==true)
		{
			PdfPCell datacell = new PdfPCell();
			PdfPTable totaltab = new PdfPTable(5);
			totaltab.setWidthPercentage(new float[]{7,35,20,20,18}, rec);
			PdfPCell cell1 = new PdfPCell(new Phrase("",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
			totaltab.addCell(cell1);


			PdfPCell cell2 = new PdfPCell(new Phrase(lkh.getLKP_Desc("BANK", Integer.parseInt(bname))+" Total (Rs.)=>",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));  
			cell2.setColspan(3);
			cell2.setHorizontalAlignment(Element.ALIGN_RIGHT);
			totaltab.addCell(cell2);
			PdfPCell cell3 = new PdfPCell(new Phrase(""+trans((int)total, "", "", false, false),new Font(FONT.TIMES_ROMAN,8,Font.BOLD))); 
			totaltab.addCell(cell3);
			doc.add(totaltab);
			//datacell.addElement(totaltab);

			bnks_total=bnks_total+total;
			total=0;
			// total=total+Float.parseFloat(bsb.getNETPAY());
			//   maintab.addCell(datacell);
		}
		PdfPCell datacell = new PdfPCell();
		PdfPTable totaltab = new PdfPTable(5);
		totaltab.setWidthPercentage(new float[]{7,35,20,20,18}, rec);
		PdfPCell cell1 = new PdfPCell(new Phrase("",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));
		totaltab.addCell(cell1);

		bnks_total=bnks_total+total;
		PdfPCell cell2 = new PdfPCell(new Phrase(" All BANKS Total  (Rs.)=>",new Font(FONT.TIMES_ROMAN,8,Font.BOLD)));  
		cell2.setColspan(3);
		cell2.setHorizontalAlignment(Element.ALIGN_RIGHT);
		totaltab.addCell(cell2);
		PdfPCell cell3 = new PdfPCell(new Phrase(""+trans((int)bnks_total, "", "", false, false),new Font(FONT.TIMES_ROMAN,8,Font.BOLD))); 
		totaltab.addCell(cell3);
		doc.add(totaltab);
		//datacell.addElement(totaltab);

		// total=total+Float.parseFloat(bsb.getNETPAY());
		//maintab.addCell(datacell);

		//doc.add(maintab);

		con.close();
		doc.close();
	}catch(Exception e)
	{
		e.printStackTrace();
	}
	finally
	{

	}
}

	public static void newpayreg(String PAYREGDT,String TName,String imgpath,String filepath,String type)
	{
		System.out.println("in new pay regdao");

		RepoartBean repBean  = new RepoartBean();
		UtilityDAO dao = new UtilityDAO();
		Connection con =null;
		String BomDt = "";
		String EomDt = "";
		int lastdat = 0;
		//String dt = PAYREGDT;
		String table_name = null;
		/*if(TName.equals("before") )
		{
		table_name = "PAYTRAN";
		lable1="Before Finalize";
		}
		else if(TName.equals("after") )
		{
			table_name="YTDTRAN";
			lable1="Final After Release";
		}
		else
		{
			table_name="PAYTRAN_STAGE";
			lable1="Pending for Release";
		}*/
		//System.out.println(dt);
		lastdat = (int) Calculate.getDays(PAYREGDT);
		System.out.println("maxdt"+lastdat);
		BomDt = ReportDAO.BOM(PAYREGDT);
		//System.out.println("bomdt "+BomDt);
		EomDt = ReportDAO.EOM(PAYREGDT);
		//System.out.println("eomdt"+EomDt);

		String temp = PAYREGDT.substring(3);
		ResultSet emp = null;
		String EmpSql = ""; 
		String pBrcd1 = "";
		int tot_no_emp = 0;
		int br_tot_no_emp = 0;
		float totmthsal1 = 0.0f;
		float totearning1 = 0.0f;
		float totearning2 = 0.0f;
		float totactualpay = 0.0f;
		float totmobded = 0.0f;
		float totadvanc = 0.0f;
		float totloan = 0.0f;
		float tottds = 0.0f;


		try
		{

			if(type.equalsIgnoreCase("G")){
				ReportDAO.OpenCon("", "", "",repBean);
				con = repBean.getCn();	
				Statement st = con.createStatement();

				Document doc = new Document(new Rectangle(900,500));

				PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
				Footer ftr = dao.new Footer(lable1);
				writer.setPageEvent(ftr);
				doc.open();


				Font FONT = new Font(Font.HELVETICA, 30, Font.NORMAL, new GrayColor(0.75f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 450f, 230, 45);



				Image image1 = Image.getInstance(imgpath);


				Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);

				image1.scaleAbsolute(90f, 50f);
				image1.setAbsolutePosition(50f, 405f);

				doc.add(image1);
				doc.add(para);


				para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);

				Font f = new Font(Font.HELVETICA,8);
				Font f1 = new Font(Font.HELVETICA,7);

				para = new Paragraph(new Phrase("Salary Sheet For The Month Of :- "+temp,new Font(Font.TIMES_ROMAN,10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);



				Rectangle rec = new  Rectangle(650,100);

				PdfPTable main = new PdfPTable(11);
				main.setSpacingBefore(10);
				//main.setWidthPercentage(new float[]{35,57,40,30,23,20,25,25,25,30,25,20,20,30,30,30,30,170}, rec);
				main.setWidthPercentage(new float[]{30,99,59,59,59,59,59,59,49,49,60}, rec);
				PdfPCell maincell ;

				maincell = new PdfPCell(new Phrase("Emp code",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Emp Name",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("C.T.C",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("L.O.P Days",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Earning 1",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Earning 2",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Mobile Deduction",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Advance Given",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Loan",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("TDS",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("NET PAY",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				main.setHeaderRows(1);




				//EmpSql = "select distinct p.empno,e.empcode from "+table_name+" p right join EMPMAST e on e.EMPNO = p.EMPNO where TRNDT BETWEEN '" + BomDt + "' AND '" + EomDt + "' order by p.EMPNO";
				EmpSql = "select distinct p.empno,CONVERT(INT, e.empcode) as empcode,t.PRJ_SRNO,t.PRJ_CODE from paytran p right join EMPMAST e on e.EMPNO = p.EMPNO join EMPTRAN t on p.EMPNO = t.EMPNO where TRNDT BETWEEN '" + BomDt + "' AND '" + EomDt + "' and e.STATUS = 'A'" +
						"and T.EFFDATE = (SELECT E2.EFFDATE FROM EMPTRAN E2 WHERE E2.EMPNO = e.EMPNO AND E2.EFFDATE <= '"+ReportDAO.EOM(PAYREGDT)+"' and E2.srno=(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e.EMPNO AND E2.EFFDATE <= '"+ReportDAO.EOM(PAYREGDT)+"')) order by t.PRJ_CODE,empcode";
				System.out.println(EmpSql);
				emp = st.executeQuery(EmpSql);


				List<Integer> results = new ArrayList<Integer>();

				while (emp.next()) {

					results.add(emp.getInt("empno"));
					//System.out.println(emp.getInt("empno"));
				}


				for(int empp:results)
				{

					EmpSql = "select empmast.EMPCODE ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as  name, doj,t.PRJ_CODE,t.PRJ_SRNO, " +
							"(select inp_AMT from  paytran  where trncd = 199 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp+") ctc, " +
							"(select cal_amt from  paytran  where trncd = 301 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp+") abs_cnt," +
							"(select net_amt as earning1 from  paytran  where trncd = 130 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp+") earning1," +
							"(select net_amt as earning2 from  paytran  where trncd = 131 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp+")earning2," +
							"(select net_amt as mobded from  paytran  where trncd = 223 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp+")mobded," +
							"(select net_amt as added from  paytran  where trncd = 225 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp+")added," +
							"(select net_amt as loan from  paytran  where trncd = 227 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp+")loan," +
							"(select net_amt as tds from  paytran  where trncd = 228 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp+")tds," +
							"(select net_amt as payable from  paytran  where trncd = 999 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp+")payable " +
							"from empmast,EMPTRAN t,paytran p1  where empmast.empno="+empp+" and t.empno = "+empp+"  and p1.trndt  BETWEEN '"+BomDt+"'and '"+EomDt+"' and p1.empno="+empp+" " +
							"  UNION  " +
							"select empmast.EMPCODE ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as  name, doj,t.PRJ_CODE,t.PRJ_SRNO, " +
							"(select inp_AMT from   paytran_stage   where trncd = 199 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp+") ctc, " +
							"(select cal_amt from   paytran_stage   where trncd = 301 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp+") abs_cnt," +
							"(select net_amt as earning1 from   paytran_stage   where trncd = 130 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp+") earning1," +
							"(select net_amt as earning2 from   paytran_stage   where trncd = 131 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp+")earning2," +
							"(select net_amt as mobded from   paytran_stage   where trncd = 223 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp+")mobded," +
							"(select net_amt as added from   paytran_stage   where trncd = 225 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp+")added," +
							"(select net_amt as loan from   paytran_stage   where trncd = 227 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp+")loan," +
							"(select net_amt as tds from   paytran_stage   where trncd = 228 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp+")tds," +
							"(select net_amt as payable from   paytran_stage   where trncd = 999 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp+")payable " +
							"from empmast,EMPTRAN t ,paytran_stage p1 where empmast.empno="+empp+" and t.empno = "+empp+" and p1.trndt   BETWEEN '"+BomDt+"'and '"+EomDt+"' and p1.empno="+empp+""; 
					System.out.println(EmpSql);
					//System.out.println(empp);
					emp = st.executeQuery(EmpSql);

					while (emp.next())
					{
						maincell = new PdfPCell(new Phrase(""+emp.getString("empcode"),f));
						maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
						main.addCell(maincell);

						maincell = new PdfPCell(new Phrase(""+emp.getString("name"),f));
						maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
						main.addCell(maincell);

						float mthsal = 0.0f;
						float absent = 0.0f;

						/*EmpSql="select inp_AMT from "+table_name+" where trncd = 199 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp;
					emp = st.executeQuery(EmpSql);
					//System.out.println(EmpSql);
					while(emp.next()){
						mthsal = emp.getFloat("inp_AMT");

						//System.out.println("mth salary "+emp.getString("inp_AMT"));
					}*/
						mthsal = emp.getFloat("ctc");
						if(mthsal == 0){
							mthsal=0;

							//mthsal = 0.0f;
						}
						else {

							totmthsal1=totmthsal1+mthsal; 
						}
						//ctc
						maincell = new PdfPCell(new Phrase(""+mthsal,f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						/*EmpSql = "select cal_amt from "+table_name+" where trncd = 301 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp;
					emp = st.executeQuery(EmpSql);
					if(emp.next()){

						absent = emp.getFloat("cal_AMT");
					}*/
						absent = emp.getFloat("abs_cnt");
						//L.O.P days
						maincell = new PdfPCell(new Phrase(""+absent,f));
						maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
						main.addCell(maincell);

						float ear1 = 0.0f;
						/*EmpSql="select net_amt as earning1 from "+table_name+" where trncd = 130 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp;
					//System.out.println(EmpSql);
					emp = st.executeQuery(EmpSql);
					while(emp.next()){
						ear1 = emp.getFloat("earning1");

						//System.out.println("earning1"+emp.getString("earning1"));
					}*/
						ear1 = emp.getFloat("earning1");
						if(ear1 == 0.0){
							ear1=0;

						}
						else {
							//earning1 = ear1;
							totearning1 = totearning1+ear1;
						}

						//earning 1
						maincell = new PdfPCell(new Phrase(""+ear1,f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float ear2 = 0.0f;
						/*EmpSql="select net_amt as earning2 from "+table_name+" where trncd = 131 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp;
					//System.out.println(EmpSql);
					emp = st.executeQuery(EmpSql);
					while(emp.next()){
						ear2 = emp.getFloat("earning2");

						//System.out.println("earning2"+emp.getString("earning2"));
					}*/
						ear2 = emp.getFloat("earning2");
						if(ear2 == 0.0){
							ear2=0;

						}
						else {

							totearning2 = totearning2+ear2;
						}

						//earning 2
						maincell = new PdfPCell(new Phrase(""+ear2,f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float mobded = 0.0f;
						/*EmpSql="select net_amt as mobded from "+table_name+" where trncd = 223 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp;
					//System.out.println(EmpSql);
					emp = st.executeQuery(EmpSql);
					while(emp.next()){
						mobded = emp.getFloat("mobded");

						//System.out.println("mobded"+emp.getString("mobded"));
					}*/
						mobded = emp.getFloat("mobded");
						if(mobded == 0.0){
							mobded=0;

						}
						else {

							totmobded = totmobded+mobded;
						}

						//mobile ded
						maincell = new PdfPCell(new Phrase(""+mobded,f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float advanc = 0.0f;
						/*EmpSql="select net_amt as added from "+table_name+" where trncd = 225 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp;
					//System.out.println(EmpSql);
					emp = st.executeQuery(EmpSql);
					while(emp.next()){
						advanc = emp.getFloat("added");

						//System.out.println("advance"+emp.getString("added"));
					}*/
						advanc = emp.getFloat("added");
						if(advanc == 0.0){
							advanc=0;

						}
						else {

							totadvanc = totadvanc+advanc;
						}

						//advance given
						maincell = new PdfPCell(new Phrase(""+advanc,f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float loan = 0.0f;
						/*EmpSql="select net_amt as loan from "+table_name+" where trncd = 227 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp;
					//System.out.println(EmpSql);
					emp = st.executeQuery(EmpSql);
					while(emp.next()){
						loan = emp.getFloat("loan");

						//System.out.println("loan "+emp.getString("loan"));
					}*/
						loan = emp.getFloat("loan");
						if(loan == 0.0){
							loan=0;

						}
						else {

							totloan = totloan+loan;
						}

						//loan
						maincell = new PdfPCell(new Phrase(""+loan,f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float tds = 0.0f;
						/*EmpSql="select net_amt as tds from "+table_name+" where trncd = 228 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp;
					//System.out.println(EmpSql);
					emp = st.executeQuery(EmpSql);
					while(emp.next()){
						tds = emp.getFloat("tds");

						//System.out.println("tds "+emp.getString("tds"));
					}*/
						tds = emp.getFloat("tds");
						if(tds == 0.0){
							tds=0;

						}
						else {

							tottds = tottds+tds;
						}

						//tds
						maincell = new PdfPCell(new Phrase(""+tds,f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);


						int payable = 0;
						/*EmpSql="select net_amt as payable from "+table_name+" where trncd = 999 and TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' and empno="+empp;
					emp = st.executeQuery(EmpSql);
					//System.out.println(""+EmpSql);
					while(emp.next()){
						payable = emp.getInt("payable");

					//System.out.println("payable "+emp.getString("payable"));
					}*/
						payable = emp.getInt("payable");
						if(payable == 0){
							payable = 0;
						}
						else {

							totactualpay=totactualpay+payable;

						}
						//actual pay
						maincell = new PdfPCell(new Phrase(""+payable,f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

					}

				}

				NumberFormat format = com.ibm.icu.text.NumberFormat.getCurrencyInstance(new Locale("en", "in"));
				String totpay = format.format(totmthsal1).substring(4);
				String eard1 = format.format(totearning1).substring(4);
				String eard2 = format.format(totearning2).substring(4);
				String totnetpay = format.format(totactualpay).substring(4);
				String tomobded = format.format(totmobded).substring(4);
				String toadv= format.format(totadvanc).substring(4);
				String toloan= format.format(totloan).substring(4);
				String totds= format.format(tottds).substring(4);

				maincell = new PdfPCell(new Phrase("TOTAL PAY",f));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				maincell.setColspan(2);
				main.addCell(maincell);
				//totctc
				maincell = new PdfPCell(new Phrase(""+totpay,f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				//totlop
				maincell = new PdfPCell(new Phrase("",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				//totear1
				maincell = new PdfPCell(new Phrase(""+eard1,f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				//totear2
				maincell = new PdfPCell(new Phrase(""+eard2,f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				//totmobileded
				maincell = new PdfPCell(new Phrase(""+tomobded,f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				//totadvancegiven
				maincell = new PdfPCell(new Phrase(""+toadv,f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				//totloan
				maincell = new PdfPCell(new Phrase(""+toloan,f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				//tottds
				maincell = new PdfPCell(new Phrase(""+totds,f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				//totnetpay
				maincell = new PdfPCell(new Phrase(""+totnetpay,f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				doc.add(main);
				st.close();
				con.close();
				doc.close();
			}

			else if(type.equalsIgnoreCase("I")){
				ReportDAO.OpenCon("", "", "",repBean);
				con = repBean.getCn();	
				Statement st = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
						ResultSet.CONCUR_READ_ONLY);


				System.out.println("in income head");
				Document doc = new Document(new Rectangle(2384,3370));
				PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
				Footer1 ftr = dao.new Footer1(lable1);
				writer.setPageEvent(ftr);
				doc.open();
				Font FONT = new Font(Font.HELVETICA,190, Font.NORMAL, new GrayColor(0.85f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 1300f, 1830f, 45);			
				Image image1 = Image.getInstance(imgpath);		
				Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,38,Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				image1.scaleAbsolute(310f, 120f);
				image1.setAbsolutePosition(60f, 3200f);
				doc.add(image1);
				doc.add(para);
				para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,28)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,28)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,28)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);

				Font f = new Font(Font.HELVETICA,23);
				Font f1 = new Font(Font.HELVETICA,20);
				/*if(TName.equalsIgnoreCase("after"))
				para = new Paragraph(new Phrase("Salary Sheet For The Income Heads for the Month Of :- "+temp,new Font(Font.TIMES_ROMAN,25)));
			else if(TName.equalsIgnoreCase("before"))
				para = new Paragraph(new Phrase("Salary Sheet For The Income Heads for the Month Of :- "+temp+" (Before Finalize)",new Font(Font.TIMES_ROMAN,25)));
			else
				 */	para = new Paragraph(new Phrase("Salary Sheet For The Income Heads for the Month Of :- "+temp+" (Pending for Release)",new Font(Font.TIMES_ROMAN,25)));

				 para.setAlignment(Element.ALIGN_CENTER);
				 para.setSpacingAfter(10);

				 doc.add(para);

				 Rectangle rec = new  Rectangle(100,100);

				 float basic_total = 0.0f;
				 float lstbasic_total = 0.0f;
				 float currda_total = 0.0f;
				 float lstcurrda_total = 0.0f;
				 float hra_total = 0.0f;
				 float lsthra_total = 0.0f;
				 float medical_total = 0.0f;
				 float lstmedical_total = 0.0f;
				 float edu_total = 0.0f;
				 float lstedu_total = 0.0f;
				 float splall_total = 0.0f;
				 float lstsplall_total = 0.0f;
				 float convall_total = 0.0f;
				 float lstconvall_total = 0.0f;
				 float washingall_total = 0.0f;
				 float lstwashingall_total = 0.0f;
				 float bonus_total = 0.0f;
				 float lstbonus_total = 0.0f;
				 float minins_total = 0.0f;
				 float lstminins_total = 0.0f;
				 float addlss_total = 0.0f;
				 float lstaddlss_total = 0.0f;
				 float col_total = 0.0f;
				 float lstcol_total = 0.0f;
				 float special_total = 0.0f;
				 float lstspecial_total = 0.0f;
				 float addinc_total = 0.0f;
				 float lstaddinc_total = 0.0f;
				 float totinc_total = 0.0f;
				 float lsttotinc_total = 0.0f;
				 float totded_total = 0.0f;
				 float lsttotded_total = 0.0f;
				 float netpay_total = 0.0f;
				 float lstnetpay_total = 0.0f;

				 EmpSql = "select CONVERT(INT, empmast.empcode) as EMPCODE ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as name,empmast.empno,t.PRJ_SRNO," +
						 "p1.NET_AMT as basic,p2.NET_AMT as payable,p3.NET_AMT as hra,p4.NET_AMT as medical," +
						 "p5.NET_AMT as education,p6.NET_AMT as convall,p7.NET_AMT as min_ins," +
						 "p10.NET_AMT as col," +
						 "(select net_amt from  PAYTRAN where TRNCD = 127 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as addless," +
						 //"(select net_amt from  PAYTRAN where TRNCD = 129 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as special, " +
						 "(select net_amt from  PAYTRAN where TRNCD = 107 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as splall," +
						 "(select net_amt from  PAYTRAN where TRNCD = 102 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as curda," +
						 "(select net_amt from  PAYTRAN where TRNCD = 115 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as washall," +
						 "(select net_amt from  PAYTRAN where TRNCD = 135 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as bonusall," +
						 "(select SUM(net_amt) from  PAYTRAN where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and TRNCD not in(101,103,104,105,108,126,127,128,107,102,115,135) and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as addinc," +
						 "(select SUM(net_amt) from  PAYTRAN where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as totded, " +
						 "(select SUM(net_amt) from  PAYTRAN where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as totear " +
						 "from EMPMAST empmast join " +
						 " PAYTRAN p1 on empmast.EMPNO = p1.EMPNO join  PAYTRAN p2 on empmast.EMPNO = p2.EMPNO " +
						 "join  PAYTRAN p3 on empmast.EMPNO = p3.EMPNO " +
						 "join  PAYTRAN p4 on empmast.EMPNO = p4.EMPNO " +
						 "join  PAYTRAN p5 on empmast.EMPNO = p5.EMPNO " +
						 "join  PAYTRAN p6 on empmast.EMPNO = p6.EMPNO " +
						 "join  PAYTRAN p7 on empmast.EMPNO = p7.EMPNO " +
						 "join  PAYTRAN p10 on empmast.EMPNO = p10.EMPNO " +
						 "join EMPTRAN t on t.EMPNO = empmast.EMPNO where " +
						 "p1.TRNCD = 101 and p1.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
						 "and p2.TRNCD = 999 and p2.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
						 "and p3.TRNCD = 103 and p3.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
						 "and p4.TRNCD = 104 and p4.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
						 "and p5.TRNCD = 105 and p5.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
						 "and p6.TRNCD = 108 and p6.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
						 "and p7.TRNCD = 126 and p7.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
						 "and p10.TRNCD = 128 and p10.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
						 //"and empmast.STATUS = 'A'" +
						 " and T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"+ReportDAO.EOM(PAYREGDT)+"') " +

						 " UNION  select CONVERT(INT, empmast.empcode) as EMPCODE ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as name,empmast.empno,t.PRJ_SRNO," +
						 "p1.NET_AMT as basic,p2.NET_AMT as payable,p3.NET_AMT as hra,p4.NET_AMT as medical," +
						 "p5.NET_AMT as education,p6.NET_AMT as convall,p7.NET_AMT as min_ins," +
						 "p10.NET_AMT as col," +
						 "(select net_amt from   paytran_stage  where TRNCD = 127 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as addless," +
						 //"(select net_amt from   paytran_stage  where TRNCD = 129 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as special, " +
						 "(select net_amt from   paytran_stage  where TRNCD = 107 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as splall," +
						 "(select net_amt from   paytran_stage  where TRNCD = 102 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as curda," +
						 "(select net_amt from   paytran_stage  where TRNCD = 115 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as washall," +
						 "(select net_amt from   paytran_stage  where TRNCD = 135 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as bonusall," +
						 "(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and TRNCD not in(101,103,104,105,108,126,127,128,107,102,115,135) and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as addinc," +
						 "(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as totded, " +
						 "(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as totear " +
						 "from EMPMAST empmast join " +
						 "  paytran_stage  p1 on empmast.EMPNO = p1.EMPNO join   paytran_stage  p2 on empmast.EMPNO = p2.EMPNO " +
						 "join   paytran_stage  p3 on empmast.EMPNO = p3.EMPNO " +
						 "join   paytran_stage  p4 on empmast.EMPNO = p4.EMPNO " +
						 "join   paytran_stage  p5 on empmast.EMPNO = p5.EMPNO " +
						 "join   paytran_stage  p6 on empmast.EMPNO = p6.EMPNO " +
						 "join   paytran_stage  p7 on empmast.EMPNO = p7.EMPNO " +
						 "join   paytran_stage  p10 on empmast.EMPNO = p10.EMPNO " +
						 "join EMPTRAN t on t.EMPNO = empmast.EMPNO where " +
						 "p1.TRNCD = 101 and p1.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
						 "and p2.TRNCD = 999 and p2.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
						 "and p3.TRNCD = 103 and p3.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
						 "and p4.TRNCD = 104 and p4.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
						 "and p5.TRNCD = 105 and p5.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
						 "and p6.TRNCD = 108 and p6.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
						 "and p7.TRNCD = 126 and p7.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
						 "and p10.TRNCD = 128 and p10.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
						 //"and empmast.STATUS = 'A'" +
						 " and T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"+ReportDAO.EOM(PAYREGDT)+"') " +




						"order by t.PRJ_SRNO,EMPCODE";
				 System.out.println(EmpSql);
				 ResultSet rs = st.executeQuery(EmpSql);

				 while(rs.next()){

					 String prj_name = null;
					 String prj_code = null;
					 Connection conn = ConnectionManager.getConnectionTech();
					 Statement stmt = conn.createStatement();
					 String prjquery = "select Site_Name,Project_Code from Project_Sites where SITE_ID = '"+rs.getString("PRJ_SRNO")+"'";
					 //System.out.println(prjquery);
					 ResultSet prj = stmt.executeQuery(prjquery);
					 if(prj.next()){
						 prj_name = prj.getString("Site_Name");
						 prj_code = prj.getString("Project_Code");
					 }
					 pBrcd1 = rs.getString("PRJ_SRNO");
					 br_tot_no_emp = 0;
					 para = new Paragraph(new Phrase("Employee's Salary List For Project Site : "+prj_name+ " ("+prj_code+")",f));
					 para.setAlignment(Element.ALIGN_LEFT);
					 para.setSpacingAfter(4);
					 doc.add(para);
					 prj.close();
					 stmt.close();
					 conn.close();
					 PdfPTable datatab;
					 PdfPTable datatot;
					 PdfPTable main = new PdfPTable(18);
					 main.setSpacingBefore(10);
					 main.setWidthPercentage(new float[]{3,12,5,5,5,5,5,5,5.5f,5.5f,5.5f,5.5f,5.5f,5.5f,5.5f,5.5f,5.5f,5.5f}, rec);
					 PdfPCell maincell ;

					 maincell = new PdfPCell(new Phrase("EMP CODE",f1));
					 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 main.addCell(maincell);

					 maincell = new PdfPCell(new Phrase("EMPNAME",f));
					 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 main.addCell(maincell);

					 maincell = new PdfPCell(new Phrase("Basic",f));
					 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 main.addCell(maincell);

					 maincell = new PdfPCell(new Phrase("Current D.A",f));
					 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 main.addCell(maincell);

					 maincell = new PdfPCell(new Phrase("H.R.A",f));
					 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 main.addCell(maincell);

					 maincell = new PdfPCell(new Phrase("Medical",f));
					 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 main.addCell(maincell);

					 maincell = new PdfPCell(new Phrase("Education",f));
					 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 main.addCell(maincell);

					 maincell = new PdfPCell(new Phrase("Spl All",f));
					 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 main.addCell(maincell);

					 maincell = new PdfPCell(new Phrase("Conv All",f));
					 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 main.addCell(maincell);

					 maincell = new PdfPCell(new Phrase("Washing All",f));
					 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 main.addCell(maincell);


					 maincell = new PdfPCell(new Phrase("Bonus",f));
					 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 main.addCell(maincell);

					 maincell = new PdfPCell(new Phrase("Min Insurance",f));
					 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 main.addCell(maincell);

					 maincell = new PdfPCell(new Phrase("Add less Amt",f));
					 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 main.addCell(maincell);

					 maincell = new PdfPCell(new Phrase("Col",f));
					 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 main.addCell(maincell);

					 //maincell = new PdfPCell(new Phrase("Special",f));
					 //maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 //main.addCell(maincell);

					 maincell = new PdfPCell(new Phrase("Add income",f));
					 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 main.addCell(maincell);

					 maincell = new PdfPCell(new Phrase("Tot income",f));
					 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 main.addCell(maincell);

					 maincell = new PdfPCell(new Phrase("Tot deduction",f));
					 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 main.addCell(maincell);

					 maincell = new PdfPCell(new Phrase("Net pay",f));
					 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 main.addCell(maincell);


					 doc.add(main);
					 while (pBrcd1.equals(rs.getString("PRJ_SRNO")))
					 {
						 datatab = new PdfPTable(18);
						 datatab.setWidthPercentage(new float[]{3,12,5,5,5,5,5,5,5.5f,5.5f,5.5f,5.5f,5.5f,5.5f,5.5f,5.5f,5.5f,5.5f}, rec);
						 datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

						 PdfPCell cell1 = new PdfPCell(new Phrase(""+rs.getString("EMPCODE"),f1));
						 cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						 datatab.addCell(cell1);

						 PdfPCell cell2 = new PdfPCell(new Phrase(""+rs.getString("name"),f1));
						 cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
						 datatab.addCell(cell2);

						 basic_total = basic_total + rs.getFloat("basic");
						 PdfPCell cell3 = new PdfPCell(new Phrase(""+rs.getFloat("basic"),f1));
						 cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
						 datatab.addCell(cell3);

						 if(rs.getFloat("curda")==0.0){
							 PdfPCell cell4 = new PdfPCell(new Phrase("",f1));
							 datatab.addCell(cell4);
						 }
						 else{
							 float curda = rs.getFloat("curda");
							 currda_total = currda_total +curda;
							 PdfPCell cell4 = new PdfPCell(new Phrase(""+curda,f1));
							 cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
							 datatab.addCell(cell4);
						 }

						 hra_total = hra_total + rs.getFloat("hra");
						 PdfPCell cell5 = new PdfPCell(new Phrase(""+rs.getFloat("hra"),f1));
						 cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
						 datatab.addCell(cell5);

						 medical_total = medical_total = rs.getFloat("medical");
						 PdfPCell cell6 = new PdfPCell(new Phrase(""+rs.getFloat("medical"),f1));
						 cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
						 datatab.addCell(cell6);

						 edu_total = edu_total = rs.getFloat("education");
						 PdfPCell cell7 = new PdfPCell(new Phrase(""+rs.getFloat("education"),f1));
						 cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
						 datatab.addCell(cell7);

						 if(rs.getFloat("splall")==0.0){
							 PdfPCell cell8 = new PdfPCell(new Phrase("",f1));
							 datatab.addCell(cell8);
						 }
						 else{
							 float splall1 = rs.getFloat("splall");
							 splall_total = splall_total + splall1;
							 PdfPCell cell8 = new PdfPCell(new Phrase(""+rs.getFloat("splall"),f1));
							 cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
							 datatab.addCell(cell8);
						 }

						 convall_total = convall_total + rs.getFloat("convall");
						 PdfPCell cell9 = new PdfPCell(new Phrase(""+rs.getFloat("convall"),f1));
						 cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
						 datatab.addCell(cell9);

						 if(rs.getFloat("washall")==0.0){
							 PdfPCell cell10 = new PdfPCell(new Phrase("",f1));
							 datatab.addCell(cell10);	
						 }
						 else{
							 float washing = rs.getFloat("washall");
							 washingall_total = washingall_total = rs.getFloat("washall");
							 PdfPCell cell10 = new PdfPCell(new Phrase(""+washing,f1));
							 cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
							 datatab.addCell(cell10);
						 }

						 if(rs.getFloat("bonusall")==0.0){
							 PdfPCell cell11 = new PdfPCell(new Phrase("",f1));
							 datatab.addCell(cell11);
						 }
						 else{
							 float bonus = rs.getFloat("bonusall");
							 bonus_total = bonus_total + rs.getFloat("bonusall");
							 PdfPCell cell11 = new PdfPCell(new Phrase(""+bonus,f1));
							 cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
							 datatab.addCell(cell11);
						 }

						 minins_total = minins_total + +rs.getFloat("min_ins");
						 PdfPCell cell12 = new PdfPCell(new Phrase(""+rs.getFloat("min_ins"),f1));
						 cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
						 datatab.addCell(cell12);

						 if(rs.getFloat("addless")==0.0){
							 PdfPCell cell13 = new PdfPCell(new Phrase("",f1));
							 datatab.addCell(cell13);
						 }
						 else{
							 float addless = rs.getFloat("addless");
							 addlss_total = addlss_total + addless;
							 PdfPCell cell13 = new PdfPCell(new Phrase(""+addless,f1));
							 cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
							 datatab.addCell(cell13);
						 }

						 col_total = col_total + +rs.getFloat("col");
						 PdfPCell cell14 = new PdfPCell(new Phrase(""+rs.getFloat("col"),f1));
						 cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
						 datatab.addCell(cell14);

						 /*if(rs.getFloat("special")==0.0){
						PdfPCell cell15 = new PdfPCell(new Phrase("",f1));
						datatab.addCell(cell15);
					}
					else{
						float spcl = rs.getFloat("special");
						special_total = special_total + spcl; 
						PdfPCell cell15 = new PdfPCell(new Phrase(""+spcl,f1));
						cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell15);
					}
						  */
						 if(rs.getFloat("addinc")==0.0){
							 PdfPCell cell16 = new PdfPCell(new Phrase("",f1));
							 datatab.addCell(cell16);
						 }
						 else{
							 float add_inc = rs.getFloat("addinc");
							 addinc_total = addinc_total + add_inc;
							 PdfPCell cell16 = new PdfPCell(new Phrase(""+add_inc,f1));
							 cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
							 datatab.addCell(cell16);
						 }

						 totinc_total = totinc_total + rs.getFloat("totear");
						 PdfPCell cell17 = new PdfPCell(new Phrase(""+rs.getFloat("totear"),f1));
						 cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
						 datatab.addCell(cell17);

						 totded_total = totded_total + rs.getFloat("totded");
						 PdfPCell cell18 = new PdfPCell(new Phrase(""+rs.getFloat("totded"),f1));
						 cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
						 datatab.addCell(cell18);

						 netpay_total = netpay_total + rs.getFloat("payable");
						 PdfPCell cell19 = new PdfPCell(new Phrase(""+rs.getFloat("payable"),f1));
						 cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
						 datatab.addCell(cell19);

						 doc.add(datatab);

						 tot_no_emp = tot_no_emp + 1;
						 br_tot_no_emp = br_tot_no_emp + 1;
						 if (!rs.next()) {
							 break;
						 }
						 if(!pBrcd1.equals(rs.getString("PRJ_SRNO"))){
							 rs.previous();
							 break;
						 }
					 }

					 datatot = new PdfPTable(18);
					 datatot.setWidthPercentage(new float[]{3,12,5,5,5,5,5,5,5.5f,5.5f,5.5f,5.5f,5.5f,5.5f,5.5f,5.5f,5.5f,5.5f}, rec);
					 datatot.setHorizontalAlignment(Element.ALIGN_LEFT);

					 PdfPCell cell1 = new PdfPCell(new Phrase("Total:--",f1));
					 cell1.setColspan(2);
					 cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 datatot.addCell(cell1);

					 PdfPCell cell3 = new PdfPCell(new Phrase(""+basic_total,f1));
					 cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 datatot.addCell(cell3);
					 lstbasic_total = lstbasic_total+basic_total;
					 basic_total = 0.0f;

					 PdfPCell cell4 = new PdfPCell(new Phrase(""+currda_total,f1));
					 cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 datatot.addCell(cell4);
					 lstcurrda_total = lstcurrda_total+currda_total;
					 currda_total = 0.0f;

					 PdfPCell cell5 = new PdfPCell(new Phrase(""+hra_total,f1));
					 cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 datatot.addCell(cell5);
					 lsthra_total = lsthra_total + hra_total;
					 hra_total = 0.0f;

					 PdfPCell cell6 = new PdfPCell(new Phrase(""+medical_total,f1));
					 cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 datatot.addCell(cell6);
					 lstmedical_total = lstmedical_total + medical_total;
					 medical_total = 0.0f;

					 PdfPCell cell7 = new PdfPCell(new Phrase(""+edu_total,f1));
					 cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 datatot.addCell(cell7);
					 lstedu_total = lstedu_total +edu_total;
					 edu_total = 0.0f;

					 PdfPCell cell8 = new PdfPCell(new Phrase(""+splall_total,f1));
					 cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 datatot.addCell(cell8);
					 lstsplall_total = lstsplall_total = splall_total;
					 splall_total = 0.0f;

					 PdfPCell cell9 = new PdfPCell(new Phrase(""+convall_total,f1));
					 cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 datatot.addCell(cell9);
					 lstconvall_total = lstconvall_total = convall_total;
					 convall_total = 0.0f;

					 PdfPCell cell10 = new PdfPCell(new Phrase(""+washingall_total,f1));
					 cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 datatot.addCell(cell10);
					 lstwashingall_total = lstwashingall_total + washingall_total;
					 washingall_total = 0.0f;

					 PdfPCell cell11 = new PdfPCell(new Phrase(""+bonus_total,f1));
					 cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 datatot.addCell(cell11);
					 lstbonus_total = lstbonus_total + bonus_total ;
					 bonus_total = 0.0f;

					 PdfPCell cell12 = new PdfPCell(new Phrase(""+minins_total,f1));
					 cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 datatot.addCell(cell12);
					 lstminins_total = lstminins_total + minins_total ;
					 minins_total = 0.0f;

					 PdfPCell cell13 = new PdfPCell(new Phrase(""+addlss_total,f1));
					 cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 datatot.addCell(cell13);
					 lstaddlss_total = lstaddlss_total + addlss_total ;
					 addlss_total = 0.0f;

					 PdfPCell cell14 = new PdfPCell(new Phrase(""+col_total,f1));
					 cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 datatot.addCell(cell14);
					 lstcol_total = lstcol_total + col_total ;
					 col_total = 0.0f;

					 /*PdfPCell cell15 = new PdfPCell(new Phrase(""+special_total,f1));
					cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell15);
					lstspecial_total = lstspecial_total + special_total ;
					special_total = 0.0f;*/

					 PdfPCell cell16 = new PdfPCell(new Phrase(""+addinc_total,f1));
					 cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 datatot.addCell(cell16);
					 lstaddinc_total = lstaddinc_total + addinc_total ;
					 addinc_total = 0.0f;

					 PdfPCell cell17 = new PdfPCell(new Phrase(""+totinc_total,f1));
					 cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 datatot.addCell(cell17);
					 lsttotinc_total = lsttotinc_total + totinc_total ;
					 totinc_total = 0.0f;

					 PdfPCell cell18 = new PdfPCell(new Phrase(""+totded_total,f1));
					 cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 datatot.addCell(cell18);
					 lsttotded_total = lsttotded_total + totded_total ;
					 totded_total = 0.0f;

					 PdfPCell cell19 = new PdfPCell(new Phrase(""+netpay_total,f1));
					 cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 datatot.addCell(cell19);
					 lstnetpay_total = lstnetpay_total + netpay_total ;
					 netpay_total = 0.0f;

					 doc.add(datatot);

					 para = new Paragraph(new Phrase("No Of Employee :- "+br_tot_no_emp,f));
					 para.setAlignment(Element.ALIGN_LEFT);
					 para.setSpacingAfter(10);
					 doc.add(para);

				 }
				 para = new Paragraph(new Phrase("Total No Of Employee :- "+tot_no_emp,f));
				 para.setAlignment(Element.ALIGN_LEFT);
				 para.setSpacingAfter(10);
				 doc.add(para);

				 System.out.println("Total No Of Employee :- "+tot_no_emp);

				 PdfPTable main = new PdfPTable(18);
				 main.setSpacingBefore(10);
				 main.setWidthPercentage(new float[]{5,6,5,5.5f,5.5f,5.5f,5,5.5f,5.5f,5.5f,5.5f,5.5f,5.5f,5.5f,5.5f,6,6,6}, rec);
				 PdfPCell maincell ;

				 maincell = new PdfPCell(new Phrase("Summury",f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 maincell.setColspan(2);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase("Basic",f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase("Current D.A",f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase("H.R.A",f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase("Medical",f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase("Education",f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase("Spl All",f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase("Conv All",f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase("Washing All",f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);


				 maincell = new PdfPCell(new Phrase("Officiating All",f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase("Min Insurance",f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase("Add less Amt",f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase("Col",f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 /*maincell = new PdfPCell(new Phrase("Special",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);*/

				 maincell = new PdfPCell(new Phrase("Add income",f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase("Tot income",f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase("Tot deduction",f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase("Net pay",f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase("Gross Total:--",f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 maincell.setColspan(2);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase(""+trans((int)(lstbasic_total), "", "", false, false),f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase(""+trans((int)(lstcurrda_total), "", "", false, false),f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase(""+trans((int)(lsthra_total), "", "", false, false),f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase(""+trans((int)(lstmedical_total), "", "", false, false),f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase(""+trans((int)(lstedu_total), "", "", false, false),f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase(""+trans((int)(lstsplall_total), "", "", false, false),f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase(""+trans((int)(lstconvall_total), "", "", false, false),f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase(""+trans((int)(lstwashingall_total), "", "", false, false),f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);


				 maincell = new PdfPCell(new Phrase(""+trans((int)(lstbonus_total), "", "", false, false),f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase(""+trans((int)(lstminins_total), "", "", false, false),f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase(""+trans((int)(lstaddlss_total), "", "", false, false),f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase(""+trans((int)(lstcol_total), "", "", false, false),f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 /*maincell = new PdfPCell(new Phrase(""+trans((int)(lstspecial_total), "", "", false, false),f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);*/

				 maincell = new PdfPCell(new Phrase(""+trans((int)(lstaddinc_total), "", "", false, false),f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase(""+trans((int)(lsttotinc_total), "", "", false, false),f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase(""+trans((int)(lsttotded_total), "", "", false, false),f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 maincell = new PdfPCell(new Phrase(""+trans((int)(lstnetpay_total), "", "", false, false),f));
				 maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 main.addCell(maincell);

				 doc.add(main);

				 System.out.println("last basic = "+lstbasic_total);
				 System.out.println("last current da = "+lstcurrda_total);
				 System.out.println("last hra = "+lsthra_total);
				 System.out.println("last medical = "+lstmedical_total);
				 System.out.println("last education = "+lstedu_total);
				 System.out.println("last splall = "+lstsplall_total);
				 System.out.println("last convall = "+lstconvall_total);
				 System.out.println("last washing = "+lstwashingall_total);
				 System.out.println("last bonus = "+lstbonus_total);
				 System.out.println("last minins = "+lstminins_total);
				 System.out.println("last addless = "+lstaddlss_total);
				 System.out.println("last col = "+lstcol_total);
				 //System.out.println("last special = "+lstspecial_total);
				 System.out.println("last addinc = "+lstaddinc_total);
				 System.out.println("last totinc = "+lsttotinc_total);
				 System.out.println("last totded = "+lsttotded_total);
				 System.out.println("last totnetpay = "+lstnetpay_total);


				 st.close();
				 con.close();
				 doc.close();



			}


			else if(type.equalsIgnoreCase("ID")){
				ReportDAO.OpenCon("", "", "",repBean);
				con = repBean.getCn();	
				Statement st = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
						ResultSet.CONCUR_READ_ONLY);


				/*	if(TName.equalsIgnoreCase("after")){

			label2="Salary Sheet For The Income & Deduction Heads for the Month Of :- "+temp;
		}else if(TName.equalsIgnoreCase("before"))
		{	
		label2="Salary Sheet For The Income & Deduction Heads for the Month Of :- "+temp+" (Before Finalize)";
		}else
			{*/
				label2="Salary Sheet For The Income & Deduction Heads for the Month Of :- "+temp+"(Pending for Release)";
				/*}*/


				DottedLineCell app = new DottedLineCell();
				System.out.println("in income & Deduction head");
				Document document = new Document(PageSize.A3.rotate());
				Document doc = new Document(new Rectangle(2834,4008));
				PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
				HeaderAndFooter haf = new HeaderAndFooter(lable1,label2);
				writer.setPageEvent(haf);
				doc.open();
				Font FONT = new Font(Font.HELVETICA,190, Font.NORMAL, new GrayColor(0.85f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 1300f, 1830f, 45);			
				Image image1 = Image.getInstance(imgpath);		
				Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,38,Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				image1.scaleAbsolute(310f, 120f);
				image1.setAbsolutePosition(60f, 3800f);
				doc.add(image1);
				doc.add(para);
				para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,28)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,28)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,28)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);

				Font f = new Font(Font.HELVETICA,26);
				Font f1 = new Font(Font.HELVETICA,23);
				Font f2 = new Font(Font.HELVETICA,32);
				/*if(TName.equalsIgnoreCase("after")){
			para = new Paragraph(new Phrase("Salary Sheet For The Income & Deduction Heads for the Month Of :- "+temp,new Font(Font.TIMES_ROMAN,25)));
			label2="Salary Sheet For The Income & Deduction Heads for the Month Of :- "+temp;
		}else if(TName.equalsIgnoreCase("before"))
		{	para = new Paragraph(new Phrase("Salary Sheet For The Income & Deduction  Heads for the Month Of :- "+temp+" (Before Finalize)",new Font(Font.TIMES_ROMAN,25)));
		label2="Salary Sheet For The Income & Deduction Heads for the Month Of :- "+temp+" (Before Finalize)";
		}else
			{*/para = new Paragraph(new Phrase("Salary Sheet For The Income & Deduction  Heads for the Month Of :- "+temp+" (Pending for Release)",new Font(Font.TIMES_ROMAN,25)));
			label2="Salary Sheet For The Income & Deduction Heads for the Month Of :- "+temp+"(Pending for Release)";
			/*}*/
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);

			doc.add(para);

			Rectangle rec = new  Rectangle(100,100);

			float basic_total = 0.0f;
			float lstbasic_total = 0.0f;
			float lic_total = 0.0f;
			float lstlic_total = 0.0f;
			float hra_total = 0.0f;
			float lsthra_total = 0.0f;
			float medical_total = 0.0f;
			float lstmedical_total = 0.0f;
			float edu_total = 0.0f;
			float lstedu_total = 0.0f;
			float splall_total = 0.0f;
			float lstsplall_total = 0.0f;
			float convall_total = 0.0f;
			float lstconvall_total = 0.0f;
			float pf_total = 0.0f;
			float lstpf_total = 0.0f;
			float pt_total = 0.0f;
			float lstpt_total = 0.0f;
			float mlwf_total = 0.0f;
			float lstmlwf_total = 0.0f;
			float esic_total = 0.0f;
			float lstesic_total = 0.0f;
			float mob_total = 0.0f;
			float lstmob_total = 0.0f;
			float adv_total = 0.0f;
			float lstadv_total = 0.0f;
			float tds_total = 0.0f;
			float lsttds_total = 0.0f;
			float relif_total = 0.0f;
			float lstrelif_total = 0.0f;
			float netc_total = 0.0f;
			float lstnetc_total = 0.0f;
			float minins_total = 0.0f;
			float lstminins_total = 0.0f;
			float addlss_total = 0.0f;
			float lstaddlss_total = 0.0f;
			float col_total = 0.0f;
			float lstcol_total = 0.0f;
			float special_total = 0.0f;
			float lstspecial_total = 0.0f;
			float addinc_total = 0.0f;
			float lstaddinc_total = 0.0f;
			float totinc_total = 0.0f;
			float lsttotinc_total = 0.0f;
			float addded_total = 0.0f;
			float lstaddded_total = 0.0f;
			float totded_total = 0.0f;
			float lsttotded_total = 0.0f;
			float netpay_total = 0.0f;
			float lstnetpay_total = 0.0f;

			EmpSql = "select CONVERT(INT, empmast.empcode) as empcode ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as name,empmast.empno,t.PRJ_SRNO," +
					"p1.NET_AMT as basic,p2.NET_AMT as payable,p3.NET_AMT as hra,p4.NET_AMT as medical," +
					"p5.NET_AMT as education,p6.NET_AMT as convall,p7.NET_AMT as min_ins," +
					"p10.NET_AMT as col," +
					"(select net_amt from  PAYTRAN where TRNCD = 131 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as er2," +
					"(select net_amt from  PAYTRAN where TRNCD = 130 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as er1, " +
					"(select net_amt from  PAYTRAN where TRNCD = 107 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as splall," +
					"(select net_amt from  PAYTRAN where TRNCD = 201 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as pf," +
					"(select net_amt from  PAYTRAN where TRNCD = 202 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as pt," +
					"(select net_amt from  PAYTRAN where TRNCD = 205 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as lic," +
					"(select net_amt from  PAYTRAN where TRNCD = 221 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as esic," +
					"(select net_amt from  PAYTRAN where TRNCD = 223 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as mob," +
					"(select net_amt from  PAYTRAN where TRNCD = 225 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as adv," +
					"(select net_amt from  PAYTRAN where TRNCD = 228 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as tds," +
					"(select net_amt from  PAYTRAN where TRNCD = 229 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as relif," +
					"(select net_amt from  PAYTRAN where TRNCD = 230 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as netc," +
					"(select net_amt from  PAYTRAN where TRNCD = 226 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as loan," +
					//"(select SUM(net_amt) from  PAYTRAN where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and TRNCD not in(101,103,104,105,108,126,127,128,107) and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as addinc," +
					"(select SUM(net_amt) from  PAYTRAN where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and TRNCD not in(101,103,104,105,108,126,128,107,130,131) and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as addinc," +
					"(select SUM(net_amt) from  PAYTRAN where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) and TRNCD not in(201,202,205,221,223,225,228,229,230,226) and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as addded," +
					"(select SUM(net_amt) from  PAYTRAN where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as totded, " +
					"(select SUM(net_amt) from  PAYTRAN where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as totear " +
					"from EMPMAST empmast join " +
					" PAYTRAN p1 on empmast.EMPNO = p1.EMPNO join  PAYTRAN p2 on empmast.EMPNO = p2.EMPNO " +
					"join  PAYTRAN p3 on empmast.EMPNO = p3.EMPNO " +
					"join  PAYTRAN p4 on empmast.EMPNO = p4.EMPNO " +
					"join  PAYTRAN p5 on empmast.EMPNO = p5.EMPNO " +
					"join  PAYTRAN p6 on empmast.EMPNO = p6.EMPNO " +
					"join  PAYTRAN p7 on empmast.EMPNO = p7.EMPNO " +
					"join  PAYTRAN p10 on empmast.EMPNO = p10.EMPNO " +
					"join EMPTRAN t on t.EMPNO = empmast.EMPNO where " +
					"p1.TRNCD = 101 and p1.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
					"and p2.TRNCD = 999 and p2.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
					"and p3.TRNCD = 103 and p3.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
					"and p4.TRNCD = 104 and p4.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
					"and p5.TRNCD = 105 and p5.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
					"and p6.TRNCD = 108 and p6.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
					"and p7.TRNCD = 126 and p7.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
					"and p10.TRNCD = 128 and p10.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
					//"and empmast.STATUS = 'A'" +
					" and T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"+ReportDAO.EOM(PAYREGDT)+"') " +

" UNION select CONVERT(INT, empmast.empcode) as empcode ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as name,empmast.empno,t.PRJ_SRNO," +
"p1.NET_AMT as basic,p2.NET_AMT as payable,p3.NET_AMT as hra,p4.NET_AMT as medical," +
"p5.NET_AMT as education,p6.NET_AMT as convall,p7.NET_AMT as min_ins," +
"p10.NET_AMT as col," +
"(select net_amt from   paytran_stage  where TRNCD = 131 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as er2," +
"(select net_amt from   paytran_stage  where TRNCD = 130 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as er1, " +
"(select net_amt from   paytran_stage  where TRNCD = 107 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as splall," +
"(select net_amt from   paytran_stage  where TRNCD = 201 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as pf," +
"(select net_amt from   paytran_stage  where TRNCD = 202 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as pt," +
"(select net_amt from   paytran_stage  where TRNCD = 205 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as lic," +
"(select net_amt from   paytran_stage  where TRNCD = 221 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as esic," +
"(select net_amt from   paytran_stage  where TRNCD = 223 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as mob," +
"(select net_amt from   paytran_stage  where TRNCD = 225 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as adv," +
"(select net_amt from   paytran_stage  where TRNCD = 228 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as tds," +
"(select net_amt from   paytran_stage  where TRNCD = 229 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as relif," +
"(select net_amt from   paytran_stage  where TRNCD = 230 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as netc," +
"(select net_amt from   paytran_stage  where TRNCD = 226 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as loan," +
//"(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and TRNCD not in(101,103,104,105,108,126,127,128,107) and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as addinc," +
"(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and TRNCD not in(101,103,104,105,108,126,128,107,130,131) and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as addinc," +
"(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) and TRNCD not in(201,202,205,221,223,225,228,229,230,226) and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as addded," +
"(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as totded, " +
"(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as totear " +
"from EMPMAST empmast join " +
"  paytran_stage  p1 on empmast.EMPNO = p1.EMPNO join  paytran_stage p2 on empmast.EMPNO = p2.EMPNO " +
"join   paytran_stage  p3 on empmast.EMPNO = p3.EMPNO " +
"join   paytran_stage  p4 on empmast.EMPNO = p4.EMPNO " +
"join   paytran_stage  p5 on empmast.EMPNO = p5.EMPNO " +
"join   paytran_stage  p6 on empmast.EMPNO = p6.EMPNO " +
"join   paytran_stage  p7 on empmast.EMPNO = p7.EMPNO " +
"join   paytran_stage  p10 on empmast.EMPNO = p10.EMPNO " +
"join EMPTRAN t on t.EMPNO = empmast.EMPNO where " +
"p1.TRNCD = 101 and p1.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
"and p2.TRNCD = 999 and p2.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
"and p3.TRNCD = 103 and p3.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
"and p4.TRNCD = 104 and p4.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
"and p5.TRNCD = 105 and p5.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
"and p6.TRNCD = 108 and p6.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
"and p7.TRNCD = 126 and p7.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
"and p10.TRNCD = 128 and p10.TRNDT BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
//"and empmast.STATUS = 'A'" +
" and T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"+ReportDAO.EOM(PAYREGDT)+"') " +
"order by t.PRJ_SRNO,empcode";
			System.out.println(EmpSql);
			ResultSet rs = st.executeQuery(EmpSql);

			while(rs.next()){

				String prj_name = null;
				String prj_code = null;
				Connection conn = ConnectionManager.getConnectionTech();
				Statement stmt = conn.createStatement();
				String prjquery = "select Site_Name,Project_Code from Project_Sites where SITE_ID = '"+rs.getString("PRJ_SRNO")+"'";
				//System.out.println(prjquery);
				ResultSet prj = stmt.executeQuery(prjquery);
				if(prj.next()){
					prj_name = prj.getString("Site_Name");
					prj_code = prj.getString("Project_Code");
				}
				pBrcd1 = rs.getString("PRJ_SRNO");
				br_tot_no_emp = 0;
				para = new Paragraph(new Phrase("Employee's Salary List For Project Site : "+prj_name+ " ("+prj_code+")",f));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(4);
				doc.add(para);
				prj.close();
				stmt.close();
				conn.close();
				PdfPTable datatab;
				PdfPTable datatot;
				PdfPTable main = new PdfPTable(27);
				main.setSpacingBefore(10);
				main.setWidthPercentage(new float[]{3,8,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.25f,3,3,3.5f,3.5f,3.5f,3.5f}, rec);
				main.setHorizontalAlignment(Element.ALIGN_LEFT);
				PdfPCell maincell ;

				maincell = new PdfPCell(new Phrase("EMP CODE",f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				maincell.setFixedHeight(70);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("EMPNAME",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Basic",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("H.R.A",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Col",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Medical",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Conv All",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Education",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);


				maincell = new PdfPCell(new Phrase("Min Ins.",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Spl All",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Earn 1",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Earn 2",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Add Income",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Tot income",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("P.F",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("E.S.I.C",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("P.T",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("T.D.S",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Advance",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Loan Ded",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Mobile Ded",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Net Charges",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("L.I.C",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Relif Fund",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Add Ded.",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Tot Ded.",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Net Pay",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);


				doc.add(main);
				while (pBrcd1.equals(rs.getString("PRJ_SRNO")))
				{


					datatab = new PdfPTable(27);
					datatab.setTableEvent(app.new DottedCells());
					datatab.getDefaultCell().setBorder(PdfPCell.NO_BORDER);
					datatab.setWidthPercentage(new float[]{3,8,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.25f,3,3,3.5f,3.5f,3.5f,3.5f}, rec);
					datatab.setHorizontalAlignment(Element.ALIGN_LEFT);


					PdfPCell cell1 = new PdfPCell(new Phrase(""+rs.getString("EMPCODE"),f1));
					cell1.setCellEvent(app.new DottedCell());
					cell1.setFixedHeight(60);
					datatab.addCell(cell1);

					PdfPCell cell2 = new PdfPCell(new Phrase(""+rs.getString("name"),f1));
					cell2.setCellEvent(app.new DottedCell());
					datatab.addCell(cell2);

					basic_total = basic_total + rs.getFloat("basic");
					PdfPCell cell3 = new PdfPCell(new Phrase(""+rs.getFloat("basic"),f1));
					cell3.setCellEvent(app.new DottedCell());
					cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell3);

					hra_total = hra_total + rs.getFloat("hra");
					PdfPCell cell4 = new PdfPCell(new Phrase(""+rs.getFloat("hra"),f1));
					cell4.setCellEvent(app.new DottedCell());
					cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell4);

					col_total = col_total + +rs.getFloat("col");
					PdfPCell cell11 = new PdfPCell(new Phrase(""+rs.getFloat("col"),f1));
					cell11.setCellEvent(app.new DottedCell());
					cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell11);

					medical_total = medical_total + rs.getFloat("medical");
					PdfPCell cell5 = new PdfPCell(new Phrase(""+rs.getFloat("medical"),f1));
					cell5.setCellEvent(app.new DottedCell());
					cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell5);

					convall_total = convall_total + rs.getFloat("convall");
					PdfPCell cell8 = new PdfPCell(new Phrase(""+rs.getFloat("convall"),f1));
					cell8.setCellEvent(app.new DottedCell());
					cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell8);

					edu_total = edu_total + rs.getFloat("education");
					PdfPCell cell6 = new PdfPCell(new Phrase(""+rs.getFloat("education"),f1));
					cell6.setCellEvent(app.new DottedCell());
					cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell6);

					minins_total = minins_total + +rs.getFloat("min_ins");
					PdfPCell cell9 = new PdfPCell(new Phrase(""+rs.getFloat("min_ins"),f1));
					cell9.setCellEvent(app.new DottedCell());
					cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell9);

					if(rs.getFloat("splall")==0.0){
						PdfPCell cell7 = new PdfPCell(new Phrase("",f1));
						datatab.addCell(cell7);
					}
					else{
						float splall1 = rs.getFloat("splall");
						splall_total = splall_total + splall1;
						PdfPCell cell7 = new PdfPCell(new Phrase(""+splall1,f1));
						cell7.setCellEvent(app.new DottedCell());
						cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell7);
					}


					if(rs.getFloat("er1")==0.0){
						PdfPCell cell10 = new PdfPCell(new Phrase("",f1));
						datatab.addCell(cell10);
					}
					else{
						float addless = rs.getFloat("er1");
						addlss_total = addlss_total + addless;
						PdfPCell cell10 = new PdfPCell(new Phrase(""+addless,f1));
						cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell10);
					}



					if(rs.getFloat("er2")==0.0){
						PdfPCell cell12 = new PdfPCell(new Phrase("",f1));
						datatab.addCell(cell12);
					}
					else{
						float spcl = rs.getFloat("er2");
						special_total = special_total + spcl; 
						PdfPCell cell12 = new PdfPCell(new Phrase(""+spcl,f1));
						cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell12);
					}

					if(rs.getFloat("addinc")==0.0){
						PdfPCell cell23 = new PdfPCell(new Phrase("",f1));
						datatab.addCell(cell23);
					}
					else{
						float add_inc = rs.getFloat("addinc");
						addinc_total = addinc_total + add_inc;
						PdfPCell cell23 = new PdfPCell(new Phrase(""+add_inc,f1));
						cell23.setCellEvent(app.new DottedCell());
						cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell23);
					}

					totinc_total = totinc_total + rs.getFloat("totear");
					PdfPCell cell25 = new PdfPCell(new Phrase(""+rs.getFloat("totear"),f1));
					cell25.setCellEvent(app.new DottedCell());
					cell25.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell25);

					if(rs.getFloat("pf")==0.0){
						PdfPCell cell13 = new PdfPCell(new Phrase("",f1));
						datatab.addCell(cell13);
					}
					else{
						float pf = rs.getFloat("pf");
						pf_total = pf_total + pf; 
						PdfPCell cell13 = new PdfPCell(new Phrase(""+pf,f1));
						cell13.setCellEvent(app.new DottedCell());
						cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell13);
					}

					if(rs.getFloat("esic")==0.0f){
						PdfPCell cell17 = new PdfPCell(new Phrase("",f1));
						datatab.addCell(cell17);
					}
					else{
						float esic = rs.getFloat("esic");
						esic_total = esic_total+esic;
						PdfPCell cell17 = new PdfPCell(new Phrase(""+esic,f1));
						cell17.setCellEvent(app.new DottedCell());
						cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell17);
					}

					if(rs.getFloat("pt")==0.0){
						PdfPCell cell14 = new PdfPCell(new Phrase("",f1));
						datatab.addCell(cell14);
					}
					else{
						float pt = rs.getFloat("pt");
						pt_total = pt_total + pt; 
						PdfPCell cell14 = new PdfPCell(new Phrase(""+pt,f1));
						cell14.setCellEvent(app.new DottedCell());
						cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell14);
					}

					if(rs.getFloat("tds")==0.0f){
						PdfPCell cell22 = new PdfPCell(new Phrase("",f1));
						datatab.addCell(cell22);
					}
					else{
						float tds = rs.getFloat("tds");
						tds_total = tds_total + tds;
						PdfPCell cell22 = new PdfPCell(new Phrase(""+tds,f1));
						cell22.setCellEvent(app.new DottedCell());
						cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell22);
					}

					if(rs.getFloat("adv")==0.0f){
						PdfPCell cell19 = new PdfPCell(new Phrase("",f1));
						datatab.addCell(cell19);
					}
					else{
						float adv = rs.getFloat("adv");
						adv_total = adv_total + adv;
						PdfPCell cell19 = new PdfPCell(new Phrase(""+adv,f1));
						cell19.setCellEvent(app.new DottedCell());
						cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell19);
					}

					if(rs.getFloat("loan")==0.0){
						PdfPCell cell16 = new PdfPCell(new Phrase("",f1));
						datatab.addCell(cell16);
					}
					else{
						float mlwf = rs.getFloat("loan");
						mlwf_total = mlwf_total + mlwf;
						PdfPCell cell16 = new PdfPCell(new Phrase(""+mlwf,f1));
						cell16.setCellEvent(app.new DottedCell());
						cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell16);
					}

					if(rs.getFloat("mob")==0.0f){
						PdfPCell cell18 = new PdfPCell(new Phrase("",f1));
						datatab.addCell(cell18);
					}
					else{
						float mob = rs.getFloat("mob");
						mob_total = mob_total + mob;
						PdfPCell cell18 = new PdfPCell(new Phrase(""+mob,f1));
						cell18.setCellEvent(app.new DottedCell());
						cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell18);
					}

					if(rs.getFloat("netc")==0.0f){
						PdfPCell cell21 = new PdfPCell(new Phrase("",f1));
						datatab.addCell(cell21);
					}
					else{
						float netc = rs.getFloat("netc");
						netc_total = netc_total + netc;
						PdfPCell cell21 = new PdfPCell(new Phrase(""+netc,f1));
						cell21.setCellEvent(app.new DottedCell());
						cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell21);
					}

					if(rs.getFloat("lic")==0.0){
						PdfPCell cell15 = new PdfPCell(new Phrase("",f1));
						datatab.addCell(cell15);
					}
					else{
						float lic = rs.getFloat("lic");
						lic_total = lic_total + lic;
						PdfPCell cell15 = new PdfPCell(new Phrase(""+lic,f1));
						cell15.setCellEvent(app.new DottedCell());
						cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell15);
					}

					if(rs.getFloat("relif")==0.0f){
						PdfPCell cell20 = new PdfPCell(new Phrase("",f1));
						datatab.addCell(cell20);
					}
					else{
						float relif = rs.getFloat("relif");
						relif_total = relif_total + relif;
						PdfPCell cell20 = new PdfPCell(new Phrase(""+relif,f1));
						cell20.setCellEvent(app.new DottedCell());
						cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell20);
					}

					if(rs.getFloat("addded")==0.0){
						PdfPCell cell24 = new PdfPCell(new Phrase("",f1));
						datatab.addCell(cell24);
					}
					else{
						float add_ded = rs.getFloat("addded");
						addded_total = addded_total + add_ded;
						PdfPCell cell24 = new PdfPCell(new Phrase(""+add_ded,f1));
						cell24.setCellEvent(app.new DottedCell());
						cell24.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell24);
					}

					totded_total = totded_total + rs.getFloat("totded");
					PdfPCell cell26 = new PdfPCell(new Phrase(""+rs.getFloat("totded"),f1));
					cell26.setCellEvent(app.new DottedCell());
					cell26.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell26);

					netpay_total = netpay_total + rs.getFloat("payable");
					PdfPCell cell27 = new PdfPCell(new Phrase(""+rs.getFloat("payable"),f1));
					cell27.setCellEvent(app.new DottedCell());
					cell27.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell27);

					doc.add(datatab);

					tot_no_emp = tot_no_emp + 1;
					br_tot_no_emp = br_tot_no_emp + 1;
					if (!rs.next()) {
						break;
					}
					if(!pBrcd1.equals(rs.getString("PRJ_SRNO"))){
						rs.previous();
						break;
					}
				}

				datatot = new PdfPTable(27);
				datatot.setWidthPercentage(new float[]{3,8,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.5f,3.25f,3,3,3.5f,3.5f,3.5f,3.5f}, rec);
				datatot.setHorizontalAlignment(Element.ALIGN_LEFT);

				PdfPCell cell1 = new PdfPCell(new Phrase("Total:--",f1));
				cell1.setColspan(2);
				cell1.setFixedHeight(50);
				cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell1);

				PdfPCell cell3 = new PdfPCell(new Phrase(""+basic_total,f1));
				cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell3);
				lstbasic_total = lstbasic_total+basic_total;
				basic_total = 0.0f;

				PdfPCell cell4 = new PdfPCell(new Phrase(""+hra_total,f1));
				cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell4);
				lsthra_total = lsthra_total + hra_total;
				hra_total = 0.0f;

				PdfPCell cell11 = new PdfPCell(new Phrase(""+col_total,f1));
				cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell11);
				lstcol_total = lstcol_total + col_total ;
				col_total = 0.0f;

				PdfPCell cell5 = new PdfPCell(new Phrase(""+medical_total,f1));
				cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell5);
				lstmedical_total = lstmedical_total + medical_total;
				medical_total = 0.0f;

				PdfPCell cell8 = new PdfPCell(new Phrase(""+convall_total,f1));
				cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell8);
				lstconvall_total = lstconvall_total + convall_total;
				convall_total = 0.0f;

				PdfPCell cell6 = new PdfPCell(new Phrase(""+edu_total,f1));
				cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell6);
				lstedu_total = lstedu_total +edu_total;
				edu_total = 0.0f;

				PdfPCell cell9 = new PdfPCell(new Phrase(""+minins_total,f1));
				cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell9);
				lstminins_total = lstminins_total + minins_total ;
				minins_total = 0.0f;

				PdfPCell cell7 = new PdfPCell(new Phrase(""+splall_total,f1));
				cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell7);
				lstsplall_total = lstsplall_total + splall_total;
				splall_total = 0.0f;

				PdfPCell cell10 = new PdfPCell(new Phrase(""+addlss_total,f1));
				cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell10);
				lstaddlss_total = lstaddlss_total + addlss_total ;
				addlss_total = 0.0f;

				PdfPCell cell12 = new PdfPCell(new Phrase(""+special_total,f1));
				cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell12);
				lstspecial_total = lstspecial_total + special_total ;
				special_total = 0.0f;

				PdfPCell cell23 = new PdfPCell(new Phrase(""+addinc_total,f1));
				cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell23);
				lstaddinc_total = lstaddinc_total + addinc_total ;
				addinc_total = 0.0f;

				PdfPCell cell25 = new PdfPCell(new Phrase(""+totinc_total,f1));
				cell25.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell25);
				lsttotinc_total = lsttotinc_total + totinc_total ;
				totinc_total = 0.0f;

				PdfPCell cell13 = new PdfPCell(new Phrase(""+pf_total,f1));
				cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell13);
				lstpf_total = lstpf_total + pf_total ;
				pf_total = 0.0f;

				PdfPCell cell17 = new PdfPCell(new Phrase(""+esic_total,f1));
				cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell17);
				lstesic_total = lstesic_total  + esic_total ;
				esic_total =0.0f;

				PdfPCell cell14 = new PdfPCell(new Phrase(""+pt_total,f1));
				cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell14);
				lstpt_total = lstpt_total + pt_total ;
				pt_total = 0.0f;

				PdfPCell cell20 = new PdfPCell(new Phrase(""+tds_total,f1));
				cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell20);
				lsttds_total = lsttds_total  + tds_total ;
				tds_total =0.0f;

				PdfPCell cell19 = new PdfPCell(new Phrase(""+adv_total,f1));
				cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell19);
				lstadv_total = lstadv_total  + adv_total ;
				adv_total =0.0f;

				PdfPCell cell16 = new PdfPCell(new Phrase(""+mlwf_total,f1));
				cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell16);
				lstmlwf_total = lstmlwf_total  + mlwf_total ;
				mlwf_total =0.0f;

				PdfPCell cell18 = new PdfPCell(new Phrase(""+mob_total,f1));
				cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell18);
				lstmob_total = lstmob_total  + mob_total ;
				mob_total =0.0f;

				PdfPCell cell22 = new PdfPCell(new Phrase(""+netc_total,f1));
				cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell22);
				lstnetc_total = lstnetc_total  + netc_total;
				netc_total =0.0f;

				PdfPCell cell15 = new PdfPCell(new Phrase(""+lic_total,f1));
				cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell15);
				lstlic_total = lstlic_total + lic_total;
				lic_total = 0.0f;

				PdfPCell cell21 = new PdfPCell(new Phrase(""+relif_total,f1));
				cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell21);
				lstrelif_total = lstrelif_total  + relif_total ;
				relif_total =0.0f;

				PdfPCell cell24 = new PdfPCell(new Phrase(""+addded_total,f1));
				cell24.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell24);
				lstaddded_total = lstaddded_total + addded_total ;
				addded_total = 0.0f;

				PdfPCell cell26 = new PdfPCell(new Phrase(""+totded_total,f1));
				cell26.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell26);
				lsttotded_total = lsttotded_total + totded_total ;
				totded_total = 0.0f;

				PdfPCell cell27 = new PdfPCell(new Phrase(""+netpay_total,f1));
				cell27.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell27);
				lstnetpay_total = lstnetpay_total + netpay_total ;
				netpay_total = 0.0f;

				doc.add(datatot);

				para = new Paragraph(new Phrase("No Of Employee :- "+br_tot_no_emp,f));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(10);
				doc.add(para);

			}
			para = new Paragraph(new Phrase("Total No Of Employee :- "+tot_no_emp,f));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(40);
			doc.add(para);

			System.out.println("Total No Of Employee :- "+tot_no_emp);

			/*PdfPTable main = new PdfPTable(26);
					main.setSpacingBefore(10);
					main.setWidthPercentage(new float[]{5,4.6f,3.6f,3.6f,3.6f,3.6f,3.6f,3.6f,3.6f,3.6f,3.6f,3.6f,3.6f,3.6f,3.6f,3.6f,3.6f,3.6f,3.6f,3.6f,3.6f,3.6f,4.6f,4.6f,4.6f,4.6f,}, rec);
					PdfPCell maincell ;

					maincell = new PdfPCell(new Phrase("Summary",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					//maincell.setColspan(2);
					maincell.setFixedHeight(60);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Basic",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("H.R.A",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Col",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Medical",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Conv All",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Education",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Min Ins.",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Spl All",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Earn 1",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Earn 2",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Add Income",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Tot income",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("P.F",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("E.S.I.C",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("P.T",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("T.D.S",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Advance",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Loan Ded",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Mobile Ded",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Net Chrgs",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("L.I.C",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Relief Fund",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Add Ded.",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Tot Ded.",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Net Pay",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);


				maincell = new PdfPCell(new Phrase("Gross Total :",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				//maincell.setColspan(2);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstbasic_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lsthra_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstcol_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstmedical_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstconvall_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstedu_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstminins_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstsplall_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstaddlss_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstspecial_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstaddinc_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lsttotinc_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstpf_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstesic_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstpt_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lsttds_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstadv_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstmlwf_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstmob_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstnetc_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstlic_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstrelif_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstaddded_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lsttotded_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""+trans((int)(lstnetpay_total), "", "", false, false),f2));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);*/

			para = new Paragraph(new Phrase("-:Summary :- ",new Font(Font.HELVETICA,40,Font.BOLDITALIC)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);
			doc.add(para);

			PdfPTable main = new PdfPTable(10);
			main.setSpacingBefore(10);
			main.setWidthPercentage(new float[]{10,10,10,10,10,10,10,10,10,10}, rec);
			PdfPCell maincell ;

			/*maincell = new PdfPCell(new Phrase("Summary",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					//maincell.setColspan(2);
					maincell.setFixedHeight(60);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Gross Total :",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					//maincell.setColspan(2);
					main.addCell(maincell);*/

			maincell = new PdfPCell(new Phrase("Basic Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lstbasic_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("H.R.A Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lsthra_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Col Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lstcol_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Medical Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lstmedical_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Conv All Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lstconvall_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Education Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lstedu_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Min Ins. Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lstminins_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Spl All Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lstsplall_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Earn 1 Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lstaddlss_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Earn 2 Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lstspecial_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Add Income Total:-",f));
			maincell.setFixedHeight(50);
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lstaddinc_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Tot income Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lsttotinc_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("P.F Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lstpf_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("E.S.I.C Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lstesic_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("P.T Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lstpt_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("T.D.S Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lsttds_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Advance Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lstadv_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Loan Ded Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lstmlwf_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Mobile Ded Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lstmob_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Net Chrgs Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lstnetc_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("L.I.C Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lstlic_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Relief Fund Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lstrelif_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Add Ded. Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lstaddded_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Tot Ded. Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+trans((int)(lsttotded_total), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Net Pay Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			float tttt=0;
			ResultSet rsss;
			try
			{
				//System.out.println("date===="+date);
				Statement sttt =con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
				rs=st.executeQuery("select sum(net_amt) from paytran where trndt between '"+ReportDAO.BOM(PAYREGDT)+"' and '"+ReportDAO.EOM(PAYREGDT)+"'  and trncd=999  union  " +
						"select sum(net_amt) from paytran_stage where trndt between '"+ReportDAO.BOM(PAYREGDT)+"' and '"+ReportDAO.EOM(PAYREGDT)+"'  and trncd=999 ");


				while(rs.next())
				{
					tttt+=rs.getFloat(1);
				}
			}
			catch(Exception e)
			{
				e.printStackTrace();
			}


			maincell = new PdfPCell(new Phrase(""+trans((int)(tttt), "", "", false, false),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);
			doc.add(main);

			doc.add(Chunk.NEWLINE);
			doc.add(Chunk.NEWLINE);
			doc.add(Chunk.NEWLINE);
			doc.add(Chunk.NEWLINE);

			/*if(TName.equalsIgnoreCase("after")) {*/
			para = new Paragraph(new Phrase("Prepared By                         Checked By                        Approved By                 ",new Font(Font.TIMES_ROMAN,35,Font.BOLD)));
			para.setAlignment(Element.ALIGN_RIGHT);
			doc.add(para);
			/*}*/

			System.out.println("last basic = "+lstbasic_total);
			System.out.println("last hra = "+lsthra_total);
			System.out.println("last medical = "+lstmedical_total);
			System.out.println("last education = "+lstedu_total);
			System.out.println("last splall = "+lstsplall_total);
			System.out.println("last convall = "+lstconvall_total);
			System.out.println("last minins = "+lstminins_total);
			System.out.println("last addless = "+lstaddlss_total);
			System.out.println("last col = "+lstcol_total);
			System.out.println("last special = "+lstspecial_total);
			System.out.println("last pf = "+lstpf_total);
			System.out.println("last pt = "+lstpt_total);
			System.out.println("last lic = "+lstlic_total);
			System.out.println("last mlwf = "+lstmlwf_total);
			System.out.println("last esic = "+lstesic_total);
			System.out.println("last mob = "+lstmob_total);
			System.out.println("last adv = "+lstadv_total);
			System.out.println("last tds = "+lsttds_total);
			System.out.println("last relif = "+lstrelif_total);
			System.out.println("last netc = "+lstnetc_total);
			System.out.println("last addinc = "+lstaddinc_total);
			System.out.println("last addded = "+lstaddded_total);
			System.out.println("last totinc = "+lsttotinc_total);
			System.out.println("last totded = "+lsttotded_total);
			System.out.println("last totnetpay = "+lstnetpay_total);


			st.close();
			con.close();
			doc.close();


			}

		}

		catch(Exception e)
		{
			e.printStackTrace();
		}

	}

	public static void IncDedRpt(String rdt,String filepath, String imagepath,String code,String table, String type, String branch, String fromrng, String torng) 
	{
		RepoartBean repBean  = new RepoartBean();
		Connection Cn = null;
		ResultSet emp = null;
		ResultSet emp1=null;
		String EmpSql = "";
		String EmpSql1 = "";
		String []predate={""};
		String newpre="";
		int premonth=0;
		String pm="";
		float totincded = 0.0f;
		float totincded1=0.0f;
		float pretotincded1=0.0f;
		float pretotincded=0.0f;
		float Total_incded = 0.0f;
		float Total_incded1 = 0.0f;
		float Total_preincded = 0.0f;
		float Total_preincded1 = 0.0f;
		
		ReportDAO.OpenCon("", "", "",repBean);
		Cn = repBean.getCn();
		Statement st=null;
		Statement st1=null;

		SimpleDateFormat outputFormat = new SimpleDateFormat("dd/MM/yyyy");
		SimpleDateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd");
		predate=rdt.split("-");
		premonth=ReportDAO.getMonth(rdt)==0?11:ReportDAO.getMonth(rdt)-1;
		System.out.println("previous month.."+premonth);
		/*if(premonth==0)
		{
			premonth=11;
		}*/
		 pm=ReportDAO.getMonthinString(premonth);
			String pdate=predate[2];
			int prdate=Integer.parseInt(pdate);
			System.out.println("previous month.."+pm+" year..."+prdate);
			prdate=premonth==11?prdate - 1:prdate;
			pdate=String.valueOf(prdate);
			System.out.println("pdate is.."+pdate);
			predate[2]=pdate;
			newpre=predate[0]+"-"+pm+"-"+predate[2];
			System.out.println("previous..."+newpre);
			newpre=ReportDAO.EOM(newpre);
			System.out.println("previous date.."+newpre);
			try {
			st = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			Statement stmt = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);

			try
			{
				Document doc = new Document();
				PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
				doc.open();
				doc.setPageSize(PageSize.A4);

				Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
				Image image1 = Image.getInstance(imagepath);
				Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);

				image1.scaleAbsolute(60f,50f);
				image1.setAbsolutePosition(40f, 750f);

				doc.add(image1);
				doc.add(para);

				para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);

				para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);

				para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);

				if(table.equalsIgnoreCase("paytran")){
					para = new Paragraph(new Phrase("(Before Finalize Of Salary)",new Font(Font.TIMES_ROMAN,5)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);
				}

				String phara = "SELECT LKP_DISC,LKP_SRNO FROM LOOKUP WHERE LKP_CODE='CDTYPE' AND LKP_SRNO!=0 and LKP_SRNO = (select CDTYPE from CDMAST where TRNCD = "+code+") order by LKP_SRNO";
				Statement pa = Cn.createStatement();
				ResultSet par = pa.executeQuery(phara);
				String disp = "";
				int srno = 0;
				if(par.next()){
					disp = par.getString(1);
					srno = par.getInt(2);
				}
				if(srno!=1)
					disp = "DEDUCTION";
				para = new Paragraph(new Phrase(CodeMasterHandler.getCDesc(Integer.parseInt(code))+" "+disp+" Report For Month :" + rdt.substring(3),new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);

				Rectangle rec = new  Rectangle(100,100);
				PdfPTable headtab = null;

				headtab= new PdfPTable(6);	
				headtab.setSpacingBefore(3);
				headtab.setWidthPercentage(new float[]{8,32,15,15,15,15}, rec);
				headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
				headtab.setSpacingBefore(10);
				
				String GetBranch = "SELECT "+
						"distinct T.prj_srno as branch,PS.SITE_NAME "+
						"FROM   empmast EMP,"+
						"emptran T,Project_Sites PS "+
						"WHERE  T.empno = EMP.empno  and PS.SITE_ID = T.prj_srno "+
						"AND T.srno = (SELECT Max(E2.srno)  "+
						"FROM   emptran E2 "+
						"WHERE  E2.empno = EMP.empno) "+
						"AND EMP.status = 'A'"+
						"ORDER  BY T.prj_srno";  
	
				ResultSet rspt0 = stmt.executeQuery(GetBranch);
				System.out.println("GetBranch "+GetBranch);

				/*EmpSql = "SELECT emp.EMPNO,emp.EMPCODE ,rtrim(emp.fname)+' '+rtrim(emp.lname)as name,emp.SALUTE," +
				    		"(SELECT INP_AMT FROM PAYTRAN WHERE TRNCD = 135 AND TRNDT BETWEEN '"+ReportDAO.BOM(rdt)+"'and '"+ReportDAO.EOM(rdt)+"' AND EMPNO = emp.EMPNO)as bonus " +
				    		"FROM EMPMAST emp,EMPTRAN t WHERE t.EMPNO = emp.EMPNO AND t.EFFDATE = (SELECT MAX(E2.EFFDATE) FROM EMPTRAN E2 " +
							" WHERE E2.EMPNO = emp.EMPNO AND E2.EFFDATE <= '"+rdt+"') and emp.STATUS = 'A' ORDER BY emp.EMPNO";
				 */
				/*EmpSql = "SELECT emp.EMPNO,emp.EMPCODE ,rtrim(emp.fname)+' '+rtrim(emp.lname)as name,emp.SALUTE,p.Net_AMT as amt,p.INP_AMT as inp" +
						" FROM EMPMAST emp join "+table+" p on emp.EMPNO = p.EMPNO,EMPTRAN t WHERE t.EMPNO = emp.EMPNO AND t.srno = (SELECT MAX(E2.srno) FROM EMPTRAN E2 " +
						" WHERE E2.EMPNO = emp.EMPNO AND E2.EFFDATE <= '"+ReportDAO.EOM(rdt)+"') and p.TRNCD ="+code+" and p.TRNDT BETWEEN '"+ReportDAO.BOM(rdt)+"'and '"+ReportDAO.EOM(rdt)+"' ORDER BY emp.EMPNO";
				System.out.println(EmpSql);
				emp = st.executeQuery(EmpSql);
			
				EmpSql1="SELECT emp.EMPNO,emp.EMPCODE ,rtrim(emp.fname)+' '+rtrim(emp.lname)as name,emp.SALUTE,p.Net_AMT as amt,p.INP_AMT as inp" +
						" FROM EMPMAST emp join paytran_stage p on emp.EMPNO = p.EMPNO,EMPTRAN t WHERE t.EMPNO = emp.EMPNO AND t.srno = (SELECT MAX(E2.srno) FROM EMPTRAN E2 " +
						" WHERE E2.EMPNO = emp.EMPNO AND E2.EFFDATE <= '"+ReportDAO.EOM(newpre)+"') and p.TRNCD ="+code+" and p.TRNDT BETWEEN '"+ReportDAO.BOM(newpre)+"'and '"+ReportDAO.EOM(newpre)+"' ORDER BY emp.EMPNO";
				System.out.println(EmpSql1);
				emp1 = st1.executeQuery(EmpSql1);*/
				
				/*EmpSql="SELECT emp.EMPNO,emp.EMPCODE ,rtrim(emp.fname)+' '+rtrim(emp.lname)as name,"+
								"emp.SALUTE,p.Net_AMT as amt,p.INP_AMT as inp ,"+
								"p2.Net_AMT as amt1,p2.INP_AMT as inp1 "+ 
								"FROM EMPMAST "+ 
								"emp join   "+table+" p "+ 
								"on emp.EMPNO = p.EMPNO "+ 
								", paytran_stage p2 "+ 
								"WHERE "+ 
								"emp.empno = p.empno "+ 
								"and emp.empno = p2.empno "+ 
								"and p.TRNCD ='"+code+"' "+
								"and p.TRNDT BETWEEN '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"' "+ 
								"and p2.TRNCD ='"+code+"' "+ 
								"and p2.TRNDT BETWEEN '"+ReportDAO.BOM(newpre)+"' and '"+ReportDAO.EOM(newpre)+"' and (p.Net_AMT!=0 or p2.Net_AMT!=0) order by EMPCODE  ";
				*/
				
				//last query given by akshy..@ni
				if(type.equalsIgnoreCase("1"))
				{
				EmpSql="with lastmonth as"+
						"(SELECT emp.empno,emp.EMPCODE,Rtrim(emp.fname) + ' ' + Rtrim(emp.lname) AS name, "+ 
						"emp.salute, p.net_amt  AS amt, p.inp_amt AS inp,t1.prj_srno FROM   empmast emp,emptran t1 ,"+table+"  p "+ 
						"WHERE     emp.empno = p.empno AND emp.empno=t1.empno AND t1.srno=(select MAX(srno) from emptran where empno=emp.empno) AND p.trncd = '"+code+"' " +
						"AND p.trndt BETWEEN '"+ReportDAO.BOM(rdt)+"' AND '"+ReportDAO.EOM(rdt)+"' and p.INP_AMT <> 0  ),"+
						"thismonth as "+ 
						"(SELECT emp.empno, emp.EMPCODE,Rtrim(emp.fname) + ' ' + Rtrim(emp.lname) AS name, "+ 
						"emp.salute,p2.net_amt AS amt1,p2.inp_amt AS inp1,t1.prj_srno FROM   empmast emp ,emptran t1 , PAYTRAN_STAGE  p2 "+ 
						"WHERE     emp.empno = p2.empno AND emp.empno=t1.empno AND t1.srno=(select MAX(srno) from emptran where empno=emp.empno)  AND p2.trncd = '"+code+"' "+       
						"AND p2.trndt BETWEEN '"+ReportDAO.BOM(newpre)+"' AND '"+ReportDAO.EOM(newpre)+"' and p2.INP_AMT <> 0 ) "+
						"select ISNULL( t.EMPNO , l.EMPNO ) empno , ISNULL( t.EMPcode , l.EMPcode ) EMPCODE , "+ 
						"ISNULL( t.NAME , l.name ) name ,ISNULL( t.salute , l.salute ) salute ,"+
						"amt,inp,ISNULL(amt1,0.00)as amt1 ,ISNULL(inp1,0.00)as inp1,ISNULL(t.prj_srno,l.prj_srno)as prj_srno "+
						"from lastmonth l full outer join  thismonth t on  ( l.empno = t.EMPNO  ) order by prj_srno, EMPCODE ";
				}
				else if(type.equalsIgnoreCase("2"))
				{
					EmpSql="with lastmonth as"+
							"(SELECT emp.empno,emp.EMPCODE,Rtrim(emp.fname) + ' ' + Rtrim(emp.lname) AS name, "+ 
							"emp.salute, p.net_amt  AS amt, p.inp_amt AS inp,t1.prj_srno FROM   empmast emp ,emptran t1 ,"+table+"  p "+ 
							"WHERE     emp.empno = p.empno AND emp.empno=t1.empno AND t1.srno=(select MAX(srno) from emptran where empno=emp.empno) AND t1.prj_srno="+branch+" AND p.trncd = '"+code+"' " +
							"AND p.trndt BETWEEN '"+ReportDAO.BOM(rdt)+"' AND '"+ReportDAO.EOM(rdt)+"' and p.INP_AMT <> 0  ),"+
							"thismonth as "+ 
							"(SELECT emp.empno, emp.EMPCODE,Rtrim(emp.fname) + ' ' + Rtrim(emp.lname) AS name, "+ 
							"emp.salute,p2.net_amt AS amt1,p2.inp_amt AS inp1,t1.prj_srno FROM   empmast emp ,emptran t1, PAYTRAN_STAGE  p2 "+ 
							"WHERE     emp.empno = p2.empno AND emp.empno=t1.empno AND t1.srno=(select MAX(srno) from emptran where empno=emp.empno) AND t1.prj_srno="+branch+" AND p2.trncd = '"+code+"' "+       
							"AND p2.trndt BETWEEN '"+ReportDAO.BOM(newpre)+"' AND '"+ReportDAO.EOM(newpre)+"' and p2.INP_AMT <> 0 ) "+
							"select ISNULL( t.EMPNO , l.EMPNO ) empno , ISNULL( t.EMPcode , l.EMPcode ) EMPCODE , "+ 
							"ISNULL( t.NAME , l.name ) name ,ISNULL( t.salute , l.salute ) salute ,"+
							"amt,inp,ISNULL(amt1,0.00)as amt1 ,ISNULL(inp1,0.00)as inp1,ISNULL(t.prj_srno,l.prj_srno)as prj_srno "+
							"from lastmonth l full outer join  thismonth t on  ( l.empno = t.EMPNO  ) order by prj_srno, EMPCODE ";
				}
				else if(type.equalsIgnoreCase("3"))
				{
					EmpSql="with lastmonth as"+
							"(SELECT emp.empno,emp.EMPCODE,Rtrim(emp.fname) + ' ' + Rtrim(emp.lname) AS name, "+ 
							"emp.salute, p.net_amt  AS amt, p.inp_amt AS inp,t1.prj_srno FROM   empmast emp ,emptran t1,"+table+"  p "+ 
							"WHERE     emp.empno = p.empno AND emp.empno=t1.empno AND t1.srno=(select MAX(srno) from emptran where empno=emp.empno) AND t1.prj_srno between "+fromrng+" AND "+torng+" AND p.trncd = '"+code+"' " +
							"AND p.trndt BETWEEN '"+ReportDAO.BOM(rdt)+"' AND '"+ReportDAO.EOM(rdt)+"' and p.INP_AMT <> 0  ),"+
							"thismonth as "+ 
							"(SELECT emp.empno, emp.EMPCODE,Rtrim(emp.fname) + ' ' + Rtrim(emp.lname) AS name, "+ 
							"emp.salute,p2.net_amt AS amt1,p2.inp_amt AS inp1,t1.prj_srno FROM   empmast emp ,emptran t1, PAYTRAN_STAGE  p2 "+ 
							"WHERE     emp.empno = p2.empno AND emp.empno=t1.empno AND t1.srno=(select MAX(srno) from emptran where empno=emp.empno) AND t1.prj_srno between "+fromrng+" AND "+torng+" AND p2.trncd = '"+code+"' "+       
							"AND p2.trndt BETWEEN '"+ReportDAO.BOM(newpre)+"' AND '"+ReportDAO.EOM(newpre)+"' and p2.INP_AMT <> 0 ) "+
							"select ISNULL( t.EMPNO , l.EMPNO ) empno , ISNULL( t.EMPcode , l.EMPcode ) EMPCODE , "+ 
							"ISNULL( t.NAME , l.name ) name ,ISNULL( t.salute , l.salute ) salute ,"+
							"amt,inp,ISNULL(amt1,0.00)as amt1 ,ISNULL(inp1,0.00)as inp1,ISNULL(t.prj_srno,l.prj_srno)as prj_srno "+
							"from lastmonth l full outer join  thismonth t on  ( l.empno = t.EMPNO  ) order by prj_srno, EMPCODE ";
				}
				System.out.println(EmpSql);
				emp = st.executeQuery(EmpSql);
				
				LookupHandler lkhp = new LookupHandler();
				int tot_no_emp = 0;
				int cnt=0;
				if(emp.next()){
					
					emp.previous();
					while(rspt0.next())
					{
						emp.next();
						if(rspt0.getInt("BRANCH") == emp.getInt("prj_srno"))
						{
							
					para = new Paragraph(new Phrase("Employee's  List For Project Site :  "+rspt0.getString("SITE_NAME"),new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(5);
					doc.add(para);
						}emp.previous();
					//headtab.addCell(para);
					PdfPTable table1=new PdfPTable(6);
					table1.setSpacingBefore(10.0f);
					table1.setWidthPercentage(new float[]{8,32,15,15,15,15},new Rectangle(100,100));
					PdfPCell c1 = new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));  
					table1.addCell(c1);
					PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					table1.addCell(c2);
					PdfPCell c3 = new PdfPCell(new Phrase(""+pm.substring(0, 1).toUpperCase()+pm.substring(1, 3).toLowerCase()+" (Input)",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					table1.addCell(c3); 
					PdfPCell c4 = new PdfPCell(new Phrase(""+pm.substring(0, 1).toUpperCase()+pm.substring(1, 3).toLowerCase()+" (Calculate)",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					table1.addCell(c4); 
					PdfPCell c5 = new PdfPCell(new Phrase(""+predate[1].substring(0, 1).toUpperCase()+predate[1].substring(1, 3)+" (Input)",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					table1.addCell(c5); 
					PdfPCell c6 = new PdfPCell(new Phrase(""+predate[1].substring(0, 1).toUpperCase()+predate[1].substring(1, 3)+" (Calculate)",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					table1.addCell(c6); 
					table1.setHeaderRows(1);
					
					//PdfPTable datatab;
					while(emp.next())
					{
						System.out.println("BRANCH===>"+rspt0.getInt("BRANCH")+"EMP BRANCH===>"+emp.getInt("prj_srno"));
						if(rspt0.getInt("BRANCH") == emp.getInt("prj_srno"))
						{
							System.out.println("111");
						float incded = 0.0f;
						incded = emp.getFloat("amt");

						float incded1 = 0.0f;
						incded1 = emp.getFloat("inp");
						
						float preincded = 0.0f;
						preincded = emp.getFloat("amt1");

						float preincded1 = 0.0f;
						preincded1 = emp.getFloat("inp1");

						PdfPCell c7 = new PdfPCell(new Phrase(""+emp.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8)));  
						table1.addCell(c7);
						PdfPCell c8 = new PdfPCell(new Phrase(""+lkhp.getLKP_Desc("SALUTE", emp.getInt("SALUTE"))+" "+emp.getString("name"),new Font(Font.TIMES_ROMAN,8)));
						table1.addCell(c8);
						pretotincded1 = pretotincded1+preincded1;
						PdfPCell c9= new PdfPCell(new Phrase(""+preincded1,new Font(Font.TIMES_ROMAN,8)));
						table1.addCell(c9);
						
						pretotincded = pretotincded+preincded;
						PdfPCell c10 = new PdfPCell(new Phrase(""+preincded,new Font(Font.TIMES_ROMAN,8)));
						table1.addCell(c10);
						
						
						totincded1 = totincded1+incded1;
						PdfPCell c11= new PdfPCell(new Phrase(""+incded1,new Font(Font.TIMES_ROMAN,8)));
						table1.addCell(c11);
						totincded = totincded+incded;
						PdfPCell c12 = new PdfPCell(new Phrase(""+incded,new Font(Font.TIMES_ROMAN,8)));
						table1.addCell(c12);
						tot_no_emp = tot_no_emp +1;
						
						Total_incded+= emp.getFloat("amt");
						Total_incded1+= emp.getFloat("inp");
						Total_preincded+= emp.getFloat("amt1");
						Total_preincded1+= emp.getFloat("inp1");
						}
						else{
							emp.previous();
							break;
						}
						
						
						
					}
					PdfPTable table2=new PdfPTable(6);
					if(tot_no_emp>0){
					
					table2.setSpacingBefore(5.0f);
					table2.setWidthPercentage(new float[]{8,32,15,15,15,15},new Rectangle(100,100));
					PdfPCell tot = new PdfPCell(new Phrase("Total:",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					tot.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tot.setColspan(2);
					table2.addCell(tot);
					PdfPCell tot1 = new PdfPCell(new Phrase(""+trans((int)(pretotincded1), "", "", false, false),new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					table2.addCell(tot1);
					PdfPCell tot2 = new PdfPCell(new Phrase(""+trans((int)(pretotincded), "", "", false, false),new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					table2.addCell(tot2);
					PdfPCell tot3 = new PdfPCell(new Phrase(""+trans((int)(totincded1), "", "", false, false),new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					table2.addCell(tot3);
					PdfPCell tot4 = new PdfPCell(new Phrase(""+trans((int)(totincded), "", "", false, false),new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					table2.addCell(tot4);
					}
					pretotincded1=0;
					pretotincded=0;
					totincded1=0;
					totincded=0;
					doc.add(table1);
					doc.add(table2);
					
					if(!rspt0.next()||!emp.next())
					{
						break;
					}
					else{
						tot_no_emp=0;
						rspt0.previous();
						emp.previous();
						continue;
					}
						 
				}//doc.add(headtab);
					/*PdfPCell tot = new PdfPCell(new Phrase("Total:",new Font(Font.TIMES_ROMAN,8)));
					tot.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tot.setColspan(3);
					headtab.addCell(tot);
					PdfPCell tot1 = new PdfPCell(new Phrase(""+trans((int)(totincded), "", "", false, false),new Font(Font.TIMES_ROMAN,8)));
					headtab.addCell(tot1);*/
					
					
					para = new Paragraph(new Phrase("SUMMERY :- ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(5);
					doc.add(para);
					
					PdfPCell tot = new PdfPCell(new Phrase("Total Summery:",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					tot.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tot.setColspan(2);
					headtab.addCell(tot);
					PdfPCell tot1 = new PdfPCell(new Phrase(""+trans((int)(Total_preincded1), "", "", false, false),new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					headtab.addCell(tot1);
					PdfPCell tot2 = new PdfPCell(new Phrase(""+trans((int)(Total_preincded), "", "", false, false),new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					headtab.addCell(tot2);
					PdfPCell tot3 = new PdfPCell(new Phrase(""+trans((int)(Total_incded1), "", "", false, false),new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					headtab.addCell(tot3);
					PdfPCell tot4 = new PdfPCell(new Phrase(""+trans((int)(Total_incded), "", "", false, false),new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					headtab.addCell(tot4);
					doc.add(headtab);

				}
				else{
					System.out.println("no record found");
					PdfPCell c1 = new PdfPCell(new Phrase("Record Not found for the Month "+rdt.substring(3),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
					c1.setColspan(6);
					//table.setSpacingBefore(40);
					headtab.addCell(c1);	
					doc.add(headtab);
				}
				
				doc.close();
				Cn.close();
				System.out.println("Completed");
			}
			catch(Exception e)
			{
				e.printStackTrace();
			}

		} catch (Exception e) {
			e.printStackTrace();
		} 
	}


	public static void getMlwfchallan(String filePath, String date,String imagepath,String table_name) throws IOException, SQLException, DocumentException 
	{
		OutputStream file = new FileOutputStream(new File(filePath));
		Document document = new Document();
		lable1="Report date : ";
		try {
			UtilityDAO dao = new UtilityDAO();
			PdfWriter writer =PdfWriter.getInstance(document, new FileOutputStream(filePath));

			Footer ftr = dao.new Footer(lable1);
			writer.setPageEvent(ftr);
			document.open();

			Phrase title = new Phrase("MLWF Challan",new Font(Font.TIMES_ROMAN,10,Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(20);
			document.add(para);

			para = new Paragraph(new Phrase("MAHARASHTRA LABOUR WELFARE BOARD",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(10);			
			document.add(para);

			para = new Paragraph(new Phrase("Mumbai Girni Kamgar Kreeda Bhavan, S. B. Marg, Elphistone, Mum: 13",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase("Tel. # 2422 77 58 / 2430 67 17.",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase("Form A-1 Cum Return",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase("(Wide Rule 3-A)",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(30);
			document.add(para);


			para = new Paragraph(new Phrase("NOTE: 1) This form-cum-return to be submitted by every Employer alongwith the payment of Employees' & Employer's",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);
			para = new Paragraph(new Phrase("Six-Monthly contribution made by him in respect of all employees whose names stand on the register of his establishment as on 30th June/31st D",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);


			para = new Paragraph(new Phrase("2) Section 2(2) (b) of Bombay Labour Welfare Fund Act, 1953 'Supervisor' means-who, being employed in a supervisory capacity,",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase("draws wages exceeding tow thousand five hundred rupee per mensem or ecercise, either by the nature of the duties attached to the",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase("3) EEC = Employees' contribution, ERC = Employer's contribution.",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase("4) Total number of employees whose names stood on the establishment registed as on December 2010",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase("a. Manager",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);


			para = new Paragraph(new Phrase("b. Employees working in supervisory capacity drawing wages Rs. 2500/- per month",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase("c. Employees drawing wages exceeding Rs.3000/- Per Month. (EEC@ Rs. 12/- Per Employee & ERC@ Rs.36/- Per Employee",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase("d. Employees drawing wages upto & inclusiove of Rs. 3000/- Per Month. (EEC@ Rs. 6/- Per Employee & ERC@ Rs.18/- Per Employee",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase("5) Total Amount of contribution paid along with this Form A-1-Cum-Return",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(10);
			document.add(para);


			para = new Paragraph(new Phrase(" For Month of : "+ date.substring(3,11),new Font(Font.TIMES_ROMAN,10)));
			para.setAlignment(Element.ALIGN_LEFT);
			// para.setSpacingBefore(30.0f);
			para.setSpacingAfter(30);
			document.add(para);

			para = new Paragraph(new Phrase("Name and address of the Factory/Estt : THE NASIK MARCHANT'S CO-OP BANK LTD.,                         CODE NO:_________",new Font(Font.TIMES_ROMAN,10)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(10);
			document.add(para);
			para = new Paragraph(new Phrase("New Pandit Colony, Gangapur Road, Nashik 422005.                    ",new Font(Font.TIMES_ROMAN,10)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(40);
			document.add(para);

			PdfPTable table=new PdfPTable(7);
			table.setSpacingBefore(10.0f);
			table.setWidthPercentage(new float[]{15,15,15,15,15,10,15,},new Rectangle(100,100));

			PdfPCell cell1=new PdfPCell(new Phrase("No of Employees",new Font(Font.TIMES_ROMAN,11)));
			cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1);

			PdfPCell cell2=new PdfPCell(new Phrase("No of employee @ 6",new Font(Font.TIMES_ROMAN,11)));
			cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell2);

			PdfPCell cell3=new PdfPCell(new Phrase("No of employee @ 12",new Font(Font.TIMES_ROMAN,11)));
			cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell3);

			PdfPCell cell4=new PdfPCell(new Phrase("EEC (Employee's Contribution)",new Font(Font.TIMES_ROMAN,11)));
			cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell4);
			PdfPCell cell5=new PdfPCell(new Phrase("EER (Employer's Contribution)",new Font(Font.TIMES_ROMAN,11)));
			cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell5);
			PdfPCell cell6=new PdfPCell(new Phrase("Penel Interest",new Font(Font.TIMES_ROMAN,11)));
			cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell6);
			PdfPCell cell7=new PdfPCell(new Phrase("Total (Rs)",new Font(Font.TIMES_ROMAN,11)));
			cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell7);


			table.setHeaderRows(1);


			table_name=table_name.equalsIgnoreCase("before")?"PAYTRAN":"PAYTRAN_STAGE";

			Connection con=null;
			con=ConnectionManager.getConnection();
			Statement stmt=con.createStatement();
			ResultSet rspt = null;
			float emp_mlwf=0;
			float empr_mlwf=0;
			int total_emp=0;
			int empsix=0;
			int emptwl=0;
			float empsamt=0;

			String sql = "select Count(Distinct(empno)) from "+table_name+" where trncd=211 and trndt between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"' and cal_amt>0";

			rspt = stmt.executeQuery(sql);

			while(rspt.next())
			{
				total_emp=rspt.getInt(1);
			}


			rspt=stmt.executeQuery("select Count(Distinct(empno)),cal_amt,sum(cal_amt) from "+table_name+" where  trncd=211 and  trndt between '"+ReportDAO.BOM(date)+"'" +
					" and '"+ReportDAO.EOM(date)+"'  group by cal_amt  ");

			while(rspt.next()){

				if(rspt.getInt("cal_amt")==6)
				{
					empsix=rspt.getInt(1);
				}

				if(rspt.getInt("cal_amt")==12)
				{
					emptwl=rspt.getInt(1);
				}

				empsamt=rspt.getInt(3);
			}


			rspt=stmt.executeQuery("select trncd,Sum(cal_amt) from "+table_name+" where trncd in(211,237) and trndt between '"+ReportDAO.BOM(date)+"'" +
					" and '"+ReportDAO.EOM(date)+"'  group by TRNCD ");


			while(rspt.next()){


				if(rspt.getInt("trncd")==211)
				{
					emp_mlwf=(int)rspt.getFloat(2);
				}

				if(rspt.getInt("trncd")==237)
				{
					empr_mlwf=(int)rspt.getFloat(2);
				}

			}	

			PdfPCell cell1data1=new PdfPCell(new Phrase(" "+total_emp,new Font(Font.TIMES_ROMAN,12)));
			cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1data1);


			PdfPCell cell1data2=new PdfPCell(new Phrase(" "+empsix,new Font(Font.TIMES_ROMAN,12)));
			cell1data2.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1data2);


			PdfPCell cell1data3=new PdfPCell(new Phrase(" "+emptwl,new Font(Font.TIMES_ROMAN,12)));
			cell1data3.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1data3);



			PdfPCell cell1data4=new PdfPCell(new Phrase(" "+emp_mlwf,new Font(Font.TIMES_ROMAN,12)));
			cell1data4.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1data4);


			PdfPCell cell1data5=new PdfPCell(new Phrase(" "+Float.valueOf((total_emp*36)),new Font(Font.TIMES_ROMAN,12))); 
			cell1data5.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1data5);

			PdfPCell cell1data6=new PdfPCell(new Phrase(" "+0 ,new Font(Font.TIMES_ROMAN,12)));
			cell1data6.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1data6);

			PdfPCell cell1data7=new PdfPCell(new Phrase(""+(emp_mlwf+(total_emp*36)),new Font(Font.TIMES_ROMAN,12)));
			cell1data7.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1data7);


			table.setSpacingAfter(50.0f);
			document.add(table);


			para = new Paragraph(new Phrase("Certified that the information / particular furnished above is / are true to the best of my knowledge and belief",new Font(Font.TIMES_ROMAN,10)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(50);
			document.add(para);

			para = new Paragraph(new Phrase("Signature of the Employer or other authorised officer",new Font(Font.TIMES_ROMAN,10)));
			para.setAlignment(Element.ALIGN_RIGHT);
			para.setSpacingAfter(10);
			document.add(para);

			para = new Paragraph(new Phrase("Date :______________                                                           " +
					"                                                        Stamp of the Factory/Estt",new Font(Font.TIMES_ROMAN,10)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(40);
			document.add(para);


			para = new Paragraph(new Phrase("IMPORTANT:",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase("1) Cheque/DD should be drawn to each Estt, Code Number seperately & in favour of Maharashtra Labour Welfare Fund.",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase("2) Cash payment will be accepted from 10.30 am to 3.00 pm.",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase("3) Code No. of the Establishment alloted to you should be quoted at the appropriate place in this form.",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase("4) DD should be payable at BOMBAY only.",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase("5) Please write Establishment code number on the back side of the Cheque/DD",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(10);
			document.add(para);

			document.close();
			file.close();

			stmt.close();
			con.close();
		}
		catch (Exception e)
		{
			e.printStackTrace();
		}
		document.open();	
	}

	public static void newAttendSheet(String PAYREGDT,String imgpath,String filepath)
	{

		System.out.println("in new attendSheet generate");

		RepoartBean repBean  = new RepoartBean();
		UtilityDAO dao = new UtilityDAO();
		Connection con =null;
		String BomDt = "";
		String EomDt = "";
		int lastdat = 0;
		//String dt = PAYREGDT;
		String table_name = null;


		//System.out.println(dt);
		lastdat = (int) Calculate.getDays(PAYREGDT);
		System.out.println("maxdt"+lastdat);
		BomDt = ReportDAO.BOM(PAYREGDT);
		//System.out.println("bomdt "+BomDt);
		EomDt = ReportDAO.EOM(PAYREGDT);
		//System.out.println("eomdt"+EomDt);

		String temp = PAYREGDT.substring(3);
		ResultSet emp = null;
		String EmpSql = ""; 
		String pBrcd1 = "";
		int tot_no_emp = 0;
		int br_tot_no_emp = 0;
		float totmthsal1 = 0.0f;
		float totearning1 = 0.0f;
		float totearning2 = 0.0f;
		float totactualpay = 0.0f;
		float totmobded = 0.0f;
		float totadvanc = 0.0f;
		float totloan = 0.0f;
		float tottds = 0.0f;


		try
		{





			ReportDAO.OpenCon("", "", "",repBean);
			con = repBean.getCn();	
			Statement st = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);


			System.out.println("in attendence sheet");
			Document doc = new Document(new Rectangle(2384,3370));
			PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
			Footer1 ftr = dao.new Footer1(lable1);
			writer.setPageEvent(ftr);
			doc.open();
			Font FONT = new Font(Font.HELVETICA,190, Font.NORMAL, new GrayColor(0.85f));
			ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 1300f, 1830f, 45);			
			Image image1 = Image.getInstance(imgpath);		
			Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,38,Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			image1.scaleAbsolute(310f, 120f);
			image1.setAbsolutePosition(60f, 3200f);
			doc.add(image1);
			doc.add(para);
			para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,28)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,28)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,28)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);

			Font f = new Font(Font.HELVETICA,30);
			Font f1 = new Font(Font.HELVETICA,25);
			Font f2 = new Font(Font.HELVETICA,32);


			para = new Paragraph(new Phrase("Attendence Sheet for the Month Of :- "+temp+" ",new Font(Font.TIMES_ROMAN,25,Font.BOLD)));

			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);

			doc.add(para);

			Rectangle rec = new  Rectangle(100,100);


			float present = 0.0f;
			float absent = 0.0f;
			float leave = 0.0f;
			float halfdays = 0.0f;
			float weekoffdays = 0.0f;
			float holidays = 0.0f;
			float workdays = 0.0f;
			float present2= 0.0f;
			float absent2=0.0f;
			float leave2= 0.0f;
			float half=0.0f;
			float hold =0.0f;
			float wo=0.0f;
			float wd=0.0f;

			/*EmpSql = "SELECT e.EMPCODE ,e.empno ,rtrim(e.fname)+' '+rtrim(e.mname)+' '+rtrim(e.lname)as  name, eat1.site_id as PRJ_SRNO, count (case ATTD_VAL when 'P' then 1 else null end ) as present_days," +
					" count (case ATTD_VAL  when 'A' then 1 else null end ) as absent_days," +
					" count (case ATTD_VAL  when 'L' then 1 else null end ) as Leave_days," +
					" count (case ATTD_VAL  when 'H' then 1 else null end ) as Half_days, " +
					" count (case ATTD_VAL  when 'HD' then 1 else null end ) as Holidays, " +
					" count (case ATTD_VAL  when 'WO' then 1 else null end ) as WeekOffDays " +
					" FROM EMP_ATTENDANCE eat1, EMPMAST e where eat1.ATTD_DATE BETWEEN '"+BomDt+"'and '"+EomDt+"' " +
					" and e.EMPNO = eat1.empno  group by e.empno,e.fname,e.mname,e.lname,eat1.site_id,e.EMPCODE order by eat1.site_id ";*/
			EmpSql="SELECT e.EMPCODE ,e.empno ,rtrim(e.fname)+' '+rtrim(e.mname)+' '+rtrim(e.lname)as  name, t.PRJ_SRNO as PRJ_SRNO," +
					" (select isnull(count  (CASE WHEN ATTD_VAL='P' THEN 1 else null end ),0) from  EMP_ATTENDANCE a1 " +
					"where a1.empno=e.EMPNO and a1.ATTD_DATE BETWEEN '"+BomDt+"' and '"+EomDt+"'  ) as present_days, " +
					"(select isnull( count (case ATTD_VAL  when 'A' then 1 else null end) ,0) from  EMP_ATTENDANCE a1 " +
					"where a1.empno=e.EMPNO and a1.ATTD_DATE BETWEEN '"+BomDt+"' and '"+EomDt+"'  ) as absent_days," +
					" (select isnull(count (case ATTD_VAL  when 'L' then 1 else null end) ,0) from  EMP_ATTENDANCE a1" +
					" where a1.empno=e.EMPNO and a1.ATTD_DATE BETWEEN '"+BomDt+"' and '"+EomDt+"'  ) as Leave_days," +
					" (select isnull( count (case ATTD_VAL  when 'H' then 1 else null end) ,0) from  EMP_ATTENDANCE a1 " +
					"where a1.empno=e.EMPNO and a1.ATTD_DATE BETWEEN '"+BomDt+"' and '"+EomDt+"'  ) as Half_days, " +
					"(select isnull( count (case ATTD_VAL  when 'HD' then 1 else null end ),0) from  EMP_ATTENDANCE a1 " +
					"where a1.empno=e.EMPNO and a1.ATTD_DATE BETWEEN '"+BomDt+"' and '"+EomDt+"'  ) as Holidays, " +
					" (select isnull(count (case ATTD_VAL  when 'WO' then 1 else null end ),0) from  EMP_ATTENDANCE a1" +
					" where a1.empno=e.EMPNO and a1.ATTD_DATE BETWEEN '"+BomDt+"' and '"+EomDt+"'  )  as WeekOffDays " +
					" FROM   EMPMAST e left join   EMPTRAN t on (e.EMPNO=t.EMPNO )" +
					"  where e.STATUS='A'   and DOJ <= '"+BomDt+"'  AND T.SRNO=(SELECT MAX(ET.SRNO) FROM EMPTRAN ET WHERE ET.EMPNO=E.EMPNO)" +
					"  order by t.PRJ_SRNO,e.EMPNO";


			System.out.println(EmpSql);
			ResultSet rs = st.executeQuery(EmpSql);

			while(rs.next()){

				String prj_name = null;
				String prj_code = null;
				Connection conn = ConnectionManager.getConnectionTech();
				Statement stmt = conn.createStatement();
				String prjquery = "select Site_Name,Project_Code from Project_Sites where SITE_ID = '"+rs.getString("PRJ_SRNO")+"'";
				System.out.println(prjquery);
				ResultSet prj = stmt.executeQuery(prjquery);
				if(prj.next()){
					prj_name = prj.getString("Site_Name");
					prj_code = prj.getString("Project_Code");
				}
				pBrcd1 = rs.getString("PRJ_SRNO");
				br_tot_no_emp = 0;
				para = new Paragraph(new Phrase("Employee's Attendance sheet List For Project Site : "+prj_name+ " ("+prj_code+")",f));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(4);
				doc.add(para);
				prj.close();
				stmt.close();
				conn.close();
				PdfPTable datatab;
				PdfPTable datatot;
				PdfPTable main = new PdfPTable(9);
				main.setSpacingBefore(10);
				main.setWidthPercentage(new float[]{8,20,9,8,8,7,7,9,7f}, rec);

				PdfPCell maincell ;

				maincell = new PdfPCell(new Phrase("EMP CODE",f1));
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("EMPLOYEE NAME",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Present Days",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Absent Days",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Leave Days",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Half Days",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);



				maincell = new PdfPCell(new Phrase("Holidays",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("WeekOff Days",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Work Days",f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);




				doc.add(main);
				while (pBrcd1.equals(rs.getString("PRJ_SRNO")))
				{
					float date=Calculate.getDays(PAYREGDT);
					datatab = new PdfPTable(9);

					datatab.setWidthPercentage(new float[]{8,20,9,8,8,7,7,9,7f}, rec);

					datatab.setHorizontalAlignment(Element.ALIGN_CENTER);

					PdfPCell cell1 = new PdfPCell(new Phrase(""+rs.getString("EMPCODE"),f1));
					cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
					cell1.setFixedHeight(50);
					datatab.addCell(cell1);

					PdfPCell cell2 = new PdfPCell(new Phrase(""+rs.getString("name"),f1));
					cell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					datatab.addCell(cell2);

					present = present + rs.getFloat("present_days");
					PdfPCell cell3 = new PdfPCell(new Phrase(""+rs.getFloat("present_days"),f1));
					cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell3);


					absent=  absent+ rs.getFloat("absent_days");
					PdfPCell cell4 = new PdfPCell(new Phrase(""+rs.getFloat("absent_days"),f1));
					cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell4);

					leave= leave+ rs.getFloat("Leave_days");
					PdfPCell cell5 = new PdfPCell(new Phrase(""+rs.getFloat("Leave_days"),f1));
					cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell5);

					halfdays= halfdays+ rs.getFloat("Half_days");
					PdfPCell cell6 = new PdfPCell(new Phrase(""+rs.getFloat("Half_days"),f1));
					cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell6);


					holidays= holidays+ rs.getFloat("Holidays");
					PdfPCell cell7 = new PdfPCell(new Phrase(""+rs.getFloat("Holidays"),f1));
					cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell7);

					weekoffdays= weekoffdays+ rs.getFloat("WeekOffDays");
					PdfPCell cell8 = new PdfPCell(new Phrase(""+rs.getFloat("WeekOffDays"),f1));
					cell8.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell8);

					workdays=workdays+date;
					float date2=Calculate.getDays(PAYREGDT);
					PdfPCell cell9 = new PdfPCell(new Phrase(""+date2,f1));
					cell9.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell9);

					doc.add(datatab);

					tot_no_emp = tot_no_emp + 1;
					br_tot_no_emp = br_tot_no_emp + 1;
					if (!rs.next()) {
						break;
					}
					if(!pBrcd1.equals(rs.getString("PRJ_SRNO"))){
						rs.previous();
						break;
					}
				}


				datatot = new PdfPTable(9);
				datatot.setWidthPercentage(new float[]{8,20,9,8,8,7,7,9,7f}, rec);
				datatot.setHorizontalAlignment(Element.ALIGN_CENTER);

				PdfPCell cell1 = new PdfPCell(new Phrase("Total:--",f1));
				cell1.setColspan(2);
				cell1.setFixedHeight(50);
				cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell1);

				PdfPCell cell2 = new PdfPCell(new Phrase(""+present,f1));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell2);
				present2 = present2 + present;
				present = 0.0f;

				PdfPCell cell4 = new PdfPCell(new Phrase(""+absent,f1));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell4);
				absent2 = absent2+ absent;
				absent = 0.0f;

				PdfPCell cell5 = new PdfPCell(new Phrase(""+leave,f1));
				cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell5);
				leave2= leave2 + leave ;
				leave = 0.0f;

				PdfPCell cell6 = new PdfPCell(new Phrase(""+halfdays,f1));
				cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell6);
				half = half + halfdays;
				halfdays = 0.0f;

				PdfPCell cell7 = new PdfPCell(new Phrase(""+holidays,f1));
				cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell7);
				hold = hold + holidays;
				holidays = 0.0f;

				PdfPCell cell8 = new PdfPCell(new Phrase(""+weekoffdays,f1));
				cell8.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell8);
				wo = wo + weekoffdays;
				weekoffdays = 0.0f;

				PdfPCell cell9 = new PdfPCell(new Phrase(""+workdays,f1));
				cell9.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell9);
				wd = wd + workdays;
				workdays = 0.0f;
				doc.add(datatot);

				para = new Paragraph(new Phrase("No Of Employee :- "+br_tot_no_emp,f));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(50);
				doc.add(para);


			}





			para = new Paragraph(new Phrase("Total No Of Employee :- "+tot_no_emp,f));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);
			doc.add(para);

			System.out.println("Total No Of Employee :- "+tot_no_emp);


			para = new Paragraph(new Phrase("-:Summary :- ",new Font(Font.HELVETICA,40,Font.BOLDITALIC)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);
			doc.add(para);

			PdfPTable main = new PdfPTable(4);
			main.setSpacingBefore(10);
			main.setWidthPercentage(new float[]{10,10,10,10}, rec);
			PdfPCell maincell ;

			maincell = new PdfPCell(new Phrase("Present Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+((int)(present2)),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Absent Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+(int)(absent2),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Leave Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+(int)(leave2),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Halfdays Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+(int)(half),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Holidays Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+(int)((hold)),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Weekoffdays Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+(int)(wo),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Workdays Total:-",f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""+(int)(wd),f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("",f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("",f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			doc.add(main);






			st.close();
			con.close();
			doc.close();



		}



		catch(Exception e)
		{
			e.printStackTrace();
		}

	}



	public static void getRelif_Fund(String filePath, String date,String imagepath,String type) throws IOException, SQLException, DocumentException 
	{

		OutputStream file = new FileOutputStream(new File(filePath));
		Document document = new Document();
		String table_name="";
		lable1="Report date : ";
		if(type.equalsIgnoreCase("before")){table_name="PAYTRAN";}else{table_name="PAYTRAN_STAGE";}
		try {
			//PdfWriter.getInstance(document, file);
			UtilityDAO dao = new UtilityDAO();
			PdfWriter writer =PdfWriter.getInstance(document, new FileOutputStream(filePath));

			Footer ftr = dao.new Footer(lable1);
			writer.setPageEvent(ftr);
			document.open();
			Image image1 = Image.getInstance(imagepath);
			image1.scaleAbsolute(80f, 80f);
			image1.setAbsolutePosition(40f, 730f); 
			document.add(image1);
			Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			document.add(para);

			para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			document.add(para);
			para = new Paragraph(new Phrase("Tel : +91-20 26812190,Email :",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			document.add(para);
			para = new Paragraph(new Phrase("Relif Fund  "+(type.equalsIgnoreCase("before")?"":""),new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			// para.setSpacingBefore(30.0f);
			para.setSpacingAfter(0);
			document.add(para);
			para = new Paragraph(new Phrase("For The Month Of "+date.substring(3,11),new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			//para.setSpacingBefore(30.0f);
			para.setSpacingAfter(0);
			document.add(para);
			PdfPTable table=new PdfPTable(5);
			table.setSpacingBefore(10.0f);
			table.setWidthPercentage(new float[]{6,12,40,19,19},new Rectangle(100,100));
			PdfPCell cell1=new PdfPCell(new Phrase("Sr NO",new Font(Font.TIMES_ROMAN,10)));
			cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
			table.addCell(cell1);
			PdfPCell cell2=new PdfPCell(new Phrase("Employee Code",new Font(Font.TIMES_ROMAN,10)));
			cell2.setHorizontalAlignment(Element.ALIGN_LEFT);
			table.addCell(cell2);
			PdfPCell cell3=new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,10)));
			cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell3);
			PdfPCell cell4=new PdfPCell(new Phrase("Gross salary(Rs)",new Font(Font.TIMES_ROMAN,10)));
			cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell4);
			PdfPCell cell5=new PdfPCell(new Phrase("Relif Fund Amount",new Font(Font.TIMES_ROMAN,10)));
			cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell5);
			table.setHeaderRows(1);

			Connection con=null;
			con=ConnectionManager.getConnection();
			Statement stmt=con.createStatement();
			ResultSet rspt = null;


			String sql1 = "select e.salute,e.empno,e.empcode,e.fname,e.mname,e.lname,y1.cal_amt as Gross,y2.cal_amt as Relif_fund from EMPMAST e join PAYTRAN y1 on e.EMPNO = y1.EMPNO join PAYTRAN y2 on e.EMPNO = y2.EMPNO " +
					"and y1.TRNCD = 199 and y1.TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"' " +
					"and y2.TRNCD = 229 and y2.TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"'  " +
					" UNION "+
					"select e.salute,e.empno,e.empcode,e.fname,e.mname,e.lname,y1.cal_amt as Gross,y2.cal_amt as Relif_fund from EMPMAST e join PAYTRAN_STAGE y1 on e.EMPNO = y1.EMPNO join PAYTRAN_STAGE y2 on e.EMPNO = y2.EMPNO " +
					"and y1.TRNCD = 199 and y1.TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"' " +
					"and y2.TRNCD = 229 and y2.TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"'  "+
					" UNION "+
					"select e.salute,e.empno,e.empcode,e.fname,e.mname,e.lname,y1.cal_amt as Gross,y2.cal_amt as Relif_fund from EMPMAST e join YTDTRAN y1 on e.EMPNO = y1.EMPNO join YTDTRAN y2 on e.EMPNO = y2.EMPNO " +
					"and y1.TRNCD = 199 and y1.TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"' " +
					"and y2.TRNCD = 229 and y2.TRNDT between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"'  ";


			//System.out.println("query is"+sql1);

			rspt = stmt.executeQuery(sql1);
			int srno=0;
			double totatlrelif=0;
			LookupHandler lkp=new LookupHandler();
			int i = 0;
			while(rspt.next())
			{
				if(rspt.getInt("Relif_fund")>0){
					i++;
				}
				srno++;
				PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,10)));
				cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data);

				PdfPCell cell1data2=new PdfPCell(new Phrase(""+rspt.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,10)));
				cell1data2.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data2);

				int cd=rspt.getInt("salute");

				String empname=lkp.getLKP_Desc("SALUTE",cd)+""+rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");

				PdfPCell cell1data3=new PdfPCell(new Phrase(""+empname,new Font(Font.TIMES_ROMAN,10)));
				cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data3);

				PdfPCell cell1data4=new PdfPCell(new Phrase(""+rspt.getInt("Gross"),new Font(Font.TIMES_ROMAN,10)));

				cell1data4.setHorizontalAlignment(Element.ALIGN_RIGHT);
				table.addCell(cell1data4);

				totatlrelif=totatlrelif + rspt.getInt("Relif_fund");

				PdfPCell cell1data5=new PdfPCell(new Phrase(""+rspt.getInt("Relif_fund"),new Font(Font.TIMES_ROMAN,10)));
				cell1data5.setHorizontalAlignment(Element.ALIGN_RIGHT);
				table.addCell(cell1data5);

			}
			PdfPCell totemp = new PdfPCell(new Phrase("Total Employee:",new Font(Font.TIMES_ROMAN,10)));
			totemp.setHorizontalAlignment(Element.ALIGN_RIGHT);
			totemp.setColspan(2);
			table.addCell(totemp);
			PdfPCell totempdisp = new PdfPCell(new Phrase(""+i,new Font(Font.TIMES_ROMAN,10)));
			totemp.setHorizontalAlignment(Element.ALIGN_LEFT);
			table.addCell(totempdisp);
			PdfPCell total=new PdfPCell(new Phrase("Relif Fund Total :",new Font(Font.TIMES_ROMAN,10)));
			total.setHorizontalAlignment(Element.ALIGN_RIGHT);
			//total.setColspan(2);
			table.addCell(total);
			PdfPCell totaldata=new PdfPCell(new Phrase(""+totatlrelif,new Font(Font.TIMES_ROMAN,10)));
			totaldata.setHorizontalAlignment(Element.ALIGN_RIGHT);
			table.addCell(totaldata);
			document.add(table);	 
			document.close();
			file.close();
			con.close();
			// System.out.println("pdf Generated Successfully");


		} catch (Exception e)
		{		
			e.printStackTrace();
		}

	}


	public static void getForm5(String filePath, String date,String imagepath) throws IOException, SQLException, DocumentException 
	{
		OutputStream file = new FileOutputStream(new File(filePath));
		Document document = new Document();

		try {
			PdfWriter.getInstance(document, file);
			document.open();
			//Image image1 = Image.getInstance(imagepath);
			//image1.scaleAbsolute(80f, 80f);
			//image1.setAbsolutePosition(40f, 730f); 
			//document.add(image1);


			Phrase title = new Phrase("FORM-5",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			document.add(para);

			para = new Paragraph(new Phrase("THE EMPLOYEE'S PROVIDENT FUNDS SCHEME, 1952 [Paragraph 36 (2) (A)]",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);			
			document.add(para);

			para = new Paragraph(new Phrase("AND THE EMPLOYEE'S PENSION SCHEME, 1995 [Para - 20 (4)]",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);
			document.add(para);

			para = new Paragraph(new Phrase("Return of employees qualifying for membership of the employees provident found, ",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_CENTER);
			// para.setSpacingBefore(30.0f);
			para.setSpacingAfter(5);
			document.add(para);

			para = new Paragraph(new Phrase(" employee's pension fund & employee's deposit linked insurance fund for the First time during the month of : "+ date.substring(3,11),new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_CENTER);
			// para.setSpacingBefore(30.0f);
			para.setSpacingAfter(5);
			document.add(para);


			para = new Paragraph(new Phrase("(To be sent to the commissioner with form 2 (EPF & EPS)",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_CENTER);
			// para.setSpacingBefore(30.0f);
			para.setSpacingAfter(10);
			document.add(para);

			para = new Paragraph(new Phrase("Name and address of the Factory/Estt : THE BUSINESS CO.OP BANK LTD.,                         CODE NO:     ",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);
			para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101.                    ",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);
			document.add(para);
			SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
			SimpleDateFormat format = new SimpleDateFormat("dd-MMM-yyyy");
			SimpleDateFormat format1 = new SimpleDateFormat("dd-MM-yyyy");
			SimpleDateFormat fromformat = new SimpleDateFormat("MM/yyyy");
			PdfPTable table=new PdfPTable(9);
			table.setSpacingBefore(10.0f);
			table.setWidthPercentage(new float[]{5,15,16,16,10,6,10,14,8},new Rectangle(100,100));
			PdfPCell cell1=new PdfPCell(new Phrase("SR NO",new Font(Font.TIMES_ROMAN,10)));
			cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1);
			PdfPCell cell2=new PdfPCell(new Phrase("Account No.",new Font(Font.TIMES_ROMAN,10)));
			cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell2);
			PdfPCell cell3=new PdfPCell(new Phrase("Name of Member",new Font(Font.TIMES_ROMAN,10)));
			cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell3);
			PdfPCell cell4=new PdfPCell(new Phrase("Father's Name or husband's name",new Font(Font.TIMES_ROMAN,10)));
			cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell4);
			PdfPCell cell5=new PdfPCell(new Phrase("Date of Birth",new Font(Font.TIMES_ROMAN,10)));
			cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell5);
			PdfPCell cell6=new PdfPCell(new Phrase("Sex",new Font(Font.TIMES_ROMAN,10)));
			cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell6);
			PdfPCell cell7=new PdfPCell(new Phrase("Date of Joining Fund",new Font(Font.TIMES_ROMAN,10)));
			cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell7);
			PdfPCell cell8=new PdfPCell(new Phrase("Total period of previous service as on date of joining the fund ",new Font(Font.TIMES_ROMAN,10)));
			cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell8);
			PdfPCell cell9=new PdfPCell(new Phrase("Remarks",new Font(Font.TIMES_ROMAN,10)));
			cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell9);
			table.setHeaderRows(1);

			Connection con=null;
			con=ConnectionManager.getConnection();
			Statement stmt=con.createStatement();
			ResultSet rspt = null;
			LookupHandler lkp = new LookupHandler();

			String sql = "SELECT e.EMPNO, e.SALUTE, e.FNAME, e.MNAME, e.LNAME, e.DOB,e.GENDER, t.ACNO,e.DOJ FROM EMPMAST e, EMPTRAN t " +
					" WHERE DOJ BETWEEN '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"' AND e.EMPNO = t.EMPNO " +
					" AND e.STATUS='A' and t.srno=(select max(srno) from emptran where empno=e.EMPNO) ORDER BY e.EMPNO";
			//System.out.println("********"+sql);
			rspt = stmt.executeQuery(sql);
			int srno = 1;

			int count =0;
			while(rspt.next()){
				count++;
				PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,8)));
				cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data);

				PdfPCell cell1data2=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
				cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data2);


				PdfPCell cell1data3=new PdfPCell(new Phrase(" "+rspt.getString("fname")+" "+rspt.getString("lname"),new Font(Font.TIMES_ROMAN,7)));
				cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data3);


				PdfPCell cell1data4=new PdfPCell(new Phrase(""+rspt.getString("mname"),new Font(Font.TIMES_ROMAN,7))); 
				cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data4);

				/*  Date DOb = sdf.parse(rspt.getString("DOB"));*/
				PdfPCell cell1data5=new PdfPCell(new Phrase(""+format.format(rspt.getDate("DOB")),new Font(Font.TIMES_ROMAN,8)));
				cell1data5.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data5);

				if(rspt.getString("GENDER").contains("M")){
					PdfPCell cell1data6=new PdfPCell(new Phrase(""+"Male",new Font(Font.TIMES_ROMAN,7)));
					cell1data6.setHorizontalAlignment(Element.ALIGN_LEFT);
					table.addCell(cell1data6);
				}
				else
				{
					PdfPCell cell1data6=new PdfPCell(new Phrase(""+"Female",new Font(Font.TIMES_ROMAN,7)));
					cell1data6.setHorizontalAlignment(Element.ALIGN_LEFT);
					table.addCell(cell1data6);
				}

				/*Date DOj = sdf.parse(rspt.getString("DOJ"));*/
				PdfPCell cell1data7=new PdfPCell(new Phrase(""+format.format(rspt.getDate("DOJ")),new Font(Font.TIMES_ROMAN,8)));
				cell1data7.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data7);

				PdfPCell cell1data8=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
				cell1data8.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data8);

				PdfPCell cell1data9=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
				cell1data9.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data9);
				srno++;
			}

			if(count<=0){
				para = new Paragraph(new Phrase("No records Found. ",new Font(Font.TIMES_ROMAN,10)));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(0);
				document.add(para);
			}

			table.setSpacingAfter(50.0f);
			document.add(table);



			document.close();
			file.close();

			stmt.close();
			con.close();
		}
		catch (Exception e)
		{
			e.printStackTrace();
		}
		document.open();	
	}

	public static void getVdaList(String filePath, String date, String imagepath) 
	{


		System.out.println("in getVdaList ");
      String firstMonth=date.substring(3,6);
      
      String secondMonth="";
      String previousMonth="";
      int previousYear=Integer.parseInt(date.substring(7,11));
       if( firstMonth.equals("Jan") || firstMonth.equals("Feb") || firstMonth.equals("Mar") ){
          firstMonth="Jan";
          previousMonth="NOV";
          previousYear=previousYear-1;
       }
       if( firstMonth.equals("Apr") || firstMonth.equals("May") || firstMonth.equals("Jun") ){
           firstMonth="Apr";     
           previousMonth="FEB";
           
       }
       if( firstMonth.equals("Jul") || firstMonth.equals("Aug") || firstMonth.equals("Sep") ){
           firstMonth="Jul";
           previousMonth="MAY";
       }
       if( firstMonth.equals("Oct")|| firstMonth.equals("Nov") || firstMonth.equals("Dec") ){
           firstMonth="Oct";
           previousMonth="AUG";
       }
       
       String Dtd="";
       
       if(firstMonth.equals("Jan"))
			Dtd="01";
		else if(firstMonth.equals("Feb"))
			Dtd="02";
		else if(firstMonth.equals("Mar"))
			Dtd="03";
		else if(firstMonth.equals("Apr"))
			Dtd="04";
		else if(firstMonth.equals("May"))
			Dtd="05";
		else if(firstMonth.equals("Jun"))
			Dtd="06";
		else if(firstMonth.equals("Jul"))
			Dtd="07";
		else if(firstMonth.equals("Aug"))
			Dtd="08";
		else if(firstMonth.equals("Sep"))
			Dtd="09";
		else if(firstMonth.equals("Oct"))
			Dtd="10";
		else if(firstMonth.equals("Nov"))
			Dtd="11";
		else
			Dtd="12";
      
       if(firstMonth.equals("Jan"))
       		secondMonth="Mar";
       if(firstMonth.equals("Apr"))
      		secondMonth="Jun";
       if(firstMonth.equals("Jul"))
      		secondMonth="Sep";
       if(firstMonth.equals("Oct"))
      		secondMonth="Dec";

       String year=date.substring(7,11);
		RepoartBean repBean  = new RepoartBean();
		UtilityDAO dao = new UtilityDAO();
		Connection connection =null;
		LookupHandler lookupHandler=new LookupHandler();
		String query = ""; 
		float basic=0.0f;	
		float da=0.0f;
		float vda=0.0f;
		float hra=0.0f;	
		float edu=0.0f;
		float med=0.0f;
		float conv=0.0f;
		float total=0.0f;	
		float totalForRow=0.0f;
		double providendFund=0;
		double pfValueTotal=0;
		
		try
		{

			ReportDAO.OpenCon("", "", "",repBean);
			connection = repBean.getCn();	
			Statement statement = connection.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);

		

			int count=1;
			
			int gradeCode=0;
			
			query="SELECT SRNO,GRADE_CODE,START_DATE,BASIC,DA_VAL FROM DA_GRADE_MASTER WHERE '"+date+"' BETWEEN " +
					"START_DATE AND END_DATE ORDER BY GRADE_CODE,SRNO";
			
   System.out.println(query);
			
			ResultSet resultSet = statement.executeQuery(query);
			Document doc = new Document();
			
			PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filePath));
			
			doc.open();
			
			Font FONT = new Font(Font.HELVETICA,52, Font.NORMAL, new GrayColor(0.75f));
			ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 300f, 450f, 45);			

 
			
			if(!resultSet.next()){

				Paragraph para = new Paragraph();
				para = new Paragraph(new Phrase("THE BUSINESS CO.OP BANK LTD",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Administrative Office-Salary Section",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("VDA Chart For "+firstMonth+" To "+secondMonth+" - "+year,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Basic statement showing the Consumer Price Index received from",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("the Office of the Commissioner of Labour",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Lr. No. CPI/Desk-29/CPI/"+previousMonth+"-"+previousYear+" Dtd. 01/"+Dtd+"/"+year+" " ,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Authority: Officier On Special Duty(Statistics),Mumbai(copy enclosed)",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				
				 para = new Paragraph();
				 date=date.substring(3,11);
				para = new Paragraph(new Phrase("No record found for the month :  "+date,new Font(Font.TIMES_ROMAN,15,Font.BOLD)));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingBefore(20);
				doc.add(para);
			}
			
			resultSet.beforeFirst();
			
			
			
			while(resultSet.next()){


				Paragraph para = new Paragraph();
				para = new Paragraph(new Phrase("THE BUSINESS CO.OP BANK LTD",new Font(Font.TIMES_ROMAN,7,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Administrative Office-Salary Section",new Font(Font.TIMES_ROMAN,7,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("VDA Chart For "+firstMonth+" To "+secondMonth+" - "+year,new Font(Font.TIMES_ROMAN,7,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Basic statement showing the Consumer Price Index received from",new Font(Font.TIMES_ROMAN,7,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("the Office of the Commissioner of Labour",new Font(Font.TIMES_ROMAN,7,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
/*				para = new Paragraph(new Phrase("Lr. No. CPI/Desk-29/CPI/MAR-2015 Dtd. 02/05/2015",new Font(Font.TIMES_ROMAN,7,Font.BOLD))); */
				para = new Paragraph(new Phrase("Lr. No. CPI/Desk-29/CPI/"+previousMonth+"-"+previousYear+" Dtd. 01/"+Dtd+"/"+year+" " ,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Authority: Officier On Special Duty(Statistics),Mumbai(copy enclosed)",new Font(Font.TIMES_ROMAN,7,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				Font f = new Font(Font.HELVETICA,10);
				Font f1 = new Font(Font.HELVETICA,8);
				Font f2 = new Font(Font.HELVETICA,6);
			String startDate=resultSet.getString("START_DATE");
			     
			
				SimpleDateFormat simpleDateFormat = new SimpleDateFormat("yyyy-MM-dd");
				 SimpleDateFormat outputDateFormat = new SimpleDateFormat("dd-MM-yyyy"); 
					Date tempDate=new Date();
				  tempDate=simpleDateFormat.parse(startDate); 
				  startDate= outputDateFormat.format(tempDate);
            startDate= startDate.replace("-","/");
			
				para = new Paragraph(new Phrase("Date :-	"+startDate+"																						" +
						"    																																			" +
						"																	Designation : "+lookupHandler.getLKP_Desc("DESIG",resultSet.getInt("GRADE_CODE"))+	 "    " +
								"														  										  									" +
								"																															Page No. : "+(count++)+"	",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));

				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(2);

				doc.add(para);

				Rectangle rec = new  Rectangle(100,100);
	
				
		
				
			gradeCode=resultSet.getInt("GRADE_CODE");
		
			
				


				PdfPTable datatab;
				PdfPTable datatot;
				PdfPTable main = new PdfPTable(10);
				main.setSpacingBefore(10);
				main.setWidthPercentage(new float[]{7,10,10,10,10,10,10,10,13,10}, rec);

				PdfPCell maincell ;

				maincell = new PdfPCell(new Phrase("Sr.No",f1));
				maincell.setFixedHeight(10);
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Basic",f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("D.A.",f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("V.D.A.",f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("H.R.A.",f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("MED_ALL",f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				
				maincell = new PdfPCell(new Phrase("EDU_ALL",f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				
				maincell = new PdfPCell(new Phrase("CONV_ALL",f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				
				maincell = new PdfPCell(new Phrase("Total",f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("P.F.",f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				doc.add(main);
			
					 while (gradeCode==resultSet.getInt("GRADE_CODE")){
	    
						 
					
			
				datatab = new PdfPTable(10);

				datatab.setWidthPercentage(new float[]{7,10,10,10,10,10,10,10,13,10}, rec);

				datatab.setHorizontalAlignment(Element.ALIGN_CENTER);
			
				PdfPCell cell1 = new PdfPCell(new Phrase(""+resultSet.getString("SRNO"),f1));
				cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell1.setFixedHeight(10);
				datatab.addCell(cell1);

			
				PdfPCell cell2 = new PdfPCell(new Phrase(""+resultSet.getFloat("BASIC"),f1));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(cell2);

				
				PdfPCell cell3 = new PdfPCell(new Phrase(""+resultSet.getFloat("DA_VAL"),f1));
				cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(cell3);


				
				PdfPCell cell4 = new PdfPCell(new Phrase(""+resultSet.getFloat("VDA_VAL"),f1));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(cell4);

			
				PdfPCell cell5 = new PdfPCell(new Phrase(""+resultSet.getFloat("HRA_VAL"),f1));
				cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(cell5);
				
				PdfPCell cell6 = new PdfPCell(new Phrase(""+resultSet.getFloat("MED_ALL"),f1));
				cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(cell6);
				
				PdfPCell cell7 = new PdfPCell(new Phrase(""+resultSet.getFloat("EDU_ALL"),f1));
				cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(cell7);
				
				PdfPCell cell8 = new PdfPCell(new Phrase(""+resultSet.getFloat("CONV_ALL"),f1));
				cell8.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(cell8);
				
				totalForRow=resultSet.getFloat("BASIC")+resultSet.getFloat("DA_VAL")+resultSet.getFloat("VDA_VAL")+resultSet.getFloat("HRA_VAL")+resultSet.getFloat("MED_ALL")+resultSet.getFloat("EDU_ALL")+resultSet.getFloat("CONV_ALL");
				PdfPCell cell9 = new PdfPCell(new Phrase(""+totalForRow,f1));
				cell9.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(cell9);

				providendFund=(resultSet.getFloat("BASIC")+resultSet.getFloat("DA_VAL")+resultSet.getFloat("VDA_VAL"))*(0.12);
				providendFund=Math.round(providendFund);
				
				
				
				PdfPCell cell10 = new PdfPCell(new Phrase(""+Math.round(providendFund)+".00",f1));
				cell10.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(cell10);
				
				pfValueTotal=pfValueTotal+providendFund;
				basic = basic + resultSet.getFloat("BASIC");
				da = da + resultSet.getFloat("DA_VAL");
				vda = vda + resultSet.getFloat("VDA_VAL");
				hra = hra + resultSet.getFloat("HRA_VAL");
				med=med+resultSet.getFloat("MED_ALL");
				edu=edu+resultSet.getFloat("EDU_ALL");
				conv=conv+resultSet.getFloat("CONV_ALL");
				total=total+totalForRow;
				
				doc.add(datatab);
				
				if (!resultSet.next()) {
				break;
			}
			
			if(gradeCode!=resultSet.getInt("GRADE_CODE")){
				    System.out.println("previous");
					resultSet.previous();
					break;
				}
				
				
				 	 }
					
				datatab = new PdfPTable(10);

				 datatab.setWidthPercentage(new float[]{7,10,10,10,10,10,10,10,13,10}, rec);

				 datatab.setHorizontalAlignment(Element.ALIGN_CENTER);

				 PdfPCell cell11 = new PdfPCell(new Phrase("Total ",f1));
				 cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
				 cell11.setFixedHeight(10);
				 datatab.addCell(cell11);

				
				 PdfPCell cell22 = new PdfPCell(new Phrase(""+basic,f1));
				 cell22.setHorizontalAlignment(Element.ALIGN_CENTER);
				 datatab.addCell(cell22);
				 basic = 0.0f;
		
				 PdfPCell cell33 = new PdfPCell(new Phrase(""+da,f1));
				 cell33.setHorizontalAlignment(Element.ALIGN_CENTER);
				 datatab.addCell(cell33);
				 da = 0.0f;

				
				 PdfPCell cell44 = new PdfPCell(new Phrase(""+vda,f1));
				 cell44.setHorizontalAlignment(Element.ALIGN_CENTER);
				 datatab.addCell(cell44);
				 vda = 0.0f;
				 
				 PdfPCell cell55 = new PdfPCell(new Phrase(""+hra,f1));
				 cell55.setHorizontalAlignment(Element.ALIGN_CENTER);
				 datatab.addCell(cell55);
				 hra = 0.0f;
				 
				 PdfPCell cell66 = new PdfPCell(new Phrase(""+med,f1));
				 cell66.setHorizontalAlignment(Element.ALIGN_CENTER);
				 datatab.addCell(cell66);
				 med = 0.0f;
				 
				 PdfPCell cell77 = new PdfPCell(new Phrase(""+edu,f1));
				 cell77.setHorizontalAlignment(Element.ALIGN_CENTER);
				 datatab.addCell(cell77);
				 edu = 0.0f;
				 
				 PdfPCell cell88 = new PdfPCell(new Phrase(""+conv,f1));
				 cell88.setHorizontalAlignment(Element.ALIGN_CENTER);
				 datatab.addCell(cell88);
				 conv = 0.0f;
				 
				 
				 PdfPCell cell89 = new PdfPCell(new Phrase(""+total,f1));
				 cell89.setHorizontalAlignment(Element.ALIGN_CENTER);
				 datatab.addCell(cell89);
				 total = 0.0f;

				 PdfPCell cell90 = new PdfPCell(new Phrase(""+Math.round(pfValueTotal)+".00",f1));
				 cell90.setHorizontalAlignment(Element.ALIGN_CENTER);
				 datatab.addCell(cell90);
				 pfValueTotal = 0.0;
				 


				 doc.add(datatab);
				 

					para = new Paragraph(new Phrase("THE BUSINESS CO.OP BANK LTD,Pune",f2));
					para.setAlignment(Element.ALIGN_RIGHT);
					para.setSpacingAfter(10);
					doc.add(para);


					para = new Paragraph(new Phrase("Chief Executive Officer/Manager",f2));
					para.setAlignment(Element.ALIGN_RIGHT);
			
					doc.add(para);

				
		
					
					
					doc.newPage();
					
			
						}
	
	/*	 */

			statement.close();
			connection.close();
			doc.close();



		}



		catch(Exception e)
		{
			e.printStackTrace();
		}



	}

	//payslip according to namco in txt format by Hrishi starts  here
public static void paysliptxtnew(String Payslipdt,String empList,String  filepath)
{
		

		RepoartBean repBean  = new RepoartBean();
		int[] Icoded = new int[41];
		int[] Ecoded = new int[41];
		int CP = 0;
		String[] Idesc = new String[41];
		String[] Edesc = new String[41];
		int[] INCamt = new int[200];
		int[] DEDamt = new int[301];
		String EmpSql = "";
		int LP = 0;
		String lSql = "";
		ResultSet TmpRs = null;
		int aCtr = 0;
		int lCtr = 0;
		Connection Cn = null;
		String[] LPRN = new String[5];
		int[] aINCamt = new int[200];
		int[] aDEDamt = new int[301];
		String CmDSQL = "";
		int TotNetPay = 0;
		int[] TotGross = new int[4];
		int[] TotDed = new int[4];
		String dtrsql = "";
		ResultSet CDM = null;
		ResultSet DTR = null;
		ResultSet emp = null;
		int LOPDays = 0;
		int SUSDays = 0;

		String Str1 = "";
		String SLINE = "";
		String sLine1  = "";
		String sLine2  = "";
		FileWriter Fp;
		boolean DtrFind = false;
		
		ReportDAO.inithead(repBean);
		//Initvar                       *****already variable are initialised  not need of initvar
	    ReportDAO.make_prn_file(filepath,repBean);
	    
	    ReportDAO.println(String.valueOf((char)18), 0, 1, false, "BANK",repBean);//          ***** P H PATIL Sir
	    
	    //for double width of font in heading
	     //ReportDAO.println(String.valueOf((char)27)+String.valueOf((char)87)+String.valueOf((char)48)+"                         THE NASIK MARCHANT'S CO-OP BANK LTD, NASHIK", 5, 1, false, "BANK",repBean);
	     
	     //*****closing of double width for font
	    //ReportDAO.println(String.valueOf((char)27)+String.valueOf((char)87)+String.valueOf((char)49), 0, 0, false, "BANK",repBean);
	    
	   //ReportDAO.println(String.valueOf((char)18), 0, 1, false, "BANK",repBean);
	    
	    repBean.setHdg1(String.valueOf((char)18)+ "Salary Slip for the Month of : "+Payslipdt.substring(3, 6) + "-" + Payslipdt.substring(7, 11));
	    SLINE = stringOfSize(80, '-');
	    sLine1 = stringOfSize(80, '-');
	    sLine2 = stringOfSize(80, '=');
	    
	    repBean.setPageNo(1);
	    repBean.setLineLen(80);
	    repBean.setPageLen(65);
	    repBean.setLnCount(0);
	    repBean.setLineSpace(2);
	    
	    dtrsql = "SELECT * FROM PAYTRAN WHERE TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' AND '"+ReportDAO.EOM(Payslipdt)+"'";
	   /* CmDSQL = "SELECT * FROM CDMAST WHERE PSLIPYN = 'Y' AND TRNCD <= 293 AND " +
	    		"TRNCD IN (SELECT TRNCD FROM CDMAST INTERSECT (SELECT DISTINCT(TRNCD) FROM PAYTRAN" +
	    		" WHERE TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' AND '"+ReportDAO.EOM(Payslipdt)+"')) ORDER BY  PRNTSEQNCE,TRNCD ";*/
	    CmDSQL = "SELECT * FROM CDMAST WHERE PSLIPYN = 'Y' AND TRNCD <= 293 AND " +
	    		"TRNCD IN (SELECT TRNCD FROM CDMAST INTERSECT (SELECT DISTINCT(TRNCD) FROM PAYTRAN" +
	    		" WHERE TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' AND '"+ReportDAO.EOM(Payslipdt)+"')) and TRNCD not in(213,250) ORDER BY  PRNTSEQNCE,TRNCD ";
	   
	    //DoEvents              
	    ReportDAO.OpenCon("", "", "",repBean);
	    Cn = repBean.getCn();
	    try
	    {
			Statement st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
			DTR = st.executeQuery(dtrsql);
			if(!DTR.next())
			{
				DtrFind = false;
				dtrsql = "SELECT * FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' AND '"+ReportDAO.EOM(Payslipdt)+"'";
				/*CmDSQL = "SELECT * FROM CDMAST WHERE PSLIPYN = 'Y' AND TRNCD <= 293 AND " +
	    		"TRNCD IN (SELECT TRNCD FROM CDMAST INTERSECT (SELECT DISTINCT(TRNCD) FROM PAYTRAN_STAGE " +
	    		" WHERE TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' AND '"+ReportDAO.EOM(Payslipdt)+"')) ORDER BY  PRNTSEQNCE ,TRNCD";*/
				CmDSQL = "SELECT * FROM CDMAST WHERE PSLIPYN = 'Y' AND TRNCD <= 293 AND " +
			    		"TRNCD IN (SELECT TRNCD FROM CDMAST INTERSECT (SELECT DISTINCT(TRNCD) FROM PAYTRAN_STAGE " +
			    		" WHERE TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' AND '"+ReportDAO.EOM(Payslipdt)+"')) and TRNCD not in(213,250) ORDER BY  PRNTSEQNCE ,TRNCD";
				System.out.println(dtrsql);
				System.out.println(CmDSQL);
				
				
			}
			/*EmpSql = "SELECT emp.*,t.ACNO,t.prj_srno,t.desig,t.GRADE FROM EMPMAST emp,EMPTRAN t WHERE t.EMPNO = emp.EMPNO" +
					" AND emp.EMPNO in ("+empList+") AND t.srno = (SELECT MAX(E2.srno) FROM EMPTRAN E2 " +
							" WHERE E2.EMPNO = emp.EMPNO AND E2.EFFDATE <= '"+ReportDAO.EOM(Payslipdt)+"') ORDER BY emp.EMPNO";*/
			EmpSql = "SELECT emp.*,t.ACNO,t.prj_srno,t.desig,t.GRADE,(select LKP_DISC from LOOKUP where LKP_CODE='SALUTE' and LKP_SRNO=emp.SALUTE)as salutation  FROM EMPMAST emp,EMPTRAN t WHERE t.EMPNO = emp.EMPNO" +
					" AND emp.EMPNO in ("+empList+") AND t.srno = (SELECT MAX(E2.srno) FROM EMPTRAN E2 " +
							" WHERE E2.EMPNO = emp.EMPNO AND E2.EFFDATE <= '"+ReportDAO.EOM(Payslipdt)+"') ORDER BY emp.EMPNO";
			System.out.println( EmpSql);
			
			DTR = st.executeQuery(dtrsql);
			if(!DTR.next())
			{
				dtrsql = "SELECT * FROM PAYTRAN WHERE TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' AND '"+ReportDAO.EOM(Payslipdt)+"'";
				DTR = st.executeQuery(dtrsql);
				if(!DTR.next())
				{
					System.out.println("TRANSACTION NOT FOUND");
					Fp = repBean.getFp();
					Fp.close();
					return;
				}
			}
			DTR.beforeFirst();
			CDM = st.executeQuery(CmDSQL);
			if(!CDM.next())
			{
				CDM = null;
				/*CmDSQL = "SELECT * FROM CDMAST WHERE TRNCD <= 293 AND TRNCD IN (SELECT TRNCD FROM CDMAST INTERSECT " +
						" (SELECT DISTINCT(TRNCD) FROM PAYTRAN" +
	    		       " WHERE TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' AND '"+ReportDAO.EOM(Payslipdt)+"')) ORDER BY  PRNTSEQNCE , TRNCD ";*/
				CmDSQL = "SELECT * FROM CDMAST WHERE TRNCD <= 293 AND TRNCD IN (SELECT TRNCD FROM CDMAST INTERSECT " +
						" (SELECT DISTINCT(TRNCD) FROM PAYTRAN" +
	    		       " WHERE TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' AND '"+ReportDAO.EOM(Payslipdt)+"')) and TRNCD not in(213,250) ORDER BY  PRNTSEQNCE , TRNCD ";
				
				System.out.println(CmDSQL);	////======
				CDM = st.executeQuery(CmDSQL);
				
				if(!CDM.next())
				{
					System.out.print("NO ANY CODE TO PRINT");
					Fp = repBean.getFp();
					Fp.close();
					return;
				}
			}
			CDM.beforeFirst();
			while (CDM.next()) 
			{
				if(CDM.getInt("TRNCD") <= 200 && (CDM.getInt("TRNCD")!=199) )
				{
				   aCtr = aCtr + 1;
				   Idesc[aCtr] =  CDM.getString("SDESC") == null ? "" : CDM.getString("SDESC").trim();
				   Icoded[aCtr] = CDM.getInt("TRNCD");
				   
				}
				else
				{
					if(CDM.getInt("TRNCD")!=199)
					{
					lCtr = lCtr + 1;
					Edesc[lCtr] = CDM.getString("SDESC") == null ? "" : CDM.getString("SDESC").trim();
					Ecoded[lCtr] = CDM.getInt("TRNCD");
					}
				}
					
			}
			Statement st1 = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
			emp = st1.executeQuery(EmpSql);
			
			if(!emp.next())
			{
				System.out.println("Employee Recordset is empty");
				Fp = repBean.getFp();
				Fp.close();
				return;
			}
			//doevents                      
			String pBranch = "";
			String Arr1 = "";
			int i = 0;
			int ctr = 0;
			emp.beforeFirst();   //Commented after exception
			
			while(emp.next())
			{
				//doevents
				int empNum = emp.getInt("EMPNO");
				DTR = null;
				if(!DtrFind)
				{
					dtrsql = "SELECT * FROM PAYTRAN_STAGE Y,CDMAST C WHERE " +
							"(Y.TRNCD = 999 OR Y.TRNCD IN (301,302) OR Y.TRNCD <= 293) AND " +
							"Y.EMPNO = "+emp.getInt("EMPNO")+" AND Y.TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' " +
							"AND '"+ReportDAO.EOM(Payslipdt)+"' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y' ORDER BY Y.TRNCD ";
				}
				else
				{
					dtrsql = "SELECT * FROM PAYTRAN_STAGE Y,CDMAST C WHERE " +
					         "(Y.TRNCD = 999 OR Y.TRNCD IN (301,302) OR Y.TRNCD <= 293) AND " +
					         "Y.EMPNO = "+emp.getInt("EMPNO")+" AND Y.TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' " +
					         "AND '"+ReportDAO.EOM(Payslipdt)+"' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y' UNION SELECT * FROM PAYTRAN Y," +
					         " CDMAST C WHERE " +
					         "(Y.TRNCD = 999 OR Y.TRNCD IN( 301,302) OR Y.TRNCD <= 293) AND " +
					         "Y.EMPNO = "+emp.getInt("EMPNO")+" AND Y.TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' " +
					         " AND '"+ReportDAO.EOM(Payslipdt)+"' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y' ORDER BY 3";
				}
				lCtr = 0;
				LOPDays = 0;
				SUSDays = 0;

				//System.out.println(emp.getInt("EMPNO"));
				System.out.println(dtrsql);
				DTR = st.executeQuery(dtrsql);
				if(!DTR.next())
				{
					dtrsql = "SELECT * FROM PAYTRAN Y,CDMAST C WHERE (Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293) AND Y.EMPNO = "+empNum+" AND Y.TRNDT BETWEEN '"+ReportDAO.BOM(Payslipdt)+"' " +
					" AND '"+ReportDAO.EOM(Payslipdt)+"' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y' ORDER BY  C.PRNTSEQNCE ,Y.TRNCD ";
					System.out.println(dtrsql);
					 DTR = null;
					DTR = st.executeQuery(dtrsql);
					if(!DTR.next())
					{
						System.out.println("TRANSACTION IS NOT FOUND FOR THIS EMPLOYEE "+empNum);
					}
				}
				for(int j=1; j< 200; j++ )
				{
					INCamt[j] = 0;
					aINCamt[j] = 0;
				}
				for(int j=200; j<301; j++ )
				{
					DEDamt[j] = 0;
					aDEDamt[j] = 0;
				}
				DTR.beforeFirst();
				if(DTR.next())
				{  //get chk by PHPATIL SIR
					ctr = ctr + 1;
					repBean.setBrnNo(1);  //emp.getInt("BRANCH");
					ReportDAO.println("", 0, 1, false, "BANK",repBean);
					ReportDAO.println("", 0, 1, false, "BANK",repBean);
				    ReportDAO.println("", 0, 1, false, "BANK",repBean);
				    ReportDAO.println("", 0, 1, false, "BANK",repBean);
					//ReportDAO.println(ReportDAO.getSysDate(), repBean.getLineSpace(), 1, false, "BANK",repBean);
					//ReportDAO.println(""+repBean.getHdg1(),repBean.getLineSpace(), 1, false, "BANK",repBean);
					ReportDAO.page_head(repBean.getBrnNo(),repBean.getHdg1(),repBean.getHdg2(), repBean.getHdg3(), repBean.getHdg4(), repBean.getHdg5(), repBean.getHdg6(), repBean.getHdg7(),repBean);	//added values for hdg 1 and 2

					//ReportDAO.println(sLine1, repBean.getLineSpace(), 1, false, "BANK",repBean);
					
					pBranch = "BRANCH";//emp.getString("BRANCH");
					//DTR.beforeFirst();
					DTR = st.executeQuery(dtrsql);
					while(DTR.next())
					{
						
						if(DTR.getInt("TRNCD") <= 200 && ( DTR.getInt("TRNCD") != 198 && DTR.getInt("TRNCD") != 199))
						{
							INCamt[DTR.getInt("TRNCD")] = DTR.getString("NET_AMT") == null?0:DTR.getInt("NET_AMT"); //*******CHECK OTHER WISE IT WILL CAUSE ARRAYOUTBOUND EXCEP ********************** 
							aINCamt[DTR.getInt("TRNCD")] = DTR.getString("ARR_AMT") == null?0:DTR.getInt("ARR_AMT");//*******CHECK OTHER WISE IT WILL CAUSE ARRAYOUTBOUND EXCEP **********************
							//System.out.println(DTR.getInt("TRNCD")+"\t"+DTR.getString("NET_AMT"));
						}
						else if(DTR.getInt("TRNCD") > 200 && DTR.getInt("TRNCD") <= 293)
						{
							DEDamt[DTR.getInt("TRNCD")] = DTR.getString("NET_AMT") == null?0:DTR.getInt("NET_AMT"); //*******CHECK OTHER WISE IT WILL CAUSE ARRAYOUTBOUND EXCEP **********************
							aDEDamt[DTR.getInt("TRNCD")] = DTR.getString("ARR_AMT") == null?0:DTR.getInt("ARR_AMT");//*******CHECK OTHER WISE IT WILL CAUSE ARRAYOUTBOUND EXCEP **********************
							//System.out.println(DTR.getInt("TRNCD")+"\t"+DTR.getString("NET_AMT"));
						}
						if(DTR.getInt("TRNCD") == 301)
						{
							LOPDays = DTR.getInt("INP_AMT");
						}
						if(DTR.getInt("TRNCD") == 302)
						{
							SUSDays = DTR.getInt("INP_AMT");
						}
					}
					Str1 = "Emp.Code: "+FixStr(String.valueOf(emp.getString("EMPCODE")), 12, 1)+"  | Name  : "+FixStr(FixStr(emp.getString("salutation")+""+emp.getString("LNAME").trim()+"  "+emp.getString("FNAME").trim()+ "  "+emp.getString("MNAME").trim(), 42, 1), 50, 1);
				    ReportDAO.println(Str1, repBean.getLineSpace(), 1, false, "BANK",repBean);
//				    Str1 = "P.F. No : "+FixStr(String.valueOf(emp.getString("PFNO")==null?"N/A":emp.getString("PFNO")), 12, 1)+"  | Desig.: "+new LookupHandler().getLKP_Desc("DESIG",emp.getInt("DESIG"));
				    Str1 = "UAN. No : "+FixStr(String.valueOf(emp.getString("IDENTY")==null?"":emp.getString("IDENTY")), 12, 1)+"  | Desig.: "+new LookupHandler().getLKP_Desc("DESIG",emp.getInt("DESIG"));
				    ReportDAO.println(Str1, repBean.getLineSpace(), 1, false, "BANK",repBean);
				    BranchDAO bd= new BranchDAO();
				    BranchBean bbean=bd.getParticularBranchDetails(emp.getInt("PRJ_SRNO"));
				    Str1 = "SB A/C  : "+FixStr(String.valueOf(emp.getString("ACNO")==null?"":emp.getString("ACNO")), 12, 1)+"  | Branch: "+(bbean.getBranchName()==null?"":bbean.getBranchName());
					ReportDAO.println(Str1, repBean.getLineSpace(), 1, false, "BANK",repBean);
					
					Str1 = "LWP Days: "+FixStr(String.valueOf(LOPDays), 8, 1)+"      |";
					ReportDAO.println(Str1, repBean.getLineSpace(), 1, false, "BANK",repBean);
					
					Str1 = "SUS Days: "+FixStr(String.valueOf(SUSDays), 8, 1)+"      |";
					ReportDAO.println(Str1, repBean.getLineSpace(), 1, false, "BANK",repBean);
					//ReportDAO.println((char)15+sLine1, 0, 1, false, "BANK",repBean);  //*********Ask P h patil sir  Chr()
					
					ReportDAO.println(sLine1, repBean.getLineSpace(), 1, false, "BANK",repBean);
					ReportDAO.println("  Salary & Allowances   | Amount.(Rs.)|        Deductions        | Amount.(Rs.)|", repBean.getLineSpace(), 1, false, "BANK",repBean);
				//ReportDAO.println((char)15+sLine1, 0, 1, false, "BANK",repBean);//*********Ask P h patil sir  Chr()
					ReportDAO.println(sLine1, repBean.getLineSpace(), 1, false, "BANK",repBean);
					for(i = 1 ; i <= 40 ; i++)
					{
						if(Icoded[i] != 0 && Ecoded[i] != 0)
						{
							Str1 = FixStr(Idesc[i], 21, 1) + "   | " + trans(INCamt[Icoded[i]], "99,99,999.99", "", false, false) +  "| " ;
							if((DEDamt[Ecoded[i]]!=0 && Ecoded[i]==242 && DEDamt[Ecoded[i]]==10) || (DEDamt[Ecoded[i]]!=0 &&Ecoded[i]==242 && DEDamt[Ecoded[i]]==25)){
								Str1 = Str1 + FixStr(Edesc[i]+   DEDamt[Ecoded[i]], 22, 1) + "   | " + trans(DEDamt[Ecoded[i]], "99,99,999.99", "", false, false)+"| "   ;	
							}else{
							Str1 = Str1 + FixStr(Edesc[i], 22, 1) + "   | " + trans(DEDamt[Ecoded[i]], "99,99,999.99", "", false, false)+"| "   ;
							}
							TotGross[1] = TotGross[1] + INCamt[Icoded[i]];
							TotGross[2] = TotGross[2] + aINCamt[Icoded[i]];
							TotGross[3] = TotGross[3] + aINCamt[Icoded[i]] + INCamt[Icoded[i]];
							TotDed[1] = TotDed[1] + DEDamt[Ecoded[i]];
							TotDed[2] = TotDed[2] + aDEDamt[Ecoded[i]];
							TotDed[3] = TotDed[3] + DEDamt[Ecoded[i]] + aDEDamt[Ecoded[i]];
						}
						else if(Icoded[i] != 0)
						{
							Str1 = FixStr(Idesc[i], 21, 1) + "   | " + trans(INCamt[Icoded[i]], "99,99,999.99", "", false, false) + "| ";
							Str1 = Str1 + ReportDAO.addSpaces("", 22) + "   | " + ReportDAO.addSpaces("", 12);
							TotGross[1] = TotGross[1] + INCamt[Icoded[i]];
							TotGross[2] = TotGross[2] + aINCamt[Icoded[i]];
							TotGross[3] = TotGross[3] + aINCamt[Icoded[i]] + INCamt[Icoded[i]];
						}
						else if(Ecoded[i] != 0)
						{
							Str1 = ReportDAO.addSpaces("", 21) + "   | "  + ReportDAO.addSpaces("", 12) + "| ";
							Str1 = Str1 + FixStr(Edesc[i], 22, 1) + "   | " + trans(DEDamt[Ecoded[i]], "99,99,999.99", "", false, false) +  "| ";
							TotDed[1] = TotDed[1] + DEDamt[Ecoded[i]];
							TotDed[2] = TotDed[2] + aDEDamt[Ecoded[i]];
							TotDed[3] = TotDed[3] + DEDamt[Ecoded[i]] + aDEDamt[Ecoded[i]];
							
						}
						else
						{
							break;
						}
						ReportDAO.println(Str1, repBean.getLineSpace(), 1, false, "BANK",repBean);
					}
					ReportDAO.println(sLine1, repBean.getLineSpace(), 1, false, "BANK",repBean); //*********Ask P h patil sir  Chr()
					Str1 = "       Gross Salary :-> | "+trans(TotGross[1], "99,99,999.99", "", false, false) + "| ";
					Str1 = Str1 + FixStr("Total Deductions:->", 22, 1) + "   | " + trans(TotDed[1], "99,99,999.99", "", false, false) + "| " ;
					ReportDAO.println(Str1, repBean.getLineSpace(), 1, false, "BANK",repBean); 
					Str1 = "        Net Salary  :-> | "+trans(TotGross[3]-TotDed[3], "99,99,999.99", "", false, false) + "|----------------------------------------|";
					ReportDAO.println(Str1, repBean.getLineSpace(), 1, false, "BANK",repBean);
					/*if(TotDed[3] != 0)
					{
						Str1 = "%Of Net Salary With Gross |"+ trans((TotGross[3]-TotDed[3]) / TotGross[3] * 100,"99,99,999.99", "", false, false) + " |"; //*** Convert (TOTGroass[3]-TotDed[3]) to words         remain*********
					}
					else
					{
						Str1 = "0%";
					}
					ReportDAO.println(Str1, 0, 1, false, "BANK",repBean);*/
					ReportDAO.println(sLine1, repBean.getLineSpace(), 1, false, "BANK",repBean);
					Str1 = "Deductions              | Amount      | Cumultive Balance |        Leave Balance       |";
					lSql = "SELECT MAX(L1.BAL),L1.LEAVECD FROM LEAVEBAL L1 WHERE L1.EMPNO = "+emp.getInt("EMPNO")+" AND (L1.srno) IN (SELECT MAX(srno) FROM LEAVEBAL L2 WHERE BALDT <='"+ReportDAO.EOM(Payslipdt)+"' AND L2.EMPNO = "+emp.getInt("EMPNO")+" and L2.LEAVECD = L1.LEAVECD ) and l1.leavecd not in (4,7,9,10) GROUP BY L1.LEAVECD";
					//lSql = "SELECT leavecd,max(bal) bal from LEAVEBAL a where a.EMPNO= = "+emp.getInt("EMPNO")+"  AND BALDT=(select max(BALDT) from LEAVEBAL b where EMPNO= a.EMPNO AND LEAVECD= a.LEAVECD and BALDT <='22-Aug-2013' )  group by LEAVECD";			
					System.out.println(lSql);
					Statement st2 = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
					TmpRs = st2.executeQuery(lSql);
					if(TmpRs.next())
					{
						Str1 = "         Leave Type :-> |             |   PL   |   SL   |   CL   |    MAT_L    |";
						ReportDAO.println(Str1, repBean.getLineSpace(), 1, false, "BANK",repBean);
						Str1 = "                        |             |----------------------------------------|";
						ReportDAO.println(Str1, repBean.getLineSpace(), 1, false, "BANK",repBean);
					// leave Taken start
						lSql = "Bal upto    "+ReportDAO.EOM(Payslipdt)+" |             |";
						Str1 = "";
						String Str2="Taken upto  "+ReportDAO.EOM(Payslipdt)+" |             |";
	//					String Str3="This Month  "+ReportDAO.EOM(Payslipdt)+" |             |";
						float leavetaken =0;
						float leavetakenInthisMonth=0;
						ReportDAO.OpenCon("", "", "",repBean);
					    Cn = repBean.getCn();
						for(LP = 1;LP <= 3;LP++)
						{
							LPRN[LP] = "";
						}
						
						CP = 1;
						TmpRs.beforeFirst();
						while(TmpRs.next())
						{
							for(LP = 1;LP <= 3;LP++)
							{
								if(LPRN[LP].equals(TmpRs.getString(2)))
								{
									continue;
								}
							}
							if(TmpRs.getString(2).equals("3") || TmpRs.getString(2).equals("1") || TmpRs.getString(2).equals("2")|| TmpRs.getString(2).equals("8"))
							{
								Str1 = Str1 + FixStr(String.valueOf(TmpRs.getInt(1)), 8, 2) + "|";
								leavetaken = ReportDAO.get_leave_avail(emp.getInt("EMPNO"),TmpRs.getInt(2),Payslipdt,Payslipdt,"0",repBean);
								leavetakenInthisMonth = ReportDAO.get_leave_avail_this_month(emp.getInt("EMPNO"),TmpRs.getInt(2),Payslipdt,Payslipdt,"0",repBean);
								
								Str2 = Str2 + FixStr(String.valueOf(leavetaken), 8, 2) + "|";
	//							Str3=  Str3 +  FixStr(String.valueOf(leavetakenInthisMonth), 8, 2) + "|";
								//System.out.println("str1 = " +Str1);
							}
							LPRN[CP] = TmpRs.getString(2);
							CP =CP + 1;
						}
						lSql = lSql + Str1;
						ReportDAO.println(lSql, repBean.getLineSpace(), 1, false, "BANK",repBean);
						ReportDAO.println(Str2, repBean.getLineSpace(), 1, false, "BANK",repBean);
//						ReportDAO.println(Str3, repBean.getLineSpace(), 1, false, "BANK",repBean);
					
						
					}
					else
					{
						Str1 = "         Leave Type :-> |             |   PL   |   SL   |   CL   |    MAT_L    |";
						ReportDAO.println(Str1,repBean.getLineSpace(), 1, false, "BANK",repBean);
						Str1 = "                        |             |----------------------------------------|";
						ReportDAO.println(Str1,repBean.getLineSpace(), 1, false, "BANK",repBean);
						lSql = "Bal upto    "+ReportDAO.EOM(Payslipdt)+" |              |";
						ReportDAO.println(lSql,repBean.getLineSpace(), 1, false, "BANK",repBean);
						lSql = "Taken upto  "+ReportDAO.EOM(Payslipdt)+" |              |";
						ReportDAO.println(lSql,repBean.getLineSpace(), 1, false, "BANK",repBean);
						lSql = "Taken this Month  "+ReportDAO.EOM(Payslipdt)+" |              |";
						ReportDAO.println(lSql,repBean.getLineSpace(), 1, false, "BANK",repBean);
					}
					ReportDAO.println(sLine1,repBean.getLineSpace(), 1, false, "BANK",repBean);
					ReportDAO.println("NET PAYMENT  "+trans(TotGross[3]-TotDed[3], "99,99,999.99", "", false, false) , repBean.getLineSpace(), 1, false, "BANK",repBean);
					ReportDAO.println("In Words:- "+originalNumToLetter.getInWords(String.valueOf(TotGross[3]-TotDed[3])) , repBean.getLineSpace(), 1, false, "BANK",repBean);
					ReportDAO.println(sLine2,repBean.getLineSpace(), 1, false, "BANK",repBean);
					ReportDAO.println("Note - In case any descripancy in salary,Please contact to Salary section ",2,1, false, "BANK",repBean);
					ReportDAO.println("immediately.",9, 5, false, "BANK",repBean);
					ReportDAO.println("AUTHORISED SIGNATORY", 61, 1, false, "BANK",repBean);
					ReportDAO.println("ADMIN & HRD H.O", 64, 3, false, "BANK",repBean);	
					
					//*****print(Chr(12));
					
			
				    //**** page break 
					ReportDAO.println(String.valueOf((char)12), 0, 1, false, "BANK",repBean);
					
					repBean.setLnCount(0);
					
					//ReportDAO.println(String.valueOf((char)18), 0, 1, false, "BANK"); //***********Remain CHr()
				}
				for(i = 0;i <= 3 ; i++)
				{
					TotDed[i] = 0;
					TotGross[i] = 0;
					
				}
			}
			
			//*******************CHk by PH patil sir
			//Print (Fp, Chr(12));
		  //  Print (Fp, Chr(18);
		  //  Close (Fp);
		    //FileName = "c:\\payslip.prn";
		  //  Load (printfrm);
		   // printfrm.Show vbModal;
			
			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
		} catch (Exception e)
		{
			e.printStackTrace();
			// TODO: handle exception
		}
	    
	
		
	
		
	}//payslip according to namco in txt format by Hrishi ends  here


public static float round(float num)
{


float temp=0;
float frac,j=1;

num=15.88F;
// FOR THE FRACTION PART
do{
j=j*10;
temp= num*j;
}while((temp%10)!=0);       

j=j/10;
temp=(int)num;
frac=(num*j)-(temp*j);

//System.out.println("Double number= "+num);      
//System.out.println("Whole part= "+(int)num+" fraction part= "+(int)frac);
int Whole =(int)num;
int frac1 = (int)frac;
if(frac1 >= 1 && frac1 <= 19){
//frac = frac - 1;	
} else if( frac1 >=20 && frac1 <=29){
	//frac = frac - 2;
} else if( frac1 >=30 && frac1 <=39){
	//frac = frac + 2;
} else if( frac1 >=40 && frac1 <=49){
	//frac = frac + 1;
} else if( frac1 >=50 && frac1 <=59){
	//frac = frac - 1;
} else if( frac1 >=60 && frac1 <=69){
	//frac = frac - 2;
 } else if( frac1 >=70 && frac1 <=79){
	 //frac = frac + 2;
	 Whole=Whole+1;
 } else if( frac1 >=80 && frac1 <=99){
	//frac = frac + 1;
	 Whole=Whole+1;
 }
	






return  Whole;
}





//leave ledger txt  method by HRISHI starts here

public static void leaveLedgertxtnew(String Fdt, String TDT, int empno,String  filepath){
	
	System.out.println("leaveLedgertxtnew");
	RepoartBean repBean  = new RepoartBean();
	FileWriter Fp;
	Connection Cn = null;	
	int feno=0;
	int teno=0;
	String fdate="";
	String tdate="";
	float clTot=0;
	float lwpTot=0;
	float plTot=0;
	float availCL=0;
	float availPL=0;
	float availSL=0;
	
	float availEncash=0;
	float availlapse_sl=0;
	float availlapse_cl=0;
	float availCredit_pl=0;
	float availCredit_cl=0;
	float availCredit_sl=0;
	float availLate=0;
	
	float Encash=0;
	float lwp=0;
	float availlwp=0;
	
	float totSL=0;
	float slTot=0;
	int mlbal =0;
	int nopl =0;
	int nosl =0;
	int nocl =0;
	ResultSet emp =null;
	String Str1 ="";
	String SLINE ="";
	String SDOTTED="";
	int TCnopl =0;
	int TCnosl =0;
	int TCnocl =0;

	int TDnopl =0;
	int TDnosl =0;
	int TDnocl =0;

	ResultSet trn =null;
	ResultSet bal =null;
	String EmpSql ="";
	String dtrsql ="";

	ReportDAO.inithead(repBean);
	repBean.setLnCount(0);
	repBean.setPageNo(1);
	repBean.setLineSpace(10);
	repBean.setLineLen(93);
	repBean.setPageLen(65);

	ReportDAO.make_prn_file(filepath,repBean);

	ReportDAO.OpenCon("", "", "",repBean);
	Cn = repBean.getCn();


	fdate=Fdt;
	tdate=TDT;

	SLINE=stringOfSize(93,'-');
	SDOTTED=stringOfSize(93,'=');
	String SBLINE=stringOfSize(40,'-');
	repBean.setHdg1("");
	repBean.setHdg2(SLINE);
/*	repBean.setHdg3("S. No|From Date |To Date |Lev. Days|Bal Day    |     Remark    |     LWP Type  | Sanction |");*/
	Str1 = FixStr("SNo", 3,3)+"| "+FixStr("From Date",10, 3)+" | "+FixStr("To Date", 10,3)+" | "+FixStr("Lev. Days", 6,3) + " | "+FixStr("Bal Day ", 6,3) + " | "+FixStr("Remark", 20,3)+" | "+FixStr("LWP Type", 7,3)+" | "+FixStr("Sanction", 8,3)+" | ";
	//Str1 = FixStr("Leave Type "+(srno), 10,3)+": "+FixStr(lkp.getLKP_Desc("LEAVE",trn.getInt("Leavecd")),7, 3)+"          "+FixStr("Opening Leave", 15,3)+" : "+FixStr(""+ReportDAO.get_leave_bal(emp.getInt("EMPNO"),trn.getInt("Leavecd"),fdate,tdate, "O",repBean), 6,3) + " ";

	repBean.setHdg3(Str1);
	
	
	//SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
	SimpleDateFormat outputFormat = new SimpleDateFormat("dd-MMM-yyyy");
	SimpleDateFormat inputFormat = new SimpleDateFormat("MM/dd/yyyy");

	/*EmpSql = "select emp.*, t.acno, t.Prj_srno, t.desig from empmast emp, emptran t where t.empno = emp.empno and EMP.EMPNO ="+empno+" AND " 
			+" t.SRNO = ( SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE e2.empno = emp.empno and E2.EFFDATE <= '"+tdate+"')" 
			+" and emp.status = 'A' order by emp.empno ";*/
/*	EmpSql = "select emp.*, t.acno, t.Prj_srno, t.desig from empmast emp, emptran t where t.empno = emp.empno and EMP.EMPNO ="+empno+" AND " 
			+" t.SRNO = ( SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE e2.empno = emp.empno and E2.EFFDATE <= '"+tdate+"')" 
			+" order by emp.empno ";
*/	
	EmpSql = "select emp.*, t.acno, t.Prj_srno, t.desig, O.F2 AS LREMARK from empmast emp, emptran t LEFT JOIN OTHERDETAIL O ON T.EMPNO=O.EMPNO where t.empno = emp.empno and EMP.EMPNO ="+empno+" AND " 
			+" t.SRNO = ( SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE e2.empno = emp.empno and E2.EFFDATE <= '"+tdate+"')" 
			+" order by emp.empno ";
	
	 System.out.println("EmpSql : "+EmpSql);
	Statement st;
	try
	{
		st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);

		System.out.println(EmpSql);
		emp = st.executeQuery(EmpSql);
		if(!emp.next())
		{
			System.out.println("Employee Record Set Is Empty ");
			return;
		}
		   ReportDAO.println(String.valueOf((char)18), 0, 1, false, "BANK",repBean);
	
		   ReportDAO.println("Employee Leave Ledger From :-> "+ fdate + " To " + tdate+" ", 20, 1, false, "BANK",repBean);
		   ReportDAO.println(" ", 10, 1, false, "BANK",repBean);
		
		  System.out.println("1     "+repBean.getBrnNo()+"2    "+repBean.getHdg1()+"3     "+ repBean.getHdg2()+"4  "+ repBean.getHdg3()+"5    "+ repBean.getHdg4()+"6       "+repBean);
		   
		   ReportDAO.page_head(repBean.getBrnNo(),repBean.getHdg1(), "", repBean.getHdg3(),"", "", "", "",repBean);
		   
		   ReportDAO.println("", 10, 1, false, "BANK",repBean);
		   ReportDAO.println(SLINE, 10, 1, false, "BANK",repBean);
		   
		   emp.beforeFirst();
		   LookupHandler lkp =new LookupHandler();
		   
		   String LeaveRemark = "";
		   
		   while(emp.next())
		{
			   LeaveRemark = emp.getString("LREMARK");
			   System.out.println("LeaveRemark :"+LeaveRemark);

			clTot = ReportDAO.get_leave_bal(emp.getInt("EMPNO"),3,fdate,tdate, "O",repBean);	//CL
			slTot = ReportDAO.get_leave_bal(emp.getInt("EMPNO"),2,fdate,tdate, "O",repBean);	//SL
			plTot = ReportDAO.get_leave_bal(emp.getInt("EMPNO"), 1,fdate,tdate, "O",repBean);	//PL
			lwpTot = ReportDAO.get_leave_bal(emp.getInt("EMPNO"),7,fdate,tdate, "O",repBean); //lwp
		
			System.out.println("start akshayy:: "+plTot);/*	
			Encash=ReportDAO.get_leave_bal(emp.getInt("EMPNO"), 5,tdate, "O",repBean);
			lwp=ReportDAO.get_leave_bal(emp.getInt("EMPNO"), 7,tdate, "O",repBean);*/
			
			availCL = ReportDAO.get_leave_avail(emp.getInt("EMPNO"),3,fdate,tdate, "O",repBean);	//availCL
			availSL = ReportDAO.get_leave_avail(emp.getInt("EMPNO"),2,fdate,tdate, "O",repBean);	//availSL
			availPL = ReportDAO.get_leave_avail(emp.getInt("EMPNO"), 1,fdate,tdate, "O",repBean);	//availPL
			
			availEncash=ReportDAO.get_leave_encash(emp.getInt("EMPNO"), 5,fdate,tdate, "O",repBean);
			
			availlapse_sl=ReportDAO.get_leave_lapse(emp.getInt("EMPNO"), 2,fdate,tdate, "O",repBean);
			availlapse_cl=ReportDAO.get_leave_lapse(emp.getInt("EMPNO"), 3,fdate,tdate, "O",repBean);
			
			availCredit_pl=ReportDAO.get_leave_credit(emp.getInt("EMPNO"),1,fdate,tdate, "O",repBean);
			availCredit_sl=ReportDAO.get_leave_credit(emp.getInt("EMPNO"),2,fdate,tdate, "O",repBean);
			availCredit_cl=ReportDAO.get_leave_credit(emp.getInt("EMPNO"),3,fdate,tdate, "O",repBean);
						
			Str1 = "Emp.Code: "+FixStr(emp.getString("empcode"), 16, 1)+"  Name  : "+FixStr((FixStr(emp.getString("lname")+ "  " +emp.getString("fname")+"  "+(emp.getString("mname")), 42, 1)), 50, 1);
			
			ReportDAO.println(Str1, 10, 1, false, "BANK",repBean);
			
			Str1 = "Desig.  : "+FixStr(lkp.getLKP_Desc("DESIG",emp.getInt("DESIG")),16,1)+"  Branch: "+FixStr(LookupHandler.getprojectName(emp.getInt("prj_srno")),50,1)+" "; 
			
			ReportDAO.println(Str1, 10, 1, false, "BANK",repBean);
			
			/*Str1 = "                               Opening Bal->|       "+FixStr(""+clbal, 3, 3)+" |       "+FixStr(""+plbal, 3, 3)+" |       "+FixStr(""+slbal, 3, 3);
			
			ReportDAO.println(Str1, 10, 1, false, "BANK",repBean);*/
			
		
			ReportDAO.println(SDOTTED,10, 3, false, "BANK",repBean);
	
			
			
			Str1=" "+FixStr("Details",11,1)+"-      "+FixStr("CL",7,1)+"|"+FixStr("PL",7,1)+"|"+FixStr("SL",7,1)+" ";
			
			ReportDAO.println(SBLINE,20, 1, false, "BANK",repBean);
			ReportDAO.println(Str1, 20, 1, false, "BANK",repBean);
			ReportDAO.println(SBLINE,20, 1, false, "BANK",repBean);
			
			Str1 = " "+FixStr("Op. Bal",11,1)+"-      "+FixStr("0.0", 7, 1)+"|"+FixStr(""+plTot, 7, 1)+"|"+FixStr(""+slTot, 7, 1);
		//	Str1 = " "+FixStr("Op. Bal",11,1)+"-      "+FixStr(""+(clTot+availCredit_cl), 7, 1)+"|"+FixStr(""+(plTot+availCredit_pl), 7, 1)+"|"+FixStr(""+(slTot), 7, 1);
			ReportDAO.println(Str1, 20, 1, false, "BANK",repBean);
			
			Str1 = " "+FixStr("Credit   ",11,1)+"-      "+FixStr(""+availCredit_cl, 7, 1)+"|"+FixStr(""+availCredit_pl, 7, 1)+"|"+FixStr(""+availCredit_sl, 7, 1);
			ReportDAO.println(Str1, 20, 1, false, "BANK",repBean);
			
			
			Str1 = " "+FixStr("Avail/Taken",11,1)+"-      "+FixStr(""+availCL, 7, 1)+"|"+FixStr(""+availPL, 7, 1)+"|"+FixStr(""+availSL, 7, 1);
			ReportDAO.println(Str1, 20, 1, false, "BANK",repBean);
			
			
			Str1 = " "+FixStr("Encash   ",11,1)+"-      "+FixStr(""+0.0, 7, 1)+"|"+FixStr(""+availEncash, 7, 1)+"|"+FixStr(""+0.0, 7, 1);
			ReportDAO.println(Str1, 20, 1, false, "BANK",repBean);
			
			
			Str1 = " "+FixStr("LWP",11,1)+"-      "+FixStr(""+ReportDAO.get_leave_lwp(emp.getInt("EMPNO"), 3,fdate,tdate, "O",repBean), 7, 1)+"|"+FixStr(""+ReportDAO.get_leave_lwp(emp.getInt("EMPNO"), 1,fdate,tdate, "O",repBean), 7, 1)+"|"+FixStr(""+ReportDAO.get_leave_lwp(emp.getInt("EMPNO"), 2,fdate,tdate, "O",repBean), 7, 1);
			ReportDAO.println(Str1, 20, 1, false, "BANK",repBean);
			
			
			Str1 = " "+FixStr("LATE MARK",11,1)+"-      "+FixStr(""+ReportDAO.get_leave_late(emp.getInt("EMPNO"), 3,fdate,tdate, "O",repBean), 7, 1)+"|"+FixStr(""+ReportDAO.get_leave_late(emp.getInt("EMPNO"), 1,fdate,tdate, "O",repBean), 7, 1)+"|"+FixStr(""+ReportDAO.get_leave_late(emp.getInt("EMPNO"), 2,fdate,tdate, "O",repBean), 7, 1);
			ReportDAO.println(Str1, 20, 1, false, "BANK",repBean);
			
			ReportDAO.println(SBLINE,20, 1, false, "BANK",repBean);
		//	Str1 = " "+FixStr("Balanace",11,1)+"-      "+FixStr(""+(Math.abs(clTot-availCL)), 7, 1)+"|"+FixStr(""+(Math.abs(plTot-availPL-availEncash+availCredit_pl)), 7, 1)+"|"+FixStr(""+(Math.abs(slTot-availSL+availCredit_sl-availlapse_sl)), 7, 1);
			
		//	System.out.println("fdate G"+fdate);

			
			//Str1 = " "+FixStr("Balanace",11,1)+"-      "+FixStr(""+(Math.abs((clTot+availCredit_cl)-availCL)), 7, 1)+"|"+FixStr(""+(Math.abs((plTot+availCredit_pl)-availEncash-availPL)), 7, 1)+"|"+FixStr(""+(Math.abs(slTot-availSL)), 7, 1);
			Str1 = " "+FixStr("Balanace",11,1)+"-      "+FixStr(""+(Math.abs((clTot+availCredit_cl)-availCL)), 7, 1)+"|"+FixStr(""+(Math.abs((plTot+availCredit_pl)-availEncash-availPL)), 7, 1)+"|"+FixStr(""+(Math.abs((slTot+availCredit_sl)-availSL)), 7, 1);
			ReportDAO.println(Str1, 20, 1, false, "BANK",repBean);
			
			ReportDAO.println("",10, 1, false, "BANK",repBean);
			
			Str1 = " "+FixStr("No. of S.L. Attempt",20,1)+" :  "+FixStr(""+ReportDAO.get_Sl_Count(emp.getInt("EMPNO"),2,fdate,tdate, "O",repBean), 3, 1)+"    "+FixStr("As on Date", 10, 1)+" - "+FixStr(""+tdate, 14, 1);
			ReportDAO.println(Str1, 20, 1, false, "BANK",repBean);
			
			Str1 = " "+FixStr("No. of C.L. Attempt",20,1)+" :  "+FixStr(""+ReportDAO.get_Sl_Count(emp.getInt("EMPNO"),3,fdate,tdate, "O",repBean), 3, 1)+"    "+FixStr("As on Date", 10, 1)+" - "+FixStr(""+tdate, 14, 1);
			ReportDAO.println(Str1, 20, 1, false, "BANK",repBean);
			
			Str1 = " "+FixStr("No. of P.L. Attempt",20,1)+" :  "+FixStr(""+ReportDAO.get_Sl_Count(emp.getInt("EMPNO"),1,fdate,tdate, "O",repBean), 3, 1)+"    "+FixStr("As on Date", 10, 1)+" - "+FixStr(""+tdate, 14, 1);
			ReportDAO.println(Str1, 20, 1, false, "BANK",repBean);
		/*	ReportDAO.println(SLINE, 10, 1,false,"BANK",repBean);
			ReportDAO.println(SLINE, 10, 1,false,"BANK",repBean);*/
			
			//Str1 = "SELECT * FROM LEAVETRAN WHERE EMPNO ="+emp.getInt("EMPNO")+" and LEAVETRAN.STATUS != '98'   AND frmdt >= '"+Fdt+"' and todt <= '"+ReportDAO.EOM(TDT)+"' and lreason!='Leave Lapse' order by leavecd, frmdt,applno  ";
			
			Str1 = "SELECT * FROM LEAVETRAN WHERE EMPNO ="+emp.getInt("EMPNO")+" and LEAVETRAN.STATUS != '98' and LEAVETRAN.STATUS= 'SANCTION' AND frmdt >= '"+Fdt+"' and todt <= '"+ReportDAO.EOM(TDT)+"' and lreason!='Leave Lapse' AND LREASON !='CREDIT AFTER CANCELLATION' order by leavecd, frmdt,applno  ";
			
			System.out.println("akshay 06 "+Str1);
			Statement st1=Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
			
			
			trn = st1.executeQuery(Str1);

			if(!trn.next())
			{
				ReportDAO.println("",10 ,1,false,"BANK",repBean);
				ReportDAO.println("NO ANY TRANSACTIONS FOUND FOR "+emp.getString("EMPCODE"),10 ,1,false,"BANK",repBean);

			}
			trn.beforeFirst();
			int srno=0;
			float totalbal=0;
			float plBal1 = 0;
			int leavecd=0;
			ReportDAO.println("", 10, 1, false, "BANK",repBean);
			ReportDAO.println(repBean.getHdg3(), 10, 1, false, "BANK",repBean);
			while(trn.next())
			{
				srno++;
				if(leavecd!=trn.getInt("LEAVECD"))
				{
					
					ReportDAO.println(" ", 10, 1, false, "BANK", repBean);
					ReportDAO.println(" ", 10, 1, false, "BANK", repBean);
				Str1 = FixStr("Leave Type "+(srno), 10,3)+": "+FixStr(lkp.getLKP_Desc("LEAVE",trn.getInt("Leavecd")),7, 3)+"          "+FixStr("Opening Leave", 15,3)+" : "+FixStr(""+ReportDAO.get_leave_bal(emp.getInt("EMPNO"),trn.getInt("Leavecd"),fdate,tdate, "O",repBean), 6,3) + " ";
					if(trn.getInt("Leavecd")==3){
						System.out.println("for CL ::  "+(clTot+availCredit_cl));
					Str1 = FixStr("Leave Type "+(srno), 10,3)+": "+FixStr(lkp.getLKP_Desc("LEAVE",trn.getInt("Leavecd")),7, 3)+"          "+FixStr("Opening Leave", 15,3)+" : "+FixStr(""+(clTot), 6,3) + " ";
					}
					else if(trn.getInt("Leavecd")==2){
						System.out.println("for SL ::  "+(slTot));
						Str1 = FixStr("Leave Type "+(srno), 10,3)+": "+FixStr(lkp.getLKP_Desc("LEAVE",trn.getInt("Leavecd")),7, 3)+"          "+FixStr("Opening Leave", 15,3)+" : "+FixStr(""+(slTot), 6,3) + " ";
						}
					else if(trn.getInt("Leavecd")==1){
						System.out.println("for PL ::  "+(plTot+availCredit_pl));
						Str1 = FixStr("Leave Type "+(srno), 10,3)+": "+FixStr(lkp.getLKP_Desc("LEAVE",trn.getInt("Leavecd")),7, 3)+"          "+FixStr("Opening Leave", 15,3)+" : "+FixStr(""+(plTot), 6,3) + " ";
						}
					
					else if(trn.getInt("Leavecd")==7 ||trn.getInt("Leavecd")==9){
						Str1 = FixStr("Leave Type "+(srno), 10,3)+": "+FixStr(lkp.getLKP_Desc("LEAVE",trn.getInt("Leavecd")),7, 3)+"          "+FixStr("Opening Leave", 15,3)+" : "+FixStr(""+(0), 6,3) + " ";
					}
					else{
						Str1 = FixStr("Leave Type "+(srno), 10,3)+": "+FixStr(lkp.getLKP_Desc("LEAVE",trn.getInt("Leavecd")),7, 3)+"          "+FixStr("Opening Leave", 15,3)+" : "+FixStr(""+ReportDAO.get_leave_bal(emp.getInt("EMPNO"),trn.getInt("Leavecd"),fdate,tdate, "O",repBean), 6,3) + " ";
					}
					ReportDAO.println(Str1, 10, 1, false, "BANK", repBean);
					ReportDAO.println(SLINE, 10, 1, false, "BANK", repBean);
					
				}
				// akshays chng 4 pl creadit after cancellation
				if(trn.getInt("LEAVECD")==1)
				{
					
					if(trn.getString("TRNTYPE").equals("C "))
					{
						totalbal=trn.getFloat("days")+plTot;
						if(trn.getString("lreason").equals("CREDIT AFTER CANCELLATION"))
						  {System.out.println("akshay"+totalbal);
						   plTot=plTot+trn.getFloat("days");
							totalbal=plTot+trn.getFloat("days");
							System.out.println("akshaay"+totalbal);
						  }
				
					}
					if(trn.getString("TRNTYPE").equals("D "))
					  {
						
						System.out.println("totalbal"+totalbal);
						System.out.println("reason __"+trn.getString("lreason"));
						/*if((trn.getString("lreason").equals("CREDIT AFTER CANCELL")))
						  {
							totalbal=plTot-trn.getFloat("days");
						  }*/
						
						if((trn.getString("lreason").equals("Leave Encash")))
						  {
							
							totalbal=plTot; 
						  }
						if(!(trn.getString("lreason").equals("Leave Encash")))
						  {
							
					        totalbal=plTot-trn.getFloat("days");
					        plTot=plTot-trn.getFloat("days");
						  }
							
				     }
					System.out.println("ak1:: "+plTot);
					Str1 = FixStr(""+(srno), 3,3)+"| "+FixStr(trn.getString("frmdt"),10, 3)+" | "+FixStr(trn.getString("todt"), 10,3)+" | "+FixStr(""+trn.getFloat("days"), 6,3) + " | "+FixStr(""+totalbal, 6,3) + " | "+FixStr(trn.getString("LREASON")==null?"No Reason":trn.getString("LREASON"), 20,3)+" | "+FixStr("", 7,3)+" | "+FixStr(trn.getString("STATUS").equals("1") || trn.getString("STATUS").equals("SANCTION")?"Y":"N", 8,3)+"|"+FixStr(trn.getString("trntype"), 1,3);
					
				}
				// end here 
				if(trn.getInt("LEAVECD")==2)
				{
					System.out.println("i am in SL");
					String a=trn.getString("TRNTYPE");
					if(a.equalsIgnoreCase("C ")){
						System.out.println("i am in SL of 'C'");
					//	totalbal=trn.getFloat("days")+slTot;
					//	slTot=slTot+trn.getFloat("days");
						//totalbal=0;
						totalbal=slTot;
						System.out.println("i am in SL of 'C' slTot::  "+slTot+"  days::  "+trn.getFloat("days"));
						System.out.println("AJ totalbal:  "+totalbal);
					}
					if(a.equalsIgnoreCase("D ")){
						System.out.println("i am in SL of 'D'   ::slTot  "+slTot);
					System.out.println("days:: "+trn.getFloat("days"));	
					totalbal=slTot-trn.getFloat("days");
					System.out.println("SL totalbal:: "+totalbal);	
					slTot=slTot-trn.getFloat("days");
					System.out.println("slTot:: "+slTot);	
					}
					System.out.println("SL totalbal 1:: "+slTot);
					System.out.println("SL final TOT:: "+slTot+"   DAYS::  "+trn.getFloat("days")+"  totSL::  "+totSL);
				//	Str1 = FixStr(""+(srno), 3,3)+"| "+FixStr(trn.getString("frmdt"),10, 3)+" | "+FixStr(trn.getString("todt"), 10,3)+" | "+FixStr(""+trn.getFloat("days"), 6,3) + " | "+FixStr(""+totalbal, 6,3) + " | "+FixStr(trn.getString("LREASON")==null?"No Reason":trn.getString("LREASON"), 20,3)+" | "+FixStr("", 7,3)+" | "+FixStr(trn.getString("STATUS").equals("1") || trn.getString("STATUS").equals("SANCTION")?"Y":"N", 8,3)+"|"+FixStr(trn.getString("trntype"), 1,3);
					Str1 = FixStr(""+(srno), 3,3)+"| "+FixStr(trn.getString("frmdt"),10, 3)+" | "+FixStr(trn.getString("todt"), 10,3)+" | "+FixStr(""+trn.getFloat("days"), 6,3) + " | "+FixStr(""+slTot, 6,3) + " | "+FixStr(trn.getString("LREASON")==null?"No Reason":trn.getString("LREASON"), 20,3)+" | "+FixStr("", 7,3)+" | "+FixStr(trn.getString("STATUS").equals("1") || trn.getString("STATUS").equals("SANCTION")?"Y":"N", 8,3)+"|"+FixStr(trn.getString("trntype"), 1,3);
					System.out.println("i am in  end of SL");
				}
				
				if(trn.getInt("LEAVECD")==3)
				{ 
					String a=trn.getString("TRNTYPE");
					if(a.equalsIgnoreCase("C ")){
						totalbal=trn.getFloat("days");
						//totalbal=0;
					}
					if(trn.getString("TRNTYPE").equalsIgnoreCase("D ")){
					/*totalbal=availCredit_cl-trn.getFloat("days");*/
						
						totalbal=(clTot+availCredit_cl)-trn.getFloat("days");
					System.out.println("totalbal new :"+totalbal);
					
					/*clTot=availCredit_cl-trn.getFloat("days");*/
					availCredit_cl=availCredit_cl-trn.getFloat("days");
					
					System.out.println(" G totalbal"+totalbal+" clTotg"+clTot);
					}
					
					
					/*Str1 = FixStr(""+(srno), 3,3)+"| "+FixStr(trn.getString("frmdt"),10, 3)+" | "+FixStr(trn.getString("todt"), 10,3)+" | "+FixStr(""+trn.getFloat("days"), 6,3) + " | "+FixStr(""+clTot, 6,3) + " | "+FixStr(trn.getString("LREASON")==null?"No Reason":trn.getString("LREASON"), 20,3)+" | "+FixStr("", 7,3)+" | "+FixStr(trn.getString("STATUS").equals("1") || trn.getString("STATUS").equals("SANCTION")?"Y":"N", 8,3)+"|"+FixStr(trn.getString("trntype"), 1,3);*/
					
					/*Str1 = FixStr(""+(srno), 3,3)+"| "+FixStr(trn.getString("frmdt"),10, 3)+" | "+FixStr(trn.getString("todt"), 10,3)+" | "+FixStr(""+trn.getFloat("days"), 6,3) + " | "+FixStr(""+clTot, 6,3) + " | "+FixStr(trn.getString("LREASON")==null?"No Reason":trn.getString("LREASON"), 20,3)+" | "+FixStr("", 7,3)+" | "+FixStr(trn.getString("STATUS").equals("1") || trn.getString("STATUS").equals("SANCTION")?"Y":"N", 8,3)+"|"+FixStr(trn.getString("trntype"), 1,3);*/
					Str1 = FixStr(""+(srno), 3,3)+"| "+FixStr(trn.getString("frmdt"),10, 3)+" | "+FixStr(trn.getString("todt"), 10,3)+" | "+FixStr(""+trn.getFloat("days"), 6,3) + " | "+FixStr(""+clTot, 6,3) + " | "+FixStr(trn.getString("LREASON")==null?"No Reason":trn.getString("LREASON"), 20,3)+" | "+FixStr("", 7,3)+" | "+FixStr(trn.getString("STATUS").equals("1") || trn.getString("STATUS").equals("SANCTION")?"Y":"N", 8,3)+"|"+FixStr(trn.getString("trntype"), 1,3);
					
				
					
					
					

				}
				
				
				if(trn.getInt("LEAVECD")==7)
				{
					if(trn.getString("TRNTYPE").equalsIgnoreCase("D ")){
					totalbal=lwpTot-trn.getFloat("days");
					
					
					lwpTot=lwpTot-trn.getFloat("days");
					}
					//Str1 = FixStr(""+(srno), 3,3)+"| "+FixStr(trn.getString("frmdt"),10, 3)+" | "+FixStr(trn.getString("todt"), 10,3)+" | "+FixStr(""+trn.getFloat("days"), 6,3) + " | "+FixStr(""+totalbal, 6,3) + " | "+FixStr(trn.getString("LREASON")==null?"No Reason":trn.getString("LREASON"), 20,3)+" | "+FixStr(trn.getString("LREASON")==null?"No Reason":trn.getString("LREASON").substring(0,3), 7,3)+" | "+FixStr(trn.getString("STATUS").equals("1") || trn.getString("STATUS").equals("SANCTION")?"Y":"N", 8,3)+"|"+FixStr(trn.getString("trntype"), 1,3);
					Str1 = FixStr(""+(srno), 3,3)+"| "+FixStr(trn.getString("frmdt"),10, 3)+" | "+FixStr(trn.getString("todt"), 10,3)+" | "+FixStr(""+trn.getFloat("days"), 6,3) + " | "+FixStr("", 6,3) + " | "+FixStr(trn.getString("LREASON")==null?"No Reason":trn.getString("LREASON"), 20,3)+" | "+FixStr(trn.getString("LREASON")==null?"No Reason":trn.getString("LREASON").substring(0,3), 7,3)+" | "+FixStr(trn.getString("STATUS").equals("1") || trn.getString("STATUS").equals("SANCTION")?"Y":"N", 8,3)+"|"+FixStr(trn.getString("trntype"), 1,3);

				}
				
				else{
					System.out.println("i am in else ::  "+totalbal+"    days=  "+trn.getFloat("days"));
					/*if(trn.getInt("LEAVECD")==2)
					{
						totalbal=slTot+trn.getFloat("days");
						Str1 = FixStr(""+(srno), 3,3)+"| "+FixStr(trn.getString("frmdt"),10, 3)+" | "+FixStr(trn.getString("todt"), 10,3)+" | "+FixStr(""+trn.getFloat("days"), 6,3) + " | "+FixStr(""+totalbal, 6,3) + " | "+FixStr(trn.getString("LREASON")==null?"No Reason":trn.getString("LREASON"), 20,3)+" | "+FixStr("", 7,3)+" | "+FixStr(trn.getString("STATUS").equals("1") || trn.getString("STATUS").equals("SANCTION")?"Y":"N", 8,3)+"|"+FixStr(trn.getString("trntype"), 1,3);
					}*/
					Str1 = FixStr(""+(srno), 3,3)+"| "+FixStr(trn.getString("frmdt"),10, 3)+" | "+FixStr(trn.getString("todt"), 10,3)+" | "+FixStr(""+trn.getFloat("days"), 6,3) + " | "+FixStr(""+totalbal, 6,3) + " | "+FixStr(trn.getString("LREASON")==null?"No Reason":trn.getString("LREASON"), 20,3)+" | "+FixStr("", 7,3)+" | "+FixStr(trn.getString("STATUS").equals("1") || trn.getString("STATUS").equals("SANCTION")?"Y":"N", 8,3)+"|"+FixStr(trn.getString("trntype"), 1,3);
					
				}
				
				
				
				nocl=0;
				nopl=0;
				nosl=0;

				/*if (trn.getInt("leavecd")==3)	//CL
				{
					//nocl = dateDiff("D",trn.getDate("frmdt"), trn.getDate("todt"));
					nocl = trn.getInt("DAYS");

					if(trn.getString("trntype").trim().equalsIgnoreCase("C"))
					{
						TCnocl = TCnocl + nocl;
					}else{
						TDnocl = TDnocl + nocl;
					}
				}
				else if(trn.getInt("leavecd")==1)	//PL
				{
					//nopl =  dateDiff("D",trn.getDate("frmdt"), trn.getDate("todt"));
					nopl = trn.getInt("DAYS");
					if(trn.getString("trntype").trim().equalsIgnoreCase("C"))
					{
						TCnopl = TCnopl + nopl;
					}else{
						TDnopl = TDnopl + nopl;
					}
				}
				else if(trn.getInt("leavecd")==2)	//SL
				{

					//nosl =  dateDiff("D",trn.getDate("frmdt"), trn.getDate("todt"));
					nosl = trn.getInt("DAYS");

					if(trn.getString("trntype").trim().equalsIgnoreCase("C"))
					{
						TCnosl = TCnosl + nosl;
					}else{
						TDnosl = TDnosl + nosl;
					}
				}



				if(trn.getString("trntype").trim().equalsIgnoreCase("D"))
				{
					Str1 = Str1 + FixStr(""+nocl, 3, 3)+" | "+ReportDAO.addSpaces("",3)+" | "+FixStr(""+nopl, 3, 3)+" | "+ReportDAO.addSpaces("", 3)+" | "+FixStr(""+nosl, 3, 3)+" | "+ReportDAO.addSpaces("", 3)+" | ";
				}
				else
				{
					Str1 = Str1 + ReportDAO.addSpaces("",3)+ " | "+FixStr(""+nocl, 3, 3)+" | "+ReportDAO.addSpaces("", 3)+" | "+FixStr(""+nopl, 3, 3)+" | "+ReportDAO.addSpaces("", 3)+" | "+FixStr(""+nosl, 3, 3)+" | ";
				}*/

				ReportDAO.println(Str1, 10, 1, false, "BANK", repBean);
				leavecd=trn.getInt("LEAVECD");
			}
			
			
			clTot = clTot + TCnocl-TDnocl;
			slTot = slTot + TCnosl - TDnosl;
			plTot = plTot + TCnopl - TDnopl;
			
			
			
			ReportDAO.println(SLINE, 10, 4,false,"BANK",repBean);
			//ReportDAO.println("Closing Bal->|       "+FixStr(""+clTot, 3, 3)+" |      "+FixStr(""+plTot, 3, 3)+"  |       "+FixStr(""+slTot, 3, 3), 31, 1,false,"BANK",repBean);
			// println "Closing Bal->|      " & FixStr(Str(clbal), 3, 3) & " |      " & FixStr(Str(plbal), 3, 3) & "  |       " & FixStr(Str(slbal), 3, 3), 32, Fp, 1

			ReportDAO.println("Leave Remark : "+LeaveRemark , 10, 4,false,"BANK",repBean);
			
			
			ReportDAO.println(SLINE,10, 1, true,"BANK",repBean);
			 ReportDAO.println("Employee Leave Ledger From :-> "+ fdate + " To " + tdate+" ", 20, 1, false, "BANK",repBean);
			   ReportDAO.println(" ", 10, 1, false, "BANK",repBean);
			
			  //System.out.println("1     "+repBean.getBrnNo()+"2    "+repBean.getHdg1()+"3     "+ repBean.getHdg2()+"4  "+ repBean.getHdg3()+"5    "+ repBean.getHdg4()+"6       "+repBean);
			   
			   ReportDAO.page_head(repBean.getBrnNo(),repBean.getHdg1(), "", repBean.getHdg3(),"", "", "", "",repBean);
			clTot = 0;
			lwpTot=0;
			plTot = 0;
			slTot = 0;
			availPL=0;
			availCL=0;
			availSL=0;
			TCnocl = 0;
			TCnopl = 0;
			TCnosl = 0;
			TDnocl = 0;
			TDnopl = 0;
			TDnosl = 0;


		}


		Fp = repBean.getFp();
		Fp.close();
		Cn.close();
		return;
	}catch(Exception e)
	{
		e.printStackTrace();
	}



}

////leave ledger txt  method by HRISHI ends here


	public static void leaveEncashReport(String date,String  filepath, String prjCode1){
	
	int year =Integer.parseInt(date.substring(7,11));
	//System.out.println("akshay"+year);
	int lastyear=year-1;
	RepoartBean repBean  = new RepoartBean();
	FileWriter Fp;
	Connection Cn = null;	
	
	try
	{
		ResultSet empRS =null;
		ResultSet empRS1 =null;
		ResultSet prjRS = null;
		
		String Str1 ="";
		String SLINE ="";
		String SLINEM ="";
		String SDOTTED="";
		
		ReportDAO.inithead(repBean);
		repBean.setLnCount(0);
		repBean.setPageNo(1);
		repBean.setLineSpace(10);
		repBean.setLineLen(123);
		repBean.setPageLen(74);
		
		ReportDAO.make_prn_file(filepath,repBean);
		ReportDAO.OpenCon("", "", "",repBean);
		Cn = repBean.getCn();
		
		SLINE=stringOfSize(161,'-');
		SLINEM=stringOfSize(174,'-');
		SDOTTED=stringOfSize(123,'=');
		String SBLINE=stringOfSize(40,'-');
		
		ReportDAO.OpenCon("", "", "",repBean);
		Cn = repBean.getCn();
		
		int i=1;
		int empno = 0;		
		int leaveDays = 0;
		float basic =0;
		float da =0;
		float vda =0;
		float total =0;
		float leaveSalary =0;
		float encashpf_3_67=0;
		float encashpf_8_33=0;
		float encashpf=0;
		float encashnet=0;
		float daTotal=0;
		float vdaTotal=0;
		float basicTotal=0;
		float totalT=0;
		float encashpf_3_67_total=0;
		float encashpf_8_33_total=0;
		float encashpfTotal=0;
		float encashnetTotal=0;
		float lSalaryTolal=0;
		
		long daTotal1 = 0;
		long vdaTotal1 = 0;
		long basicTotal1 = 0;
		long totalT1 = 0;	
		long lSalaryTolal1 = 0;
		long encashpfTotal1=0;
		long encashnetTotal1=0;
		String status="";
		String empcode = "";
		String empname ="";
		String prjname ="";
		String project_code ="";
		String designation ="";
		String date1 ="";	
				
		try
		{  
			String qry;
			if(prjCode1.equalsIgnoreCase("1000"))
			{
			qry= "select SITE_ID,site_name,Project_Code from Project_Sites order by SITE_ID  " ;
			}else
			{qry= "select SITE_ID,site_name,Project_Code from Project_Sites where site_id = "+prjCode1+"order by SITE_ID  " ;
			}
			   ResultSet brrs;	
			   Statement st123 = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
			   brrs = st123.executeQuery(qry);
			   while ( brrs.next()) 	  
			   {
				 prjname=brrs.getString("site_name");
				   project_code=brrs.getString("Project_Code");
				   ReportDAO.println(String.valueOf((char)18), 0, 1, false, "BANK",repBean);
					//ReportDAO.println("Page No : "+repBean.getPageNo(), 10, 1, false, "BANK",repBean);
				   ReportDAO.println("Branch Code : " + project_code , 10, 1, false, "BANK",repBean);
				   Str1 = "                                               THE BUSINESS CO.OP BANK LTD";
					repBean.setHdg1(Str1);
					ReportDAO.println(Str1, 10, 1, false, "BANK",repBean);
					Str1 = "                                          Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101";
					repBean.setHdg2(Str1);
					ReportDAO.println(Str1, 10, 1, false, "BANK",repBean);
					Str1 = "                            BRANCH -> "+prjname+":Leave Encashment For the Year ended December- '"+lastyear+"' ";
					repBean.setHdg3(Str1);
					ReportDAO.println(Str1, 10, 3, false, "BANK",repBean);
					ReportDAO.println(SLINE, 10, 1, false, "BANK",repBean);			
					//Str1 = FixStr("SR.No", 5,1)+"|"+FixStr("EMP.CD",6, 1)+"|"+FixStr("Name", 32,1)+"|"+FixStr("Days", 4,1)+"|"+FixStr("Basic  ", 6,1) + "|"+FixStr("D.A.   ", 7,1)+"|"+FixStr("V.D.A.  ",8,1)+"|"+FixStr("Total  ", 7,1)+"|"+FixStr("pf_3_67", 7,1)+"|"+FixStr("pf_8_33",7, 1)+"|"+FixStr("pf     ",7, 1)+"|"+FixStr("Net Pay",7,1)+"|"+FixStr("Status",7,1)+"|";
					Str1 = FixStr("SR.No", 5,1)+"|"+FixStr("EMP.CD",6, 1)+"|"+FixStr("Name", 32,1)+"|"+FixStr("Days", 4,1)+"|"+FixStr("Basic  ", 16,1) + "|"+FixStr("D.A.   ", 16,1)+"|"+FixStr("V.D.A.  ",16,1)+"|"+FixStr("Total  ", 16,1)+"|"+FixStr("pf", 16,1)+"|"+FixStr("Net Pay",16,1)+"|"+FixStr("Status",7,1)+"|";
					//repBean.setHdg4(Str1);			
				
					
					
					//ReportDAO.page_head(repBean.getBrnNo(),""," ",repBean.getHdg1(),repBean.getHdg2(), repBean.getHdg3(), " ", repBean.getHdg4(), repBean);
					ReportDAO.println(Str1, 10, 1, false, "BANK",repBean);
					ReportDAO.println(SLINE, 10, 1, false, "BANK",repBean);
							
					String query="";
					// New Query By AKSHAY 
					// this query for single site
					 // 1000 for all branch 
					   
				   
				prjCode1=brrs.getString("Site_id");
		/*		if(prjCode1.equalsIgnoreCase("1001610")){
				query = "SELECT E.EMPNO,E.EMPCODE,CONVERT(NVARCHAR(100),E.LNAME+' '+ E.FNAME+' '+ E.MNAME) AS NAME,E.EMPCODE, l.days ,l.FRMDT , lo.lkp_disc" +
							    " FROM EMPMAST E , LEAVETRAN l ,EMPTRAN t  ,LOOKUP lo " +
							    " where E.EMPNO=l.empno and l.TRNTYPE ='D' and l.LEAVEPURP= '4'  and l.TRNDATE between '01-jan-"+year+"' and '31-dec-"+year+"'   and t.EMPNO  in " +
							    "(SELECT E.EMPNO FROM EMPTRAN T WHERE T.EMPNO = E.EMPNO ) AND T.SRNO = " +
							    "( SELECT MAX(SRNO) FROM EMPTRAN T1 WHERE T1.EMPNO = T.EMPNO)   and t.DESIG = lo.lkp_srno and lo.LKP_CODE = 'DESIG' order by e.EMPCODE  ";
							
				System.out.println("query in if block"+query);
				}
				else{*/
				query = "SELECT E.EMPNO,E.EMPCODE,CONVERT(NVARCHAR(100),E.LNAME+' '+ E.FNAME+' '+ E.MNAME) AS NAME,E.EMPCODE, l.days ,l.FRMDT , lo.lkp_disc " +
						       " FROM EMPMAST E , LEAVETRAN l ,EMPTRAN t  ,LOOKUP lo " +
						       " where E.EMPNO=l.empno and  E.empno = t.empno  and l.TRNTYPE ='D' and l.LEAVEPURP= '4'  and l.TRNDATE between '01-jan-"+year+"' and '31-dec-"+year+"'   and   " +
						       " T.PRJ_SRNO = '"+prjCode1+"' AND T.SRNO = " +
						       " ( SELECT MAX(SRNO) FROM EMPTRAN T1 WHERE T1.EMPNO = T.EMPNO)   and t.DESIG = lo.lkp_srno and lo.LKP_CODE = 'DESIG' order by e.EMPCODE  ";
		
				//System.out.println("query in else Block"+query);
					
				/*}*/		
				Statement st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
				empRS = st.executeQuery(query);
				
				while(empRS.next())
				{						
					empno = empRS.getInt("EMPNO");
					empcode = empRS.getString("EMPCODE"); // it is not required in report
					leaveDays = empRS.getInt("days");
					empname = empRS.getString("NAME");
					//designation = empRS.getString("lkp_disc");
					//date1 = empRS.getString("FRMDT");		
					//String year1 = date1.substring(0,4);
					
					// This is test query for month data problem
					/*String query1 =	"select sum(net_amt) As NET_AMT, " +
							"(select NET_AMT from PAYTRAN_STAGE where empno = "+empno+" and trndt between '01-Aug-2015' and '31-Aug-2015' And trncd =101) as BASIC ," +
							"(select NET_AMT from PAYTRAN_STAGE where empno = "+empno+"  and trndt between '01-Aug-2015' and '31-Aug-2015' And trncd =102) as DA ," +
							"(select NET_AMT from PAYTRAN_STAGE where empno = "+empno+"  and trndt between '01-Aug-2015' and '31-Aug-2015' And trncd =138) as VDA ," +
							"(select NET_AMT from PAYTRAN_STAGE where empno = "+empno+"  and trndt between '01-Aug-2015' and '31-Aug-2015' And trncd =145) as EncashAMT " +
							"from PAYTRAN_STAGE " +
							"where empno = "+empno+"  and trndt between '01-Aug-2015' and '31-Aug-2015' And trncd in (101,102,138,145)";
					*/	
					//This is actual query...
					
	/*						"(select NET_AMT from PAYTRAN_STAGE where empno = "+empno+" and trndt between '01-mar-"+(year-1)+"' and '31-mar-"+(year-1)+"' And trncd =101) as BASIC ," +
							"(select NET_AMT from PAYTRAN_STAGE where empno = "+empno+"  and trndt between '01-mar-"+(year-1)+"' and '31-mar-"+(year-1)+"' And trncd =102) as DA ," +
							"(select NET_AMT from PAYTRAN_STAGE where empno = "+empno+"  and trndt between '01-mar-"+(year-1)+"' and '31-mar-"+(year-1)+"' And trncd =138) as VDA ," +
							"(select NET_AMT from PAYTRAN_STAGE where empno = "+empno+"  and trndt between '01-mar-"+(year-1)+"' and '31-mar-"+(year-1)+"' And trncd =145) as EncashAMT " +
							"from PAYTRAN_STAGE " +
							"where empno = "+empno+"  and trndt between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"' And trncd in (101,102,138,145)";*/
					String query1 =	"select basic,da,vda,amount,encashpf_3_67,encashpf_8_33, "+
							"encashpf,encashnet,status from encashment where empno = "+empno+" and "+ 
							"encashdate='1-jan-"+year+"' "; 
					System.out.println("query1 :  "+query1);
					//System.out.println("query1"+query1);
					Statement st1 = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
					
					empRS1 = st1.executeQuery(query1);
					
					while(empRS1.next()){
						
						basic = empRS1.getFloat("basic");
						da = empRS1.getFloat("da");
						vda = empRS1.getFloat("vda");
						leaveSalary = empRS1.getFloat("amount");
						encashpf_3_67=empRS1.getFloat("encashpf_3_67");
						encashpf_8_33=empRS1.getFloat("encashpf_8_33");
						encashpf=empRS1.getFloat("encashpf");
						encashnet=empRS1.getFloat("encashnet");
						status=empRS1.getString("status");
						//total = basic + da + vda;
						//leaveSalary=total/30*leaveDays;
						//Str1 = FixStr(""+i, 5,1)+"|"+FixStr(""+empno,6, 1)+"|"+FixStr(empname, 32,1)+"|"+FixStr(""+leaveDays, 5,3)+"|"+FixStr(""+basic, 10,3) + "|"+FixStr(""+da, 10,3)+"|"+FixStr(""+vda, 10,3)+"|"+FixStr(""+total, 16,3)+"|"+FixStr(""+leaveSalary, 13,3)+"| ";			
						/*Str1 =  FixStr(""+i, 5,1)+"|"+FixStr(""+empcode,6, 1)+"|"+FixStr(empname, 32,1)+"|"+FixStr(""+leaveDays,4,1)+"|"+FixStr(""+basic, 6,1) + 
								"|"+FixStr(""+da, 7,1)+"|"+FixStr(""+vda, 8,1)+"|"+FixStr(""+leaveSalary, 7,1)+"|"+FixStr(""+encashpf_3_67,7,1)+"|"+
							FixStr(""+encashpf_8_33,7, 1)+"|"+FixStr(""+encashpf,7, 1)+"|"+FixStr(""+encashnet,7,1)+"|"+FixStr(status.equals("P")?"POSTED":"PROCESS",7,1)+"|";
						*/
						Str1 =  FixStr(""+i, 5,1)+"|"+FixStr(""+empcode,6, 1)+"|"+FixStr(empname, 32,1)+"|"+FixStr(""+leaveDays,4,1)+"|"+FixStr(""+basic, 16,1) + 
								"|"+FixStr(""+da, 16,1)+"|"+FixStr(""+vda, 16,1)+"|"+FixStr(""+leaveSalary, 16,1)+"|" +
							 FixStr(""+encashpf,16, 1)+"|"+FixStr(""+encashnet,16,1)+"|"+FixStr(status.equals("P")?"POSTED":"PROCESS",7,1)+"|";
						
						ReportDAO.println(Str1, 10, 1, false, "BANK",repBean);
						ReportDAO.println(SLINE, 10, 1, false, "BANK",repBean);
						
						i++;  //  srno count
						daTotal = daTotal + da;
						vdaTotal = vdaTotal + vda;
						basicTotal = basicTotal + basic;
						encashpf_3_67_total=encashpf_3_67_total+encashpf_3_67;
						encashpf_8_33_total=encashpf_8_33_total+encashpf_8_33;
						encashpfTotal=encashpfTotal+encashpf;
						encashnetTotal=encashnetTotal+encashnet;
						
						totalT = totalT + total;	
						lSalaryTolal =  lSalaryTolal + leaveSalary;
						
					}
					
						//		ReportDAO.println(SLINE,10, 1, true,"BANK",repBean);									
				}
				
				// Total of page....
				ReportDAO.println(SLINE, 10, 1, false, "BANK",repBean);
				
				//Str1 = FixStr("Total :-", 5,3)+"|"+FixStr("",6, 3)+"|"+FixStr("", 32,3)+"|"+FixStr("", 5,3) +"|"+FixStr(""+basicTotal, 10,3) + "|"+FixStr(""+daTotal, 10,3)+"|"+FixStr(""+vdaTotal, 10,3)+"|"+FixStr(""+totalT, 16,3)+"|"+FixStr(""+lSalaryTolal, 13,3)+"| ";
			//	Str1 =  FixStr(""+i, 5,1)+"|"+FixStr(""+empno,6, 1)+"|"+FixStr(empname, 32,1)+"|"+FixStr(""+leaveDays, 5,3)+FixStr(""+basic, 10,3) + 
			//			"|"+FixStr(""+da, 7,3)+"|"+FixStr(""+vda, 8,3)+"|"+FixStr(""+leaveSalary, 7,3)+FixStr(""+encashpf_3_67,7,3)+"|"+
			//		FixStr(""+encashpf_8_33,7, 3)+"|"+FixStr(""+encashpf,7, 3)+"|"+FixStr(""+encashnet,7,3)+"|"+FixStr(""+status,7,3)+"|";
				/*Str1 =  FixStr("Total :-", 5,3)+"|"+FixStr("",6, 3)+"|"+FixStr("", 32,3)+"|"+FixStr("",4,3)+"|"+FixStr(""+basicTotal,6,3) + 
						"|"+FixStr(""+daTotal, 7,3)+"|"+FixStr(""+vdaTotal, 8,3)+"|"+FixStr(""+lSalaryTolal, 7,3)+"|"+FixStr(""+encashpf_3_67_total,7,3)+"|"+
					FixStr(""+encashpf_8_33_total,7, 3)+"|"+FixStr(""+encashpfTotal,7, 3)+"|"+FixStr(""+encashnetTotal,7,3)+"|"+FixStr("",7,3)+"|";
				*/
				
				Str1 =  FixStr("Total :-", 5,3)+"|"+FixStr("",6, 3)+"|"+FixStr("", 32,3)+"|"+FixStr("",4,3)+"|"+FixStr(""+basicTotal,16,1) + 
						"|"+FixStr(""+daTotal, 16,1)+"|"+FixStr(""+vdaTotal, 16,1)+"|"+FixStr(""+lSalaryTolal, 16,1)+"|"+
					FixStr(""+encashpfTotal,16, 1)+"|"+FixStr(""+encashnetTotal,16,1)+"|"+FixStr("",7,1)+"|";
								ReportDAO.println(Str1, 10, 1, false, "BANK",repBean);
				ReportDAO.println(SLINE, 10, 1, false, "BANK",repBean);
				
				Str1 = "The Nasik Merchants' Co-Op. Bank Ltd.";
				ReportDAO.println(Str1, 10, 3, false, "BANK",repBean);
				ReportDAO.println(SLINEM, 0, 1, false, "BANK",repBean);
		
				 daTotal1 =(long) (daTotal1+daTotal);
				 vdaTotal1 =(long) (vdaTotal1 +vdaTotal);
				 basicTotal1 = (long) (basicTotal1+basicTotal);
				 lSalaryTolal1 =(long) (lSalaryTolal1+lSalaryTolal);
				 encashpfTotal1=(long) (encashpfTotal1+encashpfTotal);
				 encashnetTotal1=(long) (encashnetTotal1+encashnetTotal);
				 System.out.println( encashpfTotal1+"     "+encashpfTotal);
				 //System.out.println( encashpfTotal1=encashpfTotal1+encashpfTotal);
				
				 daTotal = 0; 
				vdaTotal = 0; 
				basicTotal = 0;
				totalT = 0;	
				lSalaryTolal = 0;
				 i=1;
			   }
			   Str1 =  FixStr("T SUMMERY :-",9,3)+"|"+FixStr("", 35,3)+"|"+FixStr("",4,3)+"|"+FixStr(""+basicTotal1,16,1) + 
						"|"+FixStr(""+daTotal1, 16,1)+"|"+FixStr(""+vdaTotal1, 16,1)+"|"+FixStr(""+lSalaryTolal1, 16,1)+"|"+
					FixStr(""+encashpfTotal1,16, 1)+"|"+FixStr(""+encashnetTotal1,16,1)+"|"+FixStr("",7,1)+"|";
								ReportDAO.println(Str1, 10, 1, false, "BANK",repBean);
		}
		catch(Exception e){
			e.printStackTrace();
		}
		
		Fp = repBean.getFp();
		Fp.close();
		Cn.close();
		
		return;
  }
  catch(Exception e)
	{
		e.printStackTrace();
	}
	
}

	public static void tdsList(String year,String endyear, String imgpath,String filepath)
	{
		Properties prop = new Properties();
	     try
	     {
				
				ClassLoader classLoader = Thread.currentThread().getContextClassLoader();
			    InputStream stream = classLoader.getResourceAsStream("constant.properties");
			    prop.load(stream);
		 }
	     catch (Exception e) 
	     {
			
	    	 System.out.println("Error in constant properties Manager "+e);
	     }

		System.out.println("in new tdsList generate"+year +" "+ endyear);
		
		RepoartBean repBean  = new RepoartBean();
		UtilityDAO dao = new UtilityDAO();
		Connection con =null;
		String BomDt = "";
		String EomDt = "";
		
		BomDt = ReportDAO.BOM(year);
	
		EomDt = ReportDAO.EOM(endyear);
		
		
		String temp = year.substring(3);
		String temp2= endyear.substring(3);
		ResultSet emp = null;
		String EmpSql = ""; 
		String pBrcd1 = "";
		int tot_no_emp = 0;
		int br_tot_no_emp = 0;
		
		
		
		try
		{
				

			ReportDAO.OpenCon("", "", "",repBean);
			con = repBean.getCn();	
			Statement st = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			
			
			System.out.println("in tdslist sheet");
			Document doc = new Document(new Rectangle(2384,3370));
			PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
			Footer1 ftr = dao.new Footer1(lable1);
			writer.setPageEvent(ftr);
			doc.open();
			Font FONT = new Font(Font.HELVETICA,190, Font.NORMAL, new GrayColor(0.85f));
			ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase(prop.getProperty("watermark"),FONT), 1300f, 1830f, 45);			
			Image image1 = Image.getInstance(imgpath);		
			Phrase title = new Phrase(prop.getProperty("companyName"),new Font(FONT.TIMES_ROMAN,38,Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			image1.scaleAbsolute(310f, 120f);
			image1.setAbsolutePosition(60f, 3200f);
			doc.add(image1);
			doc.add(para);
			para = new Paragraph(new Phrase(prop.getProperty("addressForReport"),new Font(Font.TIMES_ROMAN,28)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
			
			doc.add(para);
			para = new Paragraph(new Phrase(prop.getProperty("contactForReport"),new Font(Font.TIMES_ROMAN,28)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
			
			doc.add(para);
			para = new Paragraph(new Phrase(prop.getProperty("mailForReport"),new Font(Font.TIMES_ROMAN,28)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
			
			doc.add(para);
			
			Font f = new Font(Font.HELVETICA,30);
			Font f1 = new Font(Font.HELVETICA,25);
			Font f2 = new Font(Font.HELVETICA,32);
			
		
				para = new Paragraph(new Phrase("TDS-list Sheet for the Month Of :- "+temp+"- To "+temp2,new Font(Font.TIMES_ROMAN,25,Font.BOLD)));
			
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);
			
			doc.add(para);
			
			Rectangle rec = new  Rectangle(100,100);
			 
		
				long salary = 0;
				long yearlySalary=0;
				long tax = 0;
				long taxValue = 0;
				
				
				long salary2= 0;
				long tax2=0;
				
			
	/*		
       		EmpSql="select * from (SELECT e.EMPCODE ,e.empno ,rtrim(e.fname)+' '+rtrim(e.mname)+' '+rtrim(e.lname)as" +
       				"    name, t.PRJ_SRNO as PRJ_SRNO,"+
       				
       				"	(select sum (inp_amt)*12 from  CTCDISPLAY a1 " +
       				"	where a1.empno=e.EMPNO	)  as YEARLY" +
       				"   FROM   EMPMAST e left join   EMPTRAN t" +
       				"   on (e.EMPNO=t.EMPNO )  where e.STATUS='A'   and DOJ <= '"+EomDt+"'" +
       				"  	AND T.SRNO=(SELECT MAX(ET.SRNO)" +
       				"   FROM EMPTRAN ET WHERE ET.EMPNO=E.EMPNO) )s" +
       				"	where s.YEARLY > 250000 order by s.PRJ_SRNO,s.EMPNO";
				*/
				
				
				EmpSql="select * from (SELECT e.EMPCODE ,e.empno ,rtrim(e.fname)+' '+rtrim(e.mname)+' '+rtrim(e.lname)as  "+
						"  name, t.PRJ_SRNO as PRJ_SRNO, "+
						 "   case (select COUNT(*) from PAYTRAN_STAGE where TRNDT between "+
						  "   '"+BomDt+"' and '"+EomDt+"' and trncd=199 and EMPNO=e.empno) when 12 then "+ 
						"	 (select sum (p.NET_AMT) from  PAYTRAN_STAGE p,CDMAST c	 where p.empno=e.EMPNO  and p.TRNDT between "+
						" '"+BomDt+"' and '"+EomDt+"' and p.trncd between 101 and 199 and p.trncd=c.TRNCD and c.TAXABLE='Y') "+
						"  else (select sum (inp_amt)*12 from  CTCDISPLAY a1 	where a1.empno=e.EMPNO	)  end as YEARLY "+				 
						"	   FROM   EMPMAST e left join   EMPTRAN t   on (e.EMPNO=t.EMPNO )  "+
						"	  where e.STATUS='A'   and DOJ <= '"+EomDt+"'  	AND T.SRNO=(SELECT MAX(ET.SRNO) "+ 
						"	    FROM EMPTRAN ET WHERE ET.EMPNO=E.EMPNO) )s	" +
						"where s.YEARLY > 250000 order by s.PRJ_SRNO,s.EMPNO";
				
				
       System.out.println(EmpSql);
			ResultSet rs = st.executeQuery(EmpSql);
			int srno  = 1;
				while(rs.next()){
					
				String prj_name = null;
				String prj_code = null;
		    	 Connection conn = ConnectionManager.getConnectionTech();
				Statement stmt = conn.createStatement();
				String prjquery = "select Site_Name,Project_Code from Project_Sites where SITE_ID = '"+rs.getString("PRJ_SRNO")+"'";
				System.out.println(prjquery);
				ResultSet prj = stmt.executeQuery(prjquery);
				if(prj.next()){
					prj_name = prj.getString("Site_Name");
					prj_code = prj.getString("Project_Code");
				}
		    	 pBrcd1 = rs.getString("PRJ_SRNO");
		    	 br_tot_no_emp = 0;
		    	 para = new Paragraph(new Phrase("Employee's TDS List For Project Site : "+prj_name+ " ("+prj_code+")",f));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(4);
				doc.add(para);
		    	 prj.close();
		    	 stmt.close();
		    	 conn.close();
		    	 PdfPTable datatab;
		    	 PdfPTable datatot;
					PdfPTable main = new PdfPTable(5);
					main.setSpacingBefore(10);
					main.setWidthPercentage(new float[]{8,8,20,15,9f}, rec);
					
					PdfPCell maincell ;
					
					maincell = new PdfPCell(new Phrase("SRNO",f));
					maincell.setFixedHeight(50);
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase("EMP CODE",f));
					maincell.setFixedHeight(50);
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase("EMPLOYEE NAME",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase("YEARLY INCOME",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase("TAX",f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					doc.add(main);
					
		    	 while (pBrcd1.equals(rs.getString("PRJ_SRNO")))
		    	 {
		    		
		    		 datatab = new PdfPTable(5);
		    	
			    	 datatab.setWidthPercentage(new float[]{8,8,20,15,9f}, rec);
			    	 
			    	 datatab.setHorizontalAlignment(Element.ALIGN_CENTER);
			    	 
			    	 PdfPCell cell111 = new PdfPCell(new Phrase(""+srno,f1));
			    		cell111.setHorizontalAlignment(Element.ALIGN_CENTER);
			    		cell111.setFixedHeight(50);
			    		datatab.addCell(cell111);
		    		 
		    		PdfPCell cell1 = new PdfPCell(new Phrase(""+rs.getString("EMPCODE"),f1));
		    		cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
		    		cell1.setFixedHeight(50);
		    		datatab.addCell(cell1);
					
					PdfPCell cell2 = new PdfPCell(new Phrase(""+rs.getString("name"),f1));
					cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell2);
					
					salary = salary + rs.getLong("yearly");
					PdfPCell cell3 = new PdfPCell(new Phrase(""+rs.getLong("YEARLY"),f1));
					cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell3);
					
					yearlySalary=rs.getLong("yearly");
					yearlySalary=yearlySalary-2500;
					taxValue= ((yearlySalary-250000)>0?
							((yearlySalary-250000)>250000?25000:(yearlySalary-250000)/10):0)
							+((yearlySalary-500000)>500000?100000:
							(yearlySalary-500000>0?(yearlySalary-500000)/5:0))
							+((yearlySalary-1000000)>0?((yearlySalary-1000000)*3/10):0);
					
					tax=tax+taxValue;
					PdfPCell cell4 = new PdfPCell(new Phrase(""+taxValue,f1));
					cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell4);
					
					srno++;
					doc.add(datatab);
					
					tot_no_emp = tot_no_emp + 1;
					br_tot_no_emp = br_tot_no_emp + 1;
					if (!rs.next()) {
						break;
					}
					if(!pBrcd1.equals(rs.getString("PRJ_SRNO"))){
					   	rs.previous();
					   	break;
				    }
		    	 }
		    	   

		    	 	datatot = new PdfPTable(5);
					datatot.setWidthPercentage(new float[]{8,8,20,15,9f}, rec);
					datatot.setHorizontalAlignment(Element.ALIGN_CENTER);
		    		 
		    		PdfPCell cell1 = new PdfPCell(new Phrase("Total:--",f1));
		    		cell1.setColspan(3);
		    		cell1.setFixedHeight(50);
		    		cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
		    		datatot.addCell(cell1);
					
					PdfPCell cell2 = new PdfPCell(new Phrase(""+salary,f1));
					cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatot.addCell(cell2);
					salary2 = salary2 + salary;
					salary = 0;
					
					PdfPCell cell4 = new PdfPCell(new Phrase(""+tax,f1));
					cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatot.addCell(cell4);
					tax2 = tax2+ tax;
					 tax = 0;
					
					
					doc.add(datatot);
		    	 
				   para = new Paragraph(new Phrase("Number Of Employees :- "+br_tot_no_emp,f));
				   para.setAlignment(Element.ALIGN_CENTER);
				   para.setSpacingAfter(50);
				   doc.add(para);
			 
					
			}
					
				     para = new Paragraph(new Phrase("Total Number Of Employees :- "+tot_no_emp,f));
					 para.setAlignment(Element.ALIGN_CENTER);
					 para.setSpacingAfter(10);
					 doc.add(para);
					 
					 System.out.println("Total No Of Employee :- "+tot_no_emp);
				 
					 
					 para = new Paragraph(new Phrase("-:Summary :- ",new Font(Font.HELVETICA,40,Font.BOLDITALIC)));
					 para.setAlignment(Element.ALIGN_CENTER);
					 para.setSpacingAfter(10);
					 doc.add(para);
					 
					 PdfPTable main = new PdfPTable(4);
					 main.setSpacingBefore(10);
					main.setWidthPercentage(new float[]{10,10,10,10}, rec);
					PdfPCell maincell ;
					
					maincell = new PdfPCell(new Phrase("Salary Total:-",f));
					maincell.setBorderWidthRight(0);
					maincell.setFixedHeight(50);
					maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase(""+((int)(salary2)),f2));
					maincell.setBorderWidthLeft(0);
					maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase("TAX Total:-",f));
					maincell.setBorderWidthRight(0);
					maincell.setFixedHeight(50);
					maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase(""+(int)(tax2),f2));
					maincell.setBorderWidthLeft(0);
					maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
					main.addCell(maincell);
					
				
					
					
					doc.add(main);
					
					
				
					
						
			
			st.close();
		    con.close();
			doc.close();
			
			
			
			}
			

		 
		 catch(Exception e)
		{
			e.printStackTrace();
		}
		
	}
	
	
	public static void payregWithBranch(String PAYREGDT,String Table,String filepath)
	{

		
		String year = PAYREGDT.substring(7,11);
		
		RepoartBean repBean  = new RepoartBean();
		FileWriter Fp;
		Connection Cn = null;	
		
		try
		{
			ResultSet empRS =null;
			ResultSet empRS1 =null;
			ResultSet prjRS = null;
			
			String Str1 ="";
			String SLINE ="";
			String SDOTTED="";
			
			ReportDAO.inithead(repBean);
			repBean.setLnCount(0);
			repBean.setPageNo(1);
			repBean.setLineSpace(10);
			repBean.setLineLen(274);
			repBean.setPageLen(65);
			
			ReportDAO.make_prn_file(filepath,repBean);
			ReportDAO.OpenCon("", "", "",repBean);
			Cn = repBean.getCn();
			
			SLINE=stringOfSize(274,'-');
			SDOTTED=stringOfSize(274,'=');
			String SBLINE=stringOfSize(40,'-');
			
			ReportDAO.OpenCon("", "", "",repBean);
			Cn = repBean.getCn();
			
			int i=1;
			int BranchTotalempno = 0;	
			int totalempno=0;
		
			// income variables
			float basic =0;
			float da =0;
			float Dept_Allw =0;
			float hra=0;
			float Convy_Allw=0;
			float Other_Allw=0;
			
			float AnyOther_Allw=0;
			float TotalEarning=0;
		
			// total income variables
			long daTotal=0;
			long Dept_Allwtotal=0;
			long basicTotal=0;
			long hraTotal=0;
			long Convy_Allwtotal=0;
			long arreartotal=0;
			long Other_Allwtotal =0;
			long AnyOther_Allwtotal =0;
			long total =0;
			
			
			
			
			
			// deduction variables
						float PF =0;
						float PT =0;
						float LIC =0;
						float MEDICLAIM=0;
						float Other_Ded=0;
						float Memb_Ded=0;
						float TDS=0;
						float MLWF=0;
						float Bank_Inst=0;
						float Other_Loan=0;
						float other=0;
						float deduction=0;
						float netpay=0;
						
						//total deduction
						long PFtotal =0;
						long PTtotal =0;
						long LICtotal =0;
						long MEDICLAIMtotal =0;
						long Other_Dedtotal =0;
						long Memb_Dedtotal =0;
						long TDStotal =0;
						long MLWFtotal =0;
						long Bank_Insttotal =0;
						long Other_Loantotal =0;
						long othertotal =0;
						long deductiontotal =0;
						
						
						long netpaytotal =0;
						
						
						
						
					
						// total deduction variables
					/*	long stamptotal =0;
						long uniontotal =0;
						long gitotal =0;
						long pttotal=0;
						long lictotal=0;
						long pftotal=0;
						long societytotal=0;
						long loantotal=0;
						long itaxtotal=0;
						long MLWFtotal=0;
						long sdftotal=0;
						long deductiontotal=0;
						long netpaytotal=0;*/
			
					
			try
			{
					Str1 = "                                                                   " +
							"  THE BUSINESS CO.OP BANK LTD.,";
					repBean.setHdg1(Str1);
					/*Str1 = "                                                                   " +
						   "  	 Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101";*/
					repBean.setHdg2(Str1);
					Str1 = "                                      " +
		"Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101,Tel : +91-20 26812190";
					repBean.setHdg3(Str1);
					Str1 = "                  " +
							"                                         Paysheet Summary For The Month Of "+PAYREGDT.substring(3,11);
					repBean.setHdg4(Str1);
								
					Str1 = FixStr("Br Code", 4,2)+"|"+FixStr("Branch Name",28, 2)+"|"+FixStr("No. Of Emp", 8,2)+"|"+FixStr("Basic", 10,1) + "|"+FixStr("D.A.", 10,1) + "|"+FixStr("H.R.A.", 10,1)+"|"+FixStr("Det Allw", 10,1)+"|"+FixStr("Convy Allw", 10,1)+"|"+FixStr("Other SPCL Allw", 10,1)+"|"+FixStr("Add Income", 10,1)+"|"+FixStr("TOTAL EARN", 13,1)+"|";
					Str1 = Str1+""+FixStr("P.F", 10,1)+"|"+FixStr("P.T",10, 1)+"|"+FixStr("L.I.C", 10,1)+"|"+FixStr("Mediclaim", 10,1) + "|"+FixStr("Other Ded", 10,1) + "|"+FixStr("Menb Ded", 10,1)+"|"+FixStr("TDS", 10,1)+"|"+FixStr("MLWF", 10,1)+"|"+FixStr("Bank Loan", 10,1)+"|"+FixStr("Other Loan", 10,1)+"|"+FixStr("Other", 10,1)+"| "+FixStr("Total Ded.", 13,1)+"|"+FixStr("Net Pay", 13,1)+"|";

					repBean.setHdg5(Str1);			
				
					ReportDAO.println(String.valueOf((char)18), 0, 1, false, "BANK",repBean);
					ReportDAO.println("Page No : "+repBean.getPageNo(), 10, 1, false, "BANK",repBean);
					ReportDAO.page_head(repBean.getBrnNo(),""," ",repBean.getHdg1(),repBean.getHdg3(), repBean.getHdg4(), " ", repBean.getHdg5(), repBean);
					ReportDAO.println(SLINE, 10, 1, false, "BANK",repBean);
					String query="";
				
					
					
					/*query = "			with empcount as ( SELECT count(e.EMPNO) as emptotal,t.site_name,  et.prj_srno    AS siteId  " +
							"			FROM   emptran et, empmast e,  project_sites t  WHERE  e.empno = et.empno  AND t.site_id = et.prj_srno " + 
                  			"			AND et.srno = (SELECT Max(srno)  FROM   emptran  WHERE  empno = E.empno)  AND ( ( E.status = 'A'  " +
                       		"			AND E.doj <= '"+ReportDAO.EOM(PAYREGDT)+"' )   OR ( E.status = 'N'  AND E.dol >= '"+ReportDAO.BOM(PAYREGDT)+"' ) )   group by t.site_name, " + 
                            "              et.prj_srno ) select * from ( select site_name,cnt.siteid,cnt.emptotal," +
							"			 SUM( case trncd when 101 then net_amt else 0 end ) as basic," +
							"			 SUM( case when trncd = 102 then net_amt else 0 end ) as da," +
							"       	 SUM( case when trncd = 138 then net_amt else 0 end ) as vda," +
							"			 SUM( case when trncd = 103 then net_amt else 0 end ) as hra," +
							"			 SUM( case when trncd IN (105,104,107,108,129)  then net_amt else 0  end )as allowances," +
							"			 SUM( case when trncd IN (142,118,140)  then net_amt else 0  end ) as Arrears," +
							"			 SUM( case when trncd= 999 THEN inp_amt else 0  end ) as Earning," +
							"			 SUM( case when trncd =250    then net_amt else 0  end ) as SDep," +
							"			 SUM( case when trncd =242    then net_amt else 0  end ) as subUnion," +
							"			 SUM( case when trncd =207    then net_amt else 0  end ) as GI," +
							"			 SUM( case when trncd =202    then net_amt else 0  end ) as PT," +
							"			 SUM( case when trncd =205    then net_amt else 0  end ) as LIC," +
							"			 SUM( case when trncd =201    then net_amt else 0  end ) as PF," +
							"			 SUM( case when trncd =206    then net_amt else 0  end ) as Society," +
							"			 SUM( case when trncd in  (212,226,255,216,247,248,245,246,244,249)    then net_amt else 0  end ) as LOANS," +
							"			 SUM( case when trncd =228    then net_amt else 0  end ) as ITAX," +
							"			 SUM( case when trncd =(CASE  WHEN  month('"+ReportDAO.EOM(PAYREGDT)+"') = 5 THEN 220 ELSE 211 END)    then net_amt else 0  end ) as MLWF," +
							"			 SUM( case when trncd =230    then net_amt else 0  end ) as sdf," +
							"			 SUM( case when trncd= 999 THEN cal_amt   else 0  end ) as deduction," +
							"			 SUM( case when trncd=  999  then net_amt else 0  end ) as netPay" +
							"			from (	select p.trncd as trncd,SUM(p.net_amt) as net_amt , Sum(p.INP_AMT ) AS inp_amt,Sum(p.CAL_AMT ) AS cal_amt,et.prj_srno as siteId" +
							"       	from "+Table+" p, 	EMPTRAN et,empmast e ,Project_Sites t where		" +
							"    	e.EMPNO=et.EMPNO and et.EMPNO=p.empno and t.SITE_ID=et.PRJ_SRNO" +
							"		and p.TRNdt between '"+ReportDAO.BOM(PAYREGDT)+"' and '"+ReportDAO.EOM(PAYREGDT)+"' " +
							"   	AND et.SRNO=(SELECT MAX(SRNO) FROM EMPTRAN WHERE EMPNO=E.EMPNO) AND (( E.STATUS='A' AND E.DOJ <= '"+ReportDAO.EOM(PAYREGDT)+"') " +
							"		 or (E.STATUS ='N' And  E.DOL>='"+ReportDAO.BOM(PAYREGDT)+"' )) and p.TRNCD not in(301,302) " +
							"		group by p.trncd, et.PRJ_SRNO, t.SITE_NAME	) as sss  ,empcount cnt where  cnt.siteId = sss.siteId   	group by cnt.siteId,site_name,emptotal  ) cnt where cnt.basic!=0.00" ;*/
							
					
					query="with empcount AS "
							+ "( "
							+ "         SELECT   count(e.empno) AS emptotal, "
							+ "                  t.site_name, "
							+ "                  et.prj_srno AS siteid "
							+ "         FROM     emptran et, "
							+ "                  empmast e, "
							+ "                  project_sites t "
							+ "         WHERE    e.empno = et.empno "
							+ "         AND      t.site_id = et.prj_srno "
							+ "         AND      et.srno = "
							+ "                  ( "
							+ "                         SELECT max(srno) "
							+ "                         FROM   emptran "
							+ "                         WHERE  empno = e.empno) "
							+ "         AND      ( ( "
							+ "                                    e.status = 'A' "
							+ "                           AND      e.doj <= '"+ ReportDAO.EOM(PAYREGDT)+"' ) "
							+ "                  OR       ( "
							+ "                                    e.status = 'N' "
							+ "                           AND      e.dol >= '"+ ReportDAO.BOM(PAYREGDT)+"' ) ) "
							+ "         GROUP BY t.site_name, "
							+ "                  et.prj_srno )SELECT * "
							+ "FROM   ( "
							+ "                SELECT   site_name, "
							+ "                         cnt.siteid, "
							+ "                         cnt.emptotal, "
							+ "                         Sum( "
							+ "                         CASE trncd "
							+ "                                  WHEN 101 THEN net_amt "
							+ "                                  ELSE 0 "
							+ "                         END ) AS basic, "
							+ "                         Sum( "
							+ "                         CASE "
							+ "                                  WHEN trncd = 102 THEN net_amt "
							+ "                                  ELSE 0 "
							+ "                         END ) AS da, "
							+ "                          "
							+ "                         Sum( "
							+ "                         CASE "
							+ "                                  WHEN trncd = 103 THEN net_amt "
							+ "                                  ELSE 0 "
							+ "                         END ) AS hra, "
							+ "                          "
							+ "                          Sum( "
							+ "                         CASE "
							+ "                                  WHEN trncd = 107 THEN net_amt "
							+ "                                  ELSE 0 "
							+ "                         END ) AS Dept_Allw, "
							+ "                          "
							+ "                           Sum( "
							+ "                         CASE "
							+ "                                  WHEN trncd = 108 THEN net_amt "
							+ "                                  ELSE 0 "
							+ "                         END ) AS Convy_Allw, "
							+ "                          "
							+ "                           Sum( "
							+ "                         CASE "
							+ "                                  WHEN trncd = 129 THEN net_amt "
							+ "                                  ELSE 0 "
							+ "                         END ) AS Other_Allw, "
							+ "                         "
							+ "                          Sum( "
							+ "                         CASE "
							+ "                                  WHEN trncd = 132 THEN net_amt "
							+ "                                  ELSE 0 "
							+ "                         END ) AS AnyOther_Allw, "
							+ "                         "
							+ "                         "
							+ "                        "
							+ "                          Sum( "
							+ "                         CASE "
							+ "                                  WHEN trncd = 999 THEN net_amt "
							+ "                                  ELSE 0 "
							+ "                         END ) AS TotalEarning, "
							+ "                         "
							+ "                         "
							+ "                        "
							+ "                       Sum( "
							+ "                         CASE "
							+ "                                  WHEN trncd =201 THEN net_amt "
							+ "                                  ELSE 0 "
							+ "                         END ) AS PF, "
							+ "                        "
							+ "                         Sum( "
							+ "                         CASE "
							+ "                                  WHEN trncd =202 THEN net_amt "
							+ "                                  ELSE 0 "
							+ "                         END ) AS PT, "
							+ "                         Sum( "
							+ "                         CASE "
							+ "                                  WHEN trncd =205 THEN net_amt "
							+ "                                  ELSE 0 "
							+ "                         END ) AS LIC, "
							+ "                        "
							+ "                       Sum( "
							+ "                         CASE "
							+ "                                  WHEN trncd =212 THEN net_amt "
							+ "                                  ELSE 0 "
							+ "                         END ) AS MEDICLAIM, "
							+ "                          "
							+ "                          Sum( "
							+ "                         CASE "
							+ "                                  WHEN trncd =213 THEN net_amt "
							+ "                                  ELSE 0 "
							+ "                         END ) AS Other_Ded, "
							+ "                          "
							+ "                          Sum( "
							+ "                         CASE "
							+ "                                  WHEN trncd =223 THEN net_amt "
							+ "                                  ELSE 0 "
							+ "                         END ) AS Memb_Ded, "
							+ "                          "
							+ "                          Sum( "
							+ "                         CASE "
							+ "                                  WHEN trncd =228 THEN net_amt "
							+ "                                  ELSE 0 "
							+ "                         END ) AS TDS, "
							+ "                        "
							+ "                         Sum( "
							+ "                         CASE "
							+ "                                  WHEN trncd =( "
							+ "                                           CASE "
							+ "                                                    WHEN Month('"+ReportDAO.EOM(PAYREGDT)+"') = 5 THEN 220 "
							+ "                                                    ELSE 211 "
							+ "                                           END) THEN net_amt "
							+ "                                  ELSE 0 "
							+ "                         END ) AS MLWF, "
							+ "                          "
							+ "                          "
							+ "                           Sum( "
							+ "                         CASE "
							+ "                                  WHEN trncd =248 THEN net_amt "
							+ "                                  ELSE 0 "
							+ "                         END ) AS Bank_Inst, "
							+ "                          "
							+ "                         Sum( "
							+ "                         CASE "
							+ "                                  WHEN trncd =226 THEN net_amt "
							+ "                                  ELSE 0 "
							+ "                         END ) AS Other_Loan, "
							+ "                         Sum( "
							+ "                         CASE "
							+ "                                  WHEN trncd NOT IN ( 201, "
							+ "                                                     202, "
							+ "                                                     205, "
							+ "                                                     206, "
							+ "                                                     207, "
							+ "                                                     211, "
							+ "                                                     212, "
							+ "                                                     216, "
							+ "                                                     226, "
							+ "                                                     228, "
							+ "                                                     230, "
							+ "                                                     242, "
							+ "                                                     243, "
							+ "                                                     244, "
							+ "                                                     245, "
							+ "                                                     246, "
							+ "                                                     247, "
							+ "                                                     248, "
							+ "                                                     250 ) THEN net_amt "
							+ "                                  ELSE 0 "
							+ "                         END) AS other, "
							+ "                          "
							+ "                          Sum( "
							+ "                         CASE "
							+ "                                  WHEN trncd = 999 THEN cal_amt "
							+ "                                  ELSE 0 "
							+ "                         END) AS Total_Deduction, "
							+ "                       "
							+ "                         Sum( "
							+ "                         CASE "
							+ "                                  WHEN trncd= 999 THEN net_amt "
							+ "                                  ELSE 0 "
							+ "                         END ) AS netPay "
							+ "                FROM     ( "
							+ "                                  SELECT   p.trncd         AS trncd, "
							+ "                                           Sum(p.net_amt)  AS net_amt , "
							+ "                                           Sum(p.inp_amt ) AS inp_amt, "
							+ "                                           Sum(p.cal_amt ) AS cal_amt, "
							+ "                                           et.prj_srno     AS siteId "
							+ "                                  FROM     "+Table+" p, "
							+ "                                           emptran et, "
							+ "                                           empmast e , "
							+ "                                           project_sites t "
							+ "                                  WHERE    e.empno=et.empno "
							+ "                                  AND      et.empno=p.empno "
							+ "                                  AND      t.site_id=et.prj_srno "
							+ "                                  AND      p.trndt BETWEEN '"+ReportDAO.BOM(PAYREGDT)+"' AND      '"+ ReportDAO.EOM(PAYREGDT)+"' "
							+ "                                  AND      et.srno= "
							+ "                                           ( "
							+ "                                                  SELECT Max(srno) "
							+ "                                                  FROM   emptran "
							+ "                                                  WHERE  empno=E.empno) "
							+ "                                  AND      (( "
							+ "                                                             E.status='A' "
							+ "                                                    AND      E.doj <= '"+ReportDAO.EOM(PAYREGDT)+"') "
							+ "                                           OR       ( "
							+ "                                                             E.status ='N' "
							+ "                                                    AND      E.dol>='"+ ReportDAO.BOM(PAYREGDT)+"' )) "
							+ "                                  AND      p.trncd NOT IN(301,302) "
							+ "                                  GROUP BY p.trncd, "
							+ "                                           et.prj_srno, "
							+ "                                           t.site_name ) AS sss , "
							+ "                         empcount cnt "
							+ "                WHERE    cnt.siteid = sss.siteid "
							+ "                GROUP BY cnt.siteid, "
							+ "                         site_name, "
							+ "                         emptotal ) cnt "
							+ "WHERE  cnt.basic!=0.00";
							System.out.println("query is for payreg with branch only "+query);
						
					
					Statement st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
					empRS = st.executeQuery(query);
					
					/*if(!empRS.next())
					{
						if(Table.equalsIgnoreCase("Paytran"))
						{
						ReportDAO.println("Already Finalized", 50, 1, false, "BANK",repBean);
						}
						if(Table.equalsIgnoreCase("Paytran_stage"))
						{
						ReportDAO.println("TO be  Finalized", 50, 1, false, "BANK",repBean);
						}
						
					}
					else*/
					while(empRS.next())
					{						
						BranchTotalempno=empRS.getInt("emptotal");				
							basic = empRS.getFloat("basic");
							da = empRS.getFloat("da");
							//vda = empRS.getFloat("VDA");
							hra = empRS.getFloat("hra");
							Dept_Allw = empRS.getFloat("Dept_Allw");
						
							Convy_Allw = empRS.getFloat("Convy_Allw");
							Other_Allw = empRS.getFloat("Other_Allw");
							AnyOther_Allw = empRS.getFloat("AnyOther_Allw");
							
							TotalEarning =empRS.getInt("TotalEarning");
							 PF =empRS.getInt("PF");
							 PT =empRS.getInt("PT");
							 LIC=empRS.getInt("LIC");
							 MEDICLAIM=empRS.getInt("MEDICLAIM");
							 Other_Ded=empRS.getInt("Other_Ded");
							 Memb_Ded=empRS.getInt("Memb_Ded");
							 TDS=empRS.getInt("TDS");
							 /*itax=empRS.getInt("itax");*/
							 MLWF=empRS.getInt("MLWF");
							 Bank_Inst=empRS.getInt("Bank_Inst");
							 Other_Loan=empRS.getInt("Other_Loan");
							 other=empRS.getInt("other");
							 deduction=empRS.getInt("Total_Deduction");
							 netpay=empRS.getInt("netPay");
							
						
							
							Str1 = FixStr(""+empRS.getInt("siteid"), 4,3)+"|"+FixStr(""+empRS.getString("site_name"),28, 1)+"|"+FixStr(""+empRS.getInt("emptotal"), 8,3)+"|"+FixStr(""+basic, 10,3) + "|"+FixStr(""+da, 10,3) + "|"+FixStr(""+hra, 10,3)+"|"+FixStr(""+Dept_Allw, 10,3)+"|"+FixStr(""+Convy_Allw, 10,3)+"|"+FixStr(""+Other_Allw,10,3)+"|"+FixStr(""+AnyOther_Allw, 10,3)+"| "+FixStr(""+TotalEarning, 13,3)+"| ";			
							Str1 = Str1+""+FixStr(""+PF, 10,3)+"|"+FixStr(""+PT,10, 3)+"|"+FixStr(""+LIC, 10,3)+"|"+FixStr(""+MEDICLAIM, 10,3) + "|"+FixStr(""+Other_Ded, 10,3) + "|"+FixStr(""+Memb_Ded, 10,3)+"|"+FixStr(""+TDS, 10,3)+"|"+FixStr(""+MLWF, 10,3)+"|"+FixStr(""+Bank_Inst, 10,3)+"|"+FixStr(""+Other_Loan, 10,3)+"|"+FixStr(""+other, 10,3)+"| "+FixStr(""+deduction, 13,3)+"|"+FixStr(""+netpay, 13,3)+"|";

							ReportDAO.println(Str1, 10, 1, false, "BANK",repBean);
							ReportDAO.println(SLINE, 10, 1, false, "BANK",repBean);
							
							i++;  //  srno count
							totalempno=totalempno+BranchTotalempno;
							
							daTotal = (long) (daTotal + da);
							//vdaTotal = (long) (vdaTotal + vda);
							basicTotal = (long) (basicTotal + basic);
							hraTotal=(long) (hraTotal+hra);
							/*allowtotal=(long) (allowtotal+Dept_Allw);
							arreartotal=(long) (arreartotal+Convy_Allw);*/
							
							
							Dept_Allwtotal = (long) (Dept_Allwtotal + Dept_Allw);
							Convy_Allwtotal = (long) (Convy_Allwtotal + Convy_Allw);
							Other_Allwtotal = (long) (Other_Allwtotal + Other_Allw);
							AnyOther_Allwtotal = (long) (AnyOther_Allwtotal + AnyOther_Allw);
							total = (long) (total + TotalEarning);
						
							 /*stamptotal = (long) (stamptotal+stamp);
							 uniontotal = (long) (uniontotal+union);
							 gitotal = (long) (gitotal+gi);
							 pttotal= (long) (pttotal+pt);
							 lictotal= (long) (lictotal+lic);
							 pftotal= (long) (pftotal+pf);
							 societytotal= (long) (societytotal+society);
							 loantotal= (long) (loantotal+loan);
							 itaxtotal= (long) (itaxtotal+itax);
							 MLWFtotal= (long) (MLWFtotal+MLWF);
							 sdftotal= (long) (sdftotal+sdf);*/
							PFtotal = (long) (PFtotal + PF);
							PTtotal = (long) (PTtotal + PT);
							LICtotal = (long) (LICtotal + LIC);
							MEDICLAIMtotal = (long) (MEDICLAIMtotal + MEDICLAIM);
							Other_Dedtotal = (long) (Other_Dedtotal + Other_Ded);
							Memb_Dedtotal = (long) (Memb_Dedtotal + Memb_Ded);
							TDStotal = (long) (TDStotal + TDS);
							MLWFtotal = (long) (MLWFtotal + MLWF);
							Bank_Insttotal = (long) (Bank_Insttotal + Bank_Inst);
							Other_Loantotal = (long) (Other_Loantotal + Other_Loan);
							othertotal = (long) (othertotal + other);
							//total = (long) (total + TotalEarning);
							
							 deductiontotal= (long) (deductiontotal+deduction);
							 netpaytotal=(long) (netpaytotal+netpay);
							
						}
						
					ReportDAO.println(SLINE, 10, 3, false, "BANK",repBean);
					
									ReportDAO.println("Note : Salary is to be credited on "+PAYREGDT,10, 1, false,"BANK",repBean);									
					ReportDAO.println("", 10, 3, false, "BANK",repBean);
					
					// Total of page....
					ReportDAO.println(SLINE, 10, 1, false, "BANK",repBean);
					
					Str1 = FixStr("Tot   :-", 4,1)+"|"+FixStr("",28, 1)+"|"+FixStr(""+totalempno, 8,3)+"|"+FixStr(""+basicTotal, 10,3) + "|"+FixStr(""+daTotal, 10,3)+"|"+FixStr(""+hraTotal, 10,3)+"|"+FixStr(""+Dept_Allwtotal, 10,3) + "|"+FixStr(""+Convy_Allwtotal, 10,3)+"|"+FixStr(""+Other_Allwtotal, 10,3)+"|"+FixStr(""+AnyOther_Allwtotal, 10,3)+"| "+FixStr(""+total, 13,3)+"| ";
					Str1 = Str1+""+FixStr(""+PFtotal, 10,3)+"|"+FixStr(""+PTtotal,10, 3)+"|"+FixStr(""+LICtotal, 10,3)+"|"+FixStr(""+MEDICLAIMtotal, 10,3) + "|"+FixStr(""+Other_Dedtotal, 10,3) + "|"+FixStr(""+Memb_Dedtotal, 10,3)+"|"+FixStr(""+TDStotal, 10,3)+"|"+FixStr(""+MLWFtotal, 10,3)+"|"+FixStr(""+Bank_Insttotal, 10,3)+"|"+FixStr(""+MLWFtotal, 10,3)+"|"+FixStr(""+Other_Loantotal, 10,3)+"| "+FixStr(""+othertotal, 13,3)+"|"+FixStr(""+deductiontotal, 13,3)+"|"+FixStr(""+netpaytotal, 13,3)+"|";

					
					ReportDAO.println(Str1, 10, 1, false, "BANK",repBean);
					ReportDAO.println(SLINE, 10, 1, false, "BANK",repBean);
					
					Str1 = "THE BUSINESS CO.OP BANK LTD.,";
					ReportDAO.println(Str1, 10, 1, false, "BANK",repBean);
			
					/*daTotal = 0;
					vdaTotal = 0;
					basicTotal = 0;
					hraTotal=0;
					allowtotal=0;
					arreartotal=0;*/
							
			}
			catch(Exception e){
				e.printStackTrace();
			}
			
			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
			
			return;
	  }
	  catch(Exception e)
		{
			e.printStackTrace();
		}
		

		
	}	//payreg according to namco in txt foramt bY Hrishi Ends here
	public static void transferreport(String fromdate,String todate,String type,String filepath,String imagepath)throws IOException, SQLException, DocumentException  // @ni
	{int lastyr=0,lastMon=0,lday=0;
	 long millis=System.currentTimeMillis();  
	 java.sql.Date date=new java.sql.Date(millis);  
	 System.out.println("date..."+date);
	 DateFormat df = new SimpleDateFormat("yyyy-MM-dd");
	 String reportDate = df.format(date);

	Document doc = new Document();
	try{
	
		int totalemp=0;
		//lable1="Report Date:-";
		//UtilityDAO ut=new UtilityDAO();
	
		PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
		
		
		
		doc.setPageSize(PageSize.A4);
		//Footer1 ftr = ut.new Footer1(lable1);
		//writer.setPageEvent(ftr);
		doc.open();
		
		Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
		ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
		Image image1 = Image.getInstance(imagepath);
		Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
		Paragraph para = new Paragraph(title);
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingBefore(0);

		image1.scaleAbsolute(60f,50f);
		image1.setAbsolutePosition(40f, 750f);

		doc.add(image1);
		doc.add(para);


		para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingAfter(0);

		doc.add(para);
		para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingAfter(0);

		doc.add(para);
		para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingAfter(0);

		doc.add(para);
		para = new Paragraph(new Phrase("Employees Transfer List " ,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingAfter(0);
		doc.add(para);
		para = new Paragraph(new Phrase("Date:-" + reportDate,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingAfter(0);
		doc.add(para);
		/*para = new Paragraph(new Phrase("Employees Transfer List For :-[" + fromdate+"] - ["+todate+"]",new Font(Font.TIMES_ROMAN,8)));
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingAfter(0);
		doc.add(para);*/

		Rectangle rec = new  Rectangle(119,100);
		PdfPTable headtab = null;

		headtab= new PdfPTable(7);	
		headtab.setSpacingBefore(0);
		headtab.setWidthPercentage(new float[]{7,7,28,17,12,24,24}, rec);
		headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
		
		PdfPTable datatab=new PdfPTable(7);
		datatab.setSpacingBefore(0);
		datatab.setWidthPercentage(new float[]{7,7,28,17,12,24,24}, rec);
		
	
		Connection conn=ConnectionManager.getConnection();
		Statement st=st = conn.createStatement(
				ResultSet.TYPE_SCROLL_INSENSITIVE,
				ResultSet.CONCUR_READ_ONLY);
		String EmpSql="";
		
		 if(type.equalsIgnoreCase("1")){
		 EmpSql=""
				 + "SELECT e.empno, "
					+ "       p.site_name AS new_site,m.DOJ, "
					+ "       m.empno, "
					+ "       m.empcode, "
					+ "       m.lname, "
					+ "       m.fname, "
					+ "       m.mname, "
					+ "       l.lkp_disc, "
					+ "       h.site_name AS old_site, "
					+ "       e.effdate, "
					+ "       e.order_dt "
					+ "       FROM   empmast m, "
					+ "       emptran e, "
					+ "       project_sites p, "
					+ "       emptran k, "
					+ "       project_sites h, "
					+ "       lookup l,emptran a "
					+ "      WHERE  m.empno = e.empno "
					+ "       AND e.prj_srno = p.site_id "
					+ "       AND k.empno = e.empno "
					+ "       AND h.site_id = k.prj_srno "
					+ "       AND k.srno = (SELECT Max(srno) - 1 "
					+ "                     FROM   emptran c "
					+ "                     WHERE  c.empno = m.empno "
					+ "                            AND c.trncd = 60) "
					+ "       AND e.srno = (SELECT Max(srno) "
					+ "                     FROM   emptran b "
					+ "                     WHERE  b.empno = m.empno "
					+ "                            AND b.trncd = 60) "
					+ "       AND m.status = 'A' "
					+ "       and a.EMPNO=e.EMPNO "
					+ "       and a.SRNO= (SELECT Max(srno) "
					+ "                     FROM   emptran g "
					+ "                     WHERE  g.empno = m.empno) "
					+ "       AND l.lkp_code = 'DESIG' "
					+ "       AND l.lkp_srno = a.desig "
					+ "       ORDER  BY a.desig"; 
				 
				 /*+ "WITH a "
				 + "     AS (SELECT Row_number() "
				 + "     OVER( "
				 + "     ORDER BY srno) AS rn, "
				 + "     srno, "
				 + "     empno "
				 + "     FROM   emptran "
				 + "     WHERE   trncd != 50 OR( trncd IS NULL OR  TRNCD < 999)) "
			//	 + "     OR trncd IS NULL )) "
				 + " "
				 + "SELECT a1.*, "
				 + " p.site_name as new_site, "
				 + "       m.empno, "
				 + "       m.empcode, "
				 + "       m.lname, "
				 + "       m.fname, "
				 + "       m.mname, "
				 + "       l.lkp_disc, "
				 + "       h.site_name as old_site, "
				 + "       e.effdate, "
				 + "       e.order_dt "
				 + "FROM   empmast m, "
				 + "       emptran e, "
				 + "       project_sites p, "
				 + "       emptran k, "
				 + "       project_sites h, "
				 + "       lookup l ,a a1 "
				 + "WHERE  m.empno = e.empno "
				 + "       AND e.prj_srno = p.site_id "
				 + "       AND m.empno = a1.empno "
				 + "       AND e.srno = a1.srno "
				 + "       AND k.empno = e.empno "
				 + "       AND h.site_id = k.prj_srno "
				 + "       AND k.srno = (SELECT Max(srno) - 1 "
				 + "       FROM   emptran c "
				 + "       WHERE  c.empno = m.empno) "
				 + "       AND l.lkp_srno = e.desig "
				 + "       AND l.lkp_code = 'DESIG' "
				 + "       AND e.srno = (SELECT Max(srno) "
				 + "       FROM   emptran b "
				 + "       WHERE  b.empno = m.empno) "
				 + "       AND m.status = 'A' "
				 + "ORDER  BY e.desig"; */
		 }
		 else if(type.equalsIgnoreCase("2")){
			 EmpSql=""
					 + "SELECT e.empno, "
						+ "       p.site_name AS new_site, m.DOJ,"
						+ "       m.empno, "
						+ "       m.empcode, "
						+ "       m.lname, "
						+ "       m.fname, "
						+ "       m.mname, "
						+ "       l.lkp_disc, "
						+ "       h.site_name AS old_site, "
						+ "       e.effdate, "
						+ "       e.order_dt "
						+ "       FROM   empmast m, "
						+ "       emptran e, "
						+ "       project_sites p, "
						+ "       emptran k, "
						+ "       project_sites h, "
						+ "       lookup l,emptran a "
						+ "      WHERE  m.empno = e.empno "
						+ "       AND e.prj_srno = p.site_id "
						+ "       AND k.empno = e.empno "
						+ "       AND h.site_id = k.prj_srno "
						+ "       AND k.srno = (SELECT Max(srno) - 1 "
						+ "                     FROM   emptran c "
						+ "                     WHERE  c.empno = m.empno "
						+ "                            AND c.trncd = 60) "
						+ "       AND e.srno = (SELECT Max(srno) "
						+ "                     FROM   emptran b "
						+ "                     WHERE  b.empno = m.empno "
						+ "                            AND b.trncd = 60) "
						+ "       AND m.status = 'A' "
						+ "       and a.EMPNO=e.EMPNO "
						+ "       and a.SRNO= (SELECT Max(srno) "
						+ "                     FROM   emptran g "
						+ "                     WHERE  g.empno = m.empno) "
						+ "       AND l.lkp_code = 'DESIG' "
						+ "       AND l.lkp_srno = a.desig "
						 + "      and e.oRDER_DT  between '"+fromdate+"' and '"+todate+"'  "
						+ "       ORDER  BY a.desig";
					 
					/* + "WITH a "
					 + "     AS (SELECT Row_number() "
					 + "     OVER( "
					 + "     ORDER BY srno) AS rn, "
					 + "     srno, "
					 + "     empno "
					 + "     FROM   emptran "
					 + "     WHERE   (trncd != 50 OR(trncd IS NULL OR  TRNCD < 999))) "
		//			 + "     OR trncd IS NULL )) "
					 + " "
					 + "SELECT a1.*, "
					 + " p.site_name as new_site, "
					 + "       m.empno, "
					 + "       m.empcode, "
					 + "       m.lname, "
					 + "       m.fname, "
					 + "       m.mname, "
					 + "       l.lkp_disc, "
					 + "       h.site_name as old_site, "
					 + "       e.effdate, "
					 + "       e.order_dt "
					 + "FROM   empmast m, "
					 + "       emptran e, "
					 + "       project_sites p, "
					 + "       emptran k, "
					 + "       project_sites h, "
					 + "       lookup l ,a a1 "
					 + "WHERE  m.empno = e.empno "
					 + "       AND e.prj_srno = p.site_id "
					 + "       AND m.empno = a1.empno "
					 + "       AND e.srno = a1.srno "
					 + "       AND k.empno = e.empno "
					 + "       AND h.site_id = k.prj_srno "
					 + "       AND k.srno = (SELECT Max(srno) - 1 "
					 + "       FROM   emptran c "
					 + "       WHERE  c.empno = m.empno) "
					 + "       AND l.lkp_srno = e.desig "
					 + "       AND l.lkp_code = 'DESIG' "
					 + "       AND e.srno = (SELECT Max(srno) "
					 + "       FROM   emptran b "
					 + "       WHERE  b.empno = m.empno) "
					 + "       AND m.status = 'A' "
					 + " and e.oRDER_DT  between '"+fromdate+"' and '"+todate+"'  "
					 + "ORDER  BY e.desig";*/
					 
		 }
		System.out.println(EmpSql);
		ResultSet emp = st.executeQuery(EmpSql);

		if(!emp.next())
		{
			System.out.println("no record found");
			/*PdfPCell c1 = new PdfPCell(new Phrase("Record is Not found for the Month "+fromdate+" - "+todate,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
			c1.setColspan(5);

			headtab.setSpacingBefore(20);
			headtab.addCell(c1);
			doc.add(headtab);*/
			
			
			PdfPTable datatab1=new PdfPTable(1);
			datatab1.setSpacingBefore(2);
			datatab1.setWidthPercentage(new float[]{107}, rec);
			PdfPCell c11 = new PdfPCell(new Phrase("Record Not found ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
			datatab1.addCell(c11);
			doc.add(datatab1);
			
		}
		else
		{
			
			emp.previous();
			headtab.setSpacingBefore(10);
			PdfPCell sr = new PdfPCell(new Phrase("Sr No",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
			headtab.addCell(sr);
			PdfPCell c1 = new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
			headtab.addCell(c1);
			PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
			headtab.addCell(c2);
			PdfPCell c3 = new PdfPCell(new Phrase("Designation",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
			headtab.addCell(c3);
			PdfPCell c4 = new PdfPCell(new Phrase("Transfer Date",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
			headtab.addCell(c4);
			PdfPCell c5 = new PdfPCell(new Phrase("Old_Branch_Name",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
			headtab.addCell(c5);
			PdfPCell c6 = new PdfPCell(new Phrase("New_Branch_Name",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
			headtab.addCell(c6);

			doc.add(headtab);
		
			while(emp.next())
			{
				
				System.out.println("empcode..."+emp.getString("EMPCODE"));
					totalemp++;
					PdfPCell srno = new PdfPCell(new Phrase(""+totalemp,new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));  
					datatab.addCell(srno);
					PdfPCell cell1 = new PdfPCell(new Phrase(""+emp.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));  
					datatab.addCell(cell1);
					PdfPCell cell2 = new PdfPCell(new Phrase(""+emp.getString("LNAME")+" "+emp.getString("FNAME")+" "+emp.getString("MNAME"),new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));
					datatab.addCell(cell2);
					PdfPCell cell3 = new PdfPCell(new Phrase(""+emp.getString("LKP_DISC"),new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));
					datatab.addCell(cell3);
					PdfPCell cell4 = new PdfPCell(new Phrase(""+emp.getString("EFFDATE"),new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));
					datatab.addCell(cell4);
					PdfPCell cell5 = new PdfPCell(new Phrase(""+emp.getString("old_site"),new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));
					datatab.addCell(cell5);
					PdfPCell cell6 = new PdfPCell(new Phrase(""+emp.getString("new_site"),new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));
					datatab.addCell(cell6);
					
				}
			doc.add(datatab);
			PdfPTable datatab1=new PdfPTable(1);
			datatab1.setSpacingBefore(0);
			datatab1.setWidthPercentage(new float[]{119}, rec);
			PdfPCell c11 = new PdfPCell(new Phrase("Total Employees Transfer:- "+totalemp,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
			datatab1.addCell(c11);
			doc.add(datatab1);
			
		}
		doc.close();
	}
	catch(Exception e)
	{
		e.printStackTrace();
	}}
	
	
	
	// For LIC Report...  16-08-2017
	
	public static void getLICList(String filePath, String date,String imagepath,String status) throws IOException, SQLException, DocumentException 
	{
		System.out.println("i am in liclist 01");
		OutputStream file = new FileOutputStream(new File(filePath));
		Document document = new Document();
		String table_name="";
		lable1="Report date : ";
		try {
			//System.out.println("i am in liclist 02");
			UtilityDAO dao = new UtilityDAO();
			PdfWriter writer =PdfWriter.getInstance(document, new FileOutputStream(filePath));

			Footer ftr = dao.new Footer(lable1);
			writer.setPageEvent(ftr);
			document.open();
			Image image1 = Image.getInstance(imagepath);
			image1.scaleAbsolute(80f, 80f);
			image1.setAbsolutePosition(40f, 730f); 
			document.add(image1);
			Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			document.add(para);

			para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			document.add(para);
			para = new Paragraph(new Phrase("Tel : +91-20 26812190,Email :",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
		//	System.out.println("i am in liclist 03");
			document.add(para);
		//	para = new Paragraph(new Phrase("E.S.I.C List "+(type.equalsIgnoreCase("before")?"":""),new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
			para = new Paragraph(new Phrase("LIC List ",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			// para.setSpacingBefore(30.0f);
			para.setSpacingAfter(0);
			document.add(para);
			para = new Paragraph(new Phrase("For The Month Of Jul 2017",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			//para.setSpacingBefore(30.0f);
			para.setSpacingAfter(0);
			document.add(para);
			PdfPTable table=new PdfPTable(6);
			table.setSpacingBefore(10.0f);
			table.setWidthPercentage(new float[]{6,12,40,13,12,13},new Rectangle(100,100));
			PdfPCell cell1=new PdfPCell(new Phrase("Sr No",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1);
			PdfPCell cell2=new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell2);
			PdfPCell cell3=new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell3);
			PdfPCell cell4=new PdfPCell(new Phrase("Policy No",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell4);
			PdfPCell cell5=new PdfPCell(new Phrase("Status",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell5);
			PdfPCell cell6=new PdfPCell(new Phrase("Amount",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell6);
			table.setHeaderRows(1);
	//		System.out.println("i am in liclist 04");
			Connection con=null;
			con=ConnectionManager.getConnection();
			Statement stmt=con.createStatement();
			ResultSet rspt = null;
			String sql1="";
			if(status.equalsIgnoreCase("Active"))
			{
				
			 sql1 = "select  e.fname,e.MNAME,e.LNAME,e.empcode,d.empno,d.amount,"+
							"d.ac_no,d.sanc_date,d.ACTYN,d.REPAY_START  "+
							"from empmast e,DEDMAST d  where e.EMPNO = d.EMPNO "+
							"and d.TRNCD=205 and d.REPAY_START between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"' and ACTYN='A'  ";
			}
			else
			{
				 sql1 = "select  e.fname,e.MNAME,e.LNAME,e.empcode,d.empno,d.amount,"+
						"d.ac_no,d.sanc_date,d.ACTYN,d.REPAY_START  "+
						"from empmast e,DEDMAST d  where e.EMPNO = d.EMPNO "+
						"and d.TRNCD=205 and d.END_DATE between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"' and ACTYN='N'  ";
			
			}
			System.out.println("query is  "+sql1);
	//		System.out.println("i am in liclist 05");
			rspt = stmt.executeQuery(sql1);
			System.out.println("i am in liclist 05");
			int srno=0;
			double totatlAmount=0;
			LookupHandler lkp=new LookupHandler();
			int i = 0;
			while(rspt.next())
			{
				i++;
				System.out.println("in while  "+i);
				srno++;
				PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,10)));
				cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data);
				
				PdfPCell cell1data1=new PdfPCell(new Phrase(""+rspt.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,10)));
				cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data1);
				
				String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
				PdfPCell cell1data2=new PdfPCell(new Phrase(""+empname,new Font(Font.TIMES_ROMAN,10)));
				cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data2);

		
				PdfPCell cell1data3=new PdfPCell(new Phrase(""+rspt.getString("AC_NO"),new Font(Font.TIMES_ROMAN,10)));
				cell1data3.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data3);
				
				if(rspt.getString("ACTYN").equalsIgnoreCase("Y"))
				{	
				PdfPCell cell1data4=new PdfPCell(new Phrase("Active",new Font(Font.TIMES_ROMAN,10)));
				cell1data4.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data4);
				}
				else
				{
					PdfPCell cell1data4=new PdfPCell(new Phrase("InActive",new Font(Font.TIMES_ROMAN,10)));
					cell1data4.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell1data4);
				}
				

				PdfPCell cell1data5=new PdfPCell(new Phrase(""+rspt.getInt("AMOUNT"),new Font(Font.TIMES_ROMAN,10)));
				cell1data5.setHorizontalAlignment(Element.ALIGN_RIGHT);
				table.addCell(cell1data5);
				totatlAmount=totatlAmount + rspt.getInt("AMOUNT");
			}
			PdfPCell totemp = new PdfPCell(new Phrase("Total Employee:",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
			totemp.setHorizontalAlignment(Element.ALIGN_RIGHT);
			totemp.setColspan(2);
			table.addCell(totemp);
			PdfPCell totempdisp = new PdfPCell(new Phrase(""+i,new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
			totemp.setHorizontalAlignment(Element.ALIGN_LEFT);
			table.addCell(totempdisp);
			PdfPCell total=new PdfPCell(new Phrase("Total Amount",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
			total.setHorizontalAlignment(Element.ALIGN_RIGHT);
			//total.setColspan(2);
			table.addCell(total);
			PdfPCell totaldata=new PdfPCell(new Phrase(""+totatlAmount,new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
			totaldata.setHorizontalAlignment(Element.ALIGN_RIGHT);
			table.addCell(totaldata);
			document.add(table);	 
			document.close();
			file.close();
			con.close();

		} catch (Exception e)
		{		
			e.printStackTrace();
		}

	}

	
// For Bonus Report..
	
	public static void SummaryBonusList(String filePath,String imagepath) throws IOException, SQLException, DocumentException 
	{
		System.out.println("i am in handler..");
		

		System.out.println("i am in BonusList 01");
		OutputStream file = new FileOutputStream(new File(filePath));
		Document document = new Document();
		String table_name="";
		String prj_srno="";
		Connection con=null;
		con=ConnectionManager.getConnection();
		Statement stmt=con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
		Statement stmt1=con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
		ResultSet rspt = null;
		ResultSet rspt0 = null;
		lable1="Report date : ";
		int srno=0;
		try {
		//	System.out.println("i am in BonusList 02");
			UtilityDAO dao = new UtilityDAO();
			PdfWriter writer =PdfWriter.getInstance(document, new FileOutputStream(filePath));

			Footer ftr = dao.new Footer(lable1);
			writer.setPageEvent(ftr);
			document.open();
			Image image1 = Image.getInstance(imagepath);
			image1.scaleAbsolute(80f, 80f);
			image1.setAbsolutePosition(40f, 730f); 
			document.add(image1);
			Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			document.add(para);

			para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			document.add(para);
			para = new Paragraph(new Phrase("Tel : +91-20 26812190,Email :",new Font(Font.TIMES_ROMAN,9)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
	//		System.out.println("i am in BonusList 03");
			document.add(para);
			para = new Paragraph(new Phrase("BONUS LIST ",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
			document.add(para);
			para = new Paragraph(new Phrase("For The Year Of ",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
			document.add(para);
			
			
			String GetBranch = "SELECT "+
								"distinct T.prj_srno as branch,PS.SITE_NAME "+
								"FROM   empmast EMP,"+
								"emptran T,Project_Sites PS "+
								"WHERE  T.empno = EMP.empno  and PS.SITE_ID = T.prj_srno "+
								"AND T.srno = (SELECT Max(E2.srno)  "+
								"FROM   emptran E2 "+
								"WHERE  E2.empno = EMP.empno) "+
								"AND EMP.status = 'A'"+
								"ORDER  BY T.prj_srno";  
			
			rspt0=stmt.executeQuery(GetBranch);
			System.out.println("GetBranch "+GetBranch);
			
			
			
			/*String sql1 ="with a as(SELECT e.empno,"+
                    "e.empcode,"+
                    "Rtrim(e.fname) + ' ' + Rtrim(e.mname) + ' '"+
                   "+ Rtrim(e.lname) AS NAME,"+
                   "b.amtforbonus,"+
                   "b.bonus "+
                   "FROM   empmast e,"+
                   "bonuscal b "+
                   "WHERE  b.empno = e.empno "+
                   "AND b.status = 'P' and e.STATUS='A')"+
                   "select a.*,t.prj_srno from a, EMPTRAN t where "+
                   "t.EMPNO=a.EMPNO and t.SRNO=(select MAX(srno) "+
                   "from EMPTRAN where EMPNO =a.EMPNO) order by convert(int,t.PRJ_SRNO), a.EMPCODE";*/
		
			String sql1 ="with a as"+
							"(SELECT e.empno,e.empcode,Rtrim(e.fname) + ' ' + Rtrim(e.mname) + ' '+ Rtrim(e.lname) "+
							"AS NAME,b.amtforbonus,b.bonus,b.year FROM   empmast e,bonuscal b "+
							"WHERE  b.empno = e.empno AND b.status = 'P' ) "+
							"select a.*,t.prj_srno,t.DESIG,(select lkp_disc from LOOKUP where LKP_SRNO=t.DESIG and LKP_CODE='DESIG') as DESIG_DISC "+
							"from a, EMPTRAN t  where t.EMPNO=a.EMPNO "+
							"and t.SRNO=(select MAX(srno) from EMPTRAN where EMPNO =a.EMPNO) "+
							"and t.DESIG =(select DESIG  from emptran t2 where srno "+
							"= (select MAX(srno) from EMPTRAN t1 where t1.EMPNO =a.EMPNO)and t2.EMPNO =a.EMPNO) "+
							"order by convert(int,t.PRJ_SRNO), a.EMPCODE";		
			
		
		System.out.println("query is  "+sql1);
//		System.out.println("i am in BonusList 05");
		rspt = stmt1.executeQuery(sql1);
	//	double totatlBonus = 0.0f;
		String numberAsString="";
		double number =0.0f;
		String TotBonusAMT ="";
		double finalBonusAMT =0.0f;
	//	String finalBonusAMT="";
			while(rspt0.next())
			{
			
			para = new Paragraph(new Phrase("Employee's Bonus List For Project Site :  "+rspt0.getString("SITE_NAME"),new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
			document.add(para);
			if(rspt0.getInt("BRANCH")==999){
				System.out.println("i am in list 0000  "+rspt0.getInt("BRANCH"));}
			PdfPTable table=new PdfPTable(6);
			table.setSpacingBefore(10.0f);
			table.setWidthPercentage(new float[]{6,12,35,25,13,13},new Rectangle(100,100));
			PdfPCell cell1=new PdfPCell(new Phrase("Sr No",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1);
			PdfPCell cell2=new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell2);
			PdfPCell cell3=new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell3);
			/*PdfPCell cell4=new PdfPCell(new Phrase("Basic",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell4);*/
			PdfPCell cell5=new PdfPCell(new Phrase("Designation",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell5);
			PdfPCell cell6=new PdfPCell(new Phrase("Amount For Bonus",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell6);
			PdfPCell cell7=new PdfPCell(new Phrase("Bonus",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell7);
			
			table.setHeaderRows(1);
			System.out.println("i am in list 00  "+rspt0.getInt("BRANCH"));
			
			
	//		System.out.println("i am in BonusList 05");
			
			double totatlBonus=0.0f;
			int i = 0;
			while(rspt.next())
			{
				if(rspt0.getInt("BRANCH") == rspt.getInt("prj_srno"))
				{
				i++;
				if(rspt0.getInt("BRANCH")==999){
				System.out.println("i am in list 01  "+rspt0.getInt("BRANCH"));}
				srno++;
				
				prj_srno = rspt.getString("PRJ_SRNO");
				
				PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,9)));
				cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data);
				
				PdfPCell cell1data1=new PdfPCell(new Phrase(""+rspt.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,9)));
				cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data1);
				
				//String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
				PdfPCell cell1data2=new PdfPCell(new Phrase(""+rspt.getString("NAME"),new Font(Font.TIMES_ROMAN,9)));
				cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data2);
				
				/*PdfPCell cell1data3=new PdfPCell(new Phrase(""+rspt.getString("amtforbonus"),new Font(Font.TIMES_ROMAN,9)));
				cell1data3.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data3);*/
				
				PdfPCell cell1data4=new PdfPCell(new Phrase(""+rspt.getString("DESIG_DISC"),new Font(Font.TIMES_ROMAN,9)));
				cell1data4.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data4);
		
				PdfPCell cell1data5=new PdfPCell(new Phrase(""+rspt.getString("amtforbonus"),new Font(Font.TIMES_ROMAN,9)));
				cell1data5.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data5);
				
				
					PdfPCell cell1data6=new PdfPCell(new Phrase(""+rspt.getString("bonus"),new Font(Font.TIMES_ROMAN,9)));
					cell1data6.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell1data6);
				
				

				totatlBonus=totatlBonus + rspt.getInt("bonus");
				TotBonusAMT = String.valueOf(totatlBonus);
				}
				
				
				else
				{
					rspt.previous();
					break;
				}
			}
			
			PdfPTable table1=new PdfPTable(6);
			table1.setSpacingBefore(0);
			table1.setWidthPercentage(new float[]{6,12,35,25,13,13},new Rectangle(100,100));
			PdfPCell cell11=new PdfPCell(new Phrase("Total Employee:   "+i,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			cell11.setHorizontalAlignment(Element.ALIGN_LEFT);
			cell11.setColspan(3);
			table1.addCell(cell11);
			
			
			PdfPCell cell21=new PdfPCell(new Phrase("Total Bonus",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			cell21.setHorizontalAlignment(Element.ALIGN_LEFT);
			cell21.setColspan(2);
			table1.addCell(cell21);
			
			PdfPCell totaldata=new PdfPCell(new Phrase(""+TotBonusAMT,new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
			cell21.setHorizontalAlignment(Element.ALIGN_CENTER);
			table1.addCell(totaldata);
			
			finalBonusAMT = finalBonusAMT + Float.parseFloat(TotBonusAMT);
			number = finalBonusAMT;
			DecimalFormat decimalFormat = new DecimalFormat("0.00");
		    numberAsString = decimalFormat.format(number);
			document.add(table);
			document.add(table1);
			
			if(!rspt0.next())
			{
				break;
			}
			else{
				rspt0.previous();
				continue;
			}
				 
		}
			para = new Paragraph(new Phrase("Total Number Of Employee :- "+srno+"          " +
					"                                                                                " +
					" Total Bonus :-          "+numberAsString
				  ,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(10);
			document.add(para);
			document.close();
			file.close();
			con.close();

		} catch (Exception e)
		{		
			e.printStackTrace();
		}

	
	}
	
	public static void SalaryReport(String rdt,String filepath, String imagepath,String code,String table,String ptcode) 
	{
		RepoartBean repBean  = new RepoartBean();
		Connection Cn = null;
		ResultSet emp = null;
		ResultSet emp1=null;
		String EmpSql = "";
		String EmpSql1 = "";
		int reporttype=0;
		int nillcnt=0;
		int cnt175=0;
		int cnt200=0;
		int cnt300=0;
		int sumnill=0;
		int sum175=0;
		int sum200=0;
		int sum300=0;
		int report2srno=0;
		String branchname="";
		ReportDAO.OpenCon("", "", "",repBean);
		Cn = repBean.getCn();
		Statement st=null;
		Statement st1=null;
		String listname=Integer.parseInt(code)==9999?"Net Salary List":Integer.parseInt(code)==999?"Nill Salary List":Integer.parseInt(ptcode)==202?
								"Nill PT List":Integer.parseInt(ptcode)==2022?"PT Distribution List":
								Integer.parseInt(ptcode)==242?"Union Member List":Integer.parseInt(code)==207?"Group Insurance Summery List":Integer.parseInt(ptcode)==2422?"Union Distribution List":
									Integer.parseInt(code)==129?"Table Allowance List":"";
										
		
			try {
			st = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			st1 = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);

			try
			{
				Document doc = new Document();
				PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
				doc.open();
				doc.setPageSize(PageSize.A4);

				Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
				Image image1 = Image.getInstance(imagepath);
				Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);

				image1.scaleAbsolute(60f,50f);
				image1.setAbsolutePosition(40f, 750f);

				doc.add(image1);
				doc.add(para);

				para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);

				para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);

				para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);
				
				para = new Paragraph(new Phrase(listname,new Font(Font.TIMES_ROMAN,8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);

				if(table.equalsIgnoreCase("paytran")){
					para = new Paragraph(new Phrase("(Before Finalize Of Salary)",new Font(Font.TIMES_ROMAN,5)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(1);
					doc.add(para);
				}
				else{
						para = new Paragraph(new Phrase("(After Finalize Of Salary)",new Font(Font.TIMES_ROMAN,5)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(1);
						doc.add(para);
					}
				
				para = new Paragraph(new Phrase("For Month :- "+ReportDAO.EOM(rdt),new Font(Font.TIMES_ROMAN,8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(2);
				doc.add(para);

				if(((Integer.parseInt(code)==202)&&(Integer.parseInt(ptcode)==202))||((Integer.parseInt(code)==999)||((Integer.parseInt(code)==242)&&(Integer.parseInt(ptcode)==242))||(Integer.parseInt(code)==129)||(Integer.parseInt(code)==9999)))
				{
					reporttype=1;
				}
				else if((Integer.parseInt(code)==207))
				{
					reporttype=3;
				}
				else
				{
					reporttype=2;
				}
				Rectangle rec = new  Rectangle(60,100);
				Rectangle rec1 = new  Rectangle(50,100);
				
				PdfPTable table1=null;
				if((Integer.parseInt(code)==129)||(Integer.parseInt(code)==9999))
				{
					 table1=new PdfPTable(5);
					table1.setWidthPercentage(new float[]{5,8,20,15,12},new Rectangle(60,100));
				}
				else
				{
					 table1=new PdfPTable(4);
					table1.setWidthPercentage(new float[]{5,8,32,15},new Rectangle(60,100));
				}
				PdfPTable table2=new PdfPTable(7);
				if(reporttype==1){
				
				table1.setSpacingBefore(0);
				
				PdfPCell cell11=new PdfPCell(new Phrase("SRNO",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
				cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
				table1.addCell(cell11);
				PdfPCell cell111=new PdfPCell(new Phrase("EMPCODE",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
				cell111.setHorizontalAlignment(Element.ALIGN_CENTER);
				table1.addCell(cell111);
				PdfPCell cell1111=new PdfPCell(new Phrase("EMPLOYEE NAME",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
				cell1111.setHorizontalAlignment(Element.ALIGN_LEFT);
				table1.addCell(cell1111);
				if((Integer.parseInt(code)==129))
				{
					PdfPCell cell1111d=new PdfPCell(new Phrase("DESIG",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell1111d.setHorizontalAlignment(Element.ALIGN_CENTER);
					table1.addCell(cell1111d);
				}
				if((Integer.parseInt(code)==9999))
				{
					PdfPCell cell1111d=new PdfPCell(new Phrase("A/C NO",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell1111d.setHorizontalAlignment(Element.ALIGN_CENTER);
					table1.addCell(cell1111d);
				}
				PdfPCell cell11111=new PdfPCell(new Phrase("NET AMOUNT",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
				cell11111.setHorizontalAlignment(Element.ALIGN_CENTER);
				table1.addCell(cell11111);
				}
				else if(reporttype==3)
				{
					table1.setSpacingBefore(5);
					table1.setWidthPercentage(new float[]{5,8,15,20},new Rectangle(60,100));
					PdfPCell cell11=new PdfPCell(new Phrase("RATE OF G.I",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
					cell11.setColspan(2);
					table1.addCell(cell11);
					PdfPCell cell111=new PdfPCell(new Phrase("NO.OF EMPLOYEE",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell111.setHorizontalAlignment(Element.ALIGN_CENTER);
					table1.addCell(cell111);
					PdfPCell cell1111=new PdfPCell(new Phrase("TOTAL AMOUNT OF G.I. DEDUCTED",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell1111.setHorizontalAlignment(Element.ALIGN_CENTER);
					table1.addCell(cell1111);
				}
				else
				{
					//do for categorywise pt list..aniket
					
					table2.setSpacingBefore(2);
					table2.setWidthPercentage(new float[]{5,20,5,5,5,5,5},rec1);
					PdfPCell cell11=new PdfPCell(new Phrase("SRNO",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
					table2.addCell(cell11);
					PdfPCell cell111=new PdfPCell(new Phrase("BRANCH NAME",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell111.setHorizontalAlignment(Element.ALIGN_CENTER);
					table2.addCell(cell111);
					PdfPCell cell1111=new PdfPCell(new Phrase("NILL",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell1111.setHorizontalAlignment(Element.ALIGN_CENTER);
					table2.addCell(cell1111);
					String is10or175=Integer.parseInt(ptcode)==2422?"10":" 175";
					PdfPCell cell11111=new PdfPCell(new Phrase(""+is10or175,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell11111.setHorizontalAlignment(Element.ALIGN_CENTER);
					table2.addCell(cell11111);
					PdfPCell cell111111=new PdfPCell(new Phrase(is10or175=="10"?" 25":" 200",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell111111.setHorizontalAlignment(Element.ALIGN_CENTER);
					table2.addCell(cell111111);
					PdfPCell cell1111111=new PdfPCell(new Phrase(is10or175=="10"?" 25":" 300",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell1111111.setHorizontalAlignment(Element.ALIGN_CENTER);
					table2.addCell(cell1111111);
					PdfPCell cell11111111=new PdfPCell(new Phrase("TOTAL",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell11111111.setHorizontalAlignment(Element.ALIGN_CENTER);
					table2.addCell(cell11111111);
					
						
					
				}
				

				String GetBranch = "SELECT "+
						"distinct T.prj_srno as branch,PS.SITE_NAME "+
						"FROM   empmast EMP,"+
						"emptran T,Project_Sites PS "+
						"WHERE  T.empno = EMP.empno  and PS.SITE_ID = T.prj_srno "+
						"AND T.srno = (SELECT Max(E2.srno)  "+
						"FROM   emptran E2 "+
						"WHERE  E2.empno = EMP.empno) "+
						"ORDER  BY T.prj_srno";  
	
				
				
				//..@niket
				if(reporttype==1)
				{
					if(((Integer.parseInt(code)==242)&&(Integer.parseInt(ptcode)==242)))
					{
						EmpSql=("with lastmonth as"+
								"(SELECT emp.empno,emp.EMPCODE,Rtrim(emp.fname) + ' '+Rtrim(emp.mname) + ' ' + Rtrim(emp.lname) AS name, "+ 
								"emp.salute, p.net_amt  AS amt FROM   empmast emp ,"+table+"  p "+ 
								"WHERE     emp.empno = p.empno AND p.trncd = '"+code+"' " +
								"AND p.trndt BETWEEN '"+ReportDAO.BOM(rdt)+"' AND '"+ReportDAO.EOM(rdt)+"' AND p.NET_AMT!=0 )"+
								
								"SELECT l.*,etran.PRJ_SRNO "+ 
								" FROM   emptran etran , lastmonth  l "+ 
								"WHERE     etran.empno = l.empno AND  "+       
								"etran.srno=(select MAX(SRNO) from emptran where empno=etran.empno) "+
								"order by etran.PRJ_SRNO,l.EMPCODE,l.amt ");
					}
					else if((Integer.parseInt(code)==129))
					{
						
						EmpSql=("with lastmonth as"+
								"(SELECT emp.empno,emp.EMPCODE,Rtrim(emp.fname) + ' '+Rtrim(emp.mname) + ' ' + Rtrim(emp.lname) AS name, "+ 
								"emp.salute, p.net_amt  AS amt FROM   empmast emp ,"+table+"  p "+ 
								"WHERE     emp.empno = p.empno AND p.trncd = '"+code+"' " +
								"AND p.trndt BETWEEN '"+ReportDAO.BOM(rdt)+"' AND '"+ReportDAO.EOM(rdt)+"' AND p.NET_AMT!=0 )"+
								
								"SELECT l.*,etran.PRJ_SRNO,L1.LKP_DISC AS DESIG "+ 
								" FROM   emptran etran , lastmonth  l,LOOKUP L1 "+ 
								"WHERE     etran.empno = l.empno AND  "+       
								"etran.srno=(select MAX(SRNO) from emptran where empno=etran.empno)  and"+ 
								" LKP_CODE='DESIG' AND "+
								" LKP_SRNO=(select ee.DESIG from EMPTRAN ee where "+
								"			ee.EMPNO=l.EMPNO and ee.SRNO = "+
								"			(select MAX(SRNO) from emptran where empno=l.empno) ) "+
								"order by etran.PRJ_SRNO,l.EMPCODE,l.amt ");
						
					}
					else if((Integer.parseInt(code)==9999))
					{
						code = "999";
						EmpSql=("with lastmonth as"+
								"(SELECT emp.empno,emp.EMPCODE,Rtrim(emp.fname) + ' '+Rtrim(emp.mname) + ' ' + Rtrim(emp.lname) AS name, "+ 
								"emp.salute,T.ACNO, p.net_amt  AS amt FROM   empmast emp ,"+table+"  p,EMPTRAN t "+ 
								"WHERE     emp.empno = p.empno AND emp.EMPNO = t.EMPNO AND p.trncd = '"+code+"' " +
								"AND p.trndt BETWEEN '"+ReportDAO.BOM(rdt)+"' AND '"+ReportDAO.EOM(rdt)+"' and p.NET_AMT >0 AND t.SRNO = (SELECT MAX(SRNO) FROM EMPTRAN WHERE EMPNO = emp.EMPNO) )"+
								
								"SELECT l.*,etran.PRJ_SRNO "+ 
								" FROM   emptran etran , lastmonth  l "+ 
								"WHERE     etran.empno = l.empno AND  "+       
								"etran.srno=(select MAX(SRNO) from emptran where empno=etran.empno) "+
								"order by etran.PRJ_SRNO,l.EMPCODE ");
						code = "9999";
							
					}
					else
					{
				EmpSql=("with lastmonth as"+
						"(SELECT emp.empno,emp.EMPCODE,Rtrim(emp.fname) + ' '+Rtrim(emp.mname) + ' ' + Rtrim(emp.lname) AS name, "+ 
						"emp.salute, p.net_amt  AS amt FROM   empmast emp ,"+table+"  p "+ 
						"WHERE     emp.empno = p.empno AND p.trncd = '"+code+"' " +
						"AND p.trndt BETWEEN '"+ReportDAO.BOM(rdt)+"' AND '"+ReportDAO.EOM(rdt)+"' and p.NET_AMT =0  )"+
						
						"SELECT l.*,etran.PRJ_SRNO "+ 
						" FROM   emptran etran , lastmonth  l "+ 
						"WHERE     etran.empno = l.empno AND  "+       
						"etran.srno=(select MAX(SRNO) from emptran where empno=etran.empno) "+
						"order by etran.PRJ_SRNO,l.EMPCODE ");
					}
				}
				else if(reporttype==3)
				{
					EmpSql=("IF EXISTS(SELECT * FROM PAYTRAN WHERE TRNDT BETWEEN '"+ReportDAO.BOM(rdt)+"' AND '"+ReportDAO.EOM(rdt)+"' AND TRNCD=207) " +
							" SELECT DISTINCT(NET_AMT) as BYAMT,COUNT(*) as TOTALCNT, convert(numeric(10,2),NET_AMT*COUNT(*)) as AMT from paytran " +
							" WHERE TRNDT BETWEEN '"+ReportDAO.BOM(rdt)+"' AND '"+ReportDAO.EOM(rdt)+"' AND TRNCD=207 group by NET_AMT " +
							" ELSE " +
							" SELECT DISTINCT(NET_AMT) as BYAMT,COUNT(*) as TOTALCNT, convert(numeric(10,2),NET_AMT*COUNT(*)) as AMT from PAYTRAN_STAGE " +
							" WHERE TRNDT BETWEEN '"+ReportDAO.BOM(rdt)+"' AND '"+ReportDAO.EOM(rdt)+"' AND TRNCD=207 group by NET_AMT");
				}
				else if(reporttype==2)
				{
					EmpSql=("with lastmonth as"+
							"(SELECT emp.empno,emp.EMPCODE,Rtrim(emp.fname) + ' '+Rtrim(emp.mname) + ' ' + Rtrim(emp.lname) AS name, "+ 
							"emp.salute, p.net_amt  AS amt FROM   empmast emp ,"+table+"  p "+ 
							"WHERE     emp.empno = p.empno AND p.trncd = '"+code+"' " +
							"AND p.trndt BETWEEN '"+ReportDAO.BOM(rdt)+"' AND '"+ReportDAO.EOM(rdt)+"'  )"+
							
							"SELECT l.*,etran.PRJ_SRNO "+ 
							" FROM   emptran etran , lastmonth  l "+ 
							"WHERE     etran.empno = l.empno AND  "+       
							"etran.srno=(select MAX(SRNO) from emptran where empno=etran.empno) "+
							"order by etran.PRJ_SRNO,l.EMPCODE ");
					
				}
				System.out.println(EmpSql);
				emp = st.executeQuery(EmpSql);
				int grandtot=0;
				LookupHandler lkhp = new LookupHandler();
				int tot_no_emp = 0;
				if(emp.next()){
					if(reporttype==1||reporttype==2)
					{
					if(reporttype!=1)
					{
						doc.add(table2);
					}
					emp.previous();
					ResultSet prjsrno=st1.executeQuery(GetBranch);
					while(prjsrno.next())
					{
						
						int srno=1;
						int amt_tot_br=0;
						int brwiseemp=0;
						emp.next();
						branchname=prjsrno.getString("SITE_NAME");
						if(prjsrno.getInt("branch")==emp.getInt("PRJ_SRNO"))
						{
							
							if(reporttype==1){
						para = new Paragraph(new Phrase("Employee List For Branch:- "+prjsrno.getString("SITE_NAME"),new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						para.setAlignment(Element.ALIGN_LEFT);
						para.setSpacingAfter(2);
						doc.add(para);
						doc.add(table1);
							}
							
						}
						emp.previous();
						/*PdfPTable headtab2 = null;*/
						PdfPTable table11=null;
						PdfPTable table12=null;
						if(reporttype==1)
						{
							
									
								if((Integer.parseInt(code)==129)||(Integer.parseInt(code)==9999))
								{
									 table11=new PdfPTable(5);
									 table11.setSpacingBefore(0);
									table11.setWidthPercentage(new float[]{5,8,20,15,12},new Rectangle(60,100));
		
								}
								else
								{
									 table11=new PdfPTable(4);
									 table11.setSpacingBefore(0);
									table11.setWidthPercentage(new float[]{5,8,32,15},new Rectangle(60,100));
			
								}
						
						
						//table11.setWidthPercentage(new float[]{5,8,32,15},new Rectangle(60,100));
						}
						else
						{
							table12=new PdfPTable(7);
							table12.setSpacingBefore(0);
							table12.setWidthPercentage(new float[]{5,20,5,5,5,5,5},new Rectangle(50,100));
						}
					while(emp.next())
					{
						
						if((prjsrno.getInt("branch")==emp.getInt("PRJ_SRNO")))
						{
							if(reporttype==1){
							brwiseemp++;
							PdfPCell c6 = new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,8)));  
							c6.setHorizontalAlignment(Element.ALIGN_CENTER);
							table11.addCell(c6);
							
							PdfPCell c7 = new PdfPCell(new Phrase(""+emp.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8)));  
							c7.setHorizontalAlignment(Element.ALIGN_CENTER);
							table11.addCell(c7);
							
							PdfPCell c8 = new PdfPCell(new Phrase(""+lkhp.getLKP_Desc("SALUTE", emp.getInt("SALUTE"))+" "+emp.getString("name"),new Font(Font.TIMES_ROMAN,8)));
							c8.setHorizontalAlignment(Element.ALIGN_LEFT);
							table11.addCell(c8);
						
							if((Integer.parseInt(code)==129))
							{
								PdfPCell c7d = new PdfPCell(new Phrase(""+emp.getString("DESIG"),new Font(Font.TIMES_ROMAN,8)));  
								c7d.setHorizontalAlignment(Element.ALIGN_CENTER);
								table11.addCell(c7d);
							}
							if((Integer.parseInt(code)==9999))
							{
								PdfPCell c7d = new PdfPCell(new Phrase(""+emp.getString("ACNO"),new Font(Font.TIMES_ROMAN,8)));  
								c7d.setHorizontalAlignment(Element.ALIGN_CENTER);
								table11.addCell(c7d);
							}
							amt_tot_br+=emp.getInt("amt");
							grandtot+=emp.getInt("amt");
							PdfPCell c9= new PdfPCell(new Phrase(""+emp.getString("amt"),new Font(Font.TIMES_ROMAN,8)));
							c9.setHorizontalAlignment(Element.ALIGN_CENTER);
							table11.addCell(c9);
							}
							else
							{
								if((Integer.parseInt(code)==242)&&(Integer.parseInt(ptcode)==2422))
								{
									if(emp.getInt("amt")==0)
									{
										nillcnt++;
									}
									else if(emp.getInt("amt")==10)
									{
										cnt175++;
									}
									else if(emp.getInt("amt")==25)
									{
										cnt200++;
									}
								}
								else{
									if(emp.getInt("amt")==0)
									{
										nillcnt++;
									}
									else if(emp.getInt("amt")==175)
									{
										cnt175++;
									}
									else if(emp.getInt("amt")==200)
									{
										cnt200++;
									}
									else if(emp.getInt("amt")==300)
									{
										cnt300++;
									}
								}
							}
							
							tot_no_emp = tot_no_emp +1;
						}
						else
						{
							if((prjsrno.getInt("branch")!=emp.getInt("PRJ_SRNO")))
							{
								
								do
								{
									prjsrno.next();
								}while(prjsrno.getInt("branch")!=emp.getInt("PRJ_SRNO"));
							prjsrno.previous();
							emp.previous();
							if(reporttype==1){
							doc.add(table11);
							para = new Paragraph(new Phrase("Total Employee:-     "+brwiseemp,new Font(Font.TIMES_ROMAN,9)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(1);
							doc.add(para);
							
							para = new Paragraph(new Phrase("Total Amount:-     "+amt_tot_br,new Font(Font.TIMES_ROMAN,9)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(1);
							
							doc.add(para);
								}
								else
								{
									report2srno++;
									PdfPCell c6 = new PdfPCell(new Phrase(""+report2srno,new Font(Font.TIMES_ROMAN,8)));  
									c6.setHorizontalAlignment(Element.ALIGN_CENTER);
									table12.addCell(c6);
									
									PdfPCell c7 = new PdfPCell(new Phrase(""+branchname,new Font(Font.TIMES_ROMAN,8)));  
									c7.setHorizontalAlignment(Element.ALIGN_LEFT);
									table12.addCell(c7);
									
									PdfPCell c8 = new PdfPCell(new Phrase(""+nillcnt,new Font(Font.TIMES_ROMAN,8)));
									c8.setHorizontalAlignment(Element.ALIGN_CENTER);
									table12.addCell(c8);
								
									PdfPCell c9= new PdfPCell(new Phrase(""+cnt175,new Font(Font.TIMES_ROMAN,8)));
									c9.setHorizontalAlignment(Element.ALIGN_CENTER);
									table12.addCell(c9);
									
									PdfPCell c10= new PdfPCell(new Phrase(""+cnt200,new Font(Font.TIMES_ROMAN,8)));
									c10.setHorizontalAlignment(Element.ALIGN_CENTER);
									table12.addCell(c10);
									
									PdfPCell c11= new PdfPCell(new Phrase(""+cnt300,new Font(Font.TIMES_ROMAN,8)));
									c11.setHorizontalAlignment(Element.ALIGN_CENTER);
									table12.addCell(c11);
									
									PdfPCell c12= new PdfPCell(new Phrase(""+(nillcnt+cnt175+cnt200+cnt300),new Font(Font.TIMES_ROMAN,8)));
									c12.setHorizontalAlignment(Element.ALIGN_CENTER);
									table12.addCell(c12);
									
									doc.add(table12);
									sumnill+=nillcnt;
									sum175+=cnt175;
									sum200+=cnt200;
									sum300+=cnt300;
									nillcnt=cnt175=cnt200=cnt300=0;
								}
							}
							break;
						}
						srno++;

					}
						if(!emp.next())
						{
							if(reporttype==1){
						
							doc.add(table11);
							para = new Paragraph(new Phrase("Total Employee:-     "+brwiseemp,new Font(Font.TIMES_ROMAN,9)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(1);
							doc.add(para);
							para = new Paragraph(new Phrase("Total Amount:-     "+amt_tot_br,new Font(Font.TIMES_ROMAN,9)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(1);
							
							doc.add(para);
						
							}
							else if(reporttype==2)
							{
								report2srno++;
								PdfPCell c6 = new PdfPCell(new Phrase(""+report2srno,new Font(Font.TIMES_ROMAN,8)));  
								c6.setHorizontalAlignment(Element.ALIGN_CENTER);
								table12.addCell(c6);
								
								PdfPCell c7 = new PdfPCell(new Phrase(""+branchname,new Font(Font.TIMES_ROMAN,8)));  
								c7.setHorizontalAlignment(Element.ALIGN_LEFT);
								table12.addCell(c7);
								
								PdfPCell c8 = new PdfPCell(new Phrase(""+nillcnt,new Font(Font.TIMES_ROMAN,8)));
								c8.setHorizontalAlignment(Element.ALIGN_CENTER);
								table12.addCell(c8);
							
								PdfPCell c9= new PdfPCell(new Phrase(""+cnt175,new Font(Font.TIMES_ROMAN,8)));
								c9.setHorizontalAlignment(Element.ALIGN_CENTER);
								table12.addCell(c9);
								
								PdfPCell c10= new PdfPCell(new Phrase(""+cnt200,new Font(Font.TIMES_ROMAN,8)));
								c10.setHorizontalAlignment(Element.ALIGN_CENTER);
								table12.addCell(c10);
								
								PdfPCell c11= new PdfPCell(new Phrase(""+(nillcnt+cnt175+cnt200),new Font(Font.TIMES_ROMAN,8)));
								c11.setHorizontalAlignment(Element.ALIGN_CENTER);
								table12.addCell(c11);
								sumnill+=nillcnt;
								sum175+=cnt175;
								sum200+=cnt200;
								doc.add(table12);
							}
							break;
						}
						else
						{
							emp.previous();
						}
					
					}
					//doc.add(headtab);
					//doc.add(para);
					}
					else if(reporttype==3)
					{
						int totemp=0;
						double totamt=0.0;
						PdfPTable table11=new PdfPTable(4);
						table11.setSpacingBefore(0);
						table11.setWidthPercentage(new float[]{5,8,15,20},new Rectangle(60,100));
						
						emp.previous();
						while(emp.next())
						{
							
							
								PdfPCell c6 = new PdfPCell(new Phrase(""+emp.getString("BYAMT"),new Font(Font.TIMES_ROMAN,8)));  
								c6.setHorizontalAlignment(Element.ALIGN_CENTER);
								c6.setColspan(2);
								table11.addCell(c6);
								
								totemp+=emp.getInt("TOTALCNT");
								PdfPCell c7 = new PdfPCell(new Phrase(""+emp.getString("TOTALCNT"),new Font(Font.TIMES_ROMAN,8)));  
								c7.setHorizontalAlignment(Element.ALIGN_CENTER);
								table11.addCell(c7);
								
								totamt+=emp.getDouble("AMT");
								PdfPCell c8 = new PdfPCell(new Phrase(""+emp.getString("AMT"),new Font(Font.TIMES_ROMAN,8)));
								c8.setHorizontalAlignment(Element.ALIGN_CENTER);
								table11.addCell(c8);
								
								if(!emp.next())
								{
									doc.add(table1);
									PdfPCell c66 = new PdfPCell(new Phrase("                      TOTAL   -                                             "+totemp+"                                                                   "+totamt,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
									//c66.setHorizontalAlignment(Element.ALIGN_CENTER);
									c66.setColspan(4);
									table11.addCell(c66);
									doc.add(table11);	
									break;
									
								}
								else
								{
									emp.previous();
									continue;
									
								}
							
						}
				}
			}
				else{
					System.out.println("no record found");
					PdfPCell c1 = new PdfPCell(new Phrase("Record Not found for the Month:-     "+rdt.substring(3),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
					c1.setColspan(4);
					table1.setSpacingBefore(40);
					table1.addCell(c1);	
					doc.add(table1);
				}
				
				if(reporttype==1){
				para = new Paragraph(new Phrase("Total No Of Employee:-     "+tot_no_emp,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(10);
				doc.add(para);
				para = new Paragraph(new Phrase("Grand Total Amount :-     "+grandtot,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(1);
				doc.add(para);
				}
				else if(reporttype==2)
				{
					PdfPTable table3=new PdfPTable(4);
					table3.setSpacingBefore(5);
					table3.setWidthPercentage(new float[]{10,10,10,10},new Rectangle(40,80));
					PdfPCell cell11=new PdfPCell(new Phrase("SUMMERY",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell11.setColspan(4);
					cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
					table3.addCell(cell11);
					PdfPCell cell111=new PdfPCell(new Phrase(((Integer.parseInt(code)==242)&&(Integer.parseInt(ptcode)==2422))?"NILL UNION AMOUNT TOTAL EMP :- "+sumnill:"NILL PT TOTAL :-  "+sumnill,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					cell111.setHorizontalAlignment(Element.ALIGN_CENTER);
					table3.addCell(cell111);
					PdfPCell cell1111=new PdfPCell(new Phrase(((Integer.parseInt(code)==242)&&(Integer.parseInt(ptcode)==2422))?"10 UNION AMOUNT TOTAL EMP :- "+sum175:"175 PT TOTAL :-  "+sum175,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					cell1111.setHorizontalAlignment(Element.ALIGN_LEFT);
					table3.addCell(cell1111);
					PdfPCell cell11111=new PdfPCell(new Phrase(((Integer.parseInt(code)==242)&&(Integer.parseInt(ptcode)==2422))?"25 UNION AMOUNT TOTAL EMP :- "+sum200:"200 PT TOTAL :-  "+sum200,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					cell11111.setHorizontalAlignment(Element.ALIGN_LEFT);
					table3.addCell(cell11111);
					PdfPCell cell111111=new PdfPCell(new Phrase(((Integer.parseInt(code)==242)&&(Integer.parseInt(ptcode)==2422))?"25 UNION AMOUNT TOTAL EMP :- "+sum300:"300 PT TOTAL :-  "+sum300,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					cell111111.setHorizontalAlignment(Element.ALIGN_LEFT);
					table3.addCell(cell111111);
					doc.add(table3);
				}
				doc.close();
				Cn.close();
				System.out.println("Completed");
			}
			catch(Exception e)
			{
				e.printStackTrace();
			}

		} catch (Exception e) {
			e.printStackTrace();
		} 
	}
	
	
	
	public static void LeaveReport(String empno,String frmdate,String todate,String status,String filepath, String imagepath) 
	{
		RepoartBean repBean  = new RepoartBean();
		Connection Cn = null;
		ResultSet emp = null;
		ResultSet emp1=null;
		String EmpSql = "";
		String EmpSql1 = "";
		int reporttype=0;
		int nillcnt=0;
		int cnt175=0;
		int cnt200=0;
		int sumnill=0;
		int sum175=0;
		int sum200=0;
		int report2srno=0;
		String branchname="";
		ReportDAO.OpenCon("", "", "",repBean);
		Cn = repBean.getCn();
		Statement st=null;
		Statement st1=null;

		
			try {
			st = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			st1 = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);

			try
			{
				Document doc = new Document();
				PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
				doc.open();
				doc.setPageSize(PageSize.A4);

				Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
				Image image1 = Image.getInstance(imagepath);
				Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);

				image1.scaleAbsolute(60f,50f);
				image1.setAbsolutePosition(40f, 750f);

				doc.add(image1);
				doc.add(para);

				para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);

				para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);

				para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);

				
					para = new Paragraph(new Phrase("Leave Report For Employee :-"+empno,new Font(Font.TIMES_ROMAN,5)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(1);
					doc.add(para);
					
					para = new Paragraph(new Phrase("Leave Status :-"+status,new Font(Font.TIMES_ROMAN,5)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(1);
					doc.add(para);
				
				/*String phara = "SELECT LKP_DISC,LKP_SRNO FROM LOOKUP WHERE LKP_CODE='CDTYPE' AND LKP_SRNO!=0 and LKP_SRNO = (select CDTYPE from CDMAST where TRNCD = "+code+") order by LKP_SRNO";
				Statement pa = Cn.createStatement();
				ResultSet par = pa.executeQuery(phara);
				String disp = "";
				int srno = 0;
				if(par.next()){
					disp = par.getString(1);
					srno = par.getInt(2);
				}
				if(srno!=1)
					disp = "DEDUCTION";
				para = new Paragraph(new Phrase(CodeMasterHandler.getCDesc(Integer.parseInt(code))+" "+disp+" Report For Month :" + rdt.substring(3),new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);*/
				String leavequery=""; 
				if(empno.equalsIgnoreCase("ALL"))
				{
					if(status.equalsIgnoreCase("ALL"))
					{
						leavequery=("with a as" +
								"(select * from leavetran where STATUS in('sanction','pending','cancel') and TRNDATE " +
								"between '"+ReportDAO.BOM(frmdate)+"' and '"+ReportDAO.EOM(todate)+"' )" +
								"select e.EMPCODE,e.SALUTE," +
								"rtrim(e.FNAME)+' '+rtrim(e.MNAME)+' '+rtrim(e.LNAME) as EMPNAME,a.*" +
								"from empmast e,a where a.empno=e.EMPNO order by e.EMPNO,a.TRNDATE ");
					}
					else
					{
						leavequery=("with a as" +
								"(select * from leavetran where STATUS='"+status+"' and TRNDATE " +
								"between '"+ReportDAO.BOM(frmdate)+"' and '"+ReportDAO.EOM(todate)+"' )" +
								"select e.EMPCODE,e.SALUTE," +
								"rtrim(e.FNAME)+' '+rtrim(e.MNAME)+' '+rtrim(e.LNAME) as EMPNAME,a.*" +
								"from empmast e,a where a.empno=e.EMPNO order by e.EMPNO,a.TRNDATE ");
					}
				}
				else
				{
					if(status.equalsIgnoreCase("ALL"))
					{
						leavequery=("with a as" +
								"(select * from leavetran where empno="+empno+" and STATUS in('sanction','pending','cancel') and TRNDATE " +
								"between '"+ReportDAO.BOM(frmdate)+"' and '"+ReportDAO.EOM(todate)+"' )" +
								"select e.EMPCODE,e.SALUTE," +
								"rtrim(e.FNAME)+' '+rtrim(e.MNAME)+' '+rtrim(e.LNAME) as EMPNAME,a.*" +
								"from empmast e,a where a.empno=e.EMPNO order by e.EMPNO,a.TRNDATE ");
					}
					else
					{
						leavequery=("with a as" +
								"(select * from leavetran where empno="+empno+" and STATUS='"+status+"' and TRNDATE " +
								"between '"+ReportDAO.BOM(frmdate)+"' and '"+ReportDAO.EOM(todate)+"' )" +
								"select e.EMPCODE,e.SALUTE," +
								"rtrim(e.FNAME)+' '+rtrim(e.MNAME)+' '+rtrim(e.LNAME) as EMPNAME,a.*" +
								"from empmast e,a where a.empno=e.EMPNO order by e.EMPNO,a.TRNDATE ");
					}
				}
				Rectangle rec = new  Rectangle(60,100);
				Rectangle rec1 = new  Rectangle(50,100);
				/*PdfPTable headtab = null;

				headtab= new PdfPTable(4);	
				headtab.setSpacingBefore(3);
				headtab.setWidthPercentage(new float[]{5,8,32,15}, rec);
				headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
				headtab.setSpacingBefore(10);*/
				
				
				/*}
				else
				{
					//do for categorywise pt list..aniket
					
					table2.setSpacingBefore(0);
					table2.setWidthPercentage(new float[]{5,20,5,5,5,10},rec1);
					PdfPCell cell11=new PdfPCell(new Phrase("SRNO",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
					table2.addCell(cell11);
					PdfPCell cell111=new PdfPCell(new Phrase("BRANCH NAME",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell111.setHorizontalAlignment(Element.ALIGN_CENTER);
					table2.addCell(cell111);
					PdfPCell cell1111=new PdfPCell(new Phrase("NILL",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell1111.setHorizontalAlignment(Element.ALIGN_CENTER);
					table2.addCell(cell1111);
					PdfPCell cell11111=new PdfPCell(new Phrase("175",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell11111.setHorizontalAlignment(Element.ALIGN_CENTER);
					table2.addCell(cell11111);
					PdfPCell cell111111=new PdfPCell(new Phrase("200",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell111111.setHorizontalAlignment(Element.ALIGN_CENTER);
					table2.addCell(cell111111);
					PdfPCell cell1111111=new PdfPCell(new Phrase("TOTAL",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell1111111.setHorizontalAlignment(Element.ALIGN_CENTER);
					table2.addCell(cell1111111);
					
						
					
				}
				

				String GetBranch = "SELECT "+
						"distinct T.prj_srno as branch,PS.SITE_NAME "+
						"FROM   empmast EMP,"+
						"emptran T,Project_Sites PS "+
						"WHERE  T.empno = EMP.empno  and PS.SITE_ID = T.prj_srno "+
						"AND T.srno = (SELECT Max(E2.srno)  "+
						"FROM   emptran E2 "+
						"WHERE  E2.empno = EMP.empno) "+
						"ORDER  BY T.prj_srno";  
	
				
				
				//..@ni
				if(((Integer.parseInt(code)==202)&&(Integer.parseInt(ptcode)==202))||((Integer.parseInt(code)==999)))
				{
				EmpSql=("with lastmonth as"+
						"(SELECT emp.empno,emp.EMPCODE,Rtrim(emp.fname) + ' '+Rtrim(emp.mname) + ' ' + Rtrim(emp.lname) AS name, "+ 
						"emp.salute, p.net_amt  AS amt FROM   empmast emp ,"+table+"  p "+ 
						"WHERE     emp.empno = p.empno AND p.trncd = '"+code+"' " +
						"AND p.trndt BETWEEN '"+ReportDAO.BOM(rdt)+"' AND '"+ReportDAO.EOM(rdt)+"' and p.NET_AMT =0  )"+
						
						"SELECT l.*,etran.PRJ_SRNO "+ 
						" FROM   emptran etran , lastmonth  l "+ 
						"WHERE     etran.empno = l.empno AND  "+       
						"etran.srno=(select MAX(SRNO) from emptran where empno=etran.empno) "+
						"order by etran.PRJ_SRNO,l.EMPCODE ");
				
				}
				else if(((Integer.parseInt(code)==202)&&((Integer.parseInt(ptcode)==2022))))
				{
					EmpSql=("with lastmonth as"+
							"(SELECT emp.empno,emp.EMPCODE,Rtrim(emp.fname) + ' '+Rtrim(emp.mname) + ' ' + Rtrim(emp.lname) AS name, "+ 
							"emp.salute, p.net_amt  AS amt FROM   empmast emp ,"+table+"  p "+ 
							"WHERE     emp.empno = p.empno AND p.trncd = '"+code+"' " +
							"AND p.trndt BETWEEN '"+ReportDAO.BOM(rdt)+"' AND '"+ReportDAO.EOM(rdt)+"'  )"+
							
							"SELECT l.*,etran.PRJ_SRNO "+ 
							" FROM   emptran etran , lastmonth  l "+ 
							"WHERE     etran.empno = l.empno AND  "+       
							"etran.srno=(select MAX(SRNO) from emptran where empno=etran.empno) "+
							"order by etran.PRJ_SRNO,l.EMPCODE ");
					
				}
*/				System.out.println(leavequery);
				emp = st.executeQuery(leavequery);
				PdfPTable table2=new PdfPTable(6);
				LookupHandler lkhp = new LookupHandler();
				int tot_no_emp = 0;
				if(emp.next()){
					int srno=1;
					PdfPTable table1=new PdfPTable(7);
					
					//if(reporttype==1){
					
					table1.setSpacingBefore(2);
					table1.setWidthPercentage(new float[]{6,10,30,25,13,13,10},new Rectangle(107,107));
					PdfPCell cell11=new PdfPCell(new Phrase("SRNO",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
					table1.addCell(cell11);
					PdfPCell cell111=new PdfPCell(new Phrase("EMPCODE",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell111.setHorizontalAlignment(Element.ALIGN_CENTER);
					table1.addCell(cell111);
					PdfPCell cell1111=new PdfPCell(new Phrase("EMPLOYEE NAME",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell1111.setHorizontalAlignment(Element.ALIGN_LEFT);
					table1.addCell(cell1111);
					PdfPCell cell11111=new PdfPCell(new Phrase("LEAVE REASON",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell11111.setHorizontalAlignment(Element.ALIGN_CENTER);
					table1.addCell(cell11111);
					PdfPCell cell11111f=new PdfPCell(new Phrase("FROMDATE",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell11111f.setHorizontalAlignment(Element.ALIGN_CENTER);
					table1.addCell(cell11111f);
					PdfPCell cell11111t=new PdfPCell(new Phrase("TODATE",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell11111t.setHorizontalAlignment(Element.ALIGN_CENTER);
					table1.addCell(cell11111t);
					PdfPCell cell11111s=new PdfPCell(new Phrase("STATUS",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell11111s.setHorizontalAlignment(Element.ALIGN_CENTER);
					table1.addCell(cell11111s);
					/*if(reporttype!=1)
					{
						doc.add(table2);
					}
					emp.previous();
					ResultSet prjsrno=st1.executeQuery(GetBranch);
					while(prjsrno.next())
					{
						
						int srno=1;
						int brwiseemp=0;
						emp.next();
						branchname=prjsrno.getString("SITE_NAME");
						if(prjsrno.getInt("branch")==emp.getInt("PRJ_SRNO"))
						{
							
							if(reporttype==1){
						para = new Paragraph(new Phrase("Employee List For Branch:- "+prjsrno.getString("SITE_NAME"),new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						para.setAlignment(Element.ALIGN_LEFT);
						para.setSpacingAfter(2);
						doc.add(para);
						doc.add(table1);
							}
							
						}
						emp.previous();
						PdfPTable headtab2 = null;
						PdfPTable table11=new PdfPTable(4);
						PdfPTable table12=new PdfPTable(6);
						if(reporttype==1){
						
						table11.setSpacingBefore(0);
						table11.setWidthPercentage(new float[]{5,8,32,15},new Rectangle(60,100));
						}
						else
						{
							
							table12.setSpacingBefore(0);
							table12.setWidthPercentage(new float[]{5,20,5,5,5,10},new Rectangle(50,100));
						}*/
					emp.previous();
					while(emp.next())
					{
						
						/*if((prjsrno.getInt("branch")==emp.getInt("PRJ_SRNO")))
						{
							if(reporttype==1){
							brwiseemp++;*/
							PdfPCell c6 = new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,8)));  
							c6.setHorizontalAlignment(Element.ALIGN_CENTER);
							table1.addCell(c6);
							
							PdfPCell c7 = new PdfPCell(new Phrase(""+emp.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8)));  
							c7.setHorizontalAlignment(Element.ALIGN_CENTER);
							table1.addCell(c7);
							
							PdfPCell c8 = new PdfPCell(new Phrase(""+lkhp.getLKP_Desc("SALUTE", emp.getInt("SALUTE"))+" "+emp.getString("EMPNAME"),new Font(Font.TIMES_ROMAN,8)));
							c8.setHorizontalAlignment(Element.ALIGN_LEFT);
							table1.addCell(c8);
						
							PdfPCell c9= new PdfPCell(new Phrase(""+emp.getString("LREASON"),new Font(Font.TIMES_ROMAN,8)));
							c9.setHorizontalAlignment(Element.ALIGN_CENTER);
							table1.addCell(c9);
					
							PdfPCell c10= new PdfPCell(new Phrase(""+emp.getString("FRMDT"),new Font(Font.TIMES_ROMAN,8)));
							c10.setHorizontalAlignment(Element.ALIGN_CENTER);
							table1.addCell(c10);
							
							PdfPCell c11= new PdfPCell(new Phrase(""+emp.getString("TODT"),new Font(Font.TIMES_ROMAN,8)));
							c11.setHorizontalAlignment(Element.ALIGN_CENTER);
							table1.addCell(c11);
							
							PdfPCell c12= new PdfPCell(new Phrase(""+emp.getString("STATUS"),new Font(Font.TIMES_ROMAN,8)));
							c12.setHorizontalAlignment(Element.ALIGN_CENTER);
							table1.addCell(c12);
							srno++;
					/*}
							else
							{
								if(emp.getInt("amt")==0)
								{
									nillcnt++;
								}
								else if(emp.getInt("amt")==175)
								{
									cnt175++;
								}
								else if(emp.getInt("amt")==200)
								{
									cnt200++;
								}
								
							}
							
							tot_no_emp = tot_no_emp +1;
						}
						else
						{
							if((prjsrno.getInt("branch")!=emp.getInt("PRJ_SRNO")))
							{
								
								do
								{
									prjsrno.next();
								}while(prjsrno.getInt("branch")!=emp.getInt("PRJ_SRNO"));
							prjsrno.previous();
							emp.previous();
							if(reporttype==1){
							para = new Paragraph(new Phrase("Total Employee:-     "+brwiseemp,new Font(Font.TIMES_ROMAN,9)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(1);
							doc.add(table11);
							doc.add(para);
								}
								else
								{
									report2srno++;
									PdfPCell c6 = new PdfPCell(new Phrase(""+report2srno,new Font(Font.TIMES_ROMAN,8)));  
									c6.setHorizontalAlignment(Element.ALIGN_CENTER);
									table12.addCell(c6);
									
									PdfPCell c7 = new PdfPCell(new Phrase(""+branchname,new Font(Font.TIMES_ROMAN,8)));  
									c7.setHorizontalAlignment(Element.ALIGN_LEFT);
									table12.addCell(c7);
									
									PdfPCell c8 = new PdfPCell(new Phrase(""+nillcnt,new Font(Font.TIMES_ROMAN,8)));
									c8.setHorizontalAlignment(Element.ALIGN_CENTER);
									table12.addCell(c8);
								
									PdfPCell c9= new PdfPCell(new Phrase(""+cnt175,new Font(Font.TIMES_ROMAN,8)));
									c9.setHorizontalAlignment(Element.ALIGN_CENTER);
									table12.addCell(c9);
									
									PdfPCell c10= new PdfPCell(new Phrase(""+cnt200,new Font(Font.TIMES_ROMAN,8)));
									c10.setHorizontalAlignment(Element.ALIGN_CENTER);
									table12.addCell(c10);
									
									PdfPCell c11= new PdfPCell(new Phrase(""+(nillcnt+cnt175+cnt200),new Font(Font.TIMES_ROMAN,8)));
									c11.setHorizontalAlignment(Element.ALIGN_CENTER);
									table12.addCell(c11);
									
									doc.add(table12);
									sumnill+=nillcnt;
									sum175+=cnt175;
									sum200+=cnt200;
									nillcnt=cnt175=cnt200=0;
								}
							}
							break;
						}
						srno++;

					}*/
						if(!emp.next())
						{
							/*if(reporttype==1){*/
						
							/*doc.add(table11);*/
							/*para = new Paragraph(new Phrase("Total Employee:-     "+brwiseemp,new Font(Font.TIMES_ROMAN,9)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(1);*/
							doc.add(table1);
							break;
						}
							else
							{
								/*report2srno++;
								PdfPCell c6 = new PdfPCell(new Phrase(""+report2srno,new Font(Font.TIMES_ROMAN,8)));  
								c6.setHorizontalAlignment(Element.ALIGN_CENTER);
								table12.addCell(c6);
								
								PdfPCell c7 = new PdfPCell(new Phrase(""+branchname,new Font(Font.TIMES_ROMAN,8)));  
								c7.setHorizontalAlignment(Element.ALIGN_LEFT);
								table12.addCell(c7);
								
								PdfPCell c8 = new PdfPCell(new Phrase(""+nillcnt,new Font(Font.TIMES_ROMAN,8)));
								c8.setHorizontalAlignment(Element.ALIGN_CENTER);
								table12.addCell(c8);
							
								PdfPCell c9= new PdfPCell(new Phrase(""+cnt175,new Font(Font.TIMES_ROMAN,8)));
								c9.setHorizontalAlignment(Element.ALIGN_CENTER);
								table12.addCell(c9);
								
								PdfPCell c10= new PdfPCell(new Phrase(""+cnt200,new Font(Font.TIMES_ROMAN,8)));
								c10.setHorizontalAlignment(Element.ALIGN_CENTER);
								table12.addCell(c10);
								
								PdfPCell c11= new PdfPCell(new Phrase(""+(nillcnt+cnt175+cnt200),new Font(Font.TIMES_ROMAN,8)));
								c11.setHorizontalAlignment(Element.ALIGN_CENTER);
								table12.addCell(c11);
								sumnill+=nillcnt;
								sum175+=cnt175;
								sum200+=cnt200;
								doc.add(table12);*/
								emp.previous();
								continue;
							}
							/*break;
						}
						else
						{
							emp.previous();
						}
					
					}*/
					//doc.add(headtab);
					//doc.add(para);
					}	
				}
				else{
					System.out.println("no record found");
					table2.setSpacingBefore(0);
					table2.setWidthPercentage(new float[]{3,6,31,21,8,8},new Rectangle(77,100));
					PdfPCell c1 = new PdfPCell(new Phrase("Record Not found for the Month:-     "+ReportDAO.BOM(frmdate)+" To "+ReportDAO.EOM(todate),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
					c1.setColspan(6);
					table2.setSpacingBefore(40);
					table2.addCell(c1);	
					doc.add(table2);
				}
				
				/*if(reporttype==1){
				para = new Paragraph(new Phrase("Total No Of Employee:-     "+tot_no_emp,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(10);
				doc.add(para);
				}
				else
				{
					PdfPTable table3=new PdfPTable(3);
					table3.setSpacingBefore(5);
					table3.setWidthPercentage(new float[]{10,10,10},new Rectangle(30,60));
					PdfPCell cell11=new PdfPCell(new Phrase("SUMMERY",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell11.setColspan(3);
					cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
					table3.addCell(cell11);
					PdfPCell cell111=new PdfPCell(new Phrase("NILL PT TOTAL -  "+sumnill,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell111.setHorizontalAlignment(Element.ALIGN_CENTER);
					table3.addCell(cell111);
					PdfPCell cell1111=new PdfPCell(new Phrase("175 PT TOTAL -  "+sum175,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell1111.setHorizontalAlignment(Element.ALIGN_LEFT);
					table3.addCell(cell1111);
					PdfPCell cell11111=new PdfPCell(new Phrase("200 PT TOTAL -  "+sum200,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell11111.setHorizontalAlignment(Element.ALIGN_LEFT);
					table3.addCell(cell11111);
					doc.add(table3);
				}*/
				doc.close();
				Cn.close();
				System.out.println("Completed");
			}
			catch(Exception e)
			{
				e.printStackTrace();
			}

		} catch (Exception e) {
			e.printStackTrace();
		} 
	}
	
	
	public static void LessSalaryReport(String frmdate,String filepath, String imagepath) 
	{
		RepoartBean repBean  = new RepoartBean();
		Connection Cn = null;
		ResultSet emp = null;
		ResultSet emp1=null;
		String EmpSql = "";
		String EmpSql1 = "";
		float totgross=0.0f;
		float sal25=0.0f;
		float netsal=0.0f;
		float diffsal=0.0f;
		float oldsostot=0.0f;
		float newsostot=0.0f;
		String branchname="";
		ReportDAO.OpenCon("", "", "",repBean);
		Cn = repBean.getCn();
		Statement st=null;
		Statement st1=null;

		
			try {
			st = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			st1 = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);

			try
			{
				Document doc = new Document();
				PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
				doc.open();
				doc.setPageSize(PageSize.A4);

				Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
				Image image1 = Image.getInstance(imagepath);
				Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);

				image1.scaleAbsolute(60f,50f);
				image1.setAbsolutePosition(40f, 750f);

				doc.add(image1);
				doc.add(para);

				para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);

				para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);

				para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);

				
				para = new Paragraph(new Phrase("Employee List for Net Salary Less than 25 % of Gross Salary of  :- "+ReportDAO.BOM(frmdate)+" to "+ReportDAO.EOM(frmdate)+" " ,new Font(Font.TIMES_ROMAN,5)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(1);
				doc.add(para);
					
					
				String lesssalquery=("if exists(select * from paytran where TRNDT between '"+ReportDAO.BOM(frmdate)+"' and '"+ReportDAO.EOM(frmdate)+"')" +
						" select e.SALUTE,e.EMPNO,e.EMPCODE,rtrim(e.FNAME)+' '+RTRIM(e.MNAME)+' '+RTRIM(e.LNAME) as NAME,p.INP_AMT as GROSS_SAL,(select convert(numeric(10,2),((p.inp_amt/100)*25) ))as SAL25,(select desig from emptran where empno=p.empno and srno=(select max(srno) from emptran where empno=p.empno))as DESIG,p.NET_AMT as NETSAL,(select convert(numeric(10,2),(((p.inp_amt/100)*25)-p.NET_AMT ))) as SAL25_NETSAL,(select convert(numeric(10,2),(NET_AMT) ) from paytran where TRNCD=206 and EMPNO=p.EMPNO and TRNDT between '"+ReportDAO.BOM(frmdate)+"' and '"+ReportDAO.EOM(frmdate)+"') as SOCIETY  from paytran p,empmast e where p.EMPNO in" +
						" (select distinct empno from paytran where empno=p.empno and NET_AMT < ((inp_amt/100)*25) and TRNCD=999 and TRNDT between '"+ReportDAO.BOM(frmdate)+"' and '"+ReportDAO.EOM(frmdate)+"') and p.TRNCD=999 and TRNDT between '"+ReportDAO.BOM(frmdate)+"' and '"+ReportDAO.EOM(frmdate)+"' and e.EMPNO=p.EMPNO order by e.EMPCODE" +
						" else " +
						" select e.SALUTE,e.EMPNO,e.EMPCODE,rtrim(e.FNAME)+' '+RTRIM(e.MNAME)+' '+RTRIM(e.LNAME) as NAME,p.INP_AMT as GROSS_SAL,(select convert(numeric(10,2),((p.inp_amt/100)*25) ))as SAL25,(select desig from emptran where empno=p.empno and srno=(select max(srno) from emptran where empno=p.empno))as DESIG,p.NET_AMT as NETSAL,(select convert(numeric(10,2),(((p.inp_amt/100)*25)-p.NET_AMT))) as SAL25_NETSAL,(select convert(numeric(10,2),(NET_AMT) ) from paytran_stage where TRNCD=206 and EMPNO=p.EMPNO and TRNDT between '"+ReportDAO.BOM(frmdate)+"' and '"+ReportDAO.EOM(frmdate)+"') as SOCIETY  from PAYTRAN_STAGE  p,empmast e where p.EMPNO in" +
						" (select distinct empno from paytran_stage where empno=p.empno and NET_AMT < ((inp_amt/100)*25) and TRNCD=999 and TRNDT between '"+ReportDAO.BOM(frmdate)+"' and '"+ReportDAO.EOM(frmdate)+"') and TRNCD=999 and TRNDT between '"+ReportDAO.BOM(frmdate)+"' and '"+ReportDAO.EOM(frmdate)+"' and e.EMPNO=p.EMPNO order by e.EMPCODE");
					
				Rectangle rec = new  Rectangle(60,100);
				Rectangle rec1 = new  Rectangle(50,100);
				
				System.out.println(lesssalquery);
				emp = st.executeQuery(lesssalquery);
				PdfPTable table2=new PdfPTable(6);
				LookupHandler lkhp = new LookupHandler();
				int tot_no_emp = 0;
				if(emp.next()){
					int srno=1;
					PdfPTable table1=new PdfPTable(10);
					
				
					table1.setSpacingBefore(2);
					table1.setWidthPercentage(new float[]{10,16,30,15,15,15,15,15,15,15},new Rectangle(161,200));
					PdfPCell cell11=new PdfPCell(new Phrase("SRNO",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
					table1.addCell(cell11);
					PdfPCell cell111=new PdfPCell(new Phrase("EMPCODE",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					cell111.setHorizontalAlignment(Element.ALIGN_CENTER);
					table1.addCell(cell111);
					PdfPCell cell1111=new PdfPCell(new Phrase("EMPLOYEE NAME",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					cell1111.setHorizontalAlignment(Element.ALIGN_LEFT);
					table1.addCell(cell1111);
					PdfPCell cell11111=new PdfPCell(new Phrase("DESIG",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					cell11111.setHorizontalAlignment(Element.ALIGN_CENTER);
					table1.addCell(cell11111);
					PdfPCell cell11111f=new PdfPCell(new Phrase("GROSS",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					cell11111f.setHorizontalAlignment(Element.ALIGN_CENTER);
					table1.addCell(cell11111f);
					PdfPCell cell11111t=new PdfPCell(new Phrase("25%SAL",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					cell11111t.setHorizontalAlignment(Element.ALIGN_CENTER);
					table1.addCell(cell11111t);
					PdfPCell cell11111s=new PdfPCell(new Phrase("NETSAL",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					cell11111s.setHorizontalAlignment(Element.ALIGN_CENTER);
					table1.addCell(cell11111s);
					PdfPCell cell11111s1=new PdfPCell(new Phrase("25%SAL-NETSAL",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					cell11111s1.setHorizontalAlignment(Element.ALIGN_CENTER);
					table1.addCell(cell11111s1);
					PdfPCell cell11111s2=new PdfPCell(new Phrase("SOCIETY",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					cell11111s2.setHorizontalAlignment(Element.ALIGN_CENTER);
					table1.addCell(cell11111s2);
					PdfPCell cell11111s3=new PdfPCell(new Phrase("NEW SOCIETY",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					cell11111s3.setHorizontalAlignment(Element.ALIGN_CENTER);
					table1.addCell(cell11111s3);
					
					emp.previous();
					while(emp.next())
					{
						
						/*if((prjsrno.getInt("branch")==emp.getInt("PRJ_SRNO")))
						{
							if(reporttype==1){
							brwiseemp++;*/
							PdfPCell c6 = new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,8)));  
							c6.setHorizontalAlignment(Element.ALIGN_CENTER);
							table1.addCell(c6);
							
							PdfPCell c7 = new PdfPCell(new Phrase(""+emp.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8)));  
							c7.setHorizontalAlignment(Element.ALIGN_CENTER);
							table1.addCell(c7);
							
							PdfPCell c8 = new PdfPCell(new Phrase(""+lkhp.getLKP_Desc("SALUTE", emp.getInt("SALUTE"))+" "+emp.getString("NAME"),new Font(Font.TIMES_ROMAN,8)));
							c8.setHorizontalAlignment(Element.ALIGN_LEFT);
							table1.addCell(c8);
						
							PdfPCell c9= new PdfPCell(new Phrase(""+lkhp.getLKP_Desc("DESIG", emp.getInt("DESIG")),new Font(Font.TIMES_ROMAN,8)));
							c9.setHorizontalAlignment(Element.ALIGN_CENTER);
							table1.addCell(c9);
					
							PdfPCell c10= new PdfPCell(new Phrase(""+emp.getString("GROSS_SAL"),new Font(Font.TIMES_ROMAN,8)));
							c10.setHorizontalAlignment(Element.ALIGN_CENTER);
							table1.addCell(c10);
							
							PdfPCell c11= new PdfPCell(new Phrase(""+emp.getString("SAL25"),new Font(Font.TIMES_ROMAN,8)));
							c11.setHorizontalAlignment(Element.ALIGN_CENTER);
							table1.addCell(c11);
							
							PdfPCell c12= new PdfPCell(new Phrase(""+emp.getString("NETSAL"),new Font(Font.TIMES_ROMAN,8)));
							c12.setHorizontalAlignment(Element.ALIGN_CENTER);
							table1.addCell(c12);
							
							PdfPCell c13= new PdfPCell(new Phrase(""+emp.getString("SAL25_NETSAL"),new Font(Font.TIMES_ROMAN,8)));
							c13.setHorizontalAlignment(Element.ALIGN_CENTER);
							table1.addCell(c13);
							
							PdfPCell c14= new PdfPCell(new Phrase(""+emp.getString("SOCIETY"),new Font(Font.TIMES_ROMAN,8)));
							c14.setHorizontalAlignment(Element.ALIGN_CENTER);
							table1.addCell(c14);
							
							float newsos=emp.getFloat("SOCIETY")-emp.getFloat("SAL25_NETSAL");
							newsos=newsos<0?0:newsos;
							PdfPCell c15= new PdfPCell(new Phrase(""+newsos,new Font(Font.TIMES_ROMAN,8)));
							c15.setHorizontalAlignment(Element.ALIGN_CENTER);
							table1.addCell(c15);
							
							totgross+=emp.getFloat("GROSS_SAL");
							sal25+=emp.getFloat("SAL25");
							netsal+=emp.getFloat("NETSAL");
							diffsal+=emp.getFloat("SAL25_NETSAL");
							oldsostot+=emp.getFloat("SOCIETY");
							newsostot+=newsos;
							newsos=0;
					
						if(!emp.next())
						{
							doc.add(table1);
							PdfPTable table3=new PdfPTable(10);
							table3.setWidthPercentage(new float[]{10,16,30,15,15,15,15,15,15,15},new Rectangle(161,200));
							PdfPCell c1 = new PdfPCell(new Phrase("TOTAL EMPLOYEE :-"+srno,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
							c1.setColspan(4);
							table3.setSpacingBefore(30);
							table3.addCell(c1);	
							PdfPCell c1g = new PdfPCell(new Phrase(""+totgross,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
							table3.addCell(c1g);
							PdfPCell c1s = new PdfPCell(new Phrase(""+sal25,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
							table3.addCell(c1s);
							PdfPCell c1n = new PdfPCell(new Phrase(""+netsal,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
							table3.addCell(c1n);
							PdfPCell c1d = new PdfPCell(new Phrase(""+diffsal,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
							table3.addCell(c1d);
							PdfPCell c1o = new PdfPCell(new Phrase(""+oldsostot,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
							table3.addCell(c1o);
							PdfPCell c1os = new PdfPCell(new Phrase(""+newsostot,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
							table3.addCell(c1os);
							doc.add(table3);
							
							break;
						}
							else
							{
								srno++;
								emp.previous();
								continue;
							}
							
					}	
				}
				else{
					System.out.println("no record found");
					table2.setSpacingBefore(0);
					table2.setWidthPercentage(new float[]{3,6,31,21,8,8},new Rectangle(77,100));
					PdfPCell c1 = new PdfPCell(new Phrase("Record Not found for the Month:-     "+ReportDAO.BOM(frmdate)+" To "+ReportDAO.EOM(frmdate),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
					c1.setColspan(6);
					table2.setSpacingBefore(40);
					table2.addCell(c1);	
					doc.add(table2);
				}
				
				
				doc.close();
				Cn.close();
				System.out.println("Completed");
			}
			catch(Exception e)
			{
				e.printStackTrace();
			}

		} catch (Exception e) {
			e.printStackTrace();
		} 
	}
	public static void StaffSalaryDetailsReport(String empno,String enamecode,String frmdate,String filepath, String imagepath) 
	{
		RepoartBean repBean  = new RepoartBean();
		Connection Cn = null;
		ResultSet emp = null;
		ResultSet emp1=null;
		String EmpSql = "";
		String EmpSql1 = "";
		float totgross=0.0f;
		float totded=0.0f;
		ReportDAO.OpenCon("", "", "",repBean);
		Cn = repBean.getCn();
		Statement st=null;
		Statement st1=null;
		Statement st2=null;
		Statement st3=null;
		DecimalFormat formatter = new DecimalFormat("#0.00");
		
			try {
			st = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			st1 = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			st2 = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			st3 = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);

			try
			{
				Document doc = new Document();
				PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
				doc.open();
				doc.setPageSize(PageSize.A4);

				Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
				Image image1 = Image.getInstance(imagepath);
				Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,10,Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);

				image1.scaleAbsolute(60f,50f);
				image1.setAbsolutePosition(30f, 750f);

				doc.add(image1);
				doc.add(para);

				para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);

				para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);

				para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);

				
				para = new Paragraph(new Phrase("Staff Salary Details :-  "+enamecode+" " ,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(1);
				doc.add(para);
				
				para = new Paragraph(new Phrase("Date :- "+ReportDAO.getSysDate()+" " ,new Font(Font.TIMES_ROMAN,10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(5);
				doc.add(para);
					
					
				String empquery=("SELECT E.SALUTE,E.EMPCODE,RTRIM(E.FNAME)+' '+RTRIM(E.MNAME)+' '+RTRIM(E.LNAME) AS NAME, " +
						" L.LKP_DISC AS DESIG,E.DOB,E.DOJ,isnull(E.CONFIRMATIONDATE,E.DOJ)CONFRMDATE,(select isnull(E.RETIREMENT_EXT_PERIOD,dateadd(day,-1,(SELECT  Dateadd(year, 58, E.dob))))) AS RETIREMENT, " +
						" (select isnull(DATEDIFF(mm,getdate(),convert(date,(select dateadd(day,-1,(SELECT  Dateadd(year, 58, E.dob))))))/12,0)) as YEAR, " +
						" (select isnull(DATEDIFF(mm,getdate(),convert(date,(select dateadd(day,-1,(SELECT  Dateadd(year, 58, E.dob))))))%12,0)) as MONTH, " +
						" (select isnull(DATEDIFF(dd,getdate(),convert(date,(select retirementdate from empmast where EMPNO="+empno+"))),0) )as DAY, " +
						" P.SITE_NAME FROM EMPMAST E,EMPTRAN ET,PROJECT_SITES P,LOOKUP L " +
						" WHERE E.EMPNO="+empno+" AND E.EMPNO=ET.EMPNO AND " +
						" ET.SRNO=(SELECT MAX(SRNO) FROM EMPTRAN WHERE EMPNO="+empno+") AND " +
						" P.SITE_ID=(SELECT PRJ_SRNO FROM EMPTRAN WHERE SRNO=(SELECT MAX(SRNO) FROM EMPTRAN WHERE EMPNO="+empno+")AND EMPNO="+empno+") AND " +
						" L.LKP_SRNO=(SELECT DESIG FROM EMPTRAN WHERE SRNO=(SELECT MAX(SRNO) FROM EMPTRAN WHERE EMPNO="+empno+")AND EMPNO="+empno+") AND " +
						" L.LKP_CODE='DESIG' ");
				
				
				String earnquery=("IF EXISTS(SELECT * FROM PAYTRAN WHERE EMPNO="+empno+" AND TRNDT BETWEEN '"+ReportDAO.BOM(frmdate)+"' AND '"+ReportDAO.EOM(frmdate)+"') " +
						" SELECT C.DISC,P.* FROM CDMAST C,PAYTRAN P WHERE EMPNO="+empno+" AND C.TRNCD=P.TRNCD AND C.TRNCD BETWEEN 101 AND 197 AND C.PSLIPYN='Y'  AND TRNDT BETWEEN '"+ReportDAO.BOM(frmdate)+"' AND '"+ReportDAO.EOM(frmdate)+"' ORDER BY C.TRNCD " +
						" ELSE " +
						"SELECT C.DISC,P.* FROM CDMAST C,PAYTRAN_STAGE P WHERE EMPNO="+empno+" AND C.TRNCD=P.TRNCD AND C.TRNCD BETWEEN 101 AND 197  AND  C.PSLIPYN='Y' AND TRNDT BETWEEN '"+ReportDAO.BOM(frmdate)+"' AND '"+ReportDAO.EOM(frmdate)+"' ORDER BY C.TRNCD ");
				
				String dedquery=("IF EXISTS(SELECT * FROM PAYTRAN WHERE EMPNO="+empno+" AND TRNDT BETWEEN '"+ReportDAO.BOM(frmdate)+"' AND '"+ReportDAO.EOM(frmdate)+"') " +
						" SELECT C.DISC,P.* FROM CDMAST C,PAYTRAN P WHERE EMPNO="+empno+" AND C.TRNCD=P.TRNCD AND C.TRNCD BETWEEN 201 AND 299 AND C.PSLIPYN='Y'  AND TRNDT BETWEEN '"+ReportDAO.BOM(frmdate)+"' AND '"+ReportDAO.EOM(frmdate)+"' ORDER BY C.TRNCD " +
						" ELSE " +
						"SELECT C.DISC,P.* FROM CDMAST C,PAYTRAN_STAGE P WHERE EMPNO="+empno+" AND C.TRNCD=P.TRNCD AND C.TRNCD BETWEEN 201 AND 299  AND  C.PSLIPYN='Y' AND TRNDT BETWEEN '"+ReportDAO.BOM(frmdate)+"' AND '"+ReportDAO.EOM(frmdate)+"' ORDER BY C.TRNCD ");
				
				
					
				Rectangle rec = new  Rectangle(60,100);
				Rectangle rec1 = new  Rectangle(50,100);
				
				System.out.println(empquery);
				emp = st.executeQuery(empquery);
				PdfPTable table2=new PdfPTable(6);
				LookupHandler lkhp = new LookupHandler();
				int tot_no_emp = 0;
				if(emp.next()){
					int srno=1;
					PdfPTable table1=new PdfPTable(6);
					
				
					table1.setSpacingBefore(2);
					table1.setWidthPercentage(new float[]{10,15,13,15,17,30},new Rectangle(100,100));
					PdfPCell cell11=new PdfPCell(new Phrase("SRNO",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
					cell11.setColspan(1);
					table1.addCell(cell11);
					PdfPCell cell111=new PdfPCell(new Phrase("DESCRIPTION",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell111.setHorizontalAlignment(Element.ALIGN_CENTER);
					cell111.setColspan(3);
					table1.addCell(cell111);
					PdfPCell cell1111=new PdfPCell(new Phrase("DETAILS",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					cell1111.setHorizontalAlignment(Element.ALIGN_CENTER);
					cell1111.setColspan(2);
					table1.addCell(cell1111);
					
					
					emp.previous();
					while(emp.next())
					{
						
						
							PdfPCell c6 = new PdfPCell(new Phrase(""+1,new Font(Font.TIMES_ROMAN,10)));  
							c6.setHorizontalAlignment(Element.ALIGN_CENTER);
							c6.setColspan(1);
							table1.addCell(c6);
							
							PdfPCell c7 = new PdfPCell(new Phrase("EMPLOYEE NAME",new Font(Font.TIMES_ROMAN,10)));  
							c7.setHorizontalAlignment(Element.ALIGN_LEFT);
							c7.setColspan(3);
							table1.addCell(c7);
							
							PdfPCell c8 = new PdfPCell(new Phrase(""+lkhp.getLKP_Desc("SALUTE", emp.getInt("SALUTE"))+" "+emp.getString("NAME"),new Font(Font.TIMES_ROMAN,10)));
							c8.setHorizontalAlignment(Element.ALIGN_CENTER);
							c8.setColspan(2);
							table1.addCell(c8);
						
							PdfPCell c9= new PdfPCell(new Phrase(""+2,new Font(Font.TIMES_ROMAN,10)));
							c9.setHorizontalAlignment(Element.ALIGN_CENTER);
							c9.setColspan(1);
							table1.addCell(c9);
					
							PdfPCell c10= new PdfPCell(new Phrase("EMPLOYEE CODE",new Font(Font.TIMES_ROMAN,10)));
							c10.setHorizontalAlignment(Element.ALIGN_LEFT);
							c10.setColspan(3);
							table1.addCell(c10);
							
							PdfPCell c11= new PdfPCell(new Phrase(""+emp.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,10)));
							c11.setHorizontalAlignment(Element.ALIGN_CENTER);
							c11.setColspan(2);
							table1.addCell(c11);
							
							PdfPCell c12= new PdfPCell(new Phrase(""+3,new Font(Font.TIMES_ROMAN,10)));
							c12.setHorizontalAlignment(Element.ALIGN_CENTER);
							c12.setColspan(1);
							table1.addCell(c12);
							
							PdfPCell c13= new PdfPCell(new Phrase("DESIGNATION",new Font(Font.TIMES_ROMAN,10)));
							c13.setHorizontalAlignment(Element.ALIGN_LEFT);
							c13.setColspan(3);
							table1.addCell(c13);
							
							PdfPCell c14= new PdfPCell(new Phrase(""+emp.getString("DESIG"),new Font(Font.TIMES_ROMAN,10)));
							c14.setHorizontalAlignment(Element.ALIGN_CENTER);
							c14.setColspan(2);
							table1.addCell(c14);
							
							
							PdfPCell c15= new PdfPCell(new Phrase(""+4,new Font(Font.TIMES_ROMAN,10)));
							c15.setHorizontalAlignment(Element.ALIGN_CENTER);
							c15.setColspan(1);
							table1.addCell(c15);
							
							PdfPCell c16= new PdfPCell(new Phrase("DATE OF BIRTH",new Font(Font.TIMES_ROMAN,10)));
							c16.setHorizontalAlignment(Element.ALIGN_LEFT);
							c16.setColspan(3);
							table1.addCell(c16);
							
							PdfPCell c17= new PdfPCell(new Phrase(""+emp.getString("DOB"),new Font(Font.TIMES_ROMAN,10)));
							c17.setHorizontalAlignment(Element.ALIGN_CENTER);
							c17.setColspan(2);
							table1.addCell(c17);
							
							PdfPCell c18= new PdfPCell(new Phrase(""+5,new Font(Font.TIMES_ROMAN,10)));
							c18.setHorizontalAlignment(Element.ALIGN_CENTER);
							c18.setColspan(1);
							table1.addCell(c18);
							
							PdfPCell c19= new PdfPCell(new Phrase("DATE OF JOINING",new Font(Font.TIMES_ROMAN,10)));
							c19.setHorizontalAlignment(Element.ALIGN_LEFT);
							c19.setColspan(3);
							table1.addCell(c19);
							
							PdfPCell c20= new PdfPCell(new Phrase(""+emp.getString("DOJ"),new Font(Font.TIMES_ROMAN,10)));
							c20.setHorizontalAlignment(Element.ALIGN_CENTER);
							c20.setColspan(2);
							table1.addCell(c20);
							
							PdfPCell c21= new PdfPCell(new Phrase(""+6,new Font(Font.TIMES_ROMAN,10)));
							c21.setHorizontalAlignment(Element.ALIGN_CENTER);
							c21.setColspan(1);
							table1.addCell(c21);
							
							PdfPCell c22= new PdfPCell(new Phrase("DATE OF CONFIRMATION",new Font(Font.TIMES_ROMAN,10)));
							c22.setHorizontalAlignment(Element.ALIGN_LEFT);
							c22.setColspan(3);
							table1.addCell(c22);
							
							PdfPCell c23= new PdfPCell(new Phrase(""+emp.getString("CONFRMDATE"),new Font(Font.TIMES_ROMAN,10)));
							c23.setHorizontalAlignment(Element.ALIGN_CENTER);
							c23.setColspan(2);
							table1.addCell(c23);
							
							PdfPCell c24= new PdfPCell(new Phrase(""+7,new Font(Font.TIMES_ROMAN,10)));
							c24.setHorizontalAlignment(Element.ALIGN_CENTER);
							c24.setColspan(1);
							table1.addCell(c24);
							
							PdfPCell c25= new PdfPCell(new Phrase("DATE OF RETIREMENT",new Font(Font.TIMES_ROMAN,10)));
							c25.setHorizontalAlignment(Element.ALIGN_LEFT);
							c25.setColspan(3);
							table1.addCell(c25);
							
							PdfPCell c26= new PdfPCell(new Phrase(""+emp.getString("RETIREMENT")=="null"?"":emp.getString("RETIREMENT"),new Font(Font.TIMES_ROMAN,10)));
							c26.setHorizontalAlignment(Element.ALIGN_CENTER);
							c26.setColspan(2);
							table1.addCell(c26);
							
							String service="";
							service=emp.getString("YEAR")==""||emp.getInt("YEAR")<=0?"":emp.getString("YEAR")+" YEAR ";
							service+=emp.getString("MONTH")==""||emp.getInt("MONTH")<=0?"":", "+emp.getString("MONTH")+" MONTH";
							service+=emp.getString("DAY")==""||emp.getInt("DAY")<=0?"":emp.getString("DAY")+" DAY";
							
							PdfPCell c27= new PdfPCell(new Phrase(""+8,new Font(Font.TIMES_ROMAN,10)));
							c27.setHorizontalAlignment(Element.ALIGN_CENTER);
							c27.setColspan(1);
							table1.addCell(c27);
							
							PdfPCell c28= new PdfPCell(new Phrase("NO.OF YEAR SERVICE LEFT",new Font(Font.TIMES_ROMAN,10)));
							c28.setHorizontalAlignment(Element.ALIGN_LEFT);
							c28.setColspan(3);
							table1.addCell(c28);
							
							PdfPCell c29= new PdfPCell(new Phrase(""+service,new Font(Font.TIMES_ROMAN,10)));
							c29.setHorizontalAlignment(Element.ALIGN_CENTER);
							c29.setColspan(2);
							table1.addCell(c29);
							
							PdfPCell c30= new PdfPCell(new Phrase(""+9,new Font(Font.TIMES_ROMAN,10)));
							c30.setHorizontalAlignment(Element.ALIGN_CENTER);
							c30.setColspan(1);
							table1.addCell(c30);
							
							PdfPCell c31= new PdfPCell(new Phrase("PRESENT POSTING",new Font(Font.TIMES_ROMAN,10)));
							c31.setHorizontalAlignment(Element.ALIGN_LEFT);
							c31.setColspan(3);
							table1.addCell(c31);
							
							PdfPCell c32= new PdfPCell(new Phrase(""+emp.getString("SITE_NAME"),new Font(Font.TIMES_ROMAN,10)));
							c32.setHorizontalAlignment(Element.ALIGN_CENTER);
							c32.setColspan(2);
							table1.addCell(c32);
							
							PdfPCell c33= new PdfPCell(new Phrase(""+10,new Font(Font.TIMES_ROMAN,10)));
							c33.setHorizontalAlignment(Element.ALIGN_CENTER);
							c33.setColspan(1);
							table1.addCell(c33);
							
							PdfPCell c34= new PdfPCell(new Phrase("SALARY DETAILS OF "+ReportDAO.EOM(frmdate),new Font(Font.TIMES_ROMAN,10)));
							c34.setHorizontalAlignment(Element.ALIGN_CENTER);
							c34.setColspan(5);
							table1.addCell(c34);
							
							PdfPCell c35= new PdfPCell(new Phrase("EARNING",new Font(Font.TIMES_ROMAN,10)));
							c35.setHorizontalAlignment(Element.ALIGN_CENTER);
							c35.setColspan(4);
							table1.addCell(c35);
							
							PdfPCell c36= new PdfPCell(new Phrase("DEDUCTION",new Font(Font.TIMES_ROMAN,10)));
							c36.setHorizontalAlignment(Element.ALIGN_CENTER);
							c36.setColspan(2);
							table1.addCell(c36);
							
							ResultSet DED=st2.executeQuery(dedquery);
							ResultSet EARN=st3.executeQuery(earnquery);
							table1.setWidthPercentage(new float[]{10,15,13,15,34,13},new Rectangle(100,100));
							while (DED.next())
							{
								
								if(EARN.next())
								{
									PdfPCell c37= new PdfPCell(new Phrase(""+EARN.getString("DISC"),new Font(Font.TIMES_ROMAN,10)));
									c37.setHorizontalAlignment(Element.ALIGN_LEFT);
									c37.setColspan(3);
									table1.addCell(c37);
									
									PdfPCell c38= new PdfPCell(new Phrase(""+EARN.getString("NET_AMT"),new Font(Font.TIMES_ROMAN,10)));
									c38.setHorizontalAlignment(Element.ALIGN_RIGHT);
									c38.setColspan(1);
									table1.addCell(c38);
									
									totgross+=EARN.getDouble("NET_AMT");
								}
								else
								{
									PdfPCell c39= new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,10)));
									c39.setHorizontalAlignment(Element.ALIGN_CENTER);
									c39.setColspan(4);
									c39.setBorder(Rectangle.LEFT);
									//c39.setBorder(Rectangle.RIGHT);
									//c39.setBorder(Rectangle.NO_BORDER);
									table1.addCell(c39);
								}
								
								PdfPCell c40= new PdfPCell(new Phrase(""+DED.getString("DISC"),new Font(Font.TIMES_ROMAN,10)));
								c40.setHorizontalAlignment(Element.ALIGN_LEFT);
								c40.setColspan(1);
								table1.addCell(c40);
								
								PdfPCell c41= new PdfPCell(new Phrase(""+DED.getString("NET_AMT"),new Font(Font.TIMES_ROMAN,10)));
								c41.setHorizontalAlignment(Element.ALIGN_RIGHT);
								c41.setColspan(1);
								table1.addCell(c41);
								
								totded+=DED.getDouble("NET_AMT");
								
								if(!DED.next())
								{
									break;
								}
								else
								{
									DED.previous();
									continue;
								}
								
							}
					
							PdfPCell c41= new PdfPCell(new Phrase("TOTAL EARNING - "+formatter.format(Math.round(totgross)),new Font(Font.TIMES_ROMAN,10)));
							c41.setHorizontalAlignment(Element.ALIGN_CENTER);
							c41.setColspan(4);
							table1.addCell(c41);
							
							PdfPCell c42= new PdfPCell(new Phrase("TOTAL DEDUCTION - "+formatter.format(Math.round(totded)),new Font(Font.TIMES_ROMAN,10)));
							c42.setHorizontalAlignment(Element.ALIGN_CENTER);
							c42.setColspan(2);
							table1.addCell(c42);
							
						if(!emp.next())
						{
							doc.add(table1);
							PdfPTable table3=new PdfPTable(6);
							table3.setWidthPercentage(new float[]{10,15,13,15,34,13},new Rectangle(100,100));
							PdfPCell c1 = new PdfPCell(new Phrase(" A. ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
							c1.setHorizontalAlignment(Element.ALIGN_CENTER);
							c1.setColspan(1);
							//table3.setSpacingBefore(30);
							table3.addCell(c1);	
							PdfPCell c1g = new PdfPCell(new Phrase("Deduction Available As Per Rule (70 % Of Total Earning ) ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
							c1g.setHorizontalAlignment(Element.ALIGN_LEFT);
							c1g.setColspan(4);
							table3.addCell(c1g);
							PdfPCell c1s = new PdfPCell(new Phrase("Rs. "+formatter.format(Math.round(((totgross/100)*70))),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
							c1s.setHorizontalAlignment(Element.ALIGN_LEFT);
							c1s.setColspan(1);
							table3.addCell(c1s);
							
							PdfPCell c1n = new PdfPCell(new Phrase(" B. ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
							c1n.setHorizontalAlignment(Element.ALIGN_CENTER);
							c1n.setColspan(1);
							table3.addCell(c1n);
							PdfPCell c1d = new PdfPCell(new Phrase("Deduction Of "+ReportDAO.EOM(frmdate),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
							c1d.setHorizontalAlignment(Element.ALIGN_LEFT);
							c1d.setColspan(4);
							table3.addCell(c1d);
							PdfPCell c1o = new PdfPCell(new Phrase("Rs. "+formatter.format(Math.round(totded)),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
							c1o.setHorizontalAlignment(Element.ALIGN_LEFT);
							c1o.setColspan(1);
							table3.addCell(c1o);
							
							PdfPCell c1os = new PdfPCell(new Phrase(" C. ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
							c1os.setHorizontalAlignment(Element.ALIGN_CENTER);
							c1os.setColspan(1);
							table3.addCell(c1os);
							PdfPCell c1c = new PdfPCell(new Phrase("Available Amount For Deduction ( C = A - B ) ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
							c1c.setHorizontalAlignment(Element.ALIGN_LEFT);
							c1c.setColspan(4);
							table3.addCell(c1c);
							PdfPCell c1cd = new PdfPCell(new Phrase("Rs. "+formatter.format(Math.round((((totgross/100)*70)-totded))),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
							c1cd.setHorizontalAlignment(Element.ALIGN_LEFT);
							c1cd.setColspan(1);
							table3.addCell(c1cd);
							
							/*PdfPCell c1last = new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
							c1last.setHorizontalAlignment(Element.ALIGN_CENTER);
							c1last.setColspan(6);
							c1last.setMinimumHeight(300);
							table3.addCell(c1last);*/
							
							
							doc.add(table3);
							
							break;
						}
							else
							{
								srno++;
								emp.previous();
								continue;
							}
							
					}	
				}
				else{
					System.out.println("no record found");
					table2.setSpacingBefore(0);
					table2.setWidthPercentage(new float[]{3,6,31,21,8,8},new Rectangle(77,77));
					PdfPCell c1 = new PdfPCell(new Phrase("Record Not found for the Month:-     "+ReportDAO.BOM(frmdate)+" To "+ReportDAO.EOM(frmdate),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
					c1.setColspan(6);
					table2.setSpacingBefore(40);
					table2.addCell(c1);	
					doc.add(table2);
				}
				
				
				doc.close();
				Cn.close();
				System.out.println("Completed");
			}
			catch(Exception e)
			{
				e.printStackTrace();
			}

		} catch (Exception e) {
			e.printStackTrace();
		} 
	}
	
		public static void PFlisttxtnew(String rdt,String reporttype,String  filepath)
		{
				

				RepoartBean repBean  = new RepoartBean();
				String EmpSql = "";
				
				Connection Cn = null;
				ResultSet emp = null;
				String Str1 = "";
				String SLINE = "";
				String sLine1  = "";
				String sLine2  = "";
				FileWriter Fp;
				boolean DtrFind = false;
				
				ReportDAO.inithead(repBean);
				//Initvar                       *****already variable are initialised  not need of initvar
			    ReportDAO.make_prn_file(filepath,repBean);
			    
			    //ReportDAO.println(String.valueOf((char)18), 0, 1, false, "BANK",repBean);//          ***** P H PATIL Sir
			    
			    //for double width of font in heading
			     //ReportDAO.println(String.valueOf((char)27)+String.valueOf((char)87)+String.valueOf((char)48)+"                         THE NASIK MARCHANT'S CO-OP BANK LTD, NASHIK", 5, 1, false, "BANK",repBean);
			     
			     //*****closing of double width for font
			    //ReportDAO.println(String.valueOf((char)27)+String.valueOf((char)87)+String.valueOf((char)49), 0, 0, false, "BANK",repBean);
			    
			   //ReportDAO.println(String.valueOf((char)18), 0, 1, false, "BANK",repBean);
			    
			   /* repBean.setHdg1(String.valueOf((char)18)+ "Salary Slip for the Month of : "+Payslipdt.substring(3, 6) + "-" + Payslipdt.substring(7, 11));
			    SLINE = stringOfSize(80, '-');
			    sLine1 = stringOfSize(80, '-');
			    sLine2 = stringOfSize(80, '=');*/
			    
			    repBean.setPageNo(1);
			    repBean.setLineLen(80);
			    repBean.setPageLen(65);
			    repBean.setLnCount(0);
			    repBean.setLineSpace(0);
			    
			    EmpSql=("IF EXISTS(select * from paytran p,empmast e  "+
			    			" where e.STATUS='A' and e.EMPNO=p.EMPNO and "+
			    			" p.TRNDT between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"' and p.trncd=101) " +
			    			//" select e.empno,isnull(e.IDENTY,0) IDENTY, RTRIM(e.LNAME)+''+RTRIM(e.FNAME)+' '+RTRIM(e.MNAME) AS NAME, "+
			    			" select e.empno,isnull(e.PFNO,0) PFNO, RTRIM(e.FNAME)+' '+RTRIM(e.MNAME)+' '+RTRIM(e.LNAME) AS NAME, "+
			    			" (select isnull((select ISNULL(p.INP_AMT,0) from PAYTRAN p where p.EMPNO=e.EMPNO and trncd=999 and TRNDT between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) as GROSS, "+
			    			" (select isnull((select ISNULL(p.CAL_AMT,0) from PAYTRAN p where p.EMPNO=e.EMPNO and trncd=136 and TRNDT between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) as PFCAL, "+
			    			" (select isnull((select ISNULL(p.CAL_AMT,0) from PAYTRAN p where p.EMPNO=e.EMPNO and trncd=137 and TRNDT between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) as EPSCAL, "+
			    			" (select isnull((select ISNULL(p.NET_AMT,0) from PAYTRAN p where p.EMPNO=e.EMPNO and trncd=201 and TRNDT between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) as PFAMT, "+
			    			" (select isnull((select ISNULL(p.CAL_AMT,0) from PAYTRAN p where p.EMPNO=e.EMPNO and trncd=232 and TRNDT between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) as EPS, "+
			    			" (select isnull((select ISNULL(p.CAL_AMT,0) from PAYTRAN p where p.EMPNO=e.EMPNO and trncd=231 and TRNDT between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) as EPF, "+
			    			" (select isnull((select ISNULL(p.NET_AMT,0) from PAYTRAN p where p.EMPNO=e.EMPNO and trncd=301 and TRNDT between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) as LWPDAYS, "+
			    			" (select 0) as secondlast, "+
			    			" (select 0) as lastone "+
			    			" from empmast e where  (e.PFNO IS NOT NULL AND e.PFNO<> '0' AND e.PFNO<>'') AND"+ 
			    			" ((e.STATUS='A' and e.DOJ<='"+ReportDAO.EOM(rdt)+"' )or(e.DOL >='"+ReportDAO.BOM(rdt)+"' and(e.STATUS='N' and e.DOL<>''))) "+
			    			"  order by e.empcode " +
			    			" ELSE " +
			    			//" select e.empno,isnull(e.IDENTY,0) IDENTY, RTRIM(e.LNAME)+''+RTRIM(e.FNAME)+' '+RTRIM(e.MNAME) AS NAME, "+
			    			" select e.empno,isnull(e.PFNO,0) PFNO, RTRIM(e.FNAME)+' '+RTRIM(e.MNAME)+' '+RTRIM(e.LNAME) AS NAME, "+
			    			" (select isnull((select ISNULL(p.INP_AMT,0) from PAYTRAN_STAGE p where p.EMPNO=e.EMPNO and trncd=999 and TRNDT between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) as GROSS, "+
			    			" (select isnull((select ISNULL(p.CAL_AMT,0) from PAYTRAN_STAGE p where p.EMPNO=e.EMPNO and trncd=136 and TRNDT between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) as PFCAL, "+
			    			" (select isnull((select ISNULL(p.CAL_AMT,0) from PAYTRAN_STAGE p where p.EMPNO=e.EMPNO and trncd=137 and TRNDT between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) as EPSCAL, "+
			    			" (select isnull((select ISNULL(p.NET_AMT,0) from PAYTRAN_STAGE p where p.EMPNO=e.EMPNO and trncd=201 and TRNDT between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) as PFAMT, "+
			    			" (select isnull((select ISNULL(p.CAL_AMT,0) from PAYTRAN_STAGE p where p.EMPNO=e.EMPNO and trncd=232 and TRNDT between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) as EPS, "+
			    			" (select isnull((select ISNULL(p.CAL_AMT,0) from PAYTRAN_STAGE p where p.EMPNO=e.EMPNO and trncd=231 and TRNDT between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) as EPF, "+
			    			" (select isnull((select ISNULL(p.NET_AMT,0) from PAYTRAN_STAGE p where p.EMPNO=e.EMPNO and trncd=301 and TRNDT between '"+ReportDAO.BOM(rdt)+"' and '"+ReportDAO.EOM(rdt)+"'),0)) as LWPDAYS, "+
			    			" (select 0) as secondlast, "+
			    			" (select 0) as lastone "+
			    			" from empmast e where (e.PFNO IS NOT NULL AND e.PFNO<> '0' AND e.PFNO<>'') AND"+ 
			    			" ((e.STATUS='A' and e.DOJ<='"+ReportDAO.EOM(rdt)+"' )or(e.DOL >='"+ReportDAO.BOM(rdt)+"' and(e.STATUS='N' and e.DOL<>''))) "+
			    			"  order by e.empcode ");
			   System.out.println(EmpSql);
			    //DoEvents              
			    ReportDAO.OpenCon("", "", "",repBean);
			    Cn = repBean.getCn();
			    try
			    {
					Statement st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
					emp=st.executeQuery(EmpSql);
					while(emp.next())
					{
						//Str1 = emp.getString("IDENTY")+"#~#"+emp.getString("NAME")+"#~#"+emp.getInt("PFCAL")+"#~#"+emp.getInt("PFCAL")+"#~#"+emp.getInt("EPSCAL")+"#~#"+emp.getInt("EPSCAL")+"#~#"+emp.getInt("PFAMT")+"#~#"+emp.getInt("EPS")+"#~#"+emp.getInt("EPF")+"#~#"+emp.getInt("secondlast")+"#~#"+emp.getInt("lastone");
						Str1 = emp.getString("PFNO")+"#~#"+emp.getString("NAME")+"#~#"+emp.getInt("GROSS")+"#~#"+emp.getInt("PFCAL")+"#~#"+emp.getInt("EPSCAL")+"#~#"+emp.getInt("EPSCAL")+"#~#"+emp.getInt("PFAMT")+"#~#"+emp.getInt("EPS")+"#~#"+emp.getInt("EPF")+"#~#"+emp.getInt("LWPDAYS")+"#~#"+emp.getInt("lastone");
						ReportDAO.println(Str1, repBean.getLineSpace(), 1, false, "BANK",repBean);



					}
					
					Fp = repBean.getFp();
					Fp.close();
					Cn.close();
				} catch (Exception e)
				{
					e.printStackTrace();
					// TODO: handle exception
				}
			    
			
				
			
				
			}
		
		// akshay nikam
		
		// Balance Leave List...
		
		public static void BalanceLeaveList(String Branch,String selectedBranch,String rangefrom,String rangeTo,String filepath, String imagepath )
		{
			
			RepoartBean repBean  = new RepoartBean();
			try
			{
				Connection Cn = null;
				Statement st = null;
				ResultSet rs = null;
				ResultSet rs1 = null;

				ReportDAO.OpenCon("", "", "",repBean);
				Cn = repBean.getCn();
				
				int totalEmployee =0;
				int Employee = 0;
				String Query = "";
				String Query1 = "";
				
				LookupHandler lkhp = new LookupHandler();
				Rectangle rec = new  Rectangle(100,100);
				Document doc = new Document();
				PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
				
				
				doc.open();
				doc.setPageSize(PageSize.A4);
				
				Font fbold = new Font(Font.TIMES_ROMAN,12,Font.BOLD);
				Font fsmall = new Font(Font.TIMES_ROMAN,10);
				Font FONT = new Font(Font.TIMES_ROMAN, 40, Font.NORMAL, new GrayColor(0.75f));
				Font  fontcolor = FontFactory.getFont(FontFactory.HELVETICA, 10, new Color(6, 8, 193));
				
				ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
				Image image = Image.getInstance(imagepath);
				image.scaleAbsolute(80f, 80f);
				image.setAbsolutePosition(10f, 740f);
				doc.add(image);
				
				Paragraph para = new Paragraph(new Phrase("Project Wise Employee List ",fbold));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);
				if(Branch.equalsIgnoreCase("1"))
						{
					Query = "select * from Project_Sites";
				}
				else if(Branch.equalsIgnoreCase("2")){
			     	Query = "select * from Project_Sites where SITE_ID =" +selectedBranch ;
				}
				else if(Branch.equalsIgnoreCase("3")){
					Query = "select * from Project_Sites where SITE_ID  between "+rangefrom +"and "+rangeTo;
				}
				System.out.println("Query is@@@ " +Query);
				st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
				rs = st.executeQuery(Query);	
				
				String site_id ="";
				String site_name ="";
				String Project_Code ="";
				int srno = 0;
				while(rs.next())
				{
					site_id = rs.getString("Site_ID");
					site_name = rs.getString("site_name");
					Project_Code = rs.getString("Project_Code");
					
						if(Branch.equalsIgnoreCase("1"))
						{
					Query1 =  " select e1.EMPNO,e1.EMPCODE ,FNAME,MNAME,LNAME,T.PRJ_SRNO," +
								"sum(case when lkp_dIsc = 'PL' then l.bal else 0 end ) 'PL' ,"+
								"sum(case when lkp_dIsc = 'CL' then l.bal else 0 end ) 'CL',"+
								"sum(case when lkp_dIsc = 'SL' then l.bal else 0 end ) 'SL'"+
								" from  leavebal l,empmast e1,LOOKUP ll,EMPTRAN T "+
								" where ll.LKP_CODE = 'LEAVE' and ll.LKP_SRNO  = l.LEAVECD and "+
								" e1.EMPNO =l.EMPNO and l.srno =(    "+
								"	select top 1.srno from leavebal l1 where l1.LEAVECD  = l.LEAVECD "+
								" and  l1.EMPNO=l.EMPNO order by BALDT desc,srno desc)  "+
								" and l.EMPNO =e1.EMPNO and e1.STATUS  ='A' "+
								" and T.EMPNO = e1.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e1.EMPNO) "+
								" and T.PRJ_SRNO="+site_id+
								"  group by e1.EMPNO,e1.EMPCODE ,FNAME,MNAME,LNAME,T.PRJ_SRNO order by e1.EMPCODE";
						}
						else if(Branch.equalsIgnoreCase("2")){
							Query1 =	"select e1.EMPNO,e1.EMPCODE ,FNAME,MNAME,LNAME,T.PRJ_SRNO," +
									"sum(case when lkp_dIsc = 'PL' then l.bal else 0 end ) 'PL' ,"+
									"sum(case when lkp_dIsc = 'CL' then l.bal else 0 end ) 'CL',"+
									"sum(case when lkp_dIsc = 'SL' then l.bal else 0 end ) 'SL'"+
									" from  leavebal l,empmast e1,LOOKUP ll,EMPTRAN T "+
									" where ll.LKP_CODE = 'LEAVE' and ll.LKP_SRNO  = l.LEAVECD and "+
									" e1.EMPNO =l.EMPNO and l.srno =(    "+
									"	select top 1.srno from leavebal l1 where l1.LEAVECD  = l.LEAVECD "+
									" and  l1.EMPNO=l.EMPNO order by BALDT desc,srno desc)  "+
									" and l.EMPNO =e1.EMPNO and e1.STATUS  ='A' "+
									" and T.EMPNO = e1.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e1.EMPNO) "+
									" and T.PRJ_SRNO="+selectedBranch+
									"  group by e1.EMPNO,e1.EMPCODE ,FNAME,MNAME,LNAME,T.PRJ_SRNO order by e1.EMPCODE";
						}
						else if(Branch.equalsIgnoreCase("3")){
					Query1 =    "select e1.EMPNO,e1.EMPCODE ,FNAME,MNAME,LNAME,T.PRJ_SRNO," +
								"sum(case when lkp_dIsc = 'PL' then l.bal else 0 end ) 'PL' ,"+
								"sum(case when lkp_dIsc = 'CL' then l.bal else 0 end ) 'CL',"+
								"sum(case when lkp_dIsc = 'SL' then l.bal else 0 end ) 'SL'"+
								" from  leavebal l,empmast e1,LOOKUP ll,EMPTRAN T "+
								" where ll.LKP_CODE = 'LEAVE' and ll.LKP_SRNO  = l.LEAVECD and "+
								" e1.EMPNO =l.EMPNO and l.srno =(    "+
								"	select top 1.srno from leavebal l1 where l1.LEAVECD  = l.LEAVECD "+
								" and  l1.EMPNO=l.EMPNO order by BALDT desc,srno desc)  "+
								" and l.EMPNO =e1.EMPNO and e1.STATUS  ='A' "+
								" and T.EMPNO = e1.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e1.EMPNO) "+
								" and T.PRJ_SRNO="+site_id+
							//	"and T.PRJ_SRNO between "+rangefrom+" and "+ rangeTo+" "+
								"  group by e1.EMPNO,e1.EMPCODE ,FNAME,MNAME,LNAME,T.PRJ_SRNO order by e1.EMPCODE";
						}
						
					System.out.println("Query1 is @@@ " +Query1);
					st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
					rs1 = st.executeQuery(Query1);	
					
					
						para = new Paragraph(new Phrase("Employee List For Project Site is :- "+( site_name + Project_Code ),fbold));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(10);
						doc.add(para);
						
						//............................ Code To print Heading start here...................................
						PdfPTable main = new PdfPTable(6);
						String str[] = new String[6];
						
						str[0]="Sr No";
						str[1]=" Emp Code";			str[2]="Employee Name";			str[3]="Balance PL";
						str[4]="Balance CL";				str[5]="Balance SL";  	
						
						main.setWidthPercentage(new float[]{10,15,40,15,15,15f}, rec);
						main.setHorizontalAlignment(Element.ALIGN_CENTER);
						PdfPCell maincell ;	
						
						for(int i=0; i<str.length;i++ )
						{					
							maincell = new PdfPCell(new Phrase(str[i],fbold));
							maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
							main.addCell(maincell);
						}	
						
						doc.add(main);
						//......................... Code To print Heading Ends here......................................
						
						rs1.beforeFirst();
						while(rs1.next())
						{
							srno++;
							PdfPTable main1 = new PdfPTable(6);
							main1.setWidthPercentage(new float[]{10,15,40,15,15,15f}, rec);
							main1.setHorizontalAlignment(Element.ALIGN_CENTER);	
							
							PdfPCell cell1 = new PdfPCell(new Phrase(""+srno,fsmall));  
							cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
							main1.addCell(cell1);
							
							PdfPCell cell3 = new PdfPCell(new Phrase(""+rs1.getString("EMPCODE"),fsmall));
							cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
							main1.addCell(cell3);
							
							String empname=rs1.getString("fname")+" "+rs1.getString("mname")+" "+rs1.getString("lname");
							PdfPCell cell4 = new PdfPCell(new Phrase(""+empname,fsmall));
							cell4.setHorizontalAlignment(Element.ALIGN_LEFT);
							main1.addCell(cell4);
							
							PdfPCell cell5 = new PdfPCell(new Phrase(""+rs1.getString("PL"),fsmall));
							cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
							main1.addCell(cell5);
							
							PdfPCell cell2 = new PdfPCell(new Phrase(""+rs1.getString("CL"),fsmall));
							cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
							main1.addCell(cell2);
							
							PdfPCell cell6 = new PdfPCell(new Phrase(""+rs1.getString("SL"),fsmall));
							cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
							main1.addCell(cell6);
							
							
							doc.add(main1);
							
							Employee+=1;	
						}     
					
					para = new Paragraph(new Phrase("Number Of Employee :- "+Employee,fsmall));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(20);
					doc.add(para);	
					
					totalEmployee = totalEmployee+ Employee;	
					Employee = 0;
					//......................... Code To print data In Table Ends here...............................
				}		
				
				para = new Paragraph(new Phrase("Total Number Of Employee :- "+totalEmployee,fbold));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);
				doc.add(para);			
			
				//doc.newPage();
				doc.close();
				Cn.close();
			}
			catch(Exception e) 
			{
				e.printStackTrace();
			}

			}
		
		// Leave Availed List...
		
		public static void LeaveAvailedList(String Branch,String selectedBranch,String rangefrom,String rangeTo,String frmdate,String todate,String filepath, String imagepath )
		{
			RepoartBean repBean  = new RepoartBean();
			try
			{
				String fdate="";
				System.out.println("date: "+frmdate);
				String fdate1[] = frmdate.split("-");
				System.out.println("month: "+fdate1[1]);
				Connection Cn = null;
				Statement st = null;
				ResultSet rs = null;
				ResultSet rs1 = null;
				
				OutputStream file = null;
				try {
					file = new FileOutputStream(new File(filepath));
				} catch (FileNotFoundException e1) {
					// TODO Auto-generated catch block
					e1.printStackTrace();
				}
				Document document = new Document();
				String table_name="";
				lable1="Report date : ";
				try {
					UtilityDAO dao = new UtilityDAO();
					PdfWriter writer =PdfWriter.getInstance(document, new FileOutputStream(filepath));

					Footer ftr = dao.new Footer(lable1);
					writer.setPageEvent(ftr);
					document.open();
					Image image1 = Image.getInstance(imagepath);
					image1.scaleAbsolute(80f, 80f);
					image1.setAbsolutePosition(40f, 730f); 
					document.add(image1);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);
					document.add(para);

					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					document.add(para);
					para = new Paragraph(new Phrase("Tel : +91-20 26812190,Email :",new Font(Font.TIMES_ROMAN,9)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					document.add(para);
					para = new Paragraph(new Phrase("Leave Availed List ",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					document.add(para);
					/*para = new Paragraph(new Phrase("For The Month : "+fdate1[1]+"-"+fdate1[2],new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);   //+fdate1[1]+"-"+fdate1[2]
					para.setSpacingAfter(0);
					document.add(para);*/
					PdfPTable table=new PdfPTable(8);
					table.setSpacingBefore(25.0f);
					table.setWidthPercentage(new float[]{5,7,7,32,19,12,12,10},new Rectangle(100,100));
					PdfPCell cell1=new PdfPCell(new Phrase("Sr No",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell1);
					PdfPCell cell11=new PdfPCell(new Phrase("Branch",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell11);
					PdfPCell cell2=new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell2);
					PdfPCell cell3=new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell3);
					PdfPCell cell5=new PdfPCell(new Phrase("Desig",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell5);
					PdfPCell cell4=new PdfPCell(new Phrase("FromDate",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell4);
					
					PdfPCell cell6=new PdfPCell(new Phrase("ToDate",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell6);
					PdfPCell cell7=new PdfPCell(new Phrase("LType",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell7);
					/*PdfPCell cell71=new PdfPCell(new Phrase("Reason",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell71.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell71);*/
					table.setHeaderRows(1);
					Connection con=null;
					con=ConnectionManager.getConnection();
					Statement stmt=con.createStatement();
					ResultSet rspt = null;
					String Query1="";
				
					// for All Branch..
					if(Branch.equalsIgnoreCase("1"))
					{
				Query1 ="select e1.EMPCODE ,FNAME,MNAME,LNAME,l.FRMDT,l.TODT,l.days,l.LREASON,l.LEAVECD,T.PRJ_SRNO,T.DESIG"+
						" from  leavetran l,empmast e1,EMPTRAN T "+
						" where   "+
						" l.STATUS='SANCTION' and FRMDT between '"+frmdate+"' and '"+todate+"' "+
						" and l.EMPNO =e1.EMPNO and e1.STATUS  ='A' "+
						" and T.EMPNO = e1.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e1.EMPNO) "+
						"   order by T.PRJ_SRNO";
					}
					// for Specific Branch..
								if(Branch.equalsIgnoreCase("2"))
								{
							Query1 ="select e1.EMPCODE ,FNAME,MNAME,LNAME,l.FRMDT,l.TODT,l.days,l.LREASON,l.LEAVECD,T.PRJ_SRNO,T.DESIG"+
									" from  leavetran l,empmast e1,EMPTRAN T "+
									" where   "+
									" l.STATUS='SANCTION' and FRMDT between '"+frmdate+"' and '"+todate+"' "+
									" and l.EMPNO =e1.EMPNO and e1.STATUS  ='A' "+
									" and T.PRJ_SRNO="+selectedBranch+
									" and T.EMPNO = e1.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e1.EMPNO) "+
									"   order by e1.EMPCODE";
								}
								//For Selected Branch...
								if(Branch.equalsIgnoreCase("3"))
								{
							Query1 ="select e1.EMPCODE ,FNAME,MNAME,LNAME,l.FRMDT,l.TODT,l.days,l.LREASON,l.LEAVECD,T.PRJ_SRNO,T.DESIG"+
									" from  leavetran l,empmast e1,EMPTRAN T "+
									" where   "+
									" l.STATUS='SANCTION' and FRMDT between '"+frmdate+"' and '"+todate+"' "+
									" and l.EMPNO =e1.EMPNO and e1.STATUS  ='A' "+
									" and  T.PRJ_SRNO  between "+rangefrom+" and "+ rangeTo+" "+
									" and T.EMPNO = e1.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e1.EMPNO) "+
									"   order by T.PRJ_SRNO";
								}
								
					System.out.println("query is  "+Query1);
					rspt = stmt.executeQuery(Query1);
					int srno=0;
					int totemp=0;
					String previousEmpCode="";
					String currentEmpCode="";
					double totatlAmount=0;
					LookupHandler lkp=new LookupHandler();
					int i = 0;
					while(rspt.next())
					{
						 DateFormat outputFormat = new SimpleDateFormat("dd-MM-yyyy");
						 DateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd");
						 Date date = inputFormat.parse(rspt.getString("FRMDT"));
						 Date date1 = inputFormat.parse(rspt.getString("TODT"));
						 String frdt = outputFormat.format(date);
						 String todt = outputFormat.format(date1);
						
						currentEmpCode = rspt.getString("EMPCODE");
						i++;
						System.out.println("in while  "+i);
						srno++;
						
						
					    if(rspt.getRow()!=1 && previousEmpCode.equalsIgnoreCase(currentEmpCode)){	
					    	PdfPCell cell1data=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,9)));
							cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data);
					    	
						PdfPCell cell1data1=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
						cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data1);
						PdfPCell cell1data0=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
						cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data0);
						
						String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
						PdfPCell cell1data2=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
						cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data2);
						PdfPCell cell1data4=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
						cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data4);
						}
					    else{
					    	totemp++;
							PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,9)));
							cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data);
							
							PdfPCell cell1data1=new PdfPCell(new Phrase(""+rspt.getString("prj_srno"),new Font(Font.TIMES_ROMAN,8)));
							cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data1);
							PdfPCell cell1data0=new PdfPCell(new Phrase(""+rspt.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8)));
							cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data0);
							
							String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
							PdfPCell cell1data2=new PdfPCell(new Phrase(""+empname,new Font(Font.TIMES_ROMAN,8)));
							cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data2);
							PdfPCell cell1data4=new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("DESIG",rspt.getInt("DESIG")),new Font(Font.TIMES_ROMAN,8)));
							cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data4);
					    }
						PdfPCell cell1data3=new PdfPCell(new Phrase(""+frdt,new Font(Font.TIMES_ROMAN,8)));
						cell1data3.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data3);
						
						PdfPCell cell1data5=new PdfPCell(new Phrase(""+todt,new Font(Font.TIMES_ROMAN,8)));
						cell1data5.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data5);
						PdfPCell cell1data6=new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("LEAVE",rspt.getInt("LEAVECD")),new Font(Font.TIMES_ROMAN,8)));
						cell1data6.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data6);
						/*PdfPCell cell1data61=new PdfPCell(new Phrase(""+rspt.getString("LREASON"),new Font(Font.TIMES_ROMAN,8)));
						cell1data61.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data61);*/
						previousEmpCode = currentEmpCode;
					}
					document.add(table);	 
					para = new Paragraph(new Phrase("Total Number Of Employee :- "+totemp,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(10);
					document.add(para);
					document.close();
					file.close();
					con.close();
				} catch (Exception e)
				{		
					e.printStackTrace();
				}
				
			}catch (Exception e)
			{		
				e.printStackTrace();
			}
	    }
		
		// Leave Availed Detail List...
		
		public static void LeaveAvailedDetailList(String Branch,String selectedBranch,String rangefrom,String rangeTo,String LType,
				 String frmdate,String todate,String empno1,String EType,String leaveType,String SelectType,String filepath, String imagepath )
		{
		RepoartBean repBean  = new RepoartBean();
		try
		{
			/*String fdate="";
			System.out.println("date: "+frmdate);
			String fdate1[] = frmdate.split("-");
			System.out.println("month: "+fdate1[1]);*/
			Connection Cn = null;
			Statement st = null;
			ResultSet rs = null;
			ResultSet rs1 = null;
			
			OutputStream file = null;
			try {
				file = new FileOutputStream(new File(filepath));
			} catch (FileNotFoundException e1) {
				e1.printStackTrace();
			}
			Document document = new Document();
			String table_name="";
			lable1="Report date : ";
			try {
				UtilityDAO dao = new UtilityDAO();
				PdfWriter writer =PdfWriter.getInstance(document, new FileOutputStream(filepath));

				Footer ftr = dao.new Footer(lable1);
				writer.setPageEvent(ftr);
				document.open();
				Image image1 = Image.getInstance(imagepath);
				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f); 
				document.add(image1);
				Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				document.add(para);

				para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Tel : +91-20 26812190,Email :",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(new Phrase("Leave Availed Detail List ",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				document.add(para);
				/*para = new Paragraph(new Phrase("For The Month : "+fdate1[1]+"-"+fdate1[2],new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);   //+fdate1[1]+"-"+fdate1[2]
				para.setSpacingAfter(0);
				document.add(para);*/
				PdfPTable table=new PdfPTable(9);
				table.setSpacingBefore(10.0f);
				table.setWidthPercentage(new float[]{5,7,7,35,15,12,5,7,18},new Rectangle(100,100));
				PdfPCell cell1=new PdfPCell(new Phrase("Sr No",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1);
				PdfPCell cell11=new PdfPCell(new Phrase("Branch",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell11);
				PdfPCell cell2=new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell2);
				PdfPCell cell3=new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell3);
				PdfPCell cell5=new PdfPCell(new Phrase("Desig",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell5);
				PdfPCell cell4=new PdfPCell(new Phrase("Availed Date",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell4);
				
				PdfPCell cell6=new PdfPCell(new Phrase("Days",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell6);
				PdfPCell cell7=new PdfPCell(new Phrase("LType",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell7);
				PdfPCell cell71=new PdfPCell(new Phrase("Reason",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				cell71.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell71);
				table.setHeaderRows(1);
				Connection con=null;
				con=ConnectionManager.getConnection();
				Statement stmt=con.createStatement();
				ResultSet rspt = null;
				String Query1="";
			
				// for All Leave and All Emp..
				if(LType.equalsIgnoreCase("1") && EType.equalsIgnoreCase("1") && SelectType.equalsIgnoreCase("1"))
				{
					System.out.println("for All Leave and All Emp");
			Query1 ="select e1.EMPCODE ,FNAME,MNAME,LNAME,l.FRMDT,l.TODT,l.days,l.LREASON,l.LEAVECD,T.PRJ_SRNO,T.DESIG"+
					" from  leavetran l,empmast e1,EMPTRAN T "+
					" where   "+
					" l.STATUS='SANCTION' and FRMDT between '"+frmdate+"' and '"+todate+"' "+
					" and l.EMPNO =e1.EMPNO and e1.STATUS  ='A' "+
					" and T.EMPNO = e1.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e1.EMPNO) "+
					"   order by T.prj_srno";
				}
				
				// for All Leave and All Branch..
				 if(LType.equalsIgnoreCase("1") && Branch.equalsIgnoreCase("1") && SelectType.equalsIgnoreCase("2"))
							{
								System.out.println("for All Leave and All branch");
						Query1 ="select e1.EMPCODE ,FNAME,MNAME,LNAME,l.FRMDT,l.TODT,l.days,l.LREASON,l.LEAVECD,T.PRJ_SRNO,T.DESIG"+
								" from  leavetran l,empmast e1,EMPTRAN T "+
								" where   "+
								" l.STATUS='SANCTION' and FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" and l.EMPNO =e1.EMPNO and e1.STATUS  ='A' "+
								" and T.EMPNO = e1.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e1.EMPNO) "+
								"   order by T.prj_srno";
							}
				
				
							//Specific Leave and All Employee..
				      if(LType.equalsIgnoreCase("2") && EType.equalsIgnoreCase("1") && SelectType.equalsIgnoreCase("1"))
							{
								System.out.println("Specific Leave and All Employee");
						Query1 ="select e1.EMPCODE ,FNAME,MNAME,LNAME,l.FRMDT,l.TODT,l.days,l.LREASON,l.LEAVECD,T.PRJ_SRNO,T.DESIG"+
								" from  leavetran l,empmast e1,EMPTRAN T "+
								" where   "+
								" l.STATUS='SANCTION' and FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" and l.EMPNO =e1.EMPNO and e1.STATUS  ='A' "+
								" and l.LEAVECD="+leaveType+
								" and T.EMPNO = e1.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e1.EMPNO) "+
								"   order by e1.EMPCODE";
							}
					// Specific Leave Specific Emp..
				        if(LType.equalsIgnoreCase("2") && EType.equalsIgnoreCase("2") && SelectType.equalsIgnoreCase("1"))
							{
								System.out.println("Specific Leave Specific Emp");
						Query1 ="select e1.EMPCODE ,FNAME,MNAME,LNAME,l.FRMDT,l.TODT,l.days,l.LREASON,l.LEAVECD,T.PRJ_SRNO,T.DESIG"+
								" from  leavetran l,empmast e1,EMPTRAN T "+
								" where   "+
								" l.STATUS='SANCTION' and FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" and l.EMPNO =e1.EMPNO and e1.STATUS  ='A' "+
								" and l.LEAVECD="+leaveType+
								" and l.EMPNO="+empno1+
								" and T.EMPNO = e1.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e1.EMPNO) "+
								"   order by e1.EMPCODE";
							}	
							// All Leave Specific Branch..
				        if(LType.equalsIgnoreCase("1") && Branch.equalsIgnoreCase("2") && SelectType.equalsIgnoreCase("2"))
							{
								System.out.println("All Leave Specific Branch");
						Query1 ="select e1.EMPCODE ,FNAME,MNAME,LNAME,l.FRMDT,l.TODT,l.days,l.LREASON,l.LEAVECD,T.PRJ_SRNO,T.DESIG"+
								" from  leavetran l,empmast e1,EMPTRAN T "+
								" where   "+
								" l.STATUS='SANCTION' and FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" and l.EMPNO =e1.EMPNO and e1.STATUS  ='A' "+
								" and T.PRJ_SRNO="+selectedBranch+
								" and T.EMPNO = e1.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e1.EMPNO) "+
								"   order by e1.EMPCODE";
							}		
							// All Leave Branch Range..
				        if(LType.equalsIgnoreCase("1") && Branch.equalsIgnoreCase("3") && SelectType.equalsIgnoreCase("2"))
							{
								System.out.println("All Leave Branch Range");
						Query1 ="select e1.EMPCODE ,FNAME,MNAME,LNAME,l.FRMDT,l.TODT,l.days,l.LREASON,l.LEAVECD,T.PRJ_SRNO,T.DESIG"+
								" from  leavetran l,empmast e1,EMPTRAN T "+
								" where   "+
								" l.STATUS='SANCTION' and FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" and  T.PRJ_SRNO  between "+rangefrom+" and "+ rangeTo+" "+
								" and l.EMPNO =e1.EMPNO and e1.STATUS  ='A' "+
								" and T.EMPNO = e1.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e1.EMPNO) "+
								"   order by T.prj_srno";
							}
							// Specific Leave All Branch..		
				        if(LType.equalsIgnoreCase("2") && Branch.equalsIgnoreCase("1") && SelectType.equalsIgnoreCase("2"))
							{
								System.out.println("Specific Leave All Branch");
						Query1 ="select e1.EMPCODE ,FNAME,MNAME,LNAME,l.FRMDT,l.TODT,l.days,l.LREASON,l.LEAVECD,T.PRJ_SRNO,T.DESIG"+
								" from  leavetran l,empmast e1,EMPTRAN T "+
								" where   "+
								" l.STATUS='SANCTION' and FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" and l.LEAVECD="+leaveType+
								" and l.EMPNO =e1.EMPNO and e1.STATUS  ='A' "+
								" and T.EMPNO = e1.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e1.EMPNO) "+
								"   order by T.prj_srno";
							}	
							// Specific Leave Specific Branch..		
				        if(LType.equalsIgnoreCase("2") && Branch.equalsIgnoreCase("2") && SelectType.equalsIgnoreCase("2"))
							{
								System.out.println("Specific Leave Specific Branch");
						Query1 ="select e1.EMPCODE ,FNAME,MNAME,LNAME,l.FRMDT,l.TODT,l.days,l.LREASON,l.LEAVECD,T.PRJ_SRNO,T.DESIG"+
								" from  leavetran l,empmast e1,EMPTRAN T "+
								" where   "+
								" l.STATUS='SANCTION' and FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" and l.LEAVECD="+leaveType+
								" and T.PRJ_SRNO="+selectedBranch+
								" and l.EMPNO =e1.EMPNO and e1.STATUS  ='A' "+
								" and T.EMPNO = e1.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e1.EMPNO) "+
								"   order by e1.EMPCODE";
							}	
							// Specific Leave Branch Range..		
				        if(LType.equalsIgnoreCase("2") && Branch.equalsIgnoreCase("3") && SelectType.equalsIgnoreCase("2"))
							{
								System.out.println("Specific Leave Branch Range");
						Query1 ="select e1.EMPCODE ,FNAME,MNAME,LNAME,l.FRMDT,l.TODT,l.days,l.LREASON,l.LEAVECD,T.PRJ_SRNO,T.DESIG"+
								" from  leavetran l,empmast e1,EMPTRAN T "+
								" where   "+
								" l.STATUS='SANCTION' and FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" and l.LEAVECD="+leaveType+
								" and  T.PRJ_SRNO  between "+rangefrom+" and "+ rangeTo+" "+
								" and l.EMPNO =e1.EMPNO and e1.STATUS  ='A' "+
								" and T.EMPNO = e1.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e1.EMPNO) "+
								"   order by T.prj_srno";
							}		
							// for All Leave and Specific Emp..
				        if(LType.equalsIgnoreCase("1") && EType.equalsIgnoreCase("2") && SelectType.equalsIgnoreCase("1"))
							{
								System.out.println("for All Leave and Specific Emp");
						Query1 ="select e1.EMPCODE ,FNAME,MNAME,LNAME,l.FRMDT,l.TODT,l.days,l.LREASON,l.LEAVECD,T.PRJ_SRNO,T.DESIG"+
								" from  leavetran l,empmast e1,EMPTRAN T "+
								" where   "+
								" l.STATUS='SANCTION' and FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" and l.EMPNO =e1.EMPNO and e1.STATUS  ='A' "+
								" and l.EMPNO="+empno1+
								" and T.EMPNO = e1.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e1.EMPNO) "+
								"   order by e1.EMPCODE";
							}
				System.out.println("query is  "+Query1);
				rspt = stmt.executeQuery(Query1);
				int srno=0;
				String previousEmpCode="";
				String currentEmpCode="";
				double totatlAmount=0;
				LookupHandler lkp=new LookupHandler();
				int i = 0;
				int totemp=0;
				while(rspt.next())
				{
					 DateFormat outputFormat = new SimpleDateFormat("dd-MM-yyyy");
					 DateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd");
					 Date date = inputFormat.parse(rspt.getString("FRMDT"));
					 Date date1 = inputFormat.parse(rspt.getString("TODT"));
					 String frdt = outputFormat.format(date);
					 String todt = outputFormat.format(date1);
					
					
					currentEmpCode = rspt.getString("EMPCODE");
					i++;
					System.out.println("in while  "+i);
					srno++;
				    if(rspt.getRow()!=1 && previousEmpCode.equalsIgnoreCase(currentEmpCode)){	
				    	PdfPCell cell1data=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,9)));
						cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data);
				    	
					PdfPCell cell1data1=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
					cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell1data1);
					PdfPCell cell1data0=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
					cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell1data0);
					
					String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
					PdfPCell cell1data2=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
					cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
					table.addCell(cell1data2);
					PdfPCell cell1data4=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
					cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
					table.addCell(cell1data4);
					}
				    else{
				    	totemp++;
						PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,9)));
						cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data);
						
						PdfPCell cell1data1=new PdfPCell(new Phrase(""+rspt.getString("prj_srno"),new Font(Font.TIMES_ROMAN,8)));
						cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data1);
						PdfPCell cell1data0=new PdfPCell(new Phrase(""+rspt.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8)));
						cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data0);
						
						String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
						PdfPCell cell1data2=new PdfPCell(new Phrase(""+empname,new Font(Font.TIMES_ROMAN,8)));
						cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data2);
						PdfPCell cell1data4=new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("DESIG",rspt.getInt("DESIG")),new Font(Font.TIMES_ROMAN,8)));
						cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data4);
				    }
					PdfPCell cell1data3=new PdfPCell(new Phrase(""+frdt+"      To  "+todt,new Font(Font.TIMES_ROMAN,8)));
					cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
					table.addCell(cell1data3);
					
					PdfPCell cell1data5=new PdfPCell(new Phrase(""+rspt.getString("DAYS"),new Font(Font.TIMES_ROMAN,8)));
					cell1data5.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell1data5);
					PdfPCell cell1data6=new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("LEAVE",rspt.getInt("LEAVECD")),new Font(Font.TIMES_ROMAN,8)));
					cell1data6.setHorizontalAlignment(Element.ALIGN_LEFT);
					table.addCell(cell1data6);
					PdfPCell cell1data61=new PdfPCell(new Phrase(""+rspt.getString("LREASON"),new Font(Font.TIMES_ROMAN,8)));
					cell1data61.setHorizontalAlignment(Element.ALIGN_LEFT);
					table.addCell(cell1data61);
					previousEmpCode = currentEmpCode;
				}
				document.add(table);	 
				para = new Paragraph(new Phrase("Total Number Of Employee :- "+totemp,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);
				document.add(para);
				document.close();
				file.close();
				con.close();
			} catch (Exception e)
			{		
				e.printStackTrace();
			}
		}catch (Exception e)
		{		
			e.printStackTrace();
		}
	  }
		
		// Cancel Leave List..
		public static void CancelLeaveList(String Branch,String selectedBranch,String rangefrom,String rangeTo,String fromDate,String toDate,String filepath, String imagepath )
		{
			RepoartBean repBean  = new RepoartBean();
			try
			{
				String fdate="";
				System.out.println("date: "+fromDate);
				String fdate1[] = fromDate.split("-");
				System.out.println("month: "+fdate1[1]);
				Connection Cn = null;
				Statement st = null;
				ResultSet rs = null;
				ResultSet rs1 = null;
				
				OutputStream file = null;
				try {
					file = new FileOutputStream(new File(filepath));
				} catch (FileNotFoundException e1) {
					// TODO Auto-generated catch block
					e1.printStackTrace();
				}
				Document document = new Document();
				String table_name="";
				lable1="Report date : ";
				try {
					UtilityDAO dao = new UtilityDAO();
					PdfWriter writer =PdfWriter.getInstance(document, new FileOutputStream(filepath));

					Footer ftr = dao.new Footer(lable1);
					writer.setPageEvent(ftr);
					document.open();
					Image image1 = Image.getInstance(imagepath);
					image1.scaleAbsolute(80f, 80f);
					image1.setAbsolutePosition(40f, 730f); 
					document.add(image1);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);
					document.add(para);

					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					document.add(para);
					para = new Paragraph(new Phrase("Tel : +91-20 26812190,Email :",new Font(Font.TIMES_ROMAN,9)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					document.add(para);
					para = new Paragraph(new Phrase("Cancel Leave List ",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					document.add(para);
					/*para = new Paragraph(new Phrase("For The Month : "+fdate1[1]+"-"+fdate1[2],new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);   //+fdate1[1]+"-"+fdate1[2]
					para.setSpacingAfter(0);
					document.add(para);*/
					PdfPTable table=new PdfPTable(9);
					table.setSpacingBefore(10.0f);
					table.setWidthPercentage(new float[]{5,7,7,35,15,12,5,7,18},new Rectangle(100,100));
					PdfPCell cell1=new PdfPCell(new Phrase("Sr No",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell1);
					PdfPCell cell11=new PdfPCell(new Phrase("Branch",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell11);
					PdfPCell cell2=new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell2);
					PdfPCell cell3=new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell3);
					PdfPCell cell5=new PdfPCell(new Phrase("Desig",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell5);
					PdfPCell cell4=new PdfPCell(new Phrase("Date",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell4);
					
					PdfPCell cell6=new PdfPCell(new Phrase("Days",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell6);
					PdfPCell cell7=new PdfPCell(new Phrase("LType",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell7);
					PdfPCell cell71=new PdfPCell(new Phrase("Reason",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell71.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell71);
					table.setHeaderRows(1);
					Connection con=null;
					con=ConnectionManager.getConnection();
					Statement stmt=con.createStatement();
					ResultSet rspt = null;
					String Query1="";
					if(Branch.equalsIgnoreCase("1"))
					{	
					Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
							" l.frmdt,l.todt,l.STATUS,l.APPLNO,"+
							" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
							" FROM     leavetran l,empmast e1,emptran T "+
							" WHERE     l.STATUS='CANCEL'  "+
							" AND      FRMDT between '"+fromDate+"' and '"+toDate+"' "+
							" AND      l.empno =e1.empno "+
							" AND      e1.status ='A'" +
							" and      t.empno = e1.empno "+
							" AND      t.srno =(SELECT max(e2.srno) "+
							" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
							" ORDER BY T.prj_srno ";
					}
					if(Branch.equalsIgnoreCase("2"))
					{
						//" and T.PRJ_SRNO="+selectedBranch+
			Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
					" l.frmdt,l.todt,l.STATUS,l.APPLNO,"+
					" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
					" FROM     leavetran l,empmast e1,emptran T "+
					" WHERE     l.STATUS='CANCEL'  "+
					" AND      FRMDT between '"+fromDate+"' and '"+toDate+"' "+
					" and T.PRJ_SRNO="+selectedBranch+
					" AND      l.empno =e1.empno "+
					" AND      e1.status ='A'" +
					" and      t.empno = e1.empno "+
					" AND      t.srno =(SELECT max(e2.srno) "+
					" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
					" ORDER BY e1.empcode ";
					}
					if(Branch.equalsIgnoreCase("3"))
					{
						Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
								" l.frmdt,l.todt,l.STATUS,l.APPLNO,"+
								" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
								" FROM     leavetran l,empmast e1,emptran T "+
								" WHERE     l.STATUS='CANCEL'  "+
								" AND      FRMDT between '"+fromDate+"' and '"+toDate+"' "+
								"and T.PRJ_SRNO between "+rangefrom+" and "+ rangeTo+" "+
								" AND      l.empno =e1.empno "+
								" AND      e1.status ='A'" +
								" and      t.empno = e1.empno "+
								" AND      t.srno =(SELECT max(e2.srno) "+
								" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
								" ORDER BY T.prj_srno ";
					}
					System.out.println("query is  "+Query1);
					rspt = stmt.executeQuery(Query1);
					int srno=0;
					String previousEmpCode="";
					String currentEmpCode="";
					double totatlAmount=0;
					LookupHandler lkp=new LookupHandler();
					int i = 0;
					int totemp=0;
					while(rspt.next())
					{
						 DateFormat outputFormat = new SimpleDateFormat("dd-MM-yyyy");
						 DateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd");
						 Date date = inputFormat.parse(rspt.getString("FRMDT"));
						 Date date1 = inputFormat.parse(rspt.getString("TODT"));
						 String frdt = outputFormat.format(date);
						 String todt = outputFormat.format(date1);
						 
						currentEmpCode = rspt.getString("EMPCODE");
						i++;
						System.out.println("in while  "+i);
						srno++;
					    if(rspt.getRow()!=1 && previousEmpCode.equalsIgnoreCase(currentEmpCode)){	
					    	PdfPCell cell1data=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,9)));
							cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data);
					    	
						PdfPCell cell1data1=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
						cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data1);
						PdfPCell cell1data0=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
						cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data0);
						
						String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
						PdfPCell cell1data2=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
						cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data2);
						PdfPCell cell1data4=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
						cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data4);
						}
					    else{
					    	totemp++;
							PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,9)));
							cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data);
							
							PdfPCell cell1data1=new PdfPCell(new Phrase(""+rspt.getString("prj_srno"),new Font(Font.TIMES_ROMAN,8)));
							cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data1);
							PdfPCell cell1data0=new PdfPCell(new Phrase(""+rspt.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8)));
							cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data0);
							
							String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
							PdfPCell cell1data2=new PdfPCell(new Phrase(""+empname,new Font(Font.TIMES_ROMAN,8)));
							cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data2);
							PdfPCell cell1data4=new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("DESIG",rspt.getInt("DESIG")),new Font(Font.TIMES_ROMAN,8)));
							cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data4);
					    }
						PdfPCell cell1data3=new PdfPCell(new Phrase(""+frdt+"      To  "+todt,new Font(Font.TIMES_ROMAN,8)));
						cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data3);
						
						PdfPCell cell1data5=new PdfPCell(new Phrase(""+rspt.getString("DAYS"),new Font(Font.TIMES_ROMAN,8)));
						cell1data5.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data5);
						PdfPCell cell1data6=new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("LEAVE",rspt.getInt("LEAVECD")),new Font(Font.TIMES_ROMAN,8)));
						cell1data6.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data6);
						PdfPCell cell1data61=new PdfPCell(new Phrase(""+rspt.getString("LREASON"),new Font(Font.TIMES_ROMAN,8)));
						cell1data61.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data61);
						previousEmpCode = currentEmpCode;
					}
					document.add(table);	 
					para = new Paragraph(new Phrase("Total Number Of Employee :- "+totemp,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(10);
					document.add(para);
					document.close();
					file.close();
					con.close();
				} catch (Exception e)
				{		
					e.printStackTrace();
				}
				
			}catch (Exception e)
			{		
				e.printStackTrace();
			}
		}
		
		// Not Sanction Leave List
		public static void NotSanctionLeaveList(String Branch,String selectedBranch,String rangefrom,String rangeTo,
				 String frmdate,String todate,String empno1,String EType,String SelectType,String filepath, String imagepath )
		{
			String fdate="";
			System.out.println("date: "+frmdate);
			String fdate1[] = frmdate.split("-");
			System.out.println("month: "+fdate1[1]);
			Connection Cn = null;
			Statement st = null;
			ResultSet rs = null;
			ResultSet rs1 = null;
			
			OutputStream file = null;
			try {
				file = new FileOutputStream(new File(filepath));
			} catch (FileNotFoundException e1) {
				e1.printStackTrace();
			}
			Document document = new Document();
			String table_name="";
			lable1="Report date : ";
			try {
				UtilityDAO dao = new UtilityDAO();
				PdfWriter writer =PdfWriter.getInstance(document, new FileOutputStream(filepath));

				Footer ftr = dao.new Footer(lable1);
				writer.setPageEvent(ftr);
				document.open();
				Image image1 = Image.getInstance(imagepath);
				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f); 
				document.add(image1);
				Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				document.add(para);

				para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Tel : +91-20 26812190,Email :",new Font(Font.TIMES_ROMAN,9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(new Phrase("Not Sanction Leave List ",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				document.add(para);
				/*para = new Paragraph(new Phrase("For The Month : "+fdate1[1]+"-"+fdate1[2],new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);   //+fdate1[1]+"-"+fdate1[2]
				para.setSpacingAfter(0);
				document.add(para);*/
				PdfPTable table=new PdfPTable(9);
				table.setSpacingBefore(20.0f);
				table.setWidthPercentage(new float[]{5,7,7,35,15,12,5,7,18},new Rectangle(100,100));
				PdfPCell cell1=new PdfPCell(new Phrase("Sr No",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1);
				PdfPCell cell11=new PdfPCell(new Phrase("Branch",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell11);
				PdfPCell cell2=new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell2);
				PdfPCell cell3=new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell3);
				PdfPCell cell5=new PdfPCell(new Phrase("Desig",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell5);
				PdfPCell cell4=new PdfPCell(new Phrase("Date",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell4);
				
				PdfPCell cell6=new PdfPCell(new Phrase("Days",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell6);
				PdfPCell cell7=new PdfPCell(new Phrase("LType",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell7);
				PdfPCell cell71=new PdfPCell(new Phrase("Reason",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
				cell71.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell71);
				table.setHeaderRows(1);
				Connection con=null;
				con=ConnectionManager.getConnection();
				Statement stmt=con.createStatement();
				ResultSet rspt = null;
				String Query1="";
				System.out.println("EType:  "+EType);
				
				if(EType.equalsIgnoreCase("1") && SelectType.equalsIgnoreCase("1"))
				{	
					System.out.println("i am in all emp");
				Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
						" l.frmdt,l.todt,l.STATUS,l.APPLNO,"+
						" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
						" FROM     leavetran l,empmast e1,emptran T "+
						" WHERE     l.STATUS='Pending'  "+
						" AND      FRMDT between '"+frmdate+"' and '"+todate+"' "+
						" AND      l.empno =e1.empno "+
						" AND      e1.status ='A'" +
						" and      t.empno = e1.empno "+
						" AND      t.srno =(SELECT max(e2.srno) "+
						" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
						" ORDER BY  T.PRJ_SRNO ";
				}
				if(EType.equalsIgnoreCase("2") && SelectType.equalsIgnoreCase("1"))
				{
					System.out.println("i am in spec.emp");
		Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
				" l.frmdt,l.todt,l.STATUS,l.APPLNO,"+
				" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
				" FROM     leavetran l,empmast e1,emptran T "+
				" WHERE     l.STATUS='Pending'  "+
				" AND      FRMDT between '"+frmdate+"' and '"+todate+"' "+
				" and l.EMPNO="+empno1+" "+
				" AND      l.empno =e1.empno "+
				" AND      e1.status ='A'" +
				" and      t.empno = e1.empno "+
				" AND      t.srno =(SELECT max(e2.srno) "+
				" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
				" ORDER BY e1.empcode ";
				}
				if(Branch.equalsIgnoreCase("1") && SelectType.equalsIgnoreCase("2"))
				{	
					System.out.println("i am in all branch");
				Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
						" l.frmdt,l.todt,l.STATUS,l.APPLNO,"+
						" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
						" FROM     leavetran l,empmast e1,emptran T "+
						" WHERE     l.STATUS='Pending'  "+
						" AND      FRMDT between '"+frmdate+"' and '"+todate+"' "+
						" AND      l.empno =e1.empno "+
						" AND      e1.status ='A'" +
						" and      t.empno = e1.empno "+
						" AND      t.srno =(SELECT max(e2.srno) "+
						" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
						" ORDER BY T.PRJ_SRNO ";
				}
				if(Branch.equalsIgnoreCase("2") && SelectType.equalsIgnoreCase("2"))
				{
					System.out.println("i am in selected Branch");
					Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
							" l.frmdt,l.todt,l.STATUS,l.APPLNO,"+
							" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
							" FROM     leavetran l,empmast e1,emptran T "+
							" WHERE     l.STATUS='Pending'  "+
							" AND      FRMDT between '"+frmdate+"' and '"+todate+"' "+
							" and T.PRJ_SRNO="+selectedBranch+
							" AND      l.empno =e1.empno "+
							" AND      e1.status ='A'" +
							" and      t.empno = e1.empno "+
							" AND      t.srno =(SELECT max(e2.srno) "+
							" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
							" ORDER BY e1.empcode ";
				}
				if(Branch.equalsIgnoreCase("3") && SelectType.equalsIgnoreCase("2"))
				{	
					System.out.println("i am in selected Range..");
				Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
						" l.frmdt,l.todt,l.STATUS,l.APPLNO,"+
						" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
						" FROM     leavetran l,empmast e1,emptran T "+
						" WHERE     l.STATUS='Pending'  "+
						" AND      FRMDT between '"+frmdate+"' and '"+todate+"' "+
						" and T.PRJ_SRNO between "+rangefrom+" and "+ rangeTo+" "+
						" AND      l.empno =e1.empno "+
						" AND      e1.status ='A'" +
						" and      t.empno = e1.empno "+
						" AND      t.srno =(SELECT max(e2.srno) "+
						" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
						" ORDER BY  T.PRJ_SRNO ";
				}
				
				System.out.println("query is  "+Query1);
				rspt = stmt.executeQuery(Query1);
				int srno=0;
				String previousEmpCode="";
				String currentEmpCode="";
				double totatlAmount=0;
				LookupHandler lkp=new LookupHandler();
				int i = 0;
				int totemp=0;
				while(rspt.next())
				{
					 DateFormat outputFormat = new SimpleDateFormat("dd-MM-yyyy");
					 DateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd");
					 Date date = inputFormat.parse(rspt.getString("FRMDT"));
					 Date date1 = inputFormat.parse(rspt.getString("TODT"));
					 String frdt = outputFormat.format(date);
					 String todt = outputFormat.format(date1);
					 
					currentEmpCode = rspt.getString("EMPCODE");
					i++;
					System.out.println("in while  "+i);
					srno++;
					if(rspt.getRow()!=1 && previousEmpCode.equalsIgnoreCase(currentEmpCode)){		
				 		PdfPCell cell1data=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,9)));
						cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data);
				    	
					PdfPCell cell1data1=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
					cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell1data1);
					PdfPCell cell1data0=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
					cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell1data0);
					
					String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
					PdfPCell cell1data2=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
					cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
					table.addCell(cell1data2);
					PdfPCell cell1data4=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
					cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
					table.addCell(cell1data4);
					}
				    else{
				    	totemp++;
						PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,9)));
						cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data);
						
						PdfPCell cell1data1=new PdfPCell(new Phrase(""+rspt.getString("prj_srno"),new Font(Font.TIMES_ROMAN,8)));
						cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data1);
						PdfPCell cell1data0=new PdfPCell(new Phrase(""+rspt.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8)));
						cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data0);
						
						String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
						PdfPCell cell1data2=new PdfPCell(new Phrase(""+empname,new Font(Font.TIMES_ROMAN,8)));
						cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data2);
						PdfPCell cell1data4=new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("DESIG",rspt.getInt("DESIG")),new Font(Font.TIMES_ROMAN,8)));
						cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data4);
				    }
					PdfPCell cell1data3=new PdfPCell(new Phrase(""+frdt+"      To  "+todt,new Font(Font.TIMES_ROMAN,8)));
					cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
					table.addCell(cell1data3);
					
					PdfPCell cell1data5=new PdfPCell(new Phrase(""+rspt.getString("DAYS"),new Font(Font.TIMES_ROMAN,8)));
					cell1data5.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell1data5);
					PdfPCell cell1data6=new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("LEAVE",rspt.getInt("LEAVECD")),new Font(Font.TIMES_ROMAN,8)));
					cell1data6.setHorizontalAlignment(Element.ALIGN_LEFT);
					table.addCell(cell1data6);
					PdfPCell cell1data61=new PdfPCell(new Phrase(""+rspt.getString("LREASON"),new Font(Font.TIMES_ROMAN,8)));
					cell1data61.setHorizontalAlignment(Element.ALIGN_LEFT);
					table.addCell(cell1data61);
					previousEmpCode = currentEmpCode;
				}
				document.add(table);	 
				para = new Paragraph(new Phrase("Total Number Of Employee :- "+totemp,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);
				document.add(para);
				document.close();
				file.close();
				con.close();
			} catch (Exception e)
			{		
				e.printStackTrace();
			}
			
		}
		// App. DateWise Leave List
			public static void AppDateWiseLeaveList(String Branch,String selectedBranch,String rangefrom,String rangeTo,
					 String frmdate,String todate,String empno1,String EType,String LType,String leaveType1,String SelectType,String filepath, String imagepath )
			{
				String fdate="";
				System.out.println("date: "+frmdate);
				String fdate1[] = frmdate.split("-");
				System.out.println("month: "+fdate1[1]);
				Connection Cn = null;
				Statement st = null;
				ResultSet rs = null;
				ResultSet rs1 = null;
				
				OutputStream file = null;
				try {
					file = new FileOutputStream(new File(filepath));
				} catch (FileNotFoundException e1) {
					// TODO Auto-generated catch block
					e1.printStackTrace();
				}
				Document document = new Document();
				String table_name="";
				lable1="Report date : ";
				try {
					UtilityDAO dao = new UtilityDAO();
					PdfWriter writer =PdfWriter.getInstance(document, new FileOutputStream(filepath));

					Footer ftr = dao.new Footer(lable1);
					writer.setPageEvent(ftr);
					document.open();
					Image image1 = Image.getInstance(imagepath);
					image1.scaleAbsolute(80f, 80f);
					image1.setAbsolutePosition(40f, 730f); 
					document.add(image1);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);
					document.add(para);

					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					document.add(para);
					para = new Paragraph(new Phrase("Tel : +91-20 26812190,Email :",new Font(Font.TIMES_ROMAN,9)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					document.add(para);
					para = new Paragraph(new Phrase("Application DateWise Leave List ",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					document.add(para);
					/*para = new Paragraph(new Phrase("For The Month : "+fdate1[1]+"-"+fdate1[2],new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);   //+fdate1[1]+"-"+fdate1[2]
					para.setSpacingAfter(0);
					document.add(para);*/
					PdfPTable table=new PdfPTable(12);
					table.setSpacingBefore(20.0f);
					table.setWidthPercentage(new float[]{5,5,5,22,15,12,6,7,5,5,11,9},new Rectangle(100,100));
					PdfPCell cell1=new PdfPCell(new Phrase("Sr No",new Font(Font.TIMES_ROMAN,6,Font.BOLD)));
					cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell1);
					PdfPCell cell11=new PdfPCell(new Phrase("Branch",new Font(Font.TIMES_ROMAN,6,Font.BOLD)));
					cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell11);
					PdfPCell cell2=new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,6,Font.BOLD)));
					cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell2);
					PdfPCell cell3=new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,6,Font.BOLD)));
					cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell3);
					PdfPCell cell5=new PdfPCell(new Phrase("Desig",new Font(Font.TIMES_ROMAN,6,Font.BOLD)));
					cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell5);
					PdfPCell cell4=new PdfPCell(new Phrase("Date",new Font(Font.TIMES_ROMAN,6,Font.BOLD)));
					cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell4);
					PdfPCell cell711=new PdfPCell(new Phrase("App.No",new Font(Font.TIMES_ROMAN,6,Font.BOLD)));
					cell711.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell711);
					
					PdfPCell cell7111=new PdfPCell(new Phrase("App.Date",new Font(Font.TIMES_ROMAN,6,Font.BOLD)));
					cell7111.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell7111);
					PdfPCell cell6=new PdfPCell(new Phrase("Days",new Font(Font.TIMES_ROMAN,6,Font.BOLD)));
					cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell6);
					PdfPCell cell7=new PdfPCell(new Phrase("LType",new Font(Font.TIMES_ROMAN,6,Font.BOLD)));
					cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell7);
					PdfPCell cell71=new PdfPCell(new Phrase("Reason",new Font(Font.TIMES_ROMAN,6,Font.BOLD)));
					cell71.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell71);
					
					PdfPCell cell71111=new PdfPCell(new Phrase("Sanction(Y/N)",new Font(Font.TIMES_ROMAN,6,Font.BOLD)));
					cell71111.setHorizontalAlignment(Element.ALIGN_LEFT);
					table.addCell(cell71111);
					
					table.setHeaderRows(1);
					Connection con=null;
					con=ConnectionManager.getConnection();
					Statement stmt=con.createStatement();
					ResultSet rspt = null;
					String Query1="";
					System.out.println("EType:  "+EType);
					System.out.println("LType DAO  "+LType);
					
					// FOR All Leave and All Emp 
					if(LType.equalsIgnoreCase("1") && EType.equalsIgnoreCase("1") && SelectType.equalsIgnoreCase("1"))
					{
						System.out.println("All Leave and All Emp");
						Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
								" l.frmdt,l.todt,l.STATUS,l.APPLNO,l.APPLDT,"+
								" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO,l.STATUS "+
								" FROM     leavetran l,empmast e1,emptran T "+
								" WHERE     FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" AND      l.empno =e1.empno "+
								" AND      e1.status ='A'" +
								" and l.STATUS <> '1'"+
								" and      t.empno = e1.empno "+
								" AND      t.srno =(SELECT max(e2.srno) "+
								" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
								" ORDER BY  l.FRMDT,l.TODT ";
					}
					//All Leave and All Branch..
					if(LType.equalsIgnoreCase("1") && Branch.equalsIgnoreCase("1") && SelectType.equalsIgnoreCase("2"))
					{
						System.out.println(" All Leave and All Branch.. ");
						Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
								" l.frmdt,l.todt,l.STATUS,l.APPLNO,l.APPLDT,"+
								" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO,l.STATUS "+
								" FROM     leavetran l,empmast e1,emptran T "+
								" WHERE     FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" AND      l.empno =e1.empno "+
								" AND      e1.status ='A'" +
								" and l.STATUS <> '1'"+
								" and      t.empno = e1.empno "+
								" AND      t.srno =(SELECT max(e2.srno) "+
								" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
								" ORDER BY  l.FRMDT,l.TODT ";
					}
					// FOR All Leave and Specific Emp..
					if(LType.equalsIgnoreCase("1") && EType.equalsIgnoreCase("2") && SelectType.equalsIgnoreCase("1")){
						System.out.println("FOR All Leave and Specific Emp");
						Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
								" l.frmdt,l.todt,l.STATUS,l.APPLNO,l.APPLDT,"+
								" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
								" FROM     leavetran l,empmast e1,emptran T "+
								" WHERE     FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" AND      l.empno =e1.empno "+
								" AND      e1.status ='A'" +
								" and l.STATUS <> '1'"+
								" and      t.empno = e1.empno "+
								" AND      t.srno =(SELECT max(e2.srno) "+
								" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
								" and l.EMPNO="+empno1+""+
								" ORDER BY  l.FRMDT,l.TODT ";
					}
					// FOR Specific Leave and All Emp..
					if(LType.equalsIgnoreCase("2") && EType.equalsIgnoreCase("1") && SelectType.equalsIgnoreCase("1")){
						System.out.println("FOR Specific Leave and All Emp");
						Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
								" l.frmdt,l.todt,l.STATUS,l.APPLNO,l.APPLDT,"+
								" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
								" FROM     leavetran l,empmast e1,emptran T "+
								" WHERE     FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" AND      l.empno =e1.empno "+
								" AND      e1.status ='A'" +
								" and l.STATUS <> '1'"+
								" and      t.empno = e1.empno "+
								" AND      t.srno =(SELECT max(e2.srno) "+
								" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
								" and l.LEAVECD="+leaveType1+""+
								" ORDER BY  l.FRMDT,l.TODT ";
					}
					// FOR Specific Leave and Specific Emp..
					if(LType.equalsIgnoreCase("2") && EType.equalsIgnoreCase("2") && SelectType.equalsIgnoreCase("1")){
						System.out.println("FOR All Leave and Specific Emp");
						Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
								" l.frmdt,l.todt,l.STATUS,l.APPLNO,l.APPLDT,"+
								" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
								" FROM     leavetran l,empmast e1,emptran T "+
								" WHERE     FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" AND      l.empno =e1.empno "+
								" AND      e1.status ='A'" +
								" and l.STATUS <> '1'"+
								" and      t.empno = e1.empno "+
								" AND      t.srno =(SELECT max(e2.srno) "+
								" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
								" and l.LEAVECD="+leaveType1+""+
								" and l.EMPNO="+empno1+""+
								" ORDER BY l.FRMDT,l.TODT ";
					}
					// For All Leave Specific Branch
					if(LType.equalsIgnoreCase("1") && Branch.equalsIgnoreCase("2") && SelectType.equalsIgnoreCase("2")){
						System.out.println("All Leave Specific Branch ");
						Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
								" l.frmdt,l.todt,l.STATUS,l.APPLNO,l.APPLDT,"+
								" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO,l.STATUS "+
								" FROM     leavetran l,empmast e1,emptran T "+
								" WHERE     FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" AND      l.empno =e1.empno "+
								" AND      e1.status ='A'" +
								" and    l.STATUS <> '1'"+
								" and      t.empno = e1.empno "+
								" AND      t.srno =(SELECT max(e2.srno) "+
								" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
								" AND  T.PRJ_SRNO="+selectedBranch+
								" ORDER BY l.FRMDT,l.TODT ";
					}
					// For All Leave Branch Range.. 
					if(LType.equalsIgnoreCase("1") && Branch.equalsIgnoreCase("3") && SelectType.equalsIgnoreCase("2")){
						System.out.println("For All Leave Branch Range.. ");
						Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
								" l.frmdt,l.todt,l.STATUS,l.APPLNO,l.APPLDT,"+
								" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO,l.STATUS "+
								" FROM     leavetran l,empmast e1,emptran T "+
								" WHERE     FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" AND      l.empno =e1.empno "+
								" AND      e1.status ='A'" +
								" and    l.STATUS <> '1'"+
								" and      t.empno = e1.empno "+
								" AND      t.srno =(SELECT max(e2.srno) "+
								" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
								"and  T.PRJ_SRNO  between "+rangefrom+" and "+ rangeTo+" "+
								" ORDER BY l.FRMDT,l.TODT ";
					}
					// For Specific Leave All Branch.. 
					if(LType.equalsIgnoreCase("2") && Branch.equalsIgnoreCase("1") && SelectType.equalsIgnoreCase("2")){
						System.out.println("For Specific Leave All Branch.. ");
						Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
								" l.frmdt,l.todt,l.STATUS,l.APPLNO,l.APPLDT,"+
								" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO,l.STATUS "+
								" FROM     leavetran l,empmast e1,emptran T "+
								" WHERE     FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" AND      l.empno =e1.empno "+
								" AND      e1.status ='A'" +
								" and    l.STATUS <> '1'"+
								" and      t.empno = e1.empno "+
								" AND      t.srno =(SELECT max(e2.srno) "+
								" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
								" AND l.leavecd= "+leaveType1+
								" ORDER BY l.FRMDT,l.TODT ";
					}
					// For Specific Leave Specific Branch.. 
					if(LType.equalsIgnoreCase("2") && Branch.equalsIgnoreCase("2") && SelectType.equalsIgnoreCase("2")){
						System.out.println("For Specific Leave Specific Branch.. ");
						Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
								" l.frmdt,l.todt,l.STATUS,l.APPLNO,l.APPLDT,"+
								" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO,l.STATUS "+
								" FROM     leavetran l,empmast e1,emptran T "+
								" WHERE     FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" AND      l.empno =e1.empno "+
								" AND      e1.status ='A'" +
								" and    l.STATUS <> '1'"+
								" and      t.empno = e1.empno "+
								" AND      t.srno =(SELECT max(e2.srno) "+
								" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
								" AND l.leavecd= "+leaveType1+
								" AND  T.PRJ_SRNO="+selectedBranch+
								" ORDER BY l.FRMDT,l.TODT ";
					}
					// For Specific Leave Branch Range.. 
					if(LType.equalsIgnoreCase("2") && Branch.equalsIgnoreCase("3") && SelectType.equalsIgnoreCase("2")){
						System.out.println("For Specific Leave Branch Range.. ");
						Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
								" l.frmdt,l.todt,l.STATUS,l.APPLNO,l.APPLDT,"+
								" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO,l.STATUS "+
								" FROM     leavetran l,empmast e1,emptran T "+
								" WHERE     FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" AND      l.empno =e1.empno "+
								" AND      e1.status ='A'" +
								" and    l.STATUS <> '1'"+
								" and      t.empno = e1.empno "+
								" AND      t.srno =(SELECT max(e2.srno) "+
								" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
								" AND l.leavecd= "+leaveType1+
								" and  T.PRJ_SRNO  between "+rangefrom+" and "+ rangeTo+" "+
								" ORDER BY l.FRMDT,l.TODT ";
					}
					
					System.out.println("query is  "+Query1);
					rspt = stmt.executeQuery(Query1);
					int srno=0;
					String previousEmpCode="";
					String currentEmpCode="";
					double totatlAmount=0;
					LookupHandler lkp=new LookupHandler();
					int i = 0;
					int totemp=0;
					while(rspt.next())
					{
						 DateFormat outputFormat = new SimpleDateFormat("dd-MM-yyyy");
						 DateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd");
						 Date date = inputFormat.parse(rspt.getString("FRMDT"));
						 Date date1 = inputFormat.parse(rspt.getString("TODT"));
						 Date date2 = inputFormat.parse(rspt.getString("APPLDT"));
						 String frdt = outputFormat.format(date);
						 String todt = outputFormat.format(date1);
						 String appldt = outputFormat.format(date2);
						 
						currentEmpCode = rspt.getString("EMPCODE");
						i++;
						System.out.println("in while  "+i);
						srno++;
					    if(rspt.getRow()!=1 && previousEmpCode.equalsIgnoreCase(currentEmpCode)){	
					    	PdfPCell cell1data=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,6)));
							cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data);
					    	
						PdfPCell cell1data1=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,6)));
						cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data1);
						PdfPCell cell1data0=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,6)));
						cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data0);
						
						String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
						PdfPCell cell1data2=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,6)));
						cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data2);
						PdfPCell cell1data4=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,6)));
						cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data4);
						}
					    else{
					    	totemp++;
							PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,6)));
							cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data);
							
							PdfPCell cell1data1=new PdfPCell(new Phrase(""+rspt.getString("prj_srno"),new Font(Font.TIMES_ROMAN,6)));
							cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data1);
							PdfPCell cell1data0=new PdfPCell(new Phrase(""+rspt.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,6)));
							cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data0);
							
							String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
							PdfPCell cell1data2=new PdfPCell(new Phrase(""+empname,new Font(Font.TIMES_ROMAN,6)));
							cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data2);
							PdfPCell cell1data4=new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("DESIG",rspt.getInt("DESIG")),new Font(Font.TIMES_ROMAN,6)));
							cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data4);
					    }
						PdfPCell cell1data3=new PdfPCell(new Phrase(""+frdt+"       To    "+todt,new Font(Font.TIMES_ROMAN,6)));
						cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data3);
						PdfPCell cell1data611=new PdfPCell(new Phrase(""+rspt.getString("APPLNO"),new Font(Font.TIMES_ROMAN,6)));
						cell1data611.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data611);
						PdfPCell cell1data6111=new PdfPCell(new Phrase(""+appldt,new Font(Font.TIMES_ROMAN,6)));
						cell1data6111.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data6111);
						PdfPCell cell1data5=new PdfPCell(new Phrase(""+rspt.getString("DAYS"),new Font(Font.TIMES_ROMAN,6)));
						cell1data5.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data5);
						PdfPCell cell1data6=new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("LEAVE",rspt.getInt("LEAVECD")),new Font(Font.TIMES_ROMAN,6)));
						cell1data6.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data6);
						PdfPCell cell1data61=new PdfPCell(new Phrase(""+rspt.getString("LREASON"),new Font(Font.TIMES_ROMAN,6)));
						cell1data61.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data61);
						
						String status="";
						if(rspt.getString("STATUS").equalsIgnoreCase("SANCTION")){
							status="Y";
						}else{status="N";}
						PdfPCell cell1data61111=new PdfPCell(new Phrase(""+status,new Font(Font.TIMES_ROMAN,6)));
						cell1data61111.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data61111);
						previousEmpCode = currentEmpCode;
					}
					document.add(table);	 
					para = new Paragraph(new Phrase("Total Number Of Employee :- "+totemp,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(10);
					document.add(para);
					document.close();
					file.close();
					con.close();
				} catch (Exception e)
				{		
					e.printStackTrace();
				}
			}
			
			// Negative Balance Leave List...13.01.18
			
			public static void NegativebalanceLeaveList(String Branch,String selectedBranch,String rangefrom,String rangeTo,String frmBaldt,String toBaldt,String filepath, String imagepath )
			{
				RepoartBean repBean  = new RepoartBean();
				try
				{
					String fdate="";
					String fdate1[] = frmBaldt.split("-");
					System.out.println("month: "+fdate1[1]);
					Connection Cn = null;
					Statement st = null;
					ResultSet rs = null;
					ResultSet rs1 = null;
					
					OutputStream file = null;
					try {
						file = new FileOutputStream(new File(filepath));
					} catch (FileNotFoundException e1) {
						e1.printStackTrace();
					}
					Document document = new Document();
					String table_name="";
					lable1="Report date : ";
					try {
						UtilityDAO dao = new UtilityDAO();
						PdfWriter writer =PdfWriter.getInstance(document, new FileOutputStream(filepath));

						Footer ftr = dao.new Footer(lable1);
						writer.setPageEvent(ftr);
						document.open();
						Image image1 = Image.getInstance(imagepath);
						image1.scaleAbsolute(80f, 80f);
						image1.setAbsolutePosition(40f, 730f); 
						document.add(image1);
						Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
						Paragraph para = new Paragraph(title);
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingBefore(0);
						document.add(para);

						para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(0);

						document.add(para);
						para = new Paragraph(new Phrase("Tel : +91-20 26812190,Email :",new Font(Font.TIMES_ROMAN,9)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(0);
						document.add(para);
						para = new Paragraph(new Phrase("Negative Balance Leave List ",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(0);
						document.add(para);
						/*para = new Paragraph(new Phrase("For The Month : "+fdate1[1]+"-"+fdate1[2],new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						para.setAlignment(Element.ALIGN_CENTER);   //+fdate1[1]+"-"+fdate1[2]
						para.setSpacingAfter(0);
						document.add(para);*/
						PdfPTable table=new PdfPTable(8);
						table.setSpacingBefore(10.0f);
						table.setWidthPercentage(new float[]{5,7,7,35,15,12,12,10},new Rectangle(100,100));
						PdfPCell cell1=new PdfPCell(new Phrase("Sr No",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1);
						PdfPCell cell11=new PdfPCell(new Phrase("Branch",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell11);
						PdfPCell cell2=new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell2);
						PdfPCell cell3=new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell3);
						PdfPCell cell5=new PdfPCell(new Phrase("Desig",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell5);
						PdfPCell cell4=new PdfPCell(new Phrase("Bal Date",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell4);
						
						PdfPCell cell7=new PdfPCell(new Phrase("LType",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell7);
						PdfPCell cell6=new PdfPCell(new Phrase("Balance",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell6);
						
						/*PdfPCell cell71=new PdfPCell(new Phrase("Reason",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell71.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell71);*/
						table.setHeaderRows(1);
						Connection con=null;
						con=ConnectionManager.getConnection();
						Statement stmt=con.createStatement();
						ResultSet rspt = null;
						String Query1="";
						if(Branch.equalsIgnoreCase("1"))
						{	
						Query1= "SELECT   e1.empcode ,fname,mname,lname,l.LEAVECD,"+
								" l.BAL,l.BALDT,T.DESIG,T.PRJ_SRNO "+
								" FROM     leavebal l,empmast e1,emptran T "+
								" WHERE      l.BAL < 0  "+
								" AND      BALDT  between '"+frmBaldt+"' and '"+toBaldt+"' "+
								" AND      l.empno =e1.empno "+
								" AND      e1.status ='A'" +
								" and      t.empno = e1.empno "+
								" AND      t.srno =(SELECT max(e2.srno) "+
								" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
								" ORDER BY  T.PRJ_SRNO ";
						}
						if(Branch.equalsIgnoreCase("2"))
						{
							Query1= "SELECT   e1.empcode ,fname,mname,lname,l.LEAVECD,"+
									" l.BAL,l.BALDT,T.DESIG,T.PRJ_SRNO "+
									" FROM     leavebal l,empmast e1,emptran T "+
									" WHERE      l.BAL < 0  "+
									" AND      BALDT  between '"+frmBaldt+"' and '"+toBaldt+"' "+
									" AND      l.empno =e1.empno "+
									" AND      e1.status ='A'" +
									" and      t.empno = e1.empno "+
									" and T.PRJ_SRNO="+selectedBranch+
									" AND      t.srno =(SELECT max(e2.srno) "+
									" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
									" ORDER BY e1.empcode ";
						}
						if(Branch.equalsIgnoreCase("3"))
						{
								Query1= "SELECT   e1.empcode ,fname,mname,lname,l.LEAVECD,"+
										" l.BAL,l.BALDT,T.DESIG,T.PRJ_SRNO "+
										" FROM     leavebal l,empmast e1,emptran T "+
										" WHERE      l.BAL < 0  "+
										" AND      BALDT  between '"+frmBaldt+"' and '"+toBaldt+"' "+
										" AND      l.empno =e1.empno "+
										" AND      e1.status ='A'" +
										" and      t.empno = e1.empno "+
										" and T.PRJ_SRNO between "+rangefrom+" and "+ rangeTo+" "+
										" AND      t.srno =(SELECT max(e2.srno) "+
										" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
										" ORDER BY T.PRJ_SRNO ";
						}
						System.out.println("query is  "+Query1);
						rspt = stmt.executeQuery(Query1);
						int srno=0;
						String previousEmpCode="";
						String currentEmpCode="";
						double totatlAmount=0;
						LookupHandler lkp=new LookupHandler();
						int i = 0;
						int totemp=0;
						while(rspt.next())
						{
							 DateFormat outputFormat = new SimpleDateFormat("dd-MM-yyyy");
							 DateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd");
							 Date date = inputFormat.parse(rspt.getString("BALDT"));
							 String baldt = outputFormat.format(date);
							
							currentEmpCode = rspt.getString("EMPCODE");
							i++;
							System.out.println("in while  "+i);
							srno++;
						    if(rspt.getRow()!=1 && previousEmpCode.equalsIgnoreCase(currentEmpCode)){	
						    	PdfPCell cell1data=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,9)));
								cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
								table.addCell(cell1data);
						    	
							PdfPCell cell1data1=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
							cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data1);
							PdfPCell cell1data0=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
							cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data0);
							
							String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
							PdfPCell cell1data2=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
							cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data2);
							PdfPCell cell1data4=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
							cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data4);
							}
						    else{
						    	totemp++;
								PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,9)));
								cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
								table.addCell(cell1data);
								
								PdfPCell cell1data1=new PdfPCell(new Phrase(""+rspt.getString("prj_srno"),new Font(Font.TIMES_ROMAN,8)));
								cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
								table.addCell(cell1data1);
								PdfPCell cell1data0=new PdfPCell(new Phrase(""+rspt.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8)));
								cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
								table.addCell(cell1data0);
								
								String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
								PdfPCell cell1data2=new PdfPCell(new Phrase(""+empname,new Font(Font.TIMES_ROMAN,8)));
								cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
								table.addCell(cell1data2);
								PdfPCell cell1data4=new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("DESIG",rspt.getInt("DESIG")),new Font(Font.TIMES_ROMAN,8)));
								cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
								table.addCell(cell1data4);
						    }
							PdfPCell cell1data3=new PdfPCell(new Phrase(""+baldt,new Font(Font.TIMES_ROMAN,8)));
							cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data3);
							
							PdfPCell cell1data6=new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("LEAVE",rspt.getInt("LEAVECD")),new Font(Font.TIMES_ROMAN,8)));
							cell1data6.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data6);
							PdfPCell cell1data5=new PdfPCell(new Phrase(""+rspt.getString("BAL"),new Font(Font.TIMES_ROMAN,8)));
							cell1data5.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data5);
							
							/*PdfPCell cell1data61=new PdfPCell(new Phrase(""+rspt.getString("LREASON"),new Font(Font.TIMES_ROMAN,8)));
							cell1data61.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data61);*/
							previousEmpCode = currentEmpCode;
						}
						document.add(table);	 
						para = new Paragraph(new Phrase("Total Number Of Employee :- "+totemp,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(10);
						document.add(para);
						document.close();
						file.close();
						con.close();
					} catch (Exception e)
					{		
						e.printStackTrace();
					}
					
				}catch (Exception e)
				{		
					e.printStackTrace();
				}
			}	
			// LWP > 25 List..
			public static void LwpGreater25List(String Branch,String selectedBranch,String rangefrom,String rangeTo,String fromDate,String toDate,String filepath, String imagepath )
			{
				RepoartBean repBean  = new RepoartBean();
				try
				{
					String fdate="";
					System.out.println("date: "+fromDate);
					String fdate1[] = fromDate.split("-");
					System.out.println("month: "+fdate1[1]);
					Connection Cn = null;
					Statement st = null;
					ResultSet rs = null;
					ResultSet rs1 = null;
					
					OutputStream file = null;
					try {
						file = new FileOutputStream(new File(filepath));
					} catch (FileNotFoundException e1) {
						// TODO Auto-generated catch block
						e1.printStackTrace();
					}
					Document document = new Document();
					String table_name="";
					lable1="Report date : ";
					try {
						UtilityDAO dao = new UtilityDAO();
						PdfWriter writer =PdfWriter.getInstance(document, new FileOutputStream(filepath));

						Footer ftr = dao.new Footer(lable1);
						writer.setPageEvent(ftr);
						document.open();
						Image image1 = Image.getInstance(imagepath);
						image1.scaleAbsolute(80f, 80f);
						image1.setAbsolutePosition(40f, 730f); 
						document.add(image1);
						Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
						Paragraph para = new Paragraph(title);
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingBefore(0);
						document.add(para);

						para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(0);

						document.add(para);
						para = new Paragraph(new Phrase("Tel : +91-20 26812190,Email :",new Font(Font.TIMES_ROMAN,9)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(0);
						document.add(para);
						para = new Paragraph(new Phrase("Lwp Greater than 25 List",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(0);
						document.add(para);
						/*para = new Paragraph(new Phrase("For The Month : "+fdate1[1]+"-"+fdate1[2],new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						para.setAlignment(Element.ALIGN_CENTER);   //+fdate1[1]+"-"+fdate1[2]
						para.setSpacingAfter(0);
						document.add(para);*/
						PdfPTable table=new PdfPTable(9);
						table.setSpacingBefore(30.0f);
						table.setWidthPercentage(new float[]{7,9,9,33,20,10,10,10,7},new Rectangle(105,100));
						PdfPCell cell1=new PdfPCell(new Phrase("Sr No",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1);
						PdfPCell cell11=new PdfPCell(new Phrase("Branch",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell11);
						PdfPCell cell2=new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell2);
						PdfPCell cell3=new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell3);
						PdfPCell cell5=new PdfPCell(new Phrase("Desig",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell5);
						PdfPCell cell51=new PdfPCell(new Phrase("LWP Total",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell51.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell51);
						PdfPCell cell4=new PdfPCell(new Phrase("From Date",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell4);
						PdfPCell cell41=new PdfPCell(new Phrase("To Date",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell41.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell41);
						
						PdfPCell cell6=new PdfPCell(new Phrase("Days",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell6);
						/*PdfPCell cell7=new PdfPCell(new Phrase("LType",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell7);
						PdfPCell cell71=new PdfPCell(new Phrase("Reason",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell71.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell71);*/
						table.setHeaderRows(1);
						Connection con=null;
						con=ConnectionManager.getConnection();
						Statement stmt=con.createStatement();
						ResultSet rspt = null;
						String Query1="";
						if(Branch.equalsIgnoreCase("1"))
						{	
						Query1= ""
								+ "with a as( "
								+ "SELECT e1.empcode, e1.EMPNO, "
								+ "       fname, "
								+ "       mname, "
								+ "       lname, e1.FILENUMBER, "
								+ "       l.frmdt, "
								+ "       l.todt, "
								+ "       l.applno, "
								+ "       l.days, "
								+ "       (select sum(l1.days) from leavetran l1 "
								+ "       where l1.empno=l.EMPNO and (l1.LEAVECD=7 or l1.LEAVECD=10) "
								+ "       and l1.frmdt BETWEEN '"+fromDate+"' and '"+toDate+"' and l1.STATUS='SANCTION')as tDays, "
								+ "	   l.leavecd,l.STATUS, "
								+ "       l.lreason, "
								+ "       T.desig, "
								+ "       T.prj_srno ,p.SITE_NAME "
								+ "FROM   leavetran l, "
								+ "       empmast e1, "
								+ "       emptran T ,Project_Sites p "
								+ "WHERE  (l.leavecd = 7 or l.LEAVECD=10) "
								+ "		AND frmdt BETWEEN '"+fromDate+"' and '"+toDate+"' "
								+ "        AND l.empno = e1.empno "
								+ "		AND t.empno = e1.empno "
								+ "        AND t.srno = (SELECT Max(e2.srno) FROM   emptran e2 WHERE  e2.empno = e1.empno) "
								+ "       AND p.SITE_ID=T.prj_srno and l.STATUS='SANCTION') "
								+ "       select * from a where a.tDays > 25 "
								+ " ORDER  BY a.prj_srno";
								/*"SELECT   e1.empcode ,fname,mname,lname,"+
								" l.frmdt,l.todt,l.APPLNO,"+
								" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
								" FROM     leavetran l,empmast e1,emptran T "+
								" WHERE    l.LEAVECD =7"+
								" and l.DAYS >= 25"+
								"  AND      FRMDT between '"+fromDate+"' and '"+toDate+"' "+
								" AND      l.empno =e1.empno "+
								" AND      e1.status ='A'" +
								" and      t.empno = e1.empno "+
								" AND      t.srno =(SELECT max(e2.srno) "+
								" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
								" ORDER BY  T.PRJ_SRNO ";*/
						}
						if(Branch.equalsIgnoreCase("2"))
						{
							//" and T.PRJ_SRNO="+selectedBranch+
							Query1= ""
									+ "with a as( "
									+ "SELECT e1.empcode, e1.EMPNO, "
									+ "       fname, "
									+ "       mname, "
									+ "       lname, e1.FILENUMBER, "
									+ "       l.frmdt, "
									+ "       l.todt, "
									+ "       l.applno, "
									+ "       l.days, "
									+ "       (select sum(l1.days) from leavetran l1 "
									+ "       where l1.empno=l.EMPNO and (l1.LEAVECD=7 or l1.LEAVECD=10) "
									+ "       and l1.frmdt BETWEEN '"+fromDate+"' and '"+toDate+"' and l1.STATUS='SANCTION')as tDays, "
									+ "	   l.leavecd,l.STATUS, "
									+ "       l.lreason, "
									+ "       T.desig, "
									+ "       T.prj_srno ,p.SITE_NAME "
									+ " FROM   leavetran l, "
									+ "       empmast e1, "
									+ "       emptran T ,Project_Sites p "
									+ " WHERE  (l.leavecd = 7 or l.LEAVECD=10) "
									+ "		AND frmdt BETWEEN '"+fromDate+"' and '"+toDate+"' "
									+ "  AND  T.PRJ_SRNO="+selectedBranch+""
									+ "        AND l.empno = e1.empno "
									+ "		AND t.empno = e1.empno "
									+ "        AND t.srno = (SELECT Max(e2.srno) FROM   emptran e2 WHERE  e2.empno = e1.empno) "
									+ "       AND p.SITE_ID=T.prj_srno and l.STATUS='SANCTION') "
									+ "       select * from a where a.tDays > 25 "
									+ " ORDER  BY a.prj_srno";
									/*"SELECT   e1.empcode ,fname,mname,lname,"+
									" l.frmdt,l.todt,l.APPLNO,"+
									" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
									" FROM     leavetran l,empmast e1,emptran T "+
									" WHERE    l.LEAVECD =7"+
									" and l.DAYS >= 25"+"
									"  AND      FRMDT between '"+fromDate+"' and '"+toDate+"' "+
									" AND  T.PRJ_SRNO="+selectedBranch+
									" AND      l.empno =e1.empno "+
									" AND      e1.status ='A'" +
									" and      t.empno = e1.empno "+
									" AND      t.srno =(SELECT max(e2.srno) "+
									" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
									" ORDER BY e1.empcode ";*/
						}
						if(Branch.equalsIgnoreCase("3"))
						{
							Query1= ""
									+ "with a as( "
									+ "SELECT e1.empcode, e1.EMPNO, "
									+ "       fname, "
									+ "       mname, "
									+ "       lname, e1.FILENUMBER, "
									+ "       l.frmdt, "
									+ "       l.todt, "
									+ "       l.applno, "
									+ "       l.days, "
									+ "       (select sum(l1.days) from leavetran l1 "
									+ "       where l1.empno=l.EMPNO and (l1.LEAVECD=7 or l1.LEAVECD=10) "
									+ "       and l1.frmdt BETWEEN '"+fromDate+"' and '"+toDate+"' and l1.STATUS='SANCTION')as tDays, "
									+ "	   l.leavecd,l.STATUS, "
									+ "       l.lreason, "
									+ "       T.desig, "
									+ "       T.prj_srno ,p.SITE_NAME "
									+ "FROM   leavetran l, "
									+ "       empmast e1, "
									+ "       emptran T ,Project_Sites p "
									+ " WHERE  (l.leavecd = 7 or l.LEAVECD=10) "
									+ "		AND frmdt BETWEEN '"+fromDate+"' and '"+toDate+"' "
									+ "  and  T.PRJ_SRNO  between "+rangefrom+" and "+ rangeTo+" "
									+ "        AND l.empno = e1.empno "
									+ "		AND t.empno = e1.empno "
									+ "        AND t.srno = (SELECT Max(e2.srno) FROM   emptran e2 WHERE  e2.empno = e1.empno) "
									+ "       AND p.SITE_ID=T.prj_srno and l.STATUS='SANCTION') "
									+ "       select * from a where a.tDays>25 "
									+ " ORDER  BY a.prj_srno";
									/*"SELECT   e1.empcode ,fname,mname,lname,"+
									" l.frmdt,l.todt,l.APPLNO,"+
									" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
									" FROM     leavetran l,empmast e1,emptran T "+
									" WHERE    l.LEAVECD =7"+
									" and l.DAYS >= 25"+
									"  AND      FRMDT between '"+fromDate+"' and '"+toDate+"' "+
									" and  T.PRJ_SRNO  between "+rangefrom+" and "+ rangeTo+" "+
									" AND      l.empno =e1.empno "+
									" AND      e1.status ='A'" +
									" and      t.empno = e1.empno "+
									" AND      t.srno =(SELECT max(e2.srno) "+
									" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
									" ORDER BY  T.PRJ_SRNO ";*/
						}
						System.out.println("query is  "+Query1);
						rspt = stmt.executeQuery(Query1);
						int srno=0;
						String previousEmpCode="";
						String currentEmpCode="";
						double totatlAmount=0;
						LookupHandler lkp=new LookupHandler();
						int i = 0;
						int totemp=0;
						while(rspt.next())
						{
							 DateFormat outputFormat = new SimpleDateFormat("dd-MM-yyyy");
							 DateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd");
							 Date date = inputFormat.parse(rspt.getString("FRMDT"));
							 Date date1 = inputFormat.parse(rspt.getString("TODT"));
							 String frdt = outputFormat.format(date);
							 String todt = outputFormat.format(date1);
							 
							currentEmpCode = rspt.getString("EMPCODE");
							i++;
							System.out.println("in while  "+i);
					//		srno++;
						    if(rspt.getRow()!=1 && previousEmpCode.equalsIgnoreCase(currentEmpCode)){	
						    	PdfPCell cell1data=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,9)));
								cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
								table.addCell(cell1data);
						    	
							PdfPCell cell1data1=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
							cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data1);
							PdfPCell cell1data0=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
							cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data0);
							
							String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
							PdfPCell cell1data2=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
							cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data2);
							PdfPCell cell1data4=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
							cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data4);
							PdfPCell cell1data41=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
							cell1data41.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data41);
							}
						    else{
						    	totemp++;
						    	srno++;
								PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,9)));
								cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
								table.addCell(cell1data);
								
								PdfPCell cell1data1=new PdfPCell(new Phrase(""+rspt.getString("prj_srno"),new Font(Font.TIMES_ROMAN,8)));
								cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
								table.addCell(cell1data1);
								PdfPCell cell1data0=new PdfPCell(new Phrase(""+rspt.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8)));
								cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
								table.addCell(cell1data0);
								
								String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
								PdfPCell cell1data2=new PdfPCell(new Phrase(""+empname,new Font(Font.TIMES_ROMAN,8)));
								cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
								table.addCell(cell1data2);
								PdfPCell cell1data4=new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("DESIG",rspt.getInt("DESIG")),new Font(Font.TIMES_ROMAN,8)));
								cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
								table.addCell(cell1data4);
								PdfPCell cell1data42=new PdfPCell(new Phrase(""+rspt.getString("tDays"),new Font(Font.TIMES_ROMAN,8)));
								cell1data42.setHorizontalAlignment(Element.ALIGN_LEFT);
								table.addCell(cell1data42);
						    }
							PdfPCell cell1data3=new PdfPCell(new Phrase(""+frdt,new Font(Font.TIMES_ROMAN,8)));
							cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data3);
							
							PdfPCell cell1data31=new PdfPCell(new Phrase(""+todt,new Font(Font.TIMES_ROMAN,8)));
							cell1data31.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data31);
							
							PdfPCell cell1data5=new PdfPCell(new Phrase(""+rspt.getString("DAYS"),new Font(Font.TIMES_ROMAN,8)));
							cell1data5.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data5);
							
							previousEmpCode = currentEmpCode;
						}
						document.add(table);	 
						para = new Paragraph(new Phrase("Total Number Of Employee :- "+totemp,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(10);
						document.add(para);
						document.close();
						file.close();
						con.close();
					} catch (Exception e)
					{		
						e.printStackTrace();
					}
					
				}catch (Exception e)
				{		
					e.printStackTrace();
				}
			}
			// LWP List...
			public static void LWPList(String Branch,String selectedBranch,String rangefrom,String rangeTo,
					 String frmdate,String todate,String empno1,String EType,String SelectType,String filepath, String imagepath )
			{
				String fdate="";
				System.out.println("date: "+frmdate);
				String fdate1[] = frmdate.split("-");
				System.out.println("month: "+fdate1[1]);
				Connection Cn = null;
				Statement st = null;
				ResultSet rs = null;
				ResultSet rs1 = null;
				
				OutputStream file = null;
				try {
					file = new FileOutputStream(new File(filepath));
				} catch (FileNotFoundException e1) {
					// TODO Auto-generated catch block
					e1.printStackTrace();
				}
				Document document = new Document();
				String table_name="";
				lable1="Report date : ";
				try {
					UtilityDAO dao = new UtilityDAO();
					PdfWriter writer =PdfWriter.getInstance(document, new FileOutputStream(filepath));

					Footer ftr = dao.new Footer(lable1);
					writer.setPageEvent(ftr);
					document.open();
					Image image1 = Image.getInstance(imagepath);
					image1.scaleAbsolute(80f, 80f);
					image1.setAbsolutePosition(40f, 730f); 
					document.add(image1);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);
					document.add(para);

					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					document.add(para);
					para = new Paragraph(new Phrase("Tel : +91-20 26812190,Email :",new Font(Font.TIMES_ROMAN,9)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					document.add(para);
					para = new Paragraph(new Phrase("LWP List ",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					document.add(para);
					/*para = new Paragraph(new Phrase("For The Month : "+fdate1[1]+"-"+fdate1[2],new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);   //+fdate1[1]+"-"+fdate1[2]
					para.setSpacingAfter(0);
					document.add(para);*/
					PdfPTable table=new PdfPTable(10);
					table.setSpacingBefore(20.0f);
					table.setWidthPercentage(new float[]{5,7,7,31,10,12,5,7,18,8},new Rectangle(100,100));
					PdfPCell cell1=new PdfPCell(new Phrase("Sr No",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell1);
					PdfPCell cell11=new PdfPCell(new Phrase("Branch",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell11);
					PdfPCell cell2=new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell2);
					PdfPCell cell3=new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell3);
					PdfPCell cell5=new PdfPCell(new Phrase("App.No",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell5);
					PdfPCell cell4=new PdfPCell(new Phrase("Date",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell4);
					
					PdfPCell cell6=new PdfPCell(new Phrase("Days",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell6);
					PdfPCell cell7=new PdfPCell(new Phrase("LType",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell7);
					PdfPCell cell71=new PdfPCell(new Phrase("Reason",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell71.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell71);
					PdfPCell cell711=new PdfPCell(new Phrase("Sanction",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell711.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell711);
					table.setHeaderRows(1);
					Connection con=null;
					con=ConnectionManager.getConnection();
					Statement stmt=con.createStatement();
					ResultSet rspt = null;
					String Query1="";
					System.out.println("EType:  "+EType);
					
					if(EType.equalsIgnoreCase("1") && SelectType.equalsIgnoreCase("1"))
					{	
						System.out.println("i am in all emp");
						Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
								" l.frmdt,l.todt,l.APPLNO,l.STATUS,"+
								" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
								" FROM     leavetran l,empmast e1,emptran T "+
								" WHERE    l.LEAVECD =7"+
								"  AND      FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" AND      l.empno =e1.empno "+
								" AND      e1.status ='A'" +
								" and      t.empno = e1.empno "+
								" AND      t.srno =(SELECT max(e2.srno) "+
								" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
								" ORDER BY T.PRJ_SRNO ";
					}
					
					if(EType.equalsIgnoreCase("2") && SelectType.equalsIgnoreCase("1"))
					{	
						System.out.println("i am in spec.emp");
						Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
								" l.frmdt,l.todt,l.APPLNO,l.STATUS,"+
								" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
								" FROM     leavetran l,empmast e1,emptran T "+
								" WHERE    l.LEAVECD =7"+
								"  AND      FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" and l.EMPNO="+empno1+
								" AND      l.empno =e1.empno "+
								" AND      e1.status ='A'" +
								" and      t.empno = e1.empno "+
								" AND      t.srno =(SELECT max(e2.srno) "+
								" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
								" ORDER BY e1.empcode ";
					}
					if(Branch.equalsIgnoreCase("1") && SelectType.equalsIgnoreCase("2"))
					{	
						System.out.println("i am in all branch");
						Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
								" l.frmdt,l.todt,l.APPLNO,l.STATUS,"+
								" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
								" FROM     leavetran l,empmast e1,emptran T "+
								" WHERE    l.LEAVECD =7"+
								"  AND      FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" AND      l.empno =e1.empno "+
								" AND      e1.status ='A'" +
								" and      t.empno = e1.empno "+
								" AND      t.srno =(SELECT max(e2.srno) "+
								" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
								" ORDER BY T.PRJ_SRNO ";
					}
					if(Branch.equalsIgnoreCase("2") && SelectType.equalsIgnoreCase("2"))
					{
						System.out.println("i am in selected Branch");
						Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
								" l.frmdt,l.todt,l.APPLNO,l.STATUS,"+
								" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
								" FROM     leavetran l,empmast e1,emptran T "+
								" WHERE    l.LEAVECD =7"+
								"  AND      FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" AND  T.PRJ_SRNO="+selectedBranch+
								" AND      l.empno =e1.empno "+
								" AND      e1.status ='A'" +
								" and      t.empno = e1.empno "+
								" AND      t.srno =(SELECT max(e2.srno) "+
								" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
								" ORDER BY  T.PRJ_SRNO ";
					}
					if(Branch.equalsIgnoreCase("3") && SelectType.equalsIgnoreCase("2"))
					{	
						System.out.println("i am in selected Range..");
						Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
								" l.frmdt,l.todt,l.APPLNO,l.STATUS,"+
								" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
								" FROM     leavetran l,empmast e1,emptran T "+
								" WHERE    l.LEAVECD =7"+
								"  AND      FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" and  T.PRJ_SRNO  between "+rangefrom+" and "+ rangeTo+" "+
								" AND      l.empno =e1.empno "+
								" AND      e1.status ='A'" +
								" and      t.empno = e1.empno "+
								" AND      t.srno =(SELECT max(e2.srno) "+
								" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
								" ORDER BY  T.PRJ_SRNO ";
					}
					
					System.out.println("query is  "+Query1);
					rspt = stmt.executeQuery(Query1);
					int srno=0;
					String previousEmpCode="";
					String currentEmpCode="";
					double totatlAmount=0;
					LookupHandler lkp=new LookupHandler();
					int i = 0;
					int totemp=0;
					while(rspt.next())
					{
						 DateFormat outputFormat = new SimpleDateFormat("dd-MM-yyyy");
						 DateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd");
						 Date date = inputFormat.parse(rspt.getString("FRMDT"));
						 Date date1 = inputFormat.parse(rspt.getString("TODT"));
						 String frdt = outputFormat.format(date);
						 String todt = outputFormat.format(date1);
						 
						currentEmpCode = rspt.getString("EMPCODE");
						i++;
						System.out.println("in while  "+i);
						srno++;
					    if(rspt.getRow()!=1 && previousEmpCode.equalsIgnoreCase(currentEmpCode)){	
					    	PdfPCell cell1data=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,9)));
							cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data);
					    	
						PdfPCell cell1data1=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
						cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data1);
						PdfPCell cell1data0=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
						cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data0);
						
						String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
						PdfPCell cell1data2=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
						cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data2);
						/*PdfPCell cell1data4=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
						cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data4);*/
						}
					    else{
					    	totemp++;
							PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,9)));
							cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data);
							
							PdfPCell cell1data1=new PdfPCell(new Phrase(""+rspt.getString("prj_srno"),new Font(Font.TIMES_ROMAN,8)));
							cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data1);
							PdfPCell cell1data0=new PdfPCell(new Phrase(""+rspt.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8)));
							cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data0);
							
							String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
							PdfPCell cell1data2=new PdfPCell(new Phrase(""+empname,new Font(Font.TIMES_ROMAN,8)));
							cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data2);
							
					    }
					    PdfPCell cell1data4=new PdfPCell(new Phrase(""+rspt.getString("Applno"),new Font(Font.TIMES_ROMAN,8)));
						cell1data4.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data4);
						PdfPCell cell1data3=new PdfPCell(new Phrase(""+frdt+"      To  "+todt,new Font(Font.TIMES_ROMAN,8)));
						cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data3);
						
						PdfPCell cell1data5=new PdfPCell(new Phrase(""+rspt.getString("DAYS"),new Font(Font.TIMES_ROMAN,8)));
						cell1data5.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data5);
						PdfPCell cell1data6=new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("LEAVE",rspt.getInt("LEAVECD")),new Font(Font.TIMES_ROMAN,8)));
						cell1data6.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data6);
						PdfPCell cell1data61=new PdfPCell(new Phrase(""+rspt.getString("LREASON"),new Font(Font.TIMES_ROMAN,8)));
						cell1data61.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data61);
						String status="";
						if(rspt.getString("STATUS").equalsIgnoreCase("SANCTION")){
							status="Y";
						}else{status="N";}
						PdfPCell cell1data611=new PdfPCell(new Phrase(""+status,new Font(Font.TIMES_ROMAN,8)));
						cell1data611.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data611);
						previousEmpCode = currentEmpCode;
					}
					document.add(table);	 
					para = new Paragraph(new Phrase("Total Number Of Employee :- "+totemp,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(10);
					document.add(para);
					document.close();
					file.close();
					con.close();
				} catch (Exception e)
				{		
					e.printStackTrace();
				}
				
			}
			
			// Late Marking..
			public static void LateMarkList(String Branch,String selectedBranch,String rangefrom,String rangeTo,String fromDate,String toDate,String filepath, String imagepath )
			{
				RepoartBean repBean  = new RepoartBean();
				try
				{
					String fdate="";
					System.out.println("date: "+fromDate);
					String fdate1[] = fromDate.split("-");
					System.out.println("month: "+fdate1[1]);
					Connection Cn = null;
					Statement st = null;
					ResultSet rs = null;
					ResultSet rs1 = null;
					
					OutputStream file = null;
					try {
						file = new FileOutputStream(new File(filepath));
					} catch (FileNotFoundException e1) {
						// TODO Auto-generated catch block
						e1.printStackTrace();
					}
					Document document = new Document();
					String table_name="";
					lable1="Report date : ";
					try {
						UtilityDAO dao = new UtilityDAO();
						PdfWriter writer =PdfWriter.getInstance(document, new FileOutputStream(filepath));

						Footer ftr = dao.new Footer(lable1);
						writer.setPageEvent(ftr);
						document.open();
						Image image1 = Image.getInstance(imagepath);
						image1.scaleAbsolute(80f, 80f);
						image1.setAbsolutePosition(40f, 730f); 
						document.add(image1);
						Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
						Paragraph para = new Paragraph(title);
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingBefore(0);
						document.add(para);

						para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(0);

						document.add(para);
						para = new Paragraph(new Phrase("Tel : +91-20 26812190,Email :",new Font(Font.TIMES_ROMAN,9)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(0);
						document.add(para);
						para = new Paragraph(new Phrase("Late Mark List ",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(0);
						document.add(para);
						/*para = new Paragraph(new Phrase("For The Month : "+fdate1[1]+"-"+fdate1[2],new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						para.setAlignment(Element.ALIGN_CENTER);   //+fdate1[1]+"-"+fdate1[2]
						para.setSpacingAfter(0);
						document.add(para);*/
						PdfPTable table=new PdfPTable(9);
						table.setSpacingBefore(20.0f);
						table.setWidthPercentage(new float[]{6,7,7,32,13,12,5,7,18},new Rectangle(100,100));
						PdfPCell cell1=new PdfPCell(new Phrase("Sr No",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1);
						PdfPCell cell11=new PdfPCell(new Phrase("Branch",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell11);
						PdfPCell cell2=new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell2);
						PdfPCell cell3=new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell3);
						PdfPCell cell5=new PdfPCell(new Phrase("Desig",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell5);
						PdfPCell cell4=new PdfPCell(new Phrase("Date",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell4);
						
						PdfPCell cell6=new PdfPCell(new Phrase("Days",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell6);
						PdfPCell cell7=new PdfPCell(new Phrase("LType",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell7);
						PdfPCell cell71=new PdfPCell(new Phrase("Reason",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						cell71.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell71);
						table.setHeaderRows(1);
						Connection con=null;
						con=ConnectionManager.getConnection();
						Statement stmt=con.createStatement();
						ResultSet rspt = null;
						String Query1="";
						if(Branch.equalsIgnoreCase("1"))
						{	
						Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
								" l.frmdt,l.todt,l.STATUS,l.APPLNO,"+
								" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
								" FROM     leavetran l,empmast e1,emptran T "+
								" WHERE    l.LADDR='Late Leave'  and l.STATUS='sanction'  "+
								" AND      l.FRMDT between '"+fromDate+"' and '"+toDate+"' "+
								" AND      l.empno =e1.empno "+
								" AND      e1.status ='A'" +
								" and      t.empno = e1.empno "+
								" AND      t.srno =(SELECT max(e2.srno) "+
								" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
								" ORDER BY  T.prj_srno ";
						}
						if(Branch.equalsIgnoreCase("2"))
						{
							//" and T.PRJ_SRNO="+selectedBranch+
				Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
						" l.frmdt,l.todt,l.STATUS,l.APPLNO,"+
						" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
						" FROM     leavetran l,empmast e1,emptran T "+
						" WHERE    l.LADDR='Late Leave'  and l.STATUS='sanction'  "+
						" AND      l.FRMDT between '"+fromDate+"' and '"+toDate+"' "+
						" and T.PRJ_SRNO="+selectedBranch+
						" AND      l.empno =e1.empno "+
						" AND      e1.status ='A'" +
						" and      t.empno = e1.empno "+
						" AND      t.srno =(SELECT max(e2.srno) "+
						" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
						" ORDER BY e1.empcode ";
						}
						if(Branch.equalsIgnoreCase("3"))
						{
							Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
									" l.frmdt,l.todt,l.STATUS,l.APPLNO,"+
									" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
									" FROM     leavetran l,empmast e1,emptran T "+
									" WHERE    l.LADDR='Late Leave'  and l.STATUS='sanction'  "+
									" AND      l.FRMDT between '"+fromDate+"' and '"+toDate+"' "+
									"and T.PRJ_SRNO between "+rangefrom+" and "+ rangeTo+" "+
									" AND      l.empno =e1.empno "+
									" AND      e1.status ='A'" +
									" and      t.empno = e1.empno "+
									" AND      t.srno =(SELECT max(e2.srno) "+
									" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
									" ORDER BY T.prj_srno ";
						}
						System.out.println("query is  "+Query1);
						rspt = stmt.executeQuery(Query1);
						int srno=0;
						String previousEmpCode="";
						String currentEmpCode="";
						double totatlAmount=0;
						LookupHandler lkp=new LookupHandler();
						int i = 0;
						int totemp=0;
						while(rspt.next())
						{
							 DateFormat outputFormat = new SimpleDateFormat("dd-MM-yyyy");
							 DateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd");
							 Date date = inputFormat.parse(rspt.getString("FRMDT"));
							 Date date1 = inputFormat.parse(rspt.getString("TODT"));
							 String frdt = outputFormat.format(date);
							 String todt = outputFormat.format(date1);
							 
							currentEmpCode = rspt.getString("EMPCODE");
							i++;
							System.out.println("in while  "+i);
							srno++;
						    if(rspt.getRow()!=1 && previousEmpCode.equalsIgnoreCase(currentEmpCode)){	
						    	PdfPCell cell1data=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,9)));
								cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
								table.addCell(cell1data);
						    	
							PdfPCell cell1data1=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
							cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data1);
							PdfPCell cell1data0=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
							cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data0);
							
							String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
							PdfPCell cell1data2=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
							cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data2);
							PdfPCell cell1data4=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
							cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data4);
							}
						    else{
						    	totemp++;
								PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,9)));
								cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
								table.addCell(cell1data);
								
								PdfPCell cell1data1=new PdfPCell(new Phrase(""+rspt.getString("prj_srno"),new Font(Font.TIMES_ROMAN,8)));
								cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
								table.addCell(cell1data1);
								PdfPCell cell1data0=new PdfPCell(new Phrase(""+rspt.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8)));
								cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
								table.addCell(cell1data0);
								
								String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
								PdfPCell cell1data2=new PdfPCell(new Phrase(""+empname,new Font(Font.TIMES_ROMAN,8)));
								cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
								table.addCell(cell1data2);
								PdfPCell cell1data4=new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("DESIG",rspt.getInt("DESIG")),new Font(Font.TIMES_ROMAN,8)));
								cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
								table.addCell(cell1data4);
						    }
							PdfPCell cell1data3=new PdfPCell(new Phrase(""+frdt+"      To  "+todt,new Font(Font.TIMES_ROMAN,8)));
							cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data3);
							
							PdfPCell cell1data5=new PdfPCell(new Phrase(""+rspt.getString("DAYS"),new Font(Font.TIMES_ROMAN,8)));
							cell1data5.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data5);
							PdfPCell cell1data6=new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("LEAVE",rspt.getInt("LEAVECD")),new Font(Font.TIMES_ROMAN,8)));
							cell1data6.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data6);
							PdfPCell cell1data61=new PdfPCell(new Phrase(""+rspt.getString("LREASON"),new Font(Font.TIMES_ROMAN,8)));
							cell1data61.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data61);
							previousEmpCode = currentEmpCode;
						}
						document.add(table);	 
						para = new Paragraph(new Phrase("Total Number Of Employee :- "+totemp,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(10);
						document.add(para);
						document.close();
						file.close();
						con.close();
					} catch (Exception e)
					{		
						e.printStackTrace();
					}
					
				}catch (Exception e)
				{		
					e.printStackTrace();
				}
			}
			
			public static void LeaveCreditBalanceList(String Branch,String selectedBranch,String rangefrom,String rangeTo,String fromDate,String toDate,String filepath, String imagepath )
			{
				RepoartBean repBean  = new RepoartBean();
				try
				{
					Connection Cn = null;
					Statement st = null;
					ResultSet rs = null;
					ResultSet rs1 = null;

					ReportDAO.OpenCon("", "", "",repBean);
					Cn = repBean.getCn();
					
					int totalEmployee =0;
					int Employee = 0;
					String Query = "";
					String Query1 = "";
					
					LookupHandler lkhp = new LookupHandler();
					Rectangle rec = new  Rectangle(100,100);
					Document doc = new Document();
					PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
					
					doc.open();
					doc.setPageSize(PageSize.A4);
					
					Font fbold = new Font(Font.TIMES_ROMAN,12,Font.BOLD);
					Font fsmall = new Font(Font.TIMES_ROMAN,10);
					Font FONT = new Font(Font.TIMES_ROMAN, 40, Font.NORMAL, new GrayColor(0.75f));
					Font  fontcolor = FontFactory.getFont(FontFactory.HELVETICA, 10, new Color(6, 8, 193));
					
					ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
					Image image = Image.getInstance(imagepath);
					image.scaleAbsolute(80f, 80f);
					image.setAbsolutePosition(30f, 760f);
					doc.add(image);
					
					Paragraph para = new Paragraph(new Phrase("Project Wise Employee List ",fbold));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);
					if(Branch.equalsIgnoreCase("1"))
							{
						Query = "select * from Project_Sites";
					}
					else if(Branch.equalsIgnoreCase("2")){
				     	Query = "select * from Project_Sites where SITE_ID =" +selectedBranch ;
					}
					else if(Branch.equalsIgnoreCase("3")){
						Query = "select * from Project_Sites where SITE_ID  between "+rangefrom +"and "+rangeTo;
					}
					System.out.println("Query is@@@ " +Query);
					st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
					rs = st.executeQuery(Query);	
					
					String site_id ="";
					String site_name ="";
					String Project_Code ="";
					int srno = 0;
					while(rs.next())
					{
						site_id = rs.getString("Site_ID");
						site_name = rs.getString("site_name");
						Project_Code = rs.getString("Project_Code");
						
							if(Branch.equalsIgnoreCase("1"))
							{
						Query1 =  " select e1.EMPNO,e1.EMPCODE ,FNAME,MNAME,LNAME,T.PRJ_SRNO," +
									"sum(case when lkp_dIsc = 'PL' then l.bal else 0 end ) 'PLBAL',"+
									"sum(case when lkp_dIsc = 'CL' then l.bal else 0 end ) 'CLBAL',"+
									"sum(case when lkp_dIsc = 'SL' then l.bal else 0 end ) 'SLBAL',"+
									"sum(case when lkp_dIsc = 'PL' then lb.totcr else 0 end ) 'PLCR' ,"+
									"sum(case when lkp_dIsc = 'CL' then lb.totcr else 0 end ) 'CLCR',"+
									"sum(case when lkp_dIsc = 'SL' then lb.totcr else 0 end ) 'SLCR'"+
									" from  leavebal l, leavebal lb, empmast e1,LOOKUP ll,EMPTRAN T "+
									" where ll.LKP_CODE = 'LEAVE' and ll.LKP_SRNO  = l.LEAVECD and "+
									" e1.EMPNO =l.EMPNO and ll.LKP_SRNO  = lb.LEAVECD and "+
									" e1.EMPNO =lb.EMPNO and l.srno =(    "+
									"	select top 1.srno from leavebal l1 where l1.LEAVECD  = l.LEAVECD "+
									" and  l1.EMPNO=l.EMPNO order by BALDT desc,srno desc) and lb.srno =(    "+
									"	select MIN(srno) from leavebal l2 where l2.LEAVECD  = lb.LEAVECD "+
									" and  l2.EMPNO=lb.EMPNO and l2.BALDT between '"+fromDate+"' and '"+toDate+"')  "+
									" and l.EMPNO =e1.EMPNO and e1.STATUS  ='A' "+
									" and T.EMPNO = e1.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e1.EMPNO) "+
									" and T.PRJ_SRNO="+site_id+
									"  group by e1.EMPNO,e1.EMPCODE ,FNAME,MNAME,LNAME,T.PRJ_SRNO order by e1.EMPCODE";
							}
							else if(Branch.equalsIgnoreCase("2")){
								Query1 =	"select e1.EMPNO,e1.EMPCODE ,FNAME,MNAME,LNAME,T.PRJ_SRNO," +
										"sum(case when lkp_dIsc = 'PL' then l.bal else 0 end ) 'PLBAL',"+
										"sum(case when lkp_dIsc = 'CL' then l.bal else 0 end ) 'CLBAL',"+
										"sum(case when lkp_dIsc = 'SL' then l.bal else 0 end ) 'SLBAL',"+
										"sum(case when lkp_dIsc = 'PL' then lb.totcr else 0 end ) 'PLCR',"+
										"sum(case when lkp_dIsc = 'CL' then lb.totcr else 0 end ) 'CLCR',"+
										"sum(case when lkp_dIsc = 'SL' then lb.totcr else 0 end ) 'SLCR'"+
										" from  leavebal l, leavebal lb, empmast e1,LOOKUP ll,EMPTRAN T "+
										" where ll.LKP_CODE = 'LEAVE' and ll.LKP_SRNO  = l.LEAVECD and "+
										" e1.EMPNO =l.EMPNO and ll.LKP_SRNO  = lb.LEAVECD and "+
										" e1.EMPNO =lb.EMPNO and l.srno =(    "+
										"	select top 1.srno from leavebal l1 where l1.LEAVECD  = l.LEAVECD "+
										" and  l1.EMPNO=l.EMPNO order by BALDT desc,srno desc)  and lb.srno =(    "+
									"	select MIN(srno) from leavebal l2 where l2.LEAVECD  = lb.LEAVECD "+
									" and  l2.EMPNO=lb.EMPNO and l2.BALDT between '"+fromDate+"' and '"+toDate+"')"+
										" and l.EMPNO =e1.EMPNO and e1.STATUS  ='A' "+
										" and T.EMPNO = e1.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e1.EMPNO) "+
										" and T.PRJ_SRNO="+selectedBranch+
										"  group by e1.EMPNO,e1.EMPCODE ,FNAME,MNAME,LNAME,T.PRJ_SRNO order by e1.EMPCODE";
							}
							else if(Branch.equalsIgnoreCase("3")){
						Query1 =    "select e1.EMPNO,e1.EMPCODE ,FNAME,MNAME,LNAME,T.PRJ_SRNO," +
									"sum(case when lkp_dIsc = 'PL' then l.bal else 0 end ) 'PLBAL' ,"+
									"sum(case when lkp_dIsc = 'CL' then l.bal else 0 end ) 'CLBAL',"+
									"sum(case when lkp_dIsc = 'SL' then l.bal else 0 end ) 'SLBAL',"+
									"sum(case when lkp_dIsc = 'PL' then lb.totcr else 0 end ) 'PLCR' ,"+
									"sum(case when lkp_dIsc = 'CL' then lb.totcr else 0 end ) 'CLCR',"+
									"sum(case when lkp_dIsc = 'SL' then lb.totcr else 0 end ) 'SLCR'"+
									" from  leavebal l, leavebal lb, empmast e1,LOOKUP ll,EMPTRAN T "+
									" where ll.LKP_CODE = 'LEAVE' and ll.LKP_SRNO  = l.LEAVECD and "+
									" e1.EMPNO =l.EMPNO and ll.LKP_SRNO  = lb.LEAVECD and "+
									" e1.EMPNO =lb.EMPNO and l.srno =(    "+
									"	select top 1.srno from leavebal l1 where l1.LEAVECD  = l.LEAVECD "+
									" and  l1.EMPNO=l.EMPNO order by BALDT desc,srno desc)  and lb.srno =(    "+
									"	select MIN(srno) from leavebal l2 where l2.LEAVECD  = lb.LEAVECD "+
									" and  l2.EMPNO=lb.EMPNO and l2.BALDT between '"+fromDate+"' and '"+toDate+"') "+
									" and l.EMPNO =e1.EMPNO and e1.STATUS  ='A' "+
									" and T.EMPNO = e1.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e1.EMPNO) "+
									" and T.PRJ_SRNO="+site_id+
								//	"and T.PRJ_SRNO between "+rangefrom+" and "+ rangeTo+" "+
									"  group by e1.EMPNO,e1.EMPCODE ,FNAME,MNAME,LNAME,T.PRJ_SRNO order by e1.EMPCODE";
							}
							
						System.out.println("Query1 is @@@ " +Query1);
						st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
						rs1 = st.executeQuery(Query1);	
						
						
							para = new Paragraph(new Phrase("Employee List For Branch is :- "+( site_name + Project_Code ),fbold));
							para.setAlignment(Element.ALIGN_CENTER);
							para.setSpacingAfter(10);
							doc.add(para);
							
							//............................ Code To print Heading start here...................................
							PdfPTable main = new PdfPTable(9);
							String str[] = new String[9];
							
							str[0]="Sr No";
							str[1]=" Emp Code";			str[2]="Employee Name";		str[3]="CR PL";		str[4]="CR CL";				
							str[5]="CR SL";				str[6]="Balance PL";		str[7]="Balance CL";	str[8]="Balance SL";  	
							
							main.setWidthPercentage(new float[]{5,10,35,10,10, 10,10,10, 10f}, rec);
							main.setHorizontalAlignment(Element.ALIGN_CENTER);
							PdfPCell maincell ;	
							
							for(int i=0; i<str.length;i++ )
							{					
								maincell = new PdfPCell(new Phrase(str[i],fbold));
								maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
								main.addCell(maincell);
							}	
							doc.add(main);
							//......................... Code To print Heading Ends here......................................
							
							rs1.beforeFirst();
							while(rs1.next())
							{
								srno++;

								PdfPTable main1 = new PdfPTable(9);
								main1.setWidthPercentage(new float[]{5,10,35,10,10, 10,10,10, 10f}, rec);
								main1.setHorizontalAlignment(Element.ALIGN_CENTER);	
							
								PdfPCell cell1 = new PdfPCell(new Phrase(""+srno,fsmall));  
								cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
								main1.addCell(cell1);
								
								PdfPCell cell3 = new PdfPCell(new Phrase(""+rs1.getString("EMPCODE"),fsmall));
								cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
								main1.addCell(cell3);
								
								String empname=rs1.getString("fname")+" "+rs1.getString("mname")+" "+rs1.getString("lname");
								PdfPCell cell4 = new PdfPCell(new Phrase(""+empname,fsmall));
								cell4.setHorizontalAlignment(Element.ALIGN_LEFT);
								main1.addCell(cell4);
								
								PdfPCell cell5 = new PdfPCell(new Phrase(""+rs1.getString("PLCR"),fsmall));
								cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
								main1.addCell(cell5);
								
								PdfPCell cell2 = new PdfPCell(new Phrase(""+rs1.getString("CLCR"),fsmall));
								cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
								main1.addCell(cell2);
								
								PdfPCell cell6 = new PdfPCell(new Phrase(""+rs1.getString("SLCR"),fsmall));
								cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
								main1.addCell(cell6);
								
								PdfPCell cell7 = new PdfPCell(new Phrase(""+rs1.getString("PLBAL"),fsmall));
								cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
								main1.addCell(cell7);
								
								PdfPCell cell8 = new PdfPCell(new Phrase(""+rs1.getString("CLBAL"),fsmall));
								cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
								main1.addCell(cell8);
								
								PdfPCell cell9 = new PdfPCell(new Phrase(""+rs1.getString("SLBAL"),fsmall));
								cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
								main1.addCell(cell9);
							
								
								doc.add(main1);
								
								Employee+=1;	
							}     
						
						para = new Paragraph(new Phrase("Number Of Employee :- "+Employee,fsmall));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(20);
						doc.add(para);	
						
						totalEmployee = totalEmployee+ Employee;	
						Employee = 0;
						//......................... Code To print data In Table Ends here...............................
					}		
					
					para = new Paragraph(new Phrase("Total Number Of Employee :- "+totalEmployee,fbold));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(10);
					doc.add(para);			
				
					//doc.newPage();
					doc.close();
					Cn.close();
				}
				catch(Exception e) 
				{
					e.printStackTrace();
				}

				}
			
			
			public static void BalanceLeaveDateWiseList(String Branch,String selectedBranch,String rangefrom,String rangeTo,String fromDate,String toDate,String filepath, String imagepath )
			{
				System.out.println("BalanceLeaveDateWiseList");

				RepoartBean repBean  = new RepoartBean();
				try
				{
					Connection Cn = null;
					Statement st = null;
					ResultSet rs = null;
					ResultSet rs1 = null;

					ReportDAO.OpenCon("", "", "",repBean);
					Cn = repBean.getCn();
					
					int totalEmployee =0;
					int Employee = 0;
					String Query = "";
					String Query1 = "";
					
					LookupHandler lkhp = new LookupHandler();
					Rectangle rec = new  Rectangle(100,100);
					Document doc = new Document();
					PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
					
					doc.open();
					doc.setPageSize(PageSize.A4);
					
					Font fbold = new Font(Font.TIMES_ROMAN,12,Font.BOLD);
					Font fsmall = new Font(Font.TIMES_ROMAN,10);
					Font FONT = new Font(Font.TIMES_ROMAN, 40, Font.NORMAL, new GrayColor(0.75f));
					Font  fontcolor = FontFactory.getFont(FontFactory.HELVETICA, 10, new Color(6, 8, 193));
					
					ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
					Image image = Image.getInstance(imagepath);
					image.scaleAbsolute(80f, 80f);
					image.setAbsolutePosition(30f, 760f);
					doc.add(image);
					
					Paragraph para = new Paragraph(new Phrase("THE BUSINESS CO.OP BANK LTD, Nashik ",fbold));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(5);
					doc.add(para);
					st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
					
					String site_id ="";
					String site_name ="";
					String Project_Code ="";
					int srno = 0;
					
						Query1="SELECT E.EMPNO, E.EMPCODE, (E.FNAME+' '+E.MNAME+' '+E.LNAME) AS NAME, "
								+ "(SELECT BAL FROM LEAVEBAL L1 WHERE E.EMPNO=L1.EMPNO AND L1.srno=(SELECT MAX(srno) FROM LEAVEBAL L1B WHERE E.EMPNO=L1B.EMPNO "
								+ "and L1B.BALDT BETWEEN '"+fromDate+"' AND '"+toDate+"' AND L1B.LEAVECD=1)) AS PL_BAL, "
								+ "(SELECT BAL FROM LEAVEBAL L2 WHERE E.EMPNO=L2.EMPNO AND L2.srno=(SELECT MAX(srno) FROM LEAVEBAL L2B WHERE E.EMPNO=L2B.EMPNO "
								+ "and L2B.BALDT BETWEEN '"+fromDate+"' AND '"+toDate+"' AND L2B.LEAVECD=2)) AS SL_BAL, "
								+ "(SELECT BAL FROM LEAVEBAL L3 WHERE E.EMPNO=L3.EMPNO AND L3.srno=(SELECT MAX(srno) FROM LEAVEBAL L3B WHERE E.EMPNO=L3B.EMPNO "
								+ "and L3B.BALDT BETWEEN '"+fromDate+"' AND '"+toDate+"' AND L3B.LEAVECD=3)) AS CL_BAL "
								+ "FROM empmast E WHERE E.STATUS='A' ORDER BY E.EMPCODE";
						
						
						System.out.println("Query1 is @@@ " +Query1);
						st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
						rs1 = st.executeQuery(Query1);	
						
						para = new Paragraph(new Phrase("Leave Balance List As Date "+toDate,fbold));
							para.setAlignment(Element.ALIGN_CENTER);
							para.setSpacingAfter(15);
							doc.add(para);
							
							//............................ Code To print Heading start here...................................
							PdfPTable main = new PdfPTable(6);
							String str[] = new String[6];
							
							str[0]="Sr No";				str[1]=" Emp Code";			str[2]="Employee Name";		
							str[3]="PL BALANCE";		str[4]="SL BALANCE";		str[5]="CL BALANCE";				
							
							main.setWidthPercentage(new float[]{5,10,35,20,20, 20f}, rec);
							main.setHorizontalAlignment(Element.ALIGN_CENTER);
							PdfPCell maincell ;	
							
							for(int i=0; i<str.length;i++ )
							{					
								maincell = new PdfPCell(new Phrase(str[i],fbold));
								maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
								main.addCell(maincell);
							}	
							doc.add(main);
							//......................... Code To print Heading Ends here......................................
							
							while(rs1.next())
							{
								srno++;
								
								PdfPTable main1 = new PdfPTable(6);
								main1.setWidthPercentage(new float[]{5,10,35,20,20, 20f}, rec);
								main1.setHorizontalAlignment(Element.ALIGN_CENTER);	
							
								PdfPCell cell1 = new PdfPCell(new Phrase(""+srno,fsmall));  
								cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
								main1.addCell(cell1);
								
								PdfPCell cell3 = new PdfPCell(new Phrase(""+rs1.getString("EMPCODE"),fsmall));
								cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
								main1.addCell(cell3);
								
								PdfPCell cell4 = new PdfPCell(new Phrase(""+rs1.getString("NAME"),fsmall));
								cell4.setHorizontalAlignment(Element.ALIGN_LEFT);
								main1.addCell(cell4);
																
								PdfPCell cell5 = new PdfPCell(new Phrase(""+rs1.getString("PL_BAL"),fsmall));
								cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
								main1.addCell(cell5);
								
								PdfPCell cell2 = new PdfPCell(new Phrase(""+rs1.getString("SL_BAL"),fsmall));
								cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
								main1.addCell(cell2);
								
								PdfPCell cell6 = new PdfPCell(new Phrase(""+rs1.getString("CL_BAL"),fsmall));
								cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
								main1.addCell(cell6);
							
								doc.add(main1);
								Employee+=1;	
							}     
						
						para = new Paragraph(new Phrase("Number Of Employee :- "+Employee,fsmall));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(20);
						doc.add(para);	
						
						totalEmployee = totalEmployee+ Employee;	
						Employee = 0;
						//......................... Code To print data In Table Ends here...............................
				//	}		
					
					para = new Paragraph(new Phrase("Total Number Of Employee :- "+totalEmployee,fbold));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(10);
					doc.add(para);			
				
					//doc.newPage();
					doc.close();
					Cn.close();
				}
				catch(Exception e) 
				{
					e.printStackTrace();
				}
			}
			
			// Old Report
	/*		// Leave Creditbalance List..
			public static void LeaveEncashList(String Branch,String selectedBranch,String rangefrom,String rangeTo,
					 String frmdate,String todate,String empno1,String EType,String SelectType,String filepath, String imagepath )
			{
				String fdate="";
				System.out.println("date: "+frmdate);
				String fdate1[] = frmdate.split("-");
				System.out.println("month: "+fdate1[1]);
				Connection Cn = null;
				Statement st = null;
				ResultSet rs = null;
				ResultSet rs1 = null;
				
				OutputStream file = null;
				try {
					file = new FileOutputStream(new File(filepath));
				} catch (FileNotFoundException e1) {
					// TODO Auto-generated catch block
					e1.printStackTrace();
				}
				Document document = new Document();
				String table_name="";
				lable1="Report date : ";
				try {
					UtilityDAO dao = new UtilityDAO();
					PdfWriter writer =PdfWriter.getInstance(document, new FileOutputStream(filepath));

					Footer ftr = dao.new Footer(lable1);
					writer.setPageEvent(ftr);
					document.open();
					Image image1 = Image.getInstance(imagepath);
					image1.scaleAbsolute(80f, 80f);
					image1.setAbsolutePosition(40f, 730f); 
					document.add(image1);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);
					document.add(para);

					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					document.add(para);
					para = new Paragraph(new Phrase("Tel : +91-20 26812190,Email :",new Font(Font.TIMES_ROMAN,9)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					document.add(para);
					para = new Paragraph(new Phrase("Leave Encash List ",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					document.add(para);
					para = new Paragraph(new Phrase("For The Month : "+fdate1[1]+"-"+fdate1[2],new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);   //+fdate1[1]+"-"+fdate1[2]
					para.setSpacingAfter(0);
					document.add(para);
					PdfPTable table=new PdfPTable(9);
					table.setSpacingBefore(20.0f);
					table.setWidthPercentage(new float[]{6,7,7,35,15,9,12,5,15},new Rectangle(100,100));
					PdfPCell cell1=new PdfPCell(new Phrase("Sr No",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell1);
					PdfPCell cell11=new PdfPCell(new Phrase("Branch",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell11);
					PdfPCell cell2=new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell2);
					PdfPCell cell3=new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell3);
					PdfPCell cell5=new PdfPCell(new Phrase("Desig",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell5);
					PdfPCell cell7=new PdfPCell(new Phrase("APP.NO",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell7);
					PdfPCell cell4=new PdfPCell(new Phrase("Date",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell4);
					
					PdfPCell cell6=new PdfPCell(new Phrase("Days",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell6);
					
					PdfPCell cell71=new PdfPCell(new Phrase("Reason",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell71.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell71);
					table.setHeaderRows(1);
					Connection con=null;
					con=ConnectionManager.getConnection();
					Statement stmt=con.createStatement();
					ResultSet rspt = null;
					String Query1="";
					System.out.println("EType:  "+EType);
					
					if(EType.equalsIgnoreCase("1") && SelectType.equalsIgnoreCase("1"))
					{	
						System.out.println("i am in all emp");
					Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
							" l.frmdt,l.todt,l.STATUS,l.APPLNO,"+
							" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO,l.STATUS "+
							" FROM     leavetran l,empmast e1,emptran T "+
							" WHERE     l.LREASON='Leave Encash'  "+
							" And  LEAVEPURP=4  and  DAYS!=0 "+
							" AND      FRMDT between '"+frmdate+"' and '"+todate+"' "+
							" AND      l.empno =e1.empno "+
							" AND      e1.status ='A'" +
							" and      t.empno = e1.empno "+
							" AND      t.srno =(SELECT max(e2.srno) "+
							" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
							" ORDER BY  T.prj_srno ";
					}
					
					if(EType.equalsIgnoreCase("2") && SelectType.equalsIgnoreCase("1"))
					{
						System.out.println("i am in spec.emp");
			Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
					" l.frmdt,l.todt,l.STATUS,l.APPLNO,"+
					" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO,l.STATUS "+
					" FROM     leavetran l,empmast e1,emptran T "+
					" WHERE     l.LREASON='Leave Encash'  "+
					" And  LEAVEPURP=4  and  DAYS!=0 "+
					" AND      FRMDT between '"+frmdate+"' and '"+todate+"' "+
					" and l.EMPNO="+empno1+" "+
					" AND      l.empno =e1.empno "+
					" AND      e1.status ='A'" +
					" and      t.empno = e1.empno "+
					" AND      t.srno =(SELECT max(e2.srno) "+
					" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
					" ORDER BY e1.empcode ";
					}
					if(Branch.equalsIgnoreCase("1") && SelectType.equalsIgnoreCase("2"))
					{	
						System.out.println("i am in all branch");
					Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
							" l.frmdt,l.todt,l.STATUS,l.APPLNO,"+
							" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO,l.STATUS "+
							" FROM     leavetran l,empmast e1,emptran T "+
							" WHERE     l.LREASON='Leave Encash'  "+
							" And  LEAVEPURP=4  and  DAYS!=0 "+
							" AND      FRMDT between '"+frmdate+"' and '"+todate+"' "+
							" AND      l.empno =e1.empno "+
							" AND      e1.status ='A'" +
							" and      t.empno = e1.empno "+
							" AND      t.srno =(SELECT max(e2.srno) "+
							" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
							" ORDER BY  T.prj_srno ";
					}
					if(Branch.equalsIgnoreCase("2") && SelectType.equalsIgnoreCase("2"))
					{
						System.out.println("i am in selected Branch");
						Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
								" l.frmdt,l.todt,l.STATUS,l.APPLNO,"+
								" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO "+
								" FROM     leavetran l,empmast e1,emptran T "+
								" WHERE     l.LREASON='Leave Encash'  "+
								" And  LEAVEPURP=4  and  DAYS!=0 "+
								" AND      FRMDT between '"+frmdate+"' and '"+todate+"' "+
								" and T.PRJ_SRNO="+selectedBranch+
								" AND      l.empno =e1.empno "+
								" AND      e1.status ='A'" +
								" and      t.empno = e1.empno "+
								" AND      t.srno =(SELECT max(e2.srno) "+
								" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
								" ORDER BY e1.empcode ";
					}
					if(Branch.equalsIgnoreCase("3") && SelectType.equalsIgnoreCase("2"))
					{	
						System.out.println("i am in selected Range..");
					Query1= "SELECT   e1.empcode ,fname,mname,lname,"+
							" l.frmdt,l.todt,l.STATUS,l.APPLNO,"+
							" l.days,l.LEAVECD,l.lreason,T.DESIG,T.PRJ_SRNO,l.STATUS "+
							" FROM     leavetran l,empmast e1,emptran T "+
							" WHERE     l.LREASON='Leave Encash'  "+
							" And  LEAVEPURP=4  and  DAYS!=0 "+
							" AND      FRMDT between '"+frmdate+"' and '"+todate+"' "+
							" and T.PRJ_SRNO between "+rangefrom+" and "+ rangeTo+" "+
							" AND      l.empno =e1.empno "+
							" AND      e1.status ='A'" +
							" and      t.empno = e1.empno "+
							" AND      t.srno =(SELECT max(e2.srno) "+
							" FROM   emptran e2 WHERE  e2.empno = e1.empno) "+
							" ORDER BY  T.prj_srno ";
					}
					
					System.out.println("query is  "+Query1);
					rspt = stmt.executeQuery(Query1);
					int srno=0;
					String previousEmpCode="";
					String currentEmpCode="";
					double totatlAmount=0;
					LookupHandler lkp=new LookupHandler();
					int i = 0;
					int totemp=0;
					while(rspt.next())
					{
					 DateFormat outputFormat = new SimpleDateFormat("dd-MM-yyyy");
					 DateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd");
					 Date date = inputFormat.parse(rspt.getString("FRMDT"));
					 Date date1 = inputFormat.parse(rspt.getString("TODT"));
					 String frdt = outputFormat.format(date);
					 String todt = outputFormat.format(date1);
							    
						currentEmpCode = rspt.getString("EMPCODE");
						i++;
						System.out.println("in while  "+i);
						srno++;
					    if(rspt.getRow()!=1 && previousEmpCode.equalsIgnoreCase(currentEmpCode)){	
					    	PdfPCell cell1data=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,9)));
							cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data);
					    	
						PdfPCell cell1data1=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
						cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data1);
						PdfPCell cell1data0=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
						cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data0);
						
						String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
						PdfPCell cell1data2=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
						cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data2);
						PdfPCell cell1data4=new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));
						cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data4);
						}
					    else{
					    	totemp++;
							PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,9)));
							cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data);
							
							PdfPCell cell1data1=new PdfPCell(new Phrase(""+rspt.getString("prj_srno"),new Font(Font.TIMES_ROMAN,8)));
							cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data1);
							PdfPCell cell1data0=new PdfPCell(new Phrase(""+rspt.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8)));
							cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data0);
							
							String empname=rspt.getString("fname")+" "+rspt.getString("mname")+" "+rspt.getString("lname");
							PdfPCell cell1data2=new PdfPCell(new Phrase(""+empname,new Font(Font.TIMES_ROMAN,8)));
							cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data2);
							PdfPCell cell1data4=new PdfPCell(new Phrase(""+new LookupHandler().getLKP_Desc("DESIG",rspt.getInt("DESIG")),new Font(Font.TIMES_ROMAN,8)));
							cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data4);
					    }
					    PdfPCell cell1data6=new PdfPCell(new Phrase(""+rspt.getString("APPLNO"),new Font(Font.TIMES_ROMAN,8)));
						cell1data6.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data6);
						PdfPCell cell1data3=new PdfPCell(new Phrase(""+frdt+"      To  "+todt,new Font(Font.TIMES_ROMAN,8)));
						cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data3);
						
						float day = Float.parseFloat(rspt.getString("DAYS"));
						
						PdfPCell cell1data5=new PdfPCell(new Phrase(""+Math.round(day),new Font(Font.TIMES_ROMAN,8)));
						cell1data5.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data5);
						
						PdfPCell cell1data61=new PdfPCell(new Phrase(""+rspt.getString("LREASON"),new Font(Font.TIMES_ROMAN,8)));
						cell1data61.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data61);
						previousEmpCode = currentEmpCode;
					}
					document.add(table);	 
					para = new Paragraph(new Phrase("Total Number Of Employee :- "+totemp,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(10);
					document.add(para);
					document.close();
					file.close();
					con.close();
				} catch (Exception e)
				{		
					e.printStackTrace();
				}
				
			}
*/			
			
			// Leave Creditbalance List..
			public static void LeaveEncashList(String Branch,String selectedBranch,String rangefrom,String rangeTo,
					 String frmdate,String todate,String empno1,String EType,String SelectType,String filepath, String imagepath )
			{
				
				String fdate="";
				System.out.println("date 123: "+frmdate);
				String fdate1[] = frmdate.split("-");
				System.out.println("month: "+fdate1[1]);
				Connection Cn = null;
				Statement st = null;
				ResultSet rs = null;
				ResultSet rs1 = null;
				
				OutputStream file = null;
				try {
					file = new FileOutputStream(new File(filepath));
				} catch (FileNotFoundException e1) {
					// TODO Auto-generated catch block
					e1.printStackTrace();
				}
				Document document = new Document();
				String table_name="";
				lable1="Report date : ";
				try {
					UtilityDAO dao = new UtilityDAO();
					PdfWriter writer =PdfWriter.getInstance(document, new FileOutputStream(filepath));

					Footer ftr = dao.new Footer(lable1);
					writer.setPageEvent(ftr);
					document.open();
					Image image1 = Image.getInstance(imagepath);
					image1.scaleAbsolute(80f, 80f);
					image1.setAbsolutePosition(40f, 730f); 
					document.add(image1);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(Font.TIMES_ROMAN,9,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);
					document.add(para);

					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,9)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					document.add(para);
					para = new Paragraph(new Phrase("Tel : +91-20 26812190,Email :",new Font(Font.TIMES_ROMAN,9)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					document.add(para);
					para = new Paragraph(new Phrase("Leave Encash List For Leave Year"+frmdate.substring(7,11),new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					document.add(para);
					PdfPTable table=new PdfPTable(10);
					table.setSpacingBefore(20.0f);
					table.setWidthPercentage(new float[]{6,7,7,20,15,10,12,12,8,12},new Rectangle(100,100));
					
					PdfPCell cell1=new PdfPCell(new Phrase("Sr No",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell1);
					PdfPCell cell11=new PdfPCell(new Phrase("Branch",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell11);
					PdfPCell cell2=new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell2);
					PdfPCell cell3=new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell3);
					PdfPCell cell5=new PdfPCell(new Phrase("Desig",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell5);
					PdfPCell cell7=new PdfPCell(new Phrase("BASIC",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell7);
					PdfPCell cell4=new PdfPCell(new Phrase("DA",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell4);
					PdfPCell cell6=new PdfPCell(new Phrase("TOTAL",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell6);
					PdfPCell cell71=new PdfPCell(new Phrase("DAYS",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell71.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell71);
					PdfPCell cell72=new PdfPCell(new Phrase("ENCASHMENT AMT",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
					cell71.setHorizontalAlignment(Element.ALIGN_CENTER);
					table.addCell(cell72);
		
					table.setHeaderRows(1);
					Connection con=null;
					con=ConnectionManager.getConnection();
					Statement stmt=con.createStatement();
					Statement stmt1=con.createStatement();
					ResultSet rspt = null;
					String Query1="";
					
				ResultSet rsencash = null;
				String EncashQuery1="";
				
					int srno=0;
					String previousEmpCode="";
					String currentEmpCode="";
					double totatlAmount=0;
					LookupHandler lkp=new LookupHandler();
					int i = 0;
					int totemp=0;
					
					int LastYear = (Integer.parseInt(frmdate.substring(7,11)))-1;
					
				/*	String LastYearFrmDate="01-Mar-"+LastYear;
					String LastYearToDate="31-Mar-"+LastYear;*/
					
					String LastYearFrmDate="01-Dec-"+LastYear;
					String LastYearToDate="31-Dec-"+LastYear;
					
					Float Total_Basic=0.0f;
					Float Last_Total_Basic=0.0f;
					
					Float Total_DA=0.0f;
					Float Last_Total_DA=0.0f;
					
					Float Total_TotalBasicDA=0.0f;
					Float Last_Total_TotalBasicDA=0.0f;
					
					Float Total_Days=0.0f;
					Float Last_Total_Days=0.0f;
					
					Float Total_Encashment=0.0f;
					Float Last_Total_Encashment=0.0f;
					
					EncashQuery1=" SELECT EMPNO FROM LEAVETRAN WHERE LREASON='Leave Encash' AND TRNTYPE='D' AND TRNDATE='"+frmdate+"' ORDER BY EMPNO";
					rsencash = stmt1.executeQuery(EncashQuery1);
					
					while(rsencash.next()){
						
						String EncashEMPNO=rsencash.getString("EMPNO");
				
						Query1= " SELECT ET.PRJ_SRNO AS BRANCH_CODE, E.EMPCODE, (E.FNAME+' '+E.MNAME+' '+E.LNAME) AS NAME, LP.LKP_DISC AS DESIG, "
								+ "(SELECT INP_AMT FROM PAYTRAN_STAGE P1 WHERE EMPNO = "+EncashEMPNO+" AND TRNDT BETWEEN '"+LastYearFrmDate+"' AND '"+LastYearToDate+"' AND TRNCD =101) AS BASIC, "
								+ "(SELECT INP_AMT FROM PAYTRAN_STAGE P2 WHERE EMPNO = "+EncashEMPNO+" AND TRNDT BETWEEN '"+LastYearFrmDate+"' AND '"+LastYearToDate+"' AND TRNCD =102) AS DA, "
								+ "SUM(INP_AMT) AS TOTAL_BASICDA, L.DAYS AS ENCASH_DAYS, ROUND(((SUM(INP_AMT)/30)*L.DAYS),2) AS ENCASHMENT_AMT "
								+ "FROM EMPMAST E, PAYTRAN_STAGE P, LEAVETRAN L, EMPTRAN ET, LOOKUP LP WHERE E.EMPNO=P.EMPNO AND E.EMPNO=L.EMPNO "
								+ "AND E.EMPNO=ET.EMPNO AND ET.DESIG=LP.LKP_SRNO AND LP.LKP_CODE='DESIG' AND E.EMPNO = "+EncashEMPNO+"  "
								+ "AND TRNDT BETWEEN '"+LastYearFrmDate+"' AND '"+LastYearToDate+"' AND P.TRNCD IN (101,102) AND L.TRNDATE='"+frmdate+"' AND L.LREASON='Leave Encash' "
								+ "AND L.TRNTYPE='D' AND ET.SRNO=(SELECT MAX(SRNO) FROM EMPTRAN ETA WHERE ETA.EMPNO="+EncashEMPNO+") "
								+ "GROUP BY E.FNAME, E.MNAME, E.LNAME, L.DAYS, ET.PRJ_SRNO, E.EMPCODE, LP.LKP_DISC ";
						
						rspt = stmt.executeQuery(Query1);
						
						System.out.println("LeaveEncash Query1 : "+Query1);
				
						while(rspt.next())
					{
					 DateFormat outputFormat = new SimpleDateFormat("dd-MM-yyyy");
					 DateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd");
							    
						currentEmpCode = rspt.getString("EMPCODE");
						i++;
						System.out.println("in while  "+i);
						srno++;
				
						totemp++;
					    	Total_Basic= Float.parseFloat(rspt.getString("BASIC"));
					    	Total_DA= Float.parseFloat(rspt.getString("DA"));
							Total_TotalBasicDA= Float.parseFloat(rspt.getString("TOTAL_BASICDA"));
							Total_Days= Float.parseFloat(rspt.getString("ENCASH_DAYS"));
							Total_Encashment= Float.parseFloat(rspt.getString("ENCASHMENT_AMT"));
						
					    	
							PdfPCell cell1data=new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,9)));
							cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data);
							
							PdfPCell cell1data1=new PdfPCell(new Phrase(""+rspt.getString("BRANCH_CODE"),new Font(Font.TIMES_ROMAN,8)));
							cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data1);
						
							PdfPCell cell1data0=new PdfPCell(new Phrase(""+rspt.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8)));
							cell1data0.setHorizontalAlignment(Element.ALIGN_CENTER);
							table.addCell(cell1data0);
							
							PdfPCell cell1data2=new PdfPCell(new Phrase(""+rspt.getString("NAME"),new Font(Font.TIMES_ROMAN,8)));
							cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data2);
							
							PdfPCell cell1data4=new PdfPCell(new Phrase(""+rspt.getString("DESIG"),new Font(Font.TIMES_ROMAN,8)));
							cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
							table.addCell(cell1data4);
					    
					    PdfPCell cell1data6=new PdfPCell(new Phrase(""+rspt.getString("BASIC"),new Font(Font.TIMES_ROMAN,8)));
						cell1data6.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data6);
						
						PdfPCell cell1data3=new PdfPCell(new Phrase(""+rspt.getString("DA"),new Font(Font.TIMES_ROMAN,8)));
						cell1data3.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data3);
						
						PdfPCell cell1data5=new PdfPCell(new Phrase(""+rspt.getString("TOTAL_BASICDA"),new Font(Font.TIMES_ROMAN,8)));
						cell1data5.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data5);
						
						PdfPCell cell1data61=new PdfPCell(new Phrase(""+rspt.getString("ENCASH_DAYS"),new Font(Font.TIMES_ROMAN,8)));
						cell1data61.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data61);
						
						PdfPCell cell1data62=new PdfPCell(new Phrase(""+rspt.getString("ENCASHMENT_AMT"),new Font(Font.TIMES_ROMAN,8)));
						cell1data62.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data62);
						
						previousEmpCode = currentEmpCode;
					}
					
					Last_Total_Basic = Last_Total_Basic + Total_Basic;
					Last_Total_DA = Last_Total_DA + Total_DA;
					Last_Total_TotalBasicDA = Last_Total_TotalBasicDA + Total_TotalBasicDA;
					Last_Total_Days = Last_Total_Days + Total_Days;
					Last_Total_Encashment = Last_Total_Encashment + Total_Encashment;
					
				}
					
					document.add(table);	 
					
					para = new Paragraph(new Phrase("Total Employee :- "+totemp+","
							+ "\n Total Basic : "+Last_Total_Basic+"  "
							+ "\n Total DA : "+Last_Total_DA+"  "
							+ "\n Total BASIC+DA : "+Last_Total_TotalBasicDA+"  "
							+ "\n Total DAYS : "+Last_Total_Days+"  "
							+ "\n Total Encashment : "+Last_Total_Encashment+"" ,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));

					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(10);
					document.add(para);
					
					
					document.close();
					file.close();
					con.close();
				} catch (Exception e)
				{		
					e.printStackTrace();
				}
				
			}

			
			public static void leavetolicPDF(String filepath,String imagepath)
			{


				RepoartBean repBean  = new RepoartBean();
				Connection Cn = null;
				ResultSet emp = null;
				String EmpSql = "";
				int PBRCD = 0;
				int gross = 0;
				int brtot[] = new int[8];
				int ALLbrtot[] = new int[8];
				SimpleDateFormat output = new SimpleDateFormat("dd/MM/yyyy");
				//String table_name=type.equalsIgnoreCase("before")?"PAYTRAN":"PAYTRAN_STAGE";	
				long millis=System.currentTimeMillis();  
				 java.sql.Date date1=new java.sql.Date(millis);  
				 System.out.println("date..."+date1);
				 DateFormat df = new SimpleDateFormat("yyyy-MM-dd");
				 String reportDate = df.format(date1);
				try{

					Document doc = new Document();
					PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
					doc.open();
					doc.setPageSize(PageSize.A4);
					Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
					//ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("HARSH CONSTRUCTION",FONT), 297.5f, 421, 45);

					//	Image image1 = Image.getInstance("/images/BusinessBankLogo.jpg");
					Image image1 = Image.getInstance(imagepath);
					image1.scaleAbsolute(80f, 80f);
					image1.setAbsolutePosition(20f, 760f); 
					doc.add(image1);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);
					doc.add(para);
					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					
					
					 doc.add(para);
						para = new Paragraph(new Phrase("Leave To LIC Report: "+reportDate,new Font(Font.TIMES_ROMAN,8)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(0);
						doc.add(para);
					/*doc.add(para);
					para = new Paragraph(new Phrase("Provident Fund Statment "+rdt.substring(3)+"  "+(type.equalsIgnoreCase("before")?" (Before Finalize)":"(After Finalize)"),new Font(Font.TIMES_ROMAN,10)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);
*/
					PdfPTable tab = new PdfPTable(14);

					tab.setWidthPercentage(new float[]{8,8,30,20,10,10,10,10,10,10,8,10,10,12}, new Rectangle(158, 100));
					tab.setSpacingBefore(20);
					tab.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab.addCell(new Phrase("Sr No",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					tab.addCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					tab.addCell(new Phrase("Emp Name",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					tab.addCell(new Phrase("Desig",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					tab.addCell(new Phrase("Policy Number",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					tab.addCell(new Phrase("Lic Id",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					tab.addCell(new Phrase("Basic ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					tab.addCell(new Phrase("DA",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					tab.addCell(new Phrase("VDA",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					tab.addCell(new Phrase("Gross Salary",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					tab.addCell(new Phrase("Leave Day",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					tab.addCell(new Phrase("Leave Salary ",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					tab.addCell(new Phrase("Join_Dt",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					tab.addCell(new Phrase("Birth_Dt",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					tab.setHeaderRows(1);
					ReportDAO.OpenCon("", "", "",repBean);
					Cn = repBean.getCn();
					
					
					//int i=11;
					int count=1;
					int days=0;
					double Totdays=0;
					double TotLeaveSal=0;
					//int k = 0;
					String year=ReportDAO.getServerDate();
					System.out.println("this is year..."+year.substring(7,11));

					Statement st;
					//System.out.println(table_name+"----"+EmpSql);
					st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
					emp=st.executeQuery("with a as( select e.empno,e.EMPCODE,e.lic_leave_encash_no,e.lic_leave_encash_policy_no,convert(nvarchar,e.DOJ,103) as DOJ,convert(nvarchar,e.DOB,103) as DOB,RTRIM(e.LNAME)+''+RTRIM(e.FNAME)+' '+RTRIM(e.MNAME) AS NAME, lkp_disc as DESIG,"+  
							   " (select isnull((select ISNULL(p.INP_AMT,0) from PAYTRAN p "+ 
								" where p.EMPNO=e.EMPNO and trncd=101 and TRNDT between "+ 
								" '"+ReportDAO.BOM("01-JAN-"+year.substring(7,11))+"'  and '"+ReportDAO.EOM("01-JAN-"+year.substring(7,11))+"' ),0)) as BASIC, "+  
								" (select isnull((select ISNULL(p.INP_AMT,0) from PAYTRAN p "+ 
								" where p.EMPNO=e.EMPNO and trncd=102 and TRNDT between "+ 
								" '"+ReportDAO.BOM("01-JAN-"+year.substring(7,11))+"'  and '"+ReportDAO.EOM("01-JAN-"+year.substring(7,11))+"'),0)) as DA,  "+
								" (select isnull((select ISNULL(p.INP_AMT,0) from PAYTRAN p "+ 
								" where p.EMPNO=e.EMPNO and trncd=138 and TRNDT between "+ 
								" '"+ReportDAO.BOM("01-JAN-"+year.substring(7,11))+"'  and '"+ReportDAO.EOM("01-JAN-"+year.substring(7,11))+"'),0)) as VDA, "+
								" (select top 1 isnull( l.BAL,0) from leavebal l where l.EMPNO=e.EMPNO and l.LEAVECD=1 order by BALDT desc,srno desc) as DAYS "+
								
								" from empmast e,emptran t,lookup l where  e.EMPNO=e.EMPNO and e.EMPNO=t.EMPNO and "+
								" t.srno=(select max(t1.srno) from emptran t1 where t1.empno=e.EMPNO ) and "+
								" l.lkp_srno=t.desig and l.lkp_code='DESIG' and "+
								" ((e.STATUS='A' and e.DOJ<='"+ReportDAO.EOM("01-MAR-"+year.substring(7,11))+"' )) and " +
								" (select DATEDIFF(MONTH,(select doj from empmast where empno=e.empno and status='A' ),GETDATE())) < 696 "+
									/*	"or "+
								" (e.DOL <='"+ReportDAO.EOM("01-MAR-"+year.substring(7,11))+"' and(e.STATUS='N' and e.DOL<>''))) "+*/  
								" UNION "+ 
						   		" select e.empno,e.EMPCODE,e.lic_leave_encash_no,e.lic_leave_encash_policy_no,convert(nvarchar,e.DOJ,103) as DOJ,convert(nvarchar,e.DOB,103) as DOB,RTRIM(e.LNAME)+''+RTRIM(e.FNAME)+' '+RTRIM(e.MNAME) AS NAME, lkp_disc as DESIG, "+  
						   		" (select isnull((select ISNULL(p.INP_AMT,0) from PAYTRAN_STAGE p "+
						   		" where p.EMPNO=e.EMPNO and trncd=101 and TRNDT between "+
						   		" '"+ReportDAO.BOM("01-JAN-"+year.substring(7,11))+"'  and '"+ReportDAO.EOM("01-JAN-"+year.substring(7,11))+"'),0)) as BASIC, "+  
						   		" (select isnull((select ISNULL(p.INP_AMT,0) from PAYTRAN_STAGE p "+
						   		" where p.EMPNO=e.EMPNO and trncd=102 and TRNDT between "+
						   		" '"+ReportDAO.BOM("01-JAN-"+year.substring(7,11))+"'  and '"+ReportDAO.EOM("01-JAN-"+year.substring(7,11))+"'),0)) as DA, "+  
						   		" (select isnull((select ISNULL(p.INP_AMT,0) from PAYTRAN_STAGE p "+
						   		" where p.EMPNO=e.EMPNO and trncd=138 and TRNDT between "+
						   		" '"+ReportDAO.BOM("01-JAN-"+year.substring(7,11))+"'  and '"+ReportDAO.EOM("01-JAN-"+year.substring(7,11))+"'),0)) as VDA, "+
						   		" (select top 1 isnull( l.BAL,0) from leavebal l where l.EMPNO=e.EMPNO and l.LEAVECD=1 order by BALDT desc,srno desc) as DAYS "+
						
								" from empmast e,emptran t,lookup l where  e.EMPNO=e.EMPNO and e.EMPNO=t.EMPNO and "+
								" t.srno=(select max(t1.srno) from emptran t1 where t1.empno=e.EMPNO ) and "+
								" l.lkp_srno=t.desig and l.lkp_code='DESIG' and "+
								" ((e.STATUS='A' and e.DOJ<='"+ReportDAO.EOM("01-MAR-"+year.substring(7,11))+"' )) and " +
								" (select DATEDIFF(MONTH,(select doj from empmast where empno=e.empno and status='A' ),GETDATE()))<696"+
								/*" ((e.DOL>='"+ReportDAO.BoFinancialy("01-MAR-"+year.substring(7,11))+"' ) and "+
						   		" (e.DOL <='"+ReportDAO.EOM("01-MAR-"+year.substring(7,11))+"' and (e.STATUS='N' and e.DOL<>''))) "+ */
						   		"  )" +
						   		" select * from a where a.VDA >0 order by a.EMPCODE,a.DESIG " );
					/*int i;
					for(i = 1; i <= 7; i++){
						ALLbrtot[i] = 0;
					}
					int count = 1;
					emp.previous();
					for(i = 1; i <= 4; i++){
						brtot[i] = 0;
					}
					int k = 0;*/
					while(emp.next()){

						
							int basic=0;
							int da=0;
							int vda=0;
							int eps = 0;
							int epf = 0;

							tab.addCell(new Phrase(""+count++,new Font(Font.TIMES_ROMAN,6)));
							tab.addCell(new Phrase(""+emp.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,6)));
							tab.addCell(new Phrase(""+emp.getString("NAME"),new Font(Font.TIMES_ROMAN,6)));
							tab.addCell(new Phrase(""+emp.getString("DESIG"),new Font(Font.TIMES_ROMAN,6)));
							tab.addCell(new Phrase(""+emp.getString("lic_leave_encash_policy_no")==null?"":emp.getString("lic_leave_encash_policy_no"),new Font(Font.TIMES_ROMAN,6)));
							tab.addCell(new Phrase(""+emp.getString("lic_leave_encash_no")==null?"":emp.getString("lic_leave_encash_no"),new Font(Font.TIMES_ROMAN,6)));
							tab.addCell(new Phrase(""+emp.getString("BASIC"),new Font(Font.TIMES_ROMAN,6)));
							tab.addCell(new Phrase(""+emp.getString("DA"),new Font(Font.TIMES_ROMAN,6)));
							tab.addCell(new Phrase(""+emp.getString("VDA"),new Font(Font.TIMES_ROMAN,6)));
							
							basic=emp.getString("BASIC")!= null?emp.getInt("BASIC"):0;
							da=emp.getString("DA")!= null?emp.getInt("DA"):0;
							vda=emp.getString("VDA")!= null?emp.getInt("VDA"):0;
							
							
							tab.addCell(new Phrase(""+trans((basic+da+vda), "999,999.99", "", false, false),new Font(Font.TIMES_ROMAN,6)));
							double gros=	(basic+da+vda);
							double gm=(gros/30);
							double ds = emp.getInt("DAYS");
							double lsal=Math.round(gm*ds);
							
							double leavesal = (((basic+da+vda)/30)*(emp.getInt("DAYS")));
							
							tab.addCell(new Phrase(""+emp.getInt("DAYS"),new Font(Font.TIMES_ROMAN,6)));
							tab.addCell(new Phrase(""+transLeavetoLIC(lsal, "999,999.99", "", false, false),new Font(Font.TIMES_ROMAN,6)));
							tab.addCell(new Phrase(""+emp.getString("DOJ"),new Font(Font.TIMES_ROMAN,6)));
							tab.addCell(new Phrase(""+emp.getString("DOB"),new Font(Font.TIMES_ROMAN,6)));
							/*tab.addCell(new Phrase(""+emp.getString("DESIG"),new Font(Font.TIMES_ROMAN,8)));
							tab.addCell(new Phrase(""+emp.getString("DESIG"),new Font(Font.TIMES_ROMAN,8)));
*/
							/*brtot[1] = brtot[1] + Math.round((basic+da+vda));
							gross = (emp.getString("BASIC")!= null?emp.getInt("BASIC"):0);
							tab.addCell(new Phrase(""+trans(emp.getInt("PF"), "999,999.99", "", false, false),new Font(Font.TIMES_ROMAN,8)));
							brtot[2] = brtot[2] + Math.round(emp.getInt("PF"));
							epf=emp.getString("EPF")!= null?emp.getInt("EPF"):0;
							eps=emp.getString("EPS")!= null?emp.getInt("EPS"):0;
							if(emp.getInt("PF") !=0.00 ){
								brtot[3] = brtot[3] + Math.round(epf);
								brtot[4] = brtot[4] + Math.round(eps);
							}
							tab.addCell(new Phrase(""+epf,new Font(Font.TIMES_ROMAN,8)));
							tab.addCell(new Phrase(""+eps,new Font(Font.TIMES_ROMAN,8)));
							tab.addCell(new Phrase(""+output.format(emp.getDate("DOB")),new Font(Font.TIMES_ROMAN,8)));
*/
							days= emp.getInt("DAYS");
							TotLeaveSal = TotLeaveSal+ leavesal;
							Totdays = Totdays + days;
							leavesal=0;
							days=0;
							}
					doc.add(tab);
					PdfPTable tab1 = new PdfPTable(4);
					tab.setWidthPercentage(new float[]{8,8,30,20,10,10,10,10,10,10,8,10,10,12}, new Rectangle(158, 100));
					tab1.setWidthPercentage(new float[]{30,30,46,60}, new Rectangle(158, 100));
					tab1.setSpacingBefore(1);
					tab1.addCell(new Phrase("Total Employee :",new Font(Font.TIMES_ROMAN,8)));
					
					tab1.addCell(new Phrase(""+(count-1),new Font(Font.TIMES_ROMAN,8)));
					tab1.addCell(new Phrase("Total Days:    "+Totdays,new Font(Font.TIMES_ROMAN,8)));
					tab1.addCell(new Phrase("Total Leave Salary:    "+transLeavetoLIC(TotLeaveSal, "999,999.99", "", false, false),new Font(Font.TIMES_ROMAN,8)));
					/*PdfPCell total=new PdfPCell(new Phrase("Total :",new Font(Font.TIMES_ROMAN,8)));
					total.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(total);
					tab.addCell(new Phrase(""+trans(brtot[1],"","",true,true),new Font(Font.TIMES_ROMAN,8)));
					tab.addCell(new Phrase(""+trans(brtot[2],"","",true,true),new Font(Font.TIMES_ROMAN,8)));

					tab.addCell(new Phrase(""+trans(brtot[3],"","",true,true),new Font(Font.TIMES_ROMAN,8)));
					tab.addCell(new Phrase(""+trans(brtot[4],"","",true,true),new Font(Font.TIMES_ROMAN,8)));
					tab.addCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));*/
					
					doc.add(tab1);
					doc.close();
					Cn.close();
					return;
				}	
				catch(Exception e)
				{
					e.printStackTrace();
				}
			}
			
			public static void transferreportofSpecificEmp(String empno,String type,String filepath,String imagepath)throws IOException, SQLException, DocumentException  // @ni
			{
				Document doc = new Document();
				try{
					 int lastyr=0,lastMon=0,lday=0;
					 long millis=System.currentTimeMillis();  
					 java.sql.Date date=new java.sql.Date(millis);  
					 System.out.println("date..."+date);
					 DateFormat df = new SimpleDateFormat("yyyy-MM-dd");
					 String reportDate = df.format(date);
					
					int totalemp=0;
					PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
					doc.setPageSize(PageSize.A4);
					doc.open();
					
					Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
					ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f,50f);
					image1.setAbsolutePosition(40f, 750f);

					doc.add(image1);
					doc.add(para);
					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Employees Transfer List " ,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);
					para = new Paragraph(new Phrase("Date:-" + reportDate,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);
					
					Rectangle rec1 = new  Rectangle(160,100);
					PdfPTable headtab1 = null;
					PdfPTable datatab2=new PdfPTable(1);
					datatab2.setSpacingBefore(0);
					datatab2.setWidthPercentage(new float[]{160}, rec1);
					
					Rectangle rec = new  Rectangle(160,100);
					PdfPTable headtab = null;

					headtab= new PdfPTable(8);	
					headtab.setSpacingBefore(0);
					headtab.setWidthPercentage(new float[]{9,9,28,17,12,24,24,37}, rec);
					headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
					
					PdfPTable datatab=new PdfPTable(8);
					datatab.setSpacingBefore(0);
					datatab.setWidthPercentage(new float[]{9,9,28,17,12,24,24,37}, rec);
					
					Connection conn=ConnectionManager.getConnection();
					Statement st=st = conn.createStatement(
							ResultSet.TYPE_SCROLL_INSENSITIVE,
							ResultSet.CONCUR_READ_ONLY);
					String EmpSql="";
					String previousEmpCode="";
					String currentEmpCode="";
					String OldBRName="",currDesig="";
					EmpSql = ""
							+ "WITH a "
							+ "     AS (SELECT Row_number() "
							+ "     OVER( "
							+ "     ORDER BY srno) AS rn, "
							+ "     srno, "
							+ "     empno "
							+ "     FROM   emptran "
							+ "     WHERE  empno = "+empno+" )"
			//				+ "       AND ( trncd != 50 OR ( trncd IS NULL OR ( trncd < 999  AND trncd != 50 ) ) )) "
							+ "       SELECT a1.*, "
							+ "       site_name  AS new_site, "
							+ "       (SELECT p1.site_name "
							+ "        FROM   project_sites p1 "
							+ "        WHERE  p1.site_id = (SELECT e1.prj_srno "
							+ "                             FROM   emptran e1 "
							+ "                             WHERE  e1.empno = e.empno "
							+ "                                    AND e1.srno = a1.rn - 1)) AS oldsite, "
							+ "       m.doj, "
							+ "       e.srno, "
							+ "       m.empno, "
							+ "       m.empcode, "
							+ "       m.lname, "
							+ "       m.fname, "
							+ "       m.mname, "
							+ "       l.lkp_disc, "
							+ "       e.effdate, "
							+ "       e.order_dt, "
							+ "       (SELECT effdate "
							+ "        FROM   emptran et "
							+ "        WHERE  et.empno = "+empno+" "
							+ "               AND srno = a1.rn + 1)AS secondEFFDATE "
							+ "       FROM   empmast m, "
							+ "       emptran e, "
							+ "       project_sites p, "
							+ "       lookup l, "
							+ "       a a1 ,emptran y "
							+ "       WHERE  m.empno = e.empno "
							+ "       AND m.empno = a1.empno "
							+ "       AND e.srno = a1.srno "
							+ "       AND e.prj_srno = p.site_id "
							+ "       AND m.empno = "+empno+" "
							+ "       AND m.status = 'A' "
							+ "       and y.EMPNO=e.EMPNO "
							+ "       and y.SRNO= (SELECT Max(srno) "
							+ "                     FROM   emptran g "
							+ "                     WHERE  g.empno = m.empno) "
							+ "       AND l.lkp_code = 'DESIG' "
							+ "       AND l.lkp_srno = y.desig "
							+ "       AND e.srno > 1 "
							+ "       AND e.trncd = 60"
							+ "       ORDER  BY e.effdate";
							
									/*+ "with a as ( "
					//				+ "select ROW_NUMBER() over(order by srno) as rn ,srno,empno from EMPTRAN   where EMPNO ="+empno+" and  (trncd != 50 OR( trncd IS NULL OR  TRNCD < 999))) "
									+ "select ROW_NUMBER() over(order by srno) as rn ,srno,empno from EMPTRAN   where EMPNO ="+empno+" and  ( trncd != 50 or ( trncd IS NULL  OR (trncd < 999 and trncd != 50) )))  "
									+ "SELECT a1.*,site_name  AS new_site, "
									+ "       (SELECT p1.site_name "
									+ "        FROM   project_sites p1 "
									+ "        WHERE  p1.site_id = (SELECT e1.prj_srno "
									+ "        FROM   emptran e1 "
									+ "        WHERE  e1.empno = e.empno "
									+ "        AND e1.srno = a1.rn - 1)) AS oldsite, "
									+ "       m.doj, "
									+ "       e.srno, "
									+ "       m.empno, "
									+ "       m.empcode, "
									+ "       m.lname, "
									+ "       m.fname, "
									+ "       m.mname, "
									+ "       l.lkp_disc, "
									+ "       e.effdate, "
									+ "       e.order_dt, "
									+ "       (SELECT effdate "
									+ "        FROM   emptran et "
									+ "        WHERE  et.empno = "+empno+" "
									+ "        AND srno = a1.rn + 1)  AS secondEFFDATE "
									+ " FROM   empmast m, "
									+ "       emptran e, "
									+ "       project_sites p, "
									+ "       lookup l, "
									+ "       a a1 "
									+ " WHERE  m.empno = e.empno "
									+ "	   and m.empno = a1.empno "
									+ "	   and e.SRNO=a1.SRNO "
									+ "       AND e.prj_srno = p.site_id "
									+ "  "
									+ "       AND m.empno = "+empno+" "
									+ "       AND l.lkp_srno = e.desig "
									+ "       AND l.lkp_code = 'DESIG' "
									+ "       AND m.status = 'A' "
									+ "       AND e.srno > 1 "
									+ "ORDER  BY e.effdate";*/
							
					System.out.println("EmpSql::"+EmpSql);
					ResultSet emp = st.executeQuery(EmpSql);
					if(!emp.next())
					{
						System.out.println("no record found");
						PdfPTable datatab1=new PdfPTable(1);
						datatab1.setSpacingBefore(2);
						datatab1.setWidthPercentage(new float[]{107}, rec);
						PdfPCell c11 = new PdfPCell(new Phrase("Record Not Found ",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));  
						datatab1.addCell(c11);
						doc.add(datatab1);
					}
					else
					{
						
						emp.previous();
						
						headtab.setSpacingBefore(10);
						
						
						PdfPCell sr = new PdfPCell(new Phrase("Sr No",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
						headtab.addCell(sr);
						PdfPCell c1 = new PdfPCell(new Phrase("Emp Code",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
						headtab.addCell(c1);
						PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c2);
						PdfPCell c3 = new PdfPCell(new Phrase("Designation",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c3);
						PdfPCell c4 = new PdfPCell(new Phrase("Transfer Date",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c4);
						PdfPCell c5 = new PdfPCell(new Phrase("Old_Branch_Name",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c5);
						PdfPCell c6 = new PdfPCell(new Phrase("New_Branch_Name",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c6);
						PdfPCell c7 = new PdfPCell(new Phrase("Period Since Previous Branch",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
						headtab.addCell(c7);

						doc.add(headtab);
						String year = "";
						String year1 = "";
						String secondDT ="";
						int preDay=0,currDay=0,preMonth=0,currMonth=0,preYear=0,currYear=0;
						int secondDay=0,secondMonth=0,secondYear=0;
						int sDay=0,sMonth=0,sYear=0;
						String previousSite = "",newSite="";
						String SecondEffDate = "";
						
						int transYear=0,transMonth=0,transday=0;
						int LY =0,LM=0,LD=0;
						String TwoDateDiff[];
						String DateDiff="";
						int YearDiff = 0;
						int monthDiff = 0;
						int dayDiff = 0;
						while(emp.next())
						{
							
	                           currentEmpCode = emp.getString("EMPCODE");
								totalemp++;
								
								year = emp.getString("EFFDATE");
								String str[] = year.split("-");
								currYear = Integer.parseInt(str[0]);
								currMonth = Integer.parseInt(str[1]);
								currDay = Integer.parseInt(str[2]);
								System.out.println("AJ   currYear:: "+currYear+"  currMonth  "+currMonth+" currDay "+currDay);
								
								secondDT = emp.getString("DOJ");
								String str2[] = secondDT.split("-");
								secondYear = Integer.parseInt(str2[0]);
								secondMonth = Integer.parseInt(str2[1]);
								secondDay = Integer.parseInt(str2[2]);
								
								 String str1[] = reportDate.split("-");
								 lastyr = Integer.parseInt(str1[0]);
								 lastMon = Integer.parseInt(str1[1]);
								 lday = Integer.parseInt(str1[2]);
								 
								 
								 
								 /*if (!emp.isLast() ){
								 SecondEffDate = emp.getString("secondEFFDATE");
								 String strlast[] = SecondEffDate.split("-");
									sYear = Integer.parseInt(strlast[0]);
									sMonth = Integer.parseInt(strlast[1]);
									sDay = Integer.parseInt(strlast[2]);
								 
								System.out.println("sYear:: "+sYear+"  sMonth  "+sMonth+" sDay "+sDay);
								 }*/
								 
								 
								
								if(emp.getRow()!=1 && previousEmpCode.equalsIgnoreCase(currentEmpCode)){	
									PdfPCell srno = new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));  
									datatab.addCell(srno);
									PdfPCell cell1 = new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));  
									datatab.addCell(cell1);
									PdfPCell cell2 = new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));
									datatab.addCell(cell2);
									PdfPCell cell3 = new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));
									datatab.addCell(cell3);
								}
								else{
								
								
								PdfPCell srno = new PdfPCell(new Phrase(""+totalemp,new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));  
								datatab.addCell(srno);
								PdfPCell cell1 = new PdfPCell(new Phrase(""+emp.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));  
								datatab.addCell(cell1);
								PdfPCell cell2 = new PdfPCell(new Phrase(""+emp.getString("LNAME")+" "+emp.getString("FNAME")+" "+emp.getString("MNAME"),new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));
								datatab.addCell(cell2);
								PdfPCell cell3 = new PdfPCell(new Phrase(""+emp.getString("LKP_DISC"),new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));
								datatab.addCell(cell3);
								}
								
								PdfPCell cell4 = new PdfPCell(new Phrase(""+emp.getString("EFFDATE"),new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));
								datatab.addCell(cell4);
								PdfPCell cell5 = new PdfPCell(new Phrase(""+emp.getString("oldsite")==null?"":emp.getString("oldsite"),new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));
								datatab.addCell(cell5);
						
								PdfPCell cell6 = new PdfPCell(new Phrase(""+emp.getString("new_site")==null?"":emp.getString("new_site"),new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));
								datatab.addCell(cell6);
								
								int diffYear =0,diffMonth=0,diffday=0;
								diffYear =Math.abs(currYear - preYear);
								diffMonth =Math.abs(currMonth - preMonth);
								diffday = Math.abs(currDay - preDay);
								
								
								LY =Math.abs(lastyr -currYear );
								LM =Math.abs(lastMon - currMonth);
								LD = Math.abs(lday - currDay);
								
								int SY =0,SM=0,SD=0;
								SY =Math.abs(secondYear -currYear );
								SM =Math.abs(secondMonth - currMonth);
								SD = Math.abs(secondDay - currDay);
								
								SY =Math.abs(currYear - secondYear );
								SM =Math.abs( currMonth - secondMonth);
								SD = Math.abs(currDay - secondDay);
								
								if(!emp.isFirst()){
								DateFormat format = new SimpleDateFormat("yyyy-MM-dd", Locale.ENGLISH);
								Date date1=format.parse(year);
								Date date2=format.parse(year1);
								System.out.println("date1:  "+date1+"   date2:  "+date2);
							    DateDiff = ReportDAO.differenceBetweenDates(date1,date2);
								TwoDateDiff= DateDiff.split("-");
								YearDiff = Integer.parseInt(TwoDateDiff[0]);
								monthDiff= Integer.parseInt(TwoDateDiff[1]);
								dayDiff = Integer.parseInt(TwoDateDiff[2]);
								}
								if(emp.isFirst()){
									/*PdfPCell cell7 = new PdfPCell(new Phrase(""+SY+"  Years,  "+SM+"  Months  and  "+SD+"  Days",new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));
									datatab.addCell(cell7);*/
									PdfPCell cell7 = new PdfPCell(new Phrase(""+SY+"  Years,  "+SM+"  Months  and  "+SD+"  Days",new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));
									datatab.addCell(cell7);
								}
								/*else if (emp.isLast() ) {
									PdfPCell cell7 = new PdfPCell(new Phrase(""+LY+"  Years,  "+LM+"  Months  and  "+LD+"  Days",new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));
									datatab.addCell(cell7);
									OldBRName = emp.getString("new_site");
									currDesig = emp.getString("LKP_DISC");
									System.out.println("OldBRName:: "+OldBRName);
								}*/
								else{
									PdfPCell cell7 = new PdfPCell(new Phrase(""+YearDiff+"  Years,  "+monthDiff+"  Months  and  "+dayDiff+"  Days",new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));
							//		PdfPCell cell7 = new PdfPCell(new Phrase(""+diffYear+"  Years,  "+diffMonth+"  Months  and  "+diffday+"  Days",new Font(Font.TIMES_ROMAN,6,Font.NORMAL)));
									datatab.addCell(cell7);
								}
								OldBRName = emp.getString("new_site");
								currDesig = emp.getString("LKP_DISC");
								 previousEmpCode = currentEmpCode;
								 preDay=currDay;
								 preMonth=currMonth;
								 preYear=currYear;
								 newSite =previousSite;
								/*preDay= sDay;
								preMonth= sMonth;
								preYear= sYear;
								newSite =previousSite;*/
								 year1 = preYear+"-"+preMonth+"-"+preDay;
								 System.out.println("preYear:: "+preYear+"  preMonth  "+preMonth+" preDay "+preDay);	
							
							}
						doc.add(datatab);
						
						String DateDifference[];
						String Date_Diff="";
						int year_diff = 0;
						int month_diff = 0;
						int day_diff = 0;
						DateFormat format = new SimpleDateFormat("yyyy-MM-dd", Locale.ENGLISH);
						Date date1=format.parse(reportDate);
						Date date2=format.parse(year);
						Date_Diff = ReportDAO.differenceBetweenDates(date1,date2);
						DateDifference= Date_Diff.split("-");
						year_diff = Integer.parseInt(DateDifference[0]);
						month_diff= Integer.parseInt(DateDifference[1]);
						day_diff = Integer.parseInt(DateDifference[2]);
						PdfPCell c11 = new PdfPCell(new Phrase("   Join Date:- "+secondDT+"                                                    Present Branch / Dept:-    "+OldBRName+"   -  "+currDesig,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
						datatab2.addCell(c11);
						PdfPCell c12 = new PdfPCell(new Phrase("   AS on Period ------>       "+year_diff+"  Years,  "+month_diff+"  Months  and  "+day_diff+"  Days",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
						datatab2.addCell(c12);
						doc.add(datatab2);
					}
					doc.close();
				}
				catch(Exception e)
				{
					e.printStackTrace();
				}

			}
			//BranhWise.....
			public static void BranchWisetransferreport(String type,String branchType,String branchName,String branchfrom,String branchto,String Year,String filepath,String imagepath)throws IOException, SQLException, DocumentException
			{int lastyr=0,lastMon=0,lday=0;
			 long millis=System.currentTimeMillis();  
			 java.sql.Date date=new java.sql.Date(millis);  
			 System.out.println("date..."+date);
			 DateFormat df = new SimpleDateFormat("yyyy-MM-dd");
			 String reportDate = df.format(date);
			RepoartBean repBean  = new RepoartBean();
			Document doc = new Document();
			try
			{
				int totalemp=0;
				Connection Cn = null;
				Statement st = null;
				ResultSet rs = null;
				ResultSet rs1 = null;

				ReportDAO.OpenCon("", "", "",repBean);
				Cn = repBean.getCn();
				
				int totalEmployee =0;
				int Employee = 0;
				String Query = "";
				String Query1 = "";
				
				LookupHandler lkhp = new LookupHandler();
				Rectangle rec = new  Rectangle(119,100);
				PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
				
				doc.open();
				doc.setPageSize(PageSize.A4);
				
				Font fbold = new Font(Font.TIMES_ROMAN,8,Font.BOLD);
				Font fsmall = new Font(Font.TIMES_ROMAN,7);
				Font FONT = new Font(Font.TIMES_ROMAN, 27, Font.NORMAL, new GrayColor(0.75f));
				Font  fontcolor = FontFactory.getFont(FontFactory.HELVETICA, 10, new Color(6, 8, 193));
				
				ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
				Image image1 = Image.getInstance(imagepath);
				Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);

				image1.scaleAbsolute(60f,50f);
				image1.setAbsolutePosition(40f, 750f);
				doc.add(image1);
				doc.add(para);
				para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Employees Transfer List " ,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);
				para = new Paragraph(new Phrase("Date:-" + reportDate,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);
				
				
				if(branchType.equalsIgnoreCase("1"))
						{
					Query = "select * from Project_Sites";
				}
				else if(branchType.equalsIgnoreCase("2")){
			     	Query = "select * from Project_Sites where SITE_ID =" +branchName ;
				}
				else if(branchType.equalsIgnoreCase("3")){
					Query = "select * from Project_Sites where SITE_ID  between "+branchfrom +"and "+branchto;
				}
				System.out.println("Query is@@@ " +Query);
				st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
				rs = st.executeQuery(Query);	
				
				String transferDate = "";
				int transferDay=0,transferMonth=0,transferYear=0;
				int differenceYear = 0,differenceMonth =0,differenceDay=0;
				String site_id ="";
				String site_name ="";
				String Project_Code ="";
				int srno = 0;
				while(rs.next())
				{
					site_id = rs.getString("Site_ID");
					site_name = rs.getString("site_name");
					Project_Code = rs.getString("Project_Code");
					
						if(branchType.equalsIgnoreCase("1"))
						{
					Query1 =""
							+ "with transferemp as( "
							+ "SELECT "
							+ "       p.site_name AS new_site, "
							+ "       m.doj, "
							+ "       m.empno, "
							+ "       m.empcode, "
							+ "       m.lname, "
							+ "       m.fname, "
							+ "       m.mname, "
							+ "       l.lkp_disc, "
							+ "       h.site_name AS old_site, "
							+ "       e.effdate, "
							+ "       e.order_dt,a.desig, "
							+ "       (select  dbo.DateDiffereceCheck2 ((select t.effdate from EMPTRAN t where t.EMPNO=m.empno and t.srno = (SELECT Max(srno)   FROM   emptran b "
							+ " WHERE  b.empno = t.empno AND b.trncd = 60)),(Convert(date, getdate())))) as DateDiff "
							+ " FROM   empmast m, "
							+ "       emptran e, "
							+ "       project_sites p, "
							+ "       emptran k, "
							+ "       project_sites h, "
							+ "       lookup l, "
							+ "       emptran a "
							+ " WHERE  m.empno = e.empno "
							+ "       AND e.prj_srno = p.site_id "
							+ "       AND k.empno = e.empno "
							+ "       AND h.site_id = k.prj_srno "
							+ "       AND k.srno = (SELECT Max(srno) - 1 "
							+ "                     FROM   emptran c "
							+ "                     WHERE  c.empno = m.empno "
							+ "                            AND c.trncd = 60) "
							+ "       AND e.srno = (SELECT Max(srno) "
							+ "                     FROM   emptran b "
							+ "                     WHERE  b.empno = m.empno "
							+ "                            AND b.trncd = 60) "
							+ "       AND m.status = 'A' "
							+ "       AND a.empno = e.empno "
							+ "       AND a.srno = (SELECT Max(srno) "
							+ "                     FROM   emptran g "
							+ "                     WHERE  g.empno = m.empno) "
							+ "       AND l.lkp_code = 'DESIG' "
							+ "       AND l.lkp_srno = a.desig AND e.prj_srno = "+site_id+""
							+ "       ) "
							+ "       select * from transferemp where transferemp.DateDiff >="+Year+""
							+ "ORDER  BY transferemp.desig";
							
						}
						else if(branchType.equalsIgnoreCase("2"))
						{
					Query1 ="" 
							+ "with transferemp as( "
							+ "SELECT "
							+ "       p.site_name AS new_site, "
							+ "       m.doj, "
							+ "       m.empno, "
							+ "       m.empcode, "
							+ "       m.lname, "
							+ "       m.fname, "
							+ "       m.mname, "
							+ "       l.lkp_disc, "
							+ "       h.site_name AS old_site, "
							+ "       e.effdate, "
							+ "       e.order_dt,a.desig, "
							+ "       (select  dbo.DateDiffereceCheck2 ((select t.effdate from EMPTRAN t where t.EMPNO=m.empno and t.srno = (SELECT Max(srno)   FROM   emptran b "
							+ " WHERE  b.empno = t.empno AND b.trncd = 60)),(Convert(date, getdate())))) as DateDiff "
							+ " FROM   empmast m, "
							+ "       emptran e, "
							+ "       project_sites p, "
							+ "       emptran k, "
							+ "       project_sites h, "
							+ "       lookup l, "
							+ "       emptran a "
							+ " WHERE  m.empno = e.empno "
							+ "       AND e.prj_srno = p.site_id "
							+ "       AND k.empno = e.empno "
							+ "       AND h.site_id = k.prj_srno "
							+ "       AND k.srno = (SELECT Max(srno) - 1 "
							+ "                     FROM   emptran c "
							+ "                     WHERE  c.empno = m.empno "
							+ "                            AND c.trncd = 60) "
							+ "       AND e.srno = (SELECT Max(srno) "
							+ "                     FROM   emptran b "
							+ "                     WHERE  b.empno = m.empno "
							+ "                            AND b.trncd = 60) "
							+ "       AND m.status = 'A' "
							+ "       AND a.empno = e.empno "
							+ "       AND a.srno = (SELECT Max(srno) "
							+ "                     FROM   emptran g "
							+ "                     WHERE  g.empno = m.empno) "
							+ "       AND l.lkp_code = 'DESIG' "
							+ "       AND l.lkp_srno = a.desig AND e.prj_srno = "+branchName+""
							+ "       ) "
							+ "       select * from transferemp where transferemp.DateDiff >="+Year+""
							+ "ORDER  BY transferemp.desig";
							
									
						}
						else if(branchType.equalsIgnoreCase("3"))
						{
					Query1 = ""
							+ "with transferemp as( "
							+ "SELECT "
							+ "       p.site_name AS new_site, "
							+ "       m.doj, "
							+ "       m.empno, "
							+ "       m.empcode, "
							+ "       m.lname, "
							+ "       m.fname, "
							+ "       m.mname, "
							+ "       l.lkp_disc, "
							+ "       h.site_name AS old_site, "
							+ "       e.effdate, "
							+ "       e.order_dt,a.desig, "
							+ "       (select  dbo.DateDiffereceCheck2 ((select t.effdate from EMPTRAN t where t.EMPNO=m.empno and t.srno = (SELECT Max(srno)   FROM   emptran b "
							+ " WHERE  b.empno = t.empno AND b.trncd = 60)),(Convert(date, getdate())))) as DateDiff "
							+ " FROM   empmast m, "
							+ "       emptran e, "
							+ "       project_sites p, "
							+ "       emptran k, "
							+ "       project_sites h, "
							+ "       lookup l, "
							+ "       emptran a "
							+ " WHERE  m.empno = e.empno "
							+ "       AND e.prj_srno = p.site_id "
							+ "       AND k.empno = e.empno "
							+ "       AND h.site_id = k.prj_srno "
							+ "       AND k.srno = (SELECT Max(srno) - 1 "
							+ "                     FROM   emptran c "
							+ "                     WHERE  c.empno = m.empno "
							+ "                            AND c.trncd = 60) "
							+ "       AND e.srno = (SELECT Max(srno) "
							+ "                     FROM   emptran b "
							+ "                     WHERE  b.empno = m.empno "
							+ "                            AND b.trncd = 60) "
							+ "       AND m.status = 'A' "
							+ "       AND a.empno = e.empno "
							+ "       AND a.srno = (SELECT Max(srno) "
							+ "                     FROM   emptran g "
							+ "                     WHERE  g.empno = m.empno) "
							+ "       AND l.lkp_code = 'DESIG' "
							+ "       AND l.lkp_srno = a.desig AND e.prj_srno = "+site_id+"  and e.PRJ_SRNO between "+branchfrom+" and "+branchto+ " "
							+ "       ) "
							+ "       select * from transferemp where transferemp.DateDiff >="+Year+""
							+ "ORDER  BY transferemp.desig";
						}
					System.out.println("Query1 is @@@ " +Query1);
					st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
					rs1 = st.executeQuery(Query1);	
					
					 if(rs1.next()){
						para = new Paragraph(new Phrase("Employee Transfer List For Project Site is :- "+( site_name + Project_Code ),fbold));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(10);
						doc.add(para);
						
						PdfPTable main = new PdfPTable(7);
						String str[] = new String[7];
						
						str[0]="Sr No";
						str[1]=" Emp Code";			str[2]="Employee Name";			str[3]="Designation";
						str[4]="Join Date";				str[5]="Transfer Date";  	            str[6]="No.of  Yrs  & Months";
						
						main.setWidthPercentage(new float[]{6,7,37,17,12,12,28}, rec);
						main.setHorizontalAlignment(Element.ALIGN_CENTER);
						PdfPCell maincell ;	
						
						for(int i=0; i<str.length;i++ )
						{					
							maincell = new PdfPCell(new Phrase(str[i],fbold));
							maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
							main.addCell(maincell);
						}	
						
						doc.add(main);
						
						String TwoDateDiff[];
						String DateDiff="";
						int YearDiff = 0;
						int monthDiff = 0;
						int dayDiff = 0;
						
						rs1.beforeFirst();
						while(rs1.next())
						{
							String str1[] = reportDate.split("-");
											 lastyr = Integer.parseInt(str1[0]);
											 lastMon = Integer.parseInt(str1[1]);
											 lday = Integer.parseInt(str1[2]);
							
											transferDate = rs1.getString("EFFDATE");
											String transdate[] = transferDate.split("-");
											transferYear = Integer.parseInt(transdate[0]);
											transferMonth = Integer.parseInt(transdate[1]);
											transferDay = Integer.parseInt(transdate[2]);
											
											differenceYear =Math.abs(lastyr - transferYear );
											differenceMonth =Math.abs(lastMon - transferMonth);
											differenceDay = Math.abs(lday - transferDay);
											
							srno++;
							PdfPTable main1 = new PdfPTable(7);
							main1.setWidthPercentage(new float[]{6,7,37,17,12,12,28}, rec);
							main1.setHorizontalAlignment(Element.ALIGN_CENTER);	
							
							PdfPCell cell1 = new PdfPCell(new Phrase(""+srno,fsmall));  
							cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
							main1.addCell(cell1);
							
							PdfPCell cell3 = new PdfPCell(new Phrase(""+rs1.getString("EMPCODE"),fsmall));
							cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
							main1.addCell(cell3);
							
							String empname=rs1.getString("fname")+" "+rs1.getString("mname")+" "+rs1.getString("lname");
							PdfPCell cell4 = new PdfPCell(new Phrase(""+empname,fsmall));
							cell4.setHorizontalAlignment(Element.ALIGN_LEFT);
							main1.addCell(cell4);
							
							PdfPCell cell5 = new PdfPCell(new Phrase(""+rs1.getString("LKP_DISC"),fsmall));
							cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
							main1.addCell(cell5);
							
							PdfPCell cell7 = new PdfPCell(new Phrase(""+rs1.getString("DOJ"),fsmall));
							cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
							main1.addCell(cell7);
							
							PdfPCell cell2 = new PdfPCell(new Phrase(""+rs1.getString("EFFDATE"),fsmall));
							cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
							main1.addCell(cell2);
							
							DateFormat format = new SimpleDateFormat("yyyy-MM-dd", Locale.ENGLISH);
							Date date1=format.parse(reportDate);
							Date date2=format.parse(transferDate);
							System.out.println("date1:  "+date1+"   date2:  "+date2);
							DateDiff = ReportDAO.differenceBetweenDates(date1,date2);
							TwoDateDiff= DateDiff.split("-");
							YearDiff = Integer.parseInt(TwoDateDiff[0]);
							monthDiff= Integer.parseInt(TwoDateDiff[1]);
							dayDiff = Integer.parseInt(TwoDateDiff[2]);

						//	PdfPCell cell6 = new PdfPCell(new Phrase(""+differenceYear+"  Year,   "+differenceMonth+" Months    and   "+differenceDay+" Day",fsmall));
							PdfPCell cell6 = new PdfPCell(new Phrase(""+YearDiff+"  Year,   "+monthDiff+" Months    and   "+dayDiff+"  Day",fsmall));
							cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
							main1.addCell(cell6);
							
							doc.add(main1);
							Employee+=1;	
						}     
					
					para = new Paragraph(new Phrase("Number Of Employee :- "+Employee,fsmall));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(20);
					doc.add(para);	
					
					totalEmployee = totalEmployee+ Employee;	
					Employee = 0;
				}
				
				}		
				para = new Paragraph(new Phrase("Total Number Of Employee :- "+totalEmployee,fbold));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);
				doc.add(para);			
				doc.close();
				Cn.close();
			}
			catch(Exception e) 
			{
				e.printStackTrace();
			}}
			// LWP Credit Debit List....
			public static void LWPCreditDebitReport(String type,String transType,String fromdate,String todate,String filepath,String imagepath)throws IOException, SQLException, DocumentException
			{
				 long millis=System.currentTimeMillis();  
				 java.sql.Date date=new java.sql.Date(millis);  
				 System.out.println("date..."+date);
				 DateFormat df = new SimpleDateFormat("yyyy-MM-dd");
				 String reportDate = df.format(date);
				RepoartBean repBean  = new RepoartBean();
				Document doc = new Document();
				try
				{
					int totalemp=0;
					Connection Cn = null;
					Statement st = null;
					Statement stmt = null;
					ResultSet rs = null;
					ResultSet emp = null;

					ReportDAO.OpenCon("", "", "",repBean);
					Cn = repBean.getCn();
					
					int totalEmployee =0;
					int Employee = 0;
					String Query = "";
					String Query1 = "";
					
					LookupHandler lkhp = new LookupHandler();
					Rectangle rec = new  Rectangle(119,100);
					PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
					
					doc.open();
					doc.setPageSize(PageSize.A4);
					
					Font fbold = new Font(Font.TIMES_ROMAN,8,Font.BOLD);
					Font fsmall = new Font(Font.TIMES_ROMAN,7);
					Font FONT = new Font(Font.TIMES_ROMAN, 27, Font.NORMAL, new GrayColor(0.75f));
					Font  fontcolor = FontFactory.getFont(FontFactory.HELVETICA, 10, new Color(6, 8, 193));
					
					ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f,50f);
					image1.setAbsolutePosition(40f, 750f);
					doc.add(image1);
					doc.add(para);
					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir Circle, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Tel : 0253-2406100, 2469545",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
//					para = new Paragraph(new Phrase("Email : hrd@namcobank.in",new Font(Font.TIMES_ROMAN,8)));
//					para.setAlignment(Element.ALIGN_CENTER);
//					para.setSpacingAfter(0);
//
//					doc.add(para);
					para = new Paragraph(new Phrase("Employees LWP List " ,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);
					para = new Paragraph(new Phrase("Date:-" + reportDate,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);
					int srno = 0;
					stmt = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
					String GetBranch = "SELECT "+
							"distinct T.prj_srno as branch,PS.SITE_NAME "+
							"FROM   empmast EMP,"+
							"emptran T,Project_Sites PS "+
							"WHERE  T.empno = EMP.empno  and PS.SITE_ID = T.prj_srno "+
							"AND T.srno = (SELECT Max(E2.srno)  "+
							"FROM   emptran E2 "+
							"WHERE  E2.empno = EMP.empno) "+
							"AND EMP.status = 'A'"+
							"ORDER  BY T.prj_srno";  
		
					ResultSet rspt0 = stmt.executeQuery(GetBranch);
					System.out.println("GetBranch "+GetBranch);
					
					if(type.equalsIgnoreCase("1") && transType.equalsIgnoreCase("1"))
							{
						Query1 = ""
								+ "select e1.EMPNO,e1.empcode,e1.salute,e1.fname,e1.MNAME,e1.LNAME,lp.TRNTYPE,lp.EMPNO,lp.TOTAL_DAYS,lp.total_amount, "
								+ "lp.PF_calamount,lp.STATUS,lp.CREATED_DATE,lp.BASICMONTH, "
								+ "T.PRJ_SRNO,p.site_name "
								+ "FROM  lwp_Amt_Payment lp, empmast e1,emptran T,Project_Sites p "
								+ "where   lp.empno =e1.empno  AND "
								+ "T.empno = e1.empno "
								+ "and T.srno =(SELECT max(e2.srno)  FROM   emptran e2 WHERE  e2.empno = e1.empno) "
								+ "and T.PRJ_SRNO = p.SITE_ID "
								+ "and lp.TRNTYPE='credit' "
								+ "ORDER BY T.PRJ_SRNO,e1.empcode";
	;
							}
					else if(type.equalsIgnoreCase("1") && transType.equalsIgnoreCase("2"))
							{
						Query1 = ""
								+ "select e1.EMPNO,e1.empcode,e1.salute,e1.fname,e1.MNAME,e1.LNAME,lp.TRNTYPE,lp.EMPNO,lp.TOTAL_DAYS,lp.total_amount, "
								+ "lp.PF_calamount,lp.STATUS,lp.CREATED_DATE,lp.BASICMONTH, "
								+ "T.PRJ_SRNO,p.site_name "
								+ "FROM  lwp_Amt_Payment lp, empmast e1,emptran T,Project_Sites p "
								+ "where   lp.empno =e1.empno  AND "
								+ "T.empno = e1.empno "
								+ "and T.srno =(SELECT max(e2.srno)  FROM   emptran e2 WHERE  e2.empno = e1.empno) "
								+ "and T.PRJ_SRNO = p.SITE_ID "
								+ "and lp.TRNTYPE='Debit' "
								+ "ORDER BY T.PRJ_SRNO,e1.empcode";
							}
					else if(type.equalsIgnoreCase("2") && transType.equalsIgnoreCase("1"))
							{
						Query1 =  ""
								+ "select e1.EMPNO,e1.empcode,e1.salute,e1.fname,e1.MNAME,e1.LNAME,lp.TRNTYPE,lp.EMPNO,lp.TOTAL_DAYS,lp.total_amount, "
								+ "lp.PF_calamount,lp.STATUS,lp.CREATED_DATE,lp.BASICMONTH, "
								+ "T.PRJ_SRNO,p.site_name "
								+ "FROM  lwp_Amt_Payment lp, empmast e1,emptran T,Project_Sites p "
								+ "where   lp.empno =e1.empno  AND "
								+ "T.empno = e1.empno "
								+ "and T.srno =(SELECT max(e2.srno)  FROM   emptran e2 WHERE  e2.empno = e1.empno) "
								+ "and T.PRJ_SRNO = p.SITE_ID and lp.TRNTYPE='credit' "
								+ "and lp.BASICMONTH between '"+fromdate+"' and '"+todate+"' "
								+ "ORDER BY T.PRJ_SRNO,e1.empcode";

										;

							}
					else if(type.equalsIgnoreCase("2") && transType.equalsIgnoreCase("2"))
					{
						Query1 = ""
								+ "select e1.EMPNO,e1.empcode,e1.salute,e1.fname,e1.MNAME,e1.LNAME,lp.TRNTYPE,lp.EMPNO,lp.TOTAL_DAYS,lp.total_amount, "
								+ "lp.PF_calamount,lp.STATUS,lp.CREATED_DATE,lp.BASICMONTH, "
								+ "T.PRJ_SRNO,p.site_name "
								+ "FROM  lwp_Amt_Payment lp, empmast e1,emptran T,Project_Sites p "
								+ "where   lp.empno =e1.empno  AND "
								+ "T.empno = e1.empno "
								+ "and T.srno =(SELECT max(e2.srno)  FROM   emptran e2 WHERE  e2.empno = e1.empno) "
								+ "and T.PRJ_SRNO = p.SITE_ID and lp.TRNTYPE='Debit' "
								+ "and lp.BASICMONTH between '"+fromdate+"' and '"+todate+"' "
								+ "ORDER BY T.PRJ_SRNO,e1.empcode";

					}
						System.out.println("Query1 is @@@ " +Query1);
						st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
						emp = st.executeQuery(Query1);	
						
						int tot_no_emp = 0;
						int cnt=0;
						float total_amt=0.0f;
						float br_total=0.0f;
						if(emp.next()){
							
							emp.previous();
							while(rspt0.next())
							{
								int srno1=1;
								emp.next();
								if(rspt0.getInt("BRANCH") == emp.getInt("prj_srno"))
						//		if(srno1==1 && tot_no_emp==0)
								{
									System.out.println("srno1:: ");
							para = new Paragraph(new Phrase("Employee's  List For Project Site :  "+rspt0.getString("SITE_NAME"),new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
							para.setAlignment(Element.ALIGN_CENTER);
							para.setSpacingAfter(5);
							doc.add(para);
								}emp.previous();
							//headtab.addCell(para);
							PdfPTable table1=new PdfPTable(7);
							table1.setSpacingBefore(10.0f);
							table1.setWidthPercentage(new float[]{6,8,32,11,11,16,16},new Rectangle(100,100));
							PdfPCell c1 = new PdfPCell(new Phrase("Srno",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));  
							table1.addCell(c1);
							PdfPCell c2 = new PdfPCell(new Phrase("Emp Code ",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
							table1.addCell(c2);
							PdfPCell c3 = new PdfPCell(new Phrase("Employee Name",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
							table1.addCell(c3); 
							PdfPCell c4 = new PdfPCell(new Phrase("LWP_Amt",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
							table1.addCell(c4); 
							PdfPCell c5 = new PdfPCell(new Phrase("Days",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
							table1.addCell(c5); 
							PdfPCell c6 = new PdfPCell(new Phrase("LWP_Month_For",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
							table1.addCell(c6); 
							PdfPCell c7 = new PdfPCell(new Phrase("LWP_Credit_Date",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
							table1.addCell(c7); 
							table1.setHeaderRows(1);
							
							//PdfPTable datatab;
							while(emp.next())
							{
								
								System.out.println("BRANCH===>"+rspt0.getInt("BRANCH")+"EMP BRANCH===>"+emp.getInt("PRJ_SRNO"));
								if(rspt0.getInt("BRANCH") == emp.getInt("PRJ_SRNO"))
								{
									
									PdfPCell c71 = new PdfPCell(new Phrase(""+srno1,new Font(Font.TIMES_ROMAN,8)));  
									table1.addCell(c71);
									
								PdfPCell c711 = new PdfPCell(new Phrase(""+emp.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8)));  
								table1.addCell(c711);
								PdfPCell c8 = new PdfPCell(new Phrase(""+lkhp.getLKP_Desc("SALUTE", emp.getInt("SALUTE"))+" "+emp.getString("fname")+" "+emp.getString("MNAME")+" "+emp.getString("LNAME"),new Font(Font.TIMES_ROMAN,8)));
								table1.addCell(c8);
								
								PdfPCell c9= new PdfPCell(new Phrase(""+emp.getString("total_amount"),new Font(Font.TIMES_ROMAN,8)));
								table1.addCell(c9);
								total_amt += Math.round(emp.getFloat("total_amount"));
								br_total  += Math.round(emp.getFloat("total_amount"));
								
								PdfPCell c10 = new PdfPCell(new Phrase(""+emp.getString("TOTAL_DAYS"),new Font(Font.TIMES_ROMAN,8)));
								table1.addCell(c10);
								
								
								
								PdfPCell c11= new PdfPCell(new Phrase(""+emp.getString("BASICMONTH"),new Font(Font.TIMES_ROMAN,8)));
								table1.addCell(c11);
								
								PdfPCell c12 = new PdfPCell(new Phrase(""+emp.getString("CREATED_DATE"),new Font(Font.TIMES_ROMAN,8)));
								table1.addCell(c12);
								tot_no_emp = tot_no_emp +1;
								srno1++;
								
								}
								else{
									emp.previous();
									break;
								}
								
								
								
							}
							PdfPTable table2=new PdfPTable(7);
							if(tot_no_emp>0){
							
							table2.setSpacingBefore(5.0f);
							table2.setWidthPercentage(new float[]{6,8,32,11,11,16,16},new Rectangle(100,100));
							PdfPCell tot = new PdfPCell(new Phrase("Total:",new Font(Font.TIMES_ROMAN,8)));
							tot.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tot.setColspan(3);
							table2.addCell(tot);
							PdfPCell tot1 = new PdfPCell(new Phrase(""+trans((int)(br_total), "", "", false, false),new Font(Font.TIMES_ROMAN,8)));
							tot1.setColspan(4);
							table2.addCell(tot1);
							
							}
							/*pretotincded1=0;
							pretotincded=0;
							totincded1=0;
							totincded=0;*/
							doc.add(table1);
							doc.add(table2);
							
							if(!rspt0.next()||!emp.next())
							{
								break;
							}
							else{
								tot_no_emp=0;
								br_total=0;
								rspt0.previous();
								emp.previous();
								continue;
							}
								 
						}//doc.add(headtab);
							
							
							para = new Paragraph(new Phrase("TOTAL SUMMERY :-",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
							para.setAlignment(Element.ALIGN_CENTER);
							para.setSpacingBefore(5);
							doc.add(para);
							
							
							
							PdfPTable headtab=new PdfPTable(2);
							headtab.setSpacingBefore(5.0f);
							headtab.setWidthPercentage(new float[]{50,50},new Rectangle(100,100));
							PdfPCell tot = new PdfPCell(new Phrase("Total LWP Amount:",new Font(Font.TIMES_ROMAN,8)));
							tot.setHorizontalAlignment(Element.ALIGN_RIGHT);
							//*tot.setColspan(3);
							headtab.addCell(tot);
							PdfPCell tot1 = new PdfPCell(new Phrase(""+trans((int)(total_amt), "", "", false, false),new Font(Font.TIMES_ROMAN,8)));
							headtab.addCell(tot1);
							doc.add(headtab);

						}
						else{
							System.out.println("no record found");
							para = new Paragraph(new Phrase("Record not found"+rspt0.getString("SITE_NAME"),new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
							para.setAlignment(Element.ALIGN_CENTER);
							para.setSpacingAfter(5);
							doc.add(para);
						}
						
							
				
					doc.close();
					Cn.close();
				}
				catch(Exception e) 
				{
					e.printStackTrace();
				}

			
			}
			public static void GroupInsuranceReport(String date, String table, String filePath, String imagepath){
				
				System.out.println("I am in table " + table);
				long millis=System.currentTimeMillis();  
				 java.sql.Date date1=new java.sql.Date(millis);  
				 System.out.println("date..."+date1);
				 DateFormat df = new SimpleDateFormat("yyyy-MM-dd");
				 String reportDate = df.format(date1);
				RepoartBean repBean  = new RepoartBean();
				try
				{
					Connection Cn = null;
					Statement st = null;
					ResultSet rs = null;

					ReportDAO.OpenCon("", "", "",repBean);
					Cn = repBean.getCn();
					
					int totalEmployee =0;
					String Query1 = "";
					
					LookupHandler lkhp = new LookupHandler();
					Rectangle rec = new  Rectangle(154,154);
					Document doc = new Document();
					PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filePath));
					
					UtilityDAO dao = new UtilityDAO();
					UtilityDAO.lable1="Date : ";
					Footer ftr = dao.new Footer(lable1);
					writer.setPageEvent(ftr);
					
					
					doc.open();
					doc.setPageSize(PageSize.A4);
					
					Font fbold = new Font(Font.TIMES_ROMAN,8,Font.BOLD);
					Font fsmall = new Font(Font.TIMES_ROMAN,7);
					Font FONT = new Font(Font.TIMES_ROMAN, 20, Font.NORMAL, new GrayColor(0.75f));
					Font  fontcolor = FontFactory.getFont(FontFactory.HELVETICA, 9, new Color(6, 8, 193));
					
					ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f,50f);
					image1.setAbsolutePosition(40f, 750f);
					doc.add(image1);
					doc.add(para);
					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Employees Group Insurance List " ,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);
					para = new Paragraph(new Phrase("Date:-" + reportDate,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);
					int srno = 1;
					int tot_GroupInsurance = 0;
						 Query1 = ""
								+ "select e.SALUTE,e.EMPCODE,rtrim(E.fname)+' '+rtrim(E.mname)+' '+rtrim(E.lname) as name,e.DOB, "
								+ "l.lkp_disc as DESIG,p.NET_AMT as AMT ,d.SANC_DATE,d.REPAY_START  "
								+ "from empmast e,EMPTRAN t,lookup l,"+table+"  p  ,DEDMAST d  "
								+ "where e.empno = t.empno "
								+ "and l.LKP_SRNO = t.DESIG   and l.LKP_CODE = 'DESIG' "
								+ "and t.srno=(select max(ee.srno) from emptran ee where ee.empno = e.empno) "
								+ "and e.EMPNO=p.EMPNO and p.TRNCD=207 and p.TRNDT ='"+ReportDAO.EOM(date)+"' "
								+ "and p.NET_AMT !=0  "
								+ "and e.EMPNO = d.EMPNO "
								+ " and d.TRNCD=207"
								+ "order by t.desig";
					
					st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
					rs = st.executeQuery(Query1);
					System.out.println("-----"+Query1);
					
					if(rs.next()){
					/*if(!rs.next()){
						System.out.println("Recordset EMpty");
					}*/
					PdfPTable main = new PdfPTable(8);
					main.setSpacingBefore(10);
					
					String str[] = new String[8];
					
					str[0]="SRNO";			str[1]="Empcode";			str[2]="EMP Name";
					str[3]="Desig";	str[4]="DOB";	str[5]="GI"; str[6]="Scheme DOJ";	str[7]="Scheme Change Date";			
					
					main.setWidthPercentage(new float[]{10,15,40,21,15,15,15,23f}, rec);
					main.setHorizontalAlignment(Element.ALIGN_CENTER);
					PdfPCell maincell ;	
					
					for(int i=0; i<str.length;i++ )
					{					
						maincell = new PdfPCell(new Phrase(str[i],fbold));
						maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
						main.addCell(maincell);
					}	
					doc.add(main);
					rs.beforeFirst();
					int cnt =0;
			//		if(rs.next()){
					while(rs.next())
					{
						
						PdfPTable main1 = new PdfPTable(8);
						main1.setWidthPercentage(new float[]{10,15,40,21,15,15,15,23f}, rec);
						main1.setHorizontalAlignment(Element.ALIGN_CENTER);	
						
						PdfPCell cell1 = new PdfPCell(new Phrase(""+srno,fsmall));  
						cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell1);
						
						PdfPCell cell2 = new PdfPCell(new Phrase((rs.getString("EMPCODE")),fsmall));	
						cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell2);
						
						PdfPCell cell3 = new PdfPCell(new Phrase(lkhp.getLKP_Desc("SALUTE", rs.getInt("SALUTE"))+" "+rs.getString("name"),fsmall));
						cell3.setHorizontalAlignment(Element.ALIGN_LEFT);
						main1.addCell(cell3);
						
						PdfPCell cell4 = new PdfPCell(new Phrase((rs.getString("DESIG")),fsmall));
						cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell4);
						
						PdfPCell cell5 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(rs.getDate("DOB")),fsmall));
						cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell5);
						
						PdfPCell cell6 = new PdfPCell(new Phrase((rs.getString("AMT")),fsmall));
						cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell6);
						tot_GroupInsurance+=rs.getInt("AMT");
						
						PdfPCell cell7 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(rs.getDate("SANC_DATE")),fsmall));
						cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell7);
						
						PdfPCell cell8 = new PdfPCell(new Phrase(""+EmpOffHandler.dateFormat(rs.getDate("repay_start")),fsmall));
						cell8.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell8);
						
						doc.add(main1);
						srno++;
						totalEmployee+=1;
						
					}		
					PdfPTable headtab=new PdfPTable(2);
					headtab.setSpacingBefore(0.0f);
					headtab.setWidthPercentage(new float[]{101,53},new Rectangle(154,154));
					PdfPCell tot = new PdfPCell(new Phrase("GI Total :",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					tot.setHorizontalAlignment(Element.ALIGN_RIGHT);
					//*tot.setColspan(3);
					headtab.addCell(tot);
					PdfPCell tot1 = new PdfPCell(new Phrase("     "+tot_GroupInsurance,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					headtab.addCell(tot1);
					doc.add(headtab);
					
					
				//	para = new Paragraph(new Phrase("No Of Employee :- "+totalEmployee+"                             GI Total :             "+tot_GroupInsurance,fbold));
					para = new Paragraph(new Phrase("No Of Employee :- "+totalEmployee,fbold));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(10);
					doc.add(para);			
				
	                  }else{
						System.out.println("no record found");
						para = new Paragraph(new Phrase("Record not found",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(5);
						doc.add(para);
					}
					doc.close();
					Cn.close();
				}
				catch(Exception e) 
				{
					e.printStackTrace();
				}

			}
			public static void LoanDeductionReport(String rdt,String filepath, String imagepath,String code,String table,String ptcode) 
			{
				System.out.println("LoanDeductionReport");
				RepoartBean repBean  = new RepoartBean();
				Connection Cn = null;
				ResultSet emp = null;
				ResultSet Desc=null;
				ResultSet Acno=null;
				String EmpSql = "";
				String codeDesc = "";
				String ACNO = "";
				ReportDAO.OpenCon("", "", "",repBean);
				Cn = repBean.getCn();
				Statement st=null;
				Statement st1=null;
					try {
					st = Cn.createStatement(
							ResultSet.TYPE_SCROLL_INSENSITIVE,
							ResultSet.CONCUR_READ_ONLY);
					st1 = Cn.createStatement(
							ResultSet.TYPE_SCROLL_INSENSITIVE,
							ResultSet.CONCUR_READ_ONLY);

					try
					{
						Document doc = new Document();
						PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
						doc.open();
						doc.setPageSize(PageSize.A4);

						Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));
						ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
						Image image1 = Image.getInstance(imagepath);
						Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
						Paragraph para = new Paragraph(title);
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingBefore(0);

						image1.scaleAbsolute(60f,50f);
						image1.setAbsolutePosition(40f, 750f);

						doc.add(image1);
						doc.add(para);

						para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(0);
						doc.add(para);

						para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(0);
						doc.add(para);

						para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(0);
						doc.add(para);
						

						if(table.equalsIgnoreCase("paytran")){
							para = new Paragraph(new Phrase("(Before Finalize Of Salary)",new Font(Font.TIMES_ROMAN,7)));
							para.setAlignment(Element.ALIGN_CENTER);
							para.setSpacingAfter(1);
							doc.add(para);
						}
						else{
								para = new Paragraph(new Phrase("(After Finalize Of Salary)",new Font(Font.TIMES_ROMAN,7)));
								para.setAlignment(Element.ALIGN_CENTER);
								para.setSpacingAfter(1);
								doc.add(para);
							}
						codeDesc ="select DISC from CDMAST where TRNCD="+code+"";
						Desc = st.executeQuery(codeDesc);
						String trncdDisc="";
						if(Desc.next()){
							trncdDisc = Desc.getString("DISC");
						}
						para = new Paragraph(new Phrase("List for :- "+trncdDisc,new Font(Font.TIMES_ROMAN,9)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(2);
						doc.add(para);
						para = new Paragraph(new Phrase("For Month :- "+ReportDAO.EOM(rdt),new Font(Font.TIMES_ROMAN,8)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(2);
						doc.add(para);
						
						Rectangle rec = new  Rectangle(60,100);
						Rectangle rec1 = new  Rectangle(50,100);
						PdfPTable table1=null;
						if((Integer.parseInt(code)==228) || (Integer.parseInt(code)==205) || (Integer.parseInt(code)==242))
						{
							table1=new PdfPTable(4);
							table1.setWidthPercentage(new float[]{5,8,20,12},new Rectangle(60,100));
						}
						else
						{
						table1=new PdfPTable(5);
						table1.setWidthPercentage(new float[]{5,8,20,15,12},new Rectangle(60,100));
					}
						table1.setSpacingBefore(10);
						PdfPCell cell11=new PdfPCell(new Phrase("SRNO",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
						cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
						table1.addCell(cell11);
						PdfPCell cell111=new PdfPCell(new Phrase("EMPCODE",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
						cell111.setHorizontalAlignment(Element.ALIGN_CENTER);
						table1.addCell(cell111);
						PdfPCell cell1111=new PdfPCell(new Phrase("EMPLOYEE NAME",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
						cell1111.setHorizontalAlignment(Element.ALIGN_LEFT);
						table1.addCell(cell1111);
						if((Integer.parseInt(code)!=228) && (Integer.parseInt(code)!=205) && (Integer.parseInt(code)!=242)){
							if((Integer.parseInt(code)!=206))
							{
								PdfPCell cell1111d=new PdfPCell(new Phrase("A/C NO",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
								cell1111d.setHorizontalAlignment(Element.ALIGN_CENTER);
								table1.addCell(cell1111d);
							}else {
								PdfPCell cell1111d=new PdfPCell(new Phrase("DESIG",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
								cell1111d.setHorizontalAlignment(Element.ALIGN_CENTER);
								table1.addCell(cell1111d);
							}
						
						}
						
						PdfPCell cell11111=new PdfPCell(new Phrase("NET AMOUNT",new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
						cell11111.setHorizontalAlignment(Element.ALIGN_CENTER);
						table1.addCell(cell11111);
							EmpSql=("with lastmonth as"+
										"(SELECT emp.empno,emp.EMPCODE,Rtrim(emp.lname) + ' '+Rtrim(emp.fname) + ' ' + Rtrim(emp.mname) AS name, "+ 
										"emp.salute,T.ACNO, p.net_amt  AS amt,l.LKP_DISC as DESIG FROM   empmast emp ,"+table+"  p,EMPTRAN t,LOOKUP l "+ 
										"WHERE     emp.empno = p.empno AND emp.EMPNO = t.EMPNO AND p.trncd = '"+code+"' " +
										"AND p.trndt BETWEEN '"+ReportDAO.BOM(rdt)+"' AND '"+ReportDAO.EOM(rdt)+"' and p.NET_AMT >0 AND t.SRNO = (SELECT MAX(SRNO) FROM EMPTRAN WHERE EMPNO = emp.EMPNO) AND l.LKP_SRNO=t.DESIG " + 
										" AND l.LKP_CODE='DESIG' )"+
										
										"SELECT l.*,etran.PRJ_SRNO "+ 
										" FROM   emptran etran , lastmonth  l "+ 
										"WHERE     etran.empno = l.empno AND  "+       
										"etran.srno=(select MAX(SRNO) from emptran where empno=etran.empno) "+
					//					"order by "+(code.equals("206")?"l.name":"etran.PRJ_SRNO,l.EMPCODE")+" ");
										"order by "+(code.equals("206")?"l.name":code.equals("228")?"l.name":"etran.PRJ_SRNO,l.EMPCODE")+" ");
						
						System.out.println(EmpSql);
						emp = st.executeQuery(EmpSql);
						int grandtot=0;
						LookupHandler lkhp = new LookupHandler();
						int tot_no_emp = 0;
						String EmpAc_no="";
						if(emp.next()){
								int srno=1;
								int amt_tot_br=0;
								int brwiseemp=0;
								PdfPTable table11=null;
								PdfPTable table12=null;
							//	table11=new PdfPTable(5);
							//	table11.setSpacingBefore(0);
						//		table11.setWidthPercentage(new float[]{5,8,20,15,12},new Rectangle(60,100));
								
								if((Integer.parseInt(code)==228) || (Integer.parseInt(code)==205) || (Integer.parseInt(code)==242))
								{
									table11=new PdfPTable(4);
									table11.setWidthPercentage(new float[]{5,8,20,12},new Rectangle(60,100));
								}
								else
								{
								table11=new PdfPTable(5);
								table11.setWidthPercentage(new float[]{5,8,20,15,12},new Rectangle(60,100));
							}
								
								emp.previous();	
							while(emp.next())
							{
								ACNO = "select AC_NO from DEDMAST where trncd="+code+" and EMPNO="+emp.getString("EMPNO")+" and ACTYN='Y'";
								Acno = st1.executeQuery(ACNO);
								if(Acno.next()){
									EmpAc_no = Acno.getString("AC_NO")==null?"0":Acno.getString("AC_NO");
								   }
									brwiseemp++;
									PdfPCell c6 = new PdfPCell(new Phrase(""+srno,new Font(Font.TIMES_ROMAN,8)));  
									c6.setHorizontalAlignment(Element.ALIGN_CENTER);
									table11.addCell(c6);
									
									PdfPCell c7 = new PdfPCell(new Phrase(""+emp.getString("EMPCODE"),new Font(Font.TIMES_ROMAN,8)));  
									c7.setHorizontalAlignment(Element.ALIGN_CENTER);
									table11.addCell(c7);
									PdfPCell C8=new PdfPCell(new Phrase(""+emp.getString("name"),new Font(Font.TIMES_ROMAN,8)));
									C8.setHorizontalAlignment(Element.ALIGN_LEFT);
									table11.addCell(C8);
									if((Integer.parseInt(code)!=228) && (Integer.parseInt(code)!=205) && (Integer.parseInt(code)!=242)){
										if((Integer.parseInt(code)!=206)){
											if(EmpAc_no == null || EmpAc_no.equals("") ){
												PdfPCell c7d = new PdfPCell(new Phrase(""+emp.getString("acno"),new Font(Font.TIMES_ROMAN,8)));  
												c7d.setHorizontalAlignment(Element.ALIGN_CENTER);
												table11.addCell(c7d);
												}else{
													PdfPCell c7d = new PdfPCell(new Phrase(""+EmpAc_no,new Font(Font.TIMES_ROMAN,8)));  
													c7d.setHorizontalAlignment(Element.ALIGN_CENTER);
													table11.addCell(c7d);
												}
										}else {

											PdfPCell c7d = new PdfPCell(new Phrase(""+emp.getString("DESIG"),new Font(Font.TIMES_ROMAN,8)));  
											c7d.setHorizontalAlignment(Element.ALIGN_CENTER);
											table11.addCell(c7d);
										
										}
									
										
										}
									/*PdfPCell c7d = new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8)));  
									c7d.setHorizontalAlignment(Element.ALIGN_CENTER);
									table11.addCell(c7d);*/
									
									amt_tot_br+=emp.getInt("amt");
									grandtot+=emp.getInt("amt");
									PdfPCell c9= new PdfPCell(new Phrase(""+emp.getString("amt"),new Font(Font.TIMES_ROMAN,8)));
									c9.setHorizontalAlignment(Element.ALIGN_CENTER);
									table11.addCell(c9);
									tot_no_emp = tot_no_emp +1;
									srno++;
									
							}
							doc.add(table1);
							doc.add(table11);
							para = new Paragraph(new Phrase("Total No Of Employee:-     "+tot_no_emp,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(10);
							doc.add(para);
							para = new Paragraph(new Phrase("Grand Total Amount :-     "+grandtot,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(1);
							doc.add(para);
							
					}
						else{
							System.out.println("no record found");
							para.setSpacingAfter(50);
							para = new Paragraph(new Phrase("Record Not found for the Month:-     "+rdt.substring(3),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
							para.setAlignment(Element.ALIGN_LEFT);
							doc.add(para);
						}
						doc.close();
						Cn.close();
						System.out.println("Completed");
					}
					catch(Exception e)
					{
						e.printStackTrace();
					}

				} catch (Exception e) {
					e.printStackTrace();
				} 
			}
			
			public static void BDVabove1500(String date, String table, String filePath, String imagepath){
				
				System.out.println("I am in table " + table);
				long millis=System.currentTimeMillis();  
				 java.sql.Date date1=new java.sql.Date(millis);  
				 System.out.println("date..."+date1);
				 DateFormat df = new SimpleDateFormat("yyyy-MM-dd");
				 String reportDate = df.format(date1);
				RepoartBean repBean  = new RepoartBean();
				try
				{
					Connection Cn = null;
					Statement st = null;
					ResultSet rs = null;

					ReportDAO.OpenCon("", "", "",repBean);
					Cn = repBean.getCn();
					
					int totalEmployee =0;
					String Query1 = "";
					
					LookupHandler lkhp = new LookupHandler();
					Rectangle rec = new  Rectangle(125,125);
					Document doc = new Document();
					PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filePath));
					
					UtilityDAO dao = new UtilityDAO();
					UtilityDAO.lable1="Date : ";
					Footer ftr = dao.new Footer(lable1);
					writer.setPageEvent(ftr);
					
					
					doc.open();
					doc.setPageSize(PageSize.A4);
					
					Font fbold = new Font(Font.TIMES_ROMAN,8,Font.BOLD);
					Font fsmall = new Font(Font.TIMES_ROMAN,7);
					Font FONT = new Font(Font.TIMES_ROMAN, 20, Font.NORMAL, new GrayColor(0.75f));
					Font  fontcolor = FontFactory.getFont(FontFactory.HELVETICA, 9, new Color(6, 8, 193));
					
					ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f,50f);
					image1.setAbsolutePosition(40f, 750f);
					doc.add(image1);
					doc.add(para);
					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Basic+DA+VDA Above 15000 (PF) List " ,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);
					para = new Paragraph(new Phrase("For Month:-" + ReportDAO.EOM(date),new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);
					int srno = 1;
					long tot1 = 0;
					long tot2 = 0;
						 Query1 = " WITH A AS(" + 
						 		" SELECT EMPNO,SUM(NET_AMT) AS net_amt FROM "+table+" P WHERE " + 
						 		" p.TRNDT BETWEEN '"+ReportDAO.BOM(date)+"' AND '"+ReportDAO.EOM(date)+"' " + 
						 		" AND P.TRNCD IN(select ONAMTCD from ONAMT where TRNCD=136 and ONAMTCD NOT IN(142)) GROUP BY EMPNO " + 
						 		" )"
								 + "SELECT emp.empno,emp.EMPCODE,Rtrim(l.LKP_DISC)+''+Rtrim(emp.fname) + ' '+Rtrim(emp.mname) + ' ' + Rtrim(emp.lname) AS name, "
								 + "emp.pfno,p.net_amt AS amt,p.net_amt-15000 as diff,ps.SITE_NAME "
								 + "FROM   empmast emp ,emptran t,A  p ,Project_Sites ps,lookup l "
								 + "WHERE     emp.empno = p.empno and emp.empno=t.empno "
								 + "AND p.NET_AMT>15000 "
								 + "and t.SRNO=(select MAX(SRNO) from EMPTRAN where empno=emp.EMPNO) and "
								 + "ps.SITE_ID=t.prj_srno and l.LKP_CODE='salute' and l.LKP_SRNO=emp.salute order by emp.EMPCODE";
								
					
					st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
					rs = st.executeQuery(Query1);
					System.out.println("-----"+Query1);
					
					if(rs.next()){
					/*if(!rs.next()){
						System.out.println("Recordset EMpty");
					}*/
					PdfPTable main = new PdfPTable(7);
					main.setSpacingBefore(10);
					
					String str[] = new String[7];
					
					str[0]="SRNO";			str[1]="EMPCODE";			str[2]="EMP NAME";
					str[3]="BRANCH NAME";	str[4]="PF NO";	str[5]="BASIC+DA+VDA"; str[6]="DIFF OF TOTAL";	
					
					main.setWidthPercentage(new float[]{8,12,40,26,15,17,17}, rec);
					main.setHorizontalAlignment(Element.ALIGN_CENTER);
					PdfPCell maincell ;	
					
					for(int i=0; i<str.length;i++ )
					{					
						maincell = new PdfPCell(new Phrase(str[i],fbold));
						maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
						main.addCell(maincell);
					}	
					doc.add(main);
					rs.beforeFirst();
					int cnt =0;
			//		if(rs.next()){
					while(rs.next())
					{
						
						PdfPTable main1 = new PdfPTable(7);
						main1.setWidthPercentage(new float[]{8,12,40,26,15,17,17}, rec);
						main1.setHorizontalAlignment(Element.ALIGN_CENTER);	
						
						PdfPCell cell1 = new PdfPCell(new Phrase(""+srno,fsmall));  
						cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell1);
						
						PdfPCell cell2 = new PdfPCell(new Phrase((rs.getString("EMPCODE")),fsmall));	
						cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell2);
						
						PdfPCell cell3 = new PdfPCell(new Phrase(""+rs.getString("name"),fsmall));
						cell3.setHorizontalAlignment(Element.ALIGN_LEFT);
						main1.addCell(cell3);
						
						PdfPCell cell4 = new PdfPCell(new Phrase((rs.getString("SITE_NAME")),fsmall));
						cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell4);
						
						PdfPCell cell5 = new PdfPCell(new Phrase(""+(rs.getString("pfno")),fsmall));
						cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell5);
						
						PdfPCell cell6 = new PdfPCell(new Phrase((rs.getString("amt")),fsmall));
						cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell6);
						tot1+=rs.getInt("amt");
						
						PdfPCell cell7 = new PdfPCell(new Phrase(""+(rs.getString("diff")),fsmall));
						cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell7);
						tot2+=rs.getInt("diff");
						
						
						doc.add(main1);
						srno++;
						totalEmployee+=1;
						
					}		
					PdfPTable headtab=new PdfPTable(7);
					headtab.setSpacingBefore(0.0f);
					headtab.setWidthPercentage(new float[]{8,12,40,26,15,17,17},new Rectangle(125,125));
					PdfPCell tot = new PdfPCell(new Phrase("Total Employee : "+totalEmployee,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					tot.setHorizontalAlignment(Element.ALIGN_LEFT);
					tot.setColspan(5);
					headtab.addCell(tot);
					PdfPCell tot11 = new PdfPCell(new Phrase("     "+tot1+".00",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					headtab.addCell(tot11);
					PdfPCell tot12 = new PdfPCell(new Phrase("     "+tot2+".00",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					headtab.addCell(tot12);
					doc.add(headtab);
					
					
				//	para = new Paragraph(new Phrase("No Of Employee :- "+totalEmployee+"                             GI Total :             "+tot_GroupInsurance,fbold));
					/*para = new Paragraph(new Phrase("No Of Employee :- "+totalEmployee,fbold));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(10);
					doc.add(para);*/			
				
	                  }else{
						System.out.println("no record found");
						para = new Paragraph(new Phrase("Record not found",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(5);
						doc.add(para);
					}
					doc.close();
					Cn.close();
				}
				catch(Exception e) 
				{
					e.printStackTrace();
				}

			}
			// Tentative Leave encashment List..
			public static void TentativeLeaveencashmentList(String date,String filePath,String imagepath){
				
				System.out.println("I am in table " + date);
				long millis=System.currentTimeMillis();  
				 java.sql.Date date7=new java.sql.Date(millis);  
				 System.out.println("date..."+date7);
				 int year = Calendar.getInstance().get(Calendar.YEAR);
				 java.sql.Date dates=new java.sql.Date(year);  
				SimpleDateFormat format = new SimpleDateFormat("yyyy-MMMM-dd");
				Date startdt = null,enddt= null,middt= null;
//---------------------------------------------------------------------------------------------------				
				int Year= Integer.parseInt(date);
				Year=Year+1;
				String Nextyear=Integer.toString(Year);
				String adate = date+"-01-01";
				String bdate = date+"-12-31";
				String cdate = date+"-03-31";
				String ndate = Nextyear+"-01-01";
				String mdate = Nextyear+"-12-31";
				
				System.out.println("adate:  "+adate);
				System.out.println("Year:  "+Year);
				RepoartBean repBean  = new RepoartBean();
				try
				{
					Connection Cn = null;
					Statement st = null;
					ResultSet rs = null;

					ReportDAO.OpenCon("", "", "",repBean);
					Cn = repBean.getCn();
					
					int totalEmployee =0;
					String Query1 = "";
					
					LookupHandler lkhp = new LookupHandler();
					Rectangle rec = new  Rectangle(137,137);
					Document doc = new Document();
					PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filePath));
					
					UtilityDAO dao = new UtilityDAO();
					UtilityDAO.lable1="Date : ";
					Footer ftr = dao.new Footer(lable1);
					writer.setPageEvent(ftr);
					
					
					doc.open();
					doc.setPageSize(PageSize.A4);
					
					Font fbold = new Font(Font.TIMES_ROMAN,8,Font.BOLD);
					Font fsmall = new Font(Font.TIMES_ROMAN,7);
					Font FONT = new Font(Font.TIMES_ROMAN, 20, Font.NORMAL, new GrayColor(0.75f));
					Font  fontcolor = FontFactory.getFont(FontFactory.HELVETICA, 9, new Color(6, 8, 193));
					
					ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f,50f);
					image1.setAbsolutePosition(40f, 750f);
					doc.add(image1);
					doc.add(para);
					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Next Year Leave Encash tentative List " ,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);
//					para = new Paragraph(new Phrase("For Month:-" + ReportDAO.EOM(date),new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
//					para.setAlignment(Element.ALIGN_CENTER);
//					para.setSpacingAfter(0);
				//	doc.add(para);
					int srno = 1;
					double tot1 = 0;
					double grosstot = 0;
					double basictot = 0;
					double basictot1 = 0;
					double pftot1 = 0;
					double datot = 0;
					double vdatot = 0;
					double pftot = 0;
					double netpaytot = 0;
					double netpaytot1 = 0;
					int tdays=0;
					int tnetpay=0;
					int netpay=0;
					 Query1 = ""
							 + "with a as ( "
							 + " "
							 + " SELECT E.EMPNO, "
							 + "       E.EMPCODE, "
							 + "       CONVERT(NVARCHAR(100), E.lname + ' ' + E.fname + ' ' + E.mname) AS NAME, "
							 + "       "
							 + "       (select top 1 case when (((l.bal+30)-90)- "
							 + "       (SELECT Isnull( case when Sum(days)>=25 then Round((Sum(days)/12),0) else 0 end, 0) AS usedleave "
							 + "					FROM   leavetran "
							 + "					WHERE  empno = E.empno "
							 + "					AND TRNDATE between '"+adate+"' and '"+bdate+"' "
							 + "					AND leavecd = 7 "
							 + "					AND status = 'SANCTION' "
							 + "					AND trntype = 'D' ))<0 then 0 "
							 + "					 "
							 + "		else ((((l.bal+30)-90)- "
							 + "       (SELECT Isnull( case when Sum(days)>=25 then round((Sum(days)/12),0) else 0 end, 0) AS usedleave "
							 + "					FROM   leavetran "
							 + "					WHERE  empno = E.empno "
							 + "					AND TRNDATE between '"+adate+"' and '"+bdate+"' "
							 + "					AND leavecd = 7 "
							 + "					AND status = 'SANCTION' "
							 + "					AND trntype = 'D' ))) end as Encash_Days from leavebal l where l.empno=E.empno and l.leavecd=1 order by baldt desc,srno desc) as Encash_Days "
							 + "       ,(select inp_amt from PAYTRAN_STAGE where EMPNO=E.EMPNO and TRNCD=101 and TRNDT='"+cdate+"') as BASIC "
							 + "       ,(select inp_amt from PAYTRAN_STAGE where EMPNO=E.EMPNO and TRNCD=102 and TRNDT='"+cdate+"') as DA "
							 + "       ,(select inp_amt from PAYTRAN_STAGE where EMPNO=E.EMPNO and TRNCD=138 and TRNDT='"+cdate+"') as VDA "
							 + "        "
							 + " "
							 + "    "
							 + "FROM   empmast E, "
							 + "       "
							 + "       emptran t "
							 + "       "
							 + "WHERE  E.empno = t.empno "
							 + "       "
							 + "       "
							 + "       AND t.srno = (SELECT Max(srno) "
							 + "                     FROM   emptran T1 "
							 + "                     WHERE  T1.empno = t.empno) "
							 + "      "
							 + "      and (( E.STATUS='A' AND E.DOJ <= '"+mdate+"') or (E.STATUS ='N' And  E.DOL>='"+ndate+"' )) "
							 + "  "
							 + " ) "
							 + " select *,round(convert(numeric(12,2),(((a.BASIC+a.DA+a.VDA)/30)*a.Encash_Days)),2) as TOTAL_AMT, "
							 + " round(convert(numeric(12,2),(((((((a.BASIC+a.DA+a.VDA)/30)*a.Encash_Days))/100)*12))),2) as PF_AMT, "
							 + " round(convert(numeric(12,2),((((a.BASIC+a.DA+a.VDA)/30)*a.Encash_Days)-((((((a.BASIC+a.DA+a.VDA)/30)*a.Encash_Days)/100)*12)))),2) AS NET_PAY "
							 + " from a  ORDER  BY a.empcode";
								
					
					st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
					rs = st.executeQuery(Query1);
					System.out.println("-----"+Query1);
					
					if(rs.next()){
					/*if(!rs.next()){
						System.out.println("Recordset EMpty");
					}*/
					PdfPTable main = new PdfPTable(10);
					main.setSpacingBefore(10);
					
					String str[] = new String[10];
					
					str[0]="SRNO";			str[1]="EMPCODE";			str[2]="NAME";
					str[3]="DAYS";	str[4]="BASIC";	str[5]="DA"; str[6]="VDA"; str[7]="Total"; str[8]="PF";
					str[9]="Net Pay";//str[10]="Status";
					
					main.setWidthPercentage(new float[]{8,8,37,11,11,11,11,14,12,14}, rec);
					main.setHorizontalAlignment(Element.ALIGN_CENTER);
					PdfPCell maincell ;	
					
					for(int i=0; i<str.length;i++ )
					{					
						maincell = new PdfPCell(new Phrase(str[i],fbold));
						maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
						main.addCell(maincell);
					}	
					doc.add(main);
					rs.beforeFirst();
					int cnt =0;
			//		if(rs.next()){
					PdfPTable main1 = new PdfPTable(10);
					while(rs.next())
					{
						
					//	PdfPTable main1 = new PdfPTable(10);
						main1.setWidthPercentage(new float[]{8,8,37,11,11,11,11,14,12,14}, rec);
						main1.setHorizontalAlignment(Element.ALIGN_CENTER);	
						
						PdfPCell cell1 = new PdfPCell(new Phrase(""+srno,fsmall));  
						cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell1);
						
						PdfPCell cell2 = new PdfPCell(new Phrase((rs.getString("EMPCODE")),fsmall));	
						cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell2);
						
						PdfPCell cell3 = new PdfPCell(new Phrase(""+rs.getString("name"),fsmall));
						cell3.setHorizontalAlignment(Element.ALIGN_LEFT);
						main1.addCell(cell3);
						
						PdfPCell cell4 = new PdfPCell(new Phrase((rs.getString("Encash_Days")),fsmall));
						cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell4);
						if(rs.getInt("Encash_Days") == 0){
							tdays++;
						}
						
						PdfPCell cell5 = new PdfPCell(new Phrase(""+(rs.getString("basic")==null?"":rs.getString("basic")),fsmall));
						cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell5);
						basictot=basictot+rs.getDouble("basic");
						
						PdfPCell cell6 = new PdfPCell(new Phrase((rs.getString("da")==null?"":rs.getString("da")),fsmall));
						cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell6);
						datot=datot+rs.getDouble("da");
						
						PdfPCell cell7 = new PdfPCell(new Phrase(""+(rs.getString("vda")==null?"":rs.getString("vda")),fsmall));
						cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell7);
						vdatot=vdatot+rs.getDouble("vda");
						
						PdfPCell cell8 = new PdfPCell(new Phrase(""+(rs.getString("TOTAL_AMT")==null?"":rs.getString("TOTAL_AMT")),fsmall));
						cell8.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell8);
						tot1=tot1+rs.getDouble("TOTAL_AMT");
						
						PdfPCell cell9 = new PdfPCell(new Phrase(""+(rs.getString("PF_AMT")==null?"":rs.getString("PF_AMT")),fsmall));
						cell9.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell9);
						pftot=pftot+rs.getDouble("PF_AMT");
						PdfPCell cell10 = new PdfPCell(new Phrase(""+(rs.getString("NET_PAY")==null?"":rs.getString("NET_PAY")),fsmall));
						cell10.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell10);
						netpaytot=netpaytot+rs.getDouble("NET_PAY");
						if(rs.getInt("NET_PAY") == 0){
							tnetpay++;
						}
						if(rs.getInt("NET_PAY") > 0){
							netpay++;
						}
			//			doc.add(main1);
						srno++;
						totalEmployee+=1;
					}	
					
					PdfPCell t = new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					t.setHorizontalAlignment(Element.ALIGN_CENTER);
					main1.addCell(t);
					PdfPCell t1 = new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					t1.setHorizontalAlignment(Element.ALIGN_CENTER);
					main1.addCell(t1);
					PdfPCell totemp = new PdfPCell(new Phrase("Total :",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					totemp.setHorizontalAlignment(Element.ALIGN_CENTER);
					main1.addCell(totemp);
					PdfPCell t11 = new PdfPCell(new Phrase("",new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					t11.setHorizontalAlignment(Element.ALIGN_CENTER);
					main1.addCell(t11);
					PdfPCell totempdisp = new PdfPCell(new Phrase(""+Math.round(basictot),new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					totemp.setHorizontalAlignment(Element.ALIGN_LEFT);
					main1.addCell(totempdisp);
					PdfPCell total=new PdfPCell(new Phrase(""+Math.round(datot),new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					total.setHorizontalAlignment(Element.ALIGN_CENTER);
					main1.addCell(total);
					PdfPCell totaldata=new PdfPCell(new Phrase(""+Math.round(vdatot),new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					totaldata.setHorizontalAlignment(Element.ALIGN_CENTER);
					main1.addCell(totaldata);
					doc.add(main1);	
					PdfPCell t12 = new PdfPCell(new Phrase(""+Math.round(tot1),new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					t12.setHorizontalAlignment(Element.ALIGN_CENTER);
					main1.addCell(t12);
					PdfPCell totaldata1=new PdfPCell(new Phrase(""+Math.round(pftot),new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					totaldata1.setHorizontalAlignment(Element.ALIGN_CENTER);
					main1.addCell(totaldata1);
					doc.add(main1);
					PdfPCell totaldata11=new PdfPCell(new Phrase(""+Math.round(netpaytot),new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					totaldata11.setHorizontalAlignment(Element.ALIGN_CENTER);
					main1.addCell(totaldata11);
					doc.add(main1);
					
					PdfPTable tab1 = new PdfPTable(2);
					tab1.setWidthPercentage(new float[]{50,50}, new Rectangle(100, 100));
					tab1.setSpacingBefore(5);
					tab1.addCell(new Phrase("Summary :    "));
					tab1.addCell(new Phrase("     ",fsmall));
					
					PdfPCell cell2 = new PdfPCell(new Phrase("Encash Day Zero of Total Employee :     "+tdays,new Font(Font.TIMES_ROMAN,7,Font.BOLD)));  
					cell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(cell2);
					
					PdfPCell cell3 = new PdfPCell(new Phrase("Net Pay Zero of Total Employee :    "+tdays,new Font(Font.TIMES_ROMAN,7,Font.BOLD)));  
					cell3.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(cell3);
					
					PdfPCell cell1 = new PdfPCell(new Phrase("Total Encashment Employee :  "+netpay,new Font(Font.TIMES_ROMAN,7,Font.BOLD)));  
					cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(cell1);
					
					PdfPCell cell11 = new PdfPCell(new Phrase("Total PF Amount :  "+Math.round(pftot),new Font(Font.TIMES_ROMAN,7,Font.BOLD)));  
					cell11.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(cell11);
					
					PdfPCell cell4 = new PdfPCell(new Phrase("Total Amount :    "+Math.round(tot1),new Font(Font.TIMES_ROMAN,7,Font.BOLD)));  
					cell4.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(cell4);
					
					PdfPCell cell5 = new PdfPCell(new Phrase("Net Amount :    "+Math.round(netpaytot),new Font(Font.TIMES_ROMAN,7,Font.BOLD)));  
					cell5.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(cell5);
					
				//	tab1.addCell(new Phrase("Total Encashment Employee's :    "+netpay,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					/*PdfPCell totp=new PdfPCell(new Phrase("Total Encashment Employee :    "+netpay,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					totp.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab1.addCell(totp);*/
					
					doc.add(tab1);
					para = new Paragraph(new Phrase("Total Employee : "+totalEmployee,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(10);
					doc.add(para);
					System.out.println("diff: "+(totalEmployee-tdays));
					
					/*para = new Paragraph(new Phrase("Encash Zero Day's of Total Employee's : "+tdays,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(10);
					doc.add(para);
					para = new Paragraph(new Phrase("Net Pay Zero of Total Employee's : "+tnetpay,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(10);
					doc.add(para);*/
					
					 }else{
						System.out.println("no record found");
						para = new Paragraph(new Phrase("Record not found",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(5);
						doc.add(para);
					}
					doc.close();
					Cn.close();
				}
				catch(Exception e) 
				{
					e.printStackTrace();
				}

			}
			// Employee retiring list....
public static void EmployeeRetiringList(String fdate, String tdate,String Branch,String Desig,String LeftRepType, String filePath, String imagepath){
				
				System.out.println("I am in EmployeeRetiringList " );
				long millis=System.currentTimeMillis();  
				 java.sql.Date date1=new java.sql.Date(millis);  
				 System.out.println("date..."+date1);
				 DateFormat df = new SimpleDateFormat("yyyy-MM-dd");
				 String reportDate = df.format(date1);
				RepoartBean repBean  = new RepoartBean();
				try
				{
					Connection Cn = null;
					Statement st = null;
					ResultSet rs = null;

					ReportDAO.OpenCon("", "", "",repBean);
					Cn = repBean.getCn();
					
					int totalEmployee =0;
					String Query1 = "";
					
					LookupHandler lkhp = new LookupHandler();
					Rectangle rec = new  Rectangle(202,202);
					Document doc = new Document();
					PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filePath));
					
					UtilityDAO dao = new UtilityDAO();
					UtilityDAO.lable1="Date : ";
					Footer ftr = dao.new Footer(lable1);
					writer.setPageEvent(ftr);
					
					
					doc.open();
					doc.setPageSize(PageSize.A4);
					
					Font fbold = new Font(Font.TIMES_ROMAN,8,Font.BOLD);
					Font fsmall = new Font(Font.TIMES_ROMAN,7);
					Font FONT = new Font(Font.TIMES_ROMAN, 20, Font.NORMAL, new GrayColor(0.75f));
					Font  fontcolor = FontFactory.getFont(FontFactory.HELVETICA, 9, new Color(6, 8, 193));
					
					ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER, new Phrase("Business Bank",FONT), 297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f,50f);
					image1.setAbsolutePosition(40f, 750f);
					doc.add(image1);
					doc.add(para);
					para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Email :",new Font(Font.TIMES_ROMAN,8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase("Employee Retiring List " ,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);
					
					String constant="";
					if(LeftRepType.equals("1")){
						constant =" and e1.prj_srno="+Branch;
					}else if(LeftRepType.equals("2")){
						constant =" and e1.DESIG="+Desig;
					}else if(LeftRepType.equals("0")){
						constant =" ";
					}
					
					int srno = 1;
						 Query1 =  ""
								 + "SELECT e.empno, "
								 + "       e.empcode,e.DOB,e.DOJ, "
								 + "       Rtrim(e.fname) + ' ' + Rtrim(e.mname) + ' ' "
								 + "       + Rtrim(e.lname)                       AS NAME, "
								 + "       e.status, "
								 + "       e.retirementdate, "
								 + "       (SELECT lkp_disc "
								 + "        FROM   lookup "
								 + "        WHERE  lkp_code = 'CASTE' "
								 + "               AND lkp_srno = e.castcd)       AS caste, "
								 + "       (SELECT lkp_disc "
								 + "        FROM   lookup "
								 + "        WHERE  lkp_code = 'CATE' "
								 + "               AND lkp_srno = e.categorycd)   AS CATE, "
								 + "       (SELECT lkp_disc "
								 + "        FROM   lookup "
								 + "        WHERE  lkp_code = 'DESIG' "
								 + "               AND lkp_srno = e1.desig)       AS DESIG, "
								 + "       p.site_name, "
								 + "	   e.retirementdate "
								 + "FROM   empmast e, "
								 + "       emptran e1, "
								 + "       project_sites p "
								 + "     "
								 + "WHERE  e.empno = e1.empno "
								 + "       AND e1.srno = (SELECT Max(srno) "
								 + "                      FROM   emptran "
								 + "                      WHERE  empno = e.empno) "
								 + "       AND p.site_id = e1.prj_srno "
								 + "       AND e.retirementdate BETWEEN '"+fdate+"' AND '"+tdate+"' and e.STATUS='A'"
								 + "  "+constant+" "
								 + "ORDER  BY e.retirementdate";
	//					}	
						 System.out.println("-----"+Query1);
					st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
					rs = st.executeQuery(Query1);
					
					
					if(rs.next()){
					/*if(!rs.next()){
						System.out.println("Recordset EMpty");
					}*/
					PdfPTable main = new PdfPTable(11);
					main.setSpacingBefore(10);
					
					String str[] = new String[11];
					
					str[0]="Srno";			str[1]="Empcode";			str[2]="Emp Name";
					str[3]="Branch Name";	str[4]="Desig";	str[5]="Status"; str[6]="Dob";
					str[7]="Doj";	str[8]="Retire Date";	str[9]="Category"; str[10]="Caste";
					
					main.setWidthPercentage(new float[]{11,14,38,26,18,11,15,15,18,18,18}, rec);
					main.setHorizontalAlignment(Element.ALIGN_CENTER);
					PdfPCell maincell ;	
					
					for(int i=0; i<str.length;i++ )
					{					
						maincell = new PdfPCell(new Phrase(str[i],fbold));
						maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
						main.addCell(maincell);
					}	
					doc.add(main);
					rs.beforeFirst();
					int cnt =0;
					
			//		if(rs.next()){
					while(rs.next())
					{
						PdfPTable main1 = new PdfPTable(11);
						main1.setWidthPercentage(new float[]{11,14,38,26,18,11,15,15,18,18,18}, rec);
						main1.setHorizontalAlignment(Element.ALIGN_CENTER);	
						
						PdfPCell cell1 = new PdfPCell(new Phrase(""+srno,fsmall));  
						cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell1);
						
						PdfPCell cell2 = new PdfPCell(new Phrase((rs.getString("EMPCODE")),fsmall));	
						cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell2);
						
						PdfPCell cell3 = new PdfPCell(new Phrase(""+rs.getString("name"),fsmall));
						cell3.setHorizontalAlignment(Element.ALIGN_LEFT);
						main1.addCell(cell3);
						
						PdfPCell cell4 = new PdfPCell(new Phrase((rs.getString("SITE_NAME")),fsmall));
						cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell4);
						
						PdfPCell cell5 = new PdfPCell(new Phrase(""+(rs.getString("DESIG")),fsmall));
						cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell5);
						
						PdfPCell cell6 = new PdfPCell(new Phrase((rs.getString("status")),fsmall));
						cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell6);
						
						PdfPCell cell7 = new PdfPCell(new Phrase(""+(rs.getString("DOB")),fsmall));
						cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell7);
						PdfPCell cell71 = new PdfPCell(new Phrase(""+(rs.getString("DOJ")),fsmall));
						cell71.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell71);
						PdfPCell cell61 = new PdfPCell(new Phrase((rs.getString("retirementdate")),fsmall));
						cell61.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell61);
						PdfPCell cell51 = new PdfPCell(new Phrase(""+(rs.getString("cate")),fsmall));
						cell51.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell51);
						PdfPCell cell41 = new PdfPCell(new Phrase((rs.getString("caste")),fsmall));
						cell41.setHorizontalAlignment(Element.ALIGN_CENTER);
						main1.addCell(cell41);
						
						doc.add(main1);
						srno++;
						totalEmployee+=1;
						
					}		
					para = new Paragraph(new Phrase("Total Employee : "+totalEmployee,new Font(Font.TIMES_ROMAN,8,Font.BOLD)));  
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(10);
					doc.add(para);
	                  }else{
						System.out.println("no record found");
						para = new Paragraph(new Phrase("Record not found",new Font(Font.TIMES_ROMAN,9,Font.BOLD)));
						para.setAlignment(Element.ALIGN_CENTER);
						para.setSpacingAfter(5);
						doc.add(para);
					}
					doc.close();
					Cn.close();
				}
				catch(Exception e) 
				{
					e.printStackTrace();
				}

			}

	//public static void newpayregwithNewFormat(String PAYREGDT, String imgpath, String filepath, String type, String reptype)
	//public static void newpayregwithNewFormat(String PAYREGDT, String imgpath, String filepath, String type, String reptype, String emptype)
	public static void newpayregwithNewFormat(String PAYREGDT, String imgpath, String filepath, String type, String reptype, String emptype, String branchCode)
	{
		System.out.println("Hi newpayregwithNewFormat");
		
		String hname = "";
		Properties prop = new Properties();
		try {
			ClassLoader classLoader = Thread.currentThread().getContextClassLoader();
			InputStream stream = classLoader.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {
			System.out.println("Error in constant Properties " + e);
		}

		if (reptype.equalsIgnoreCase("paytran")) {
			hname = "Pre-Finalize";
		} else if (reptype.equalsIgnoreCase("paytran_stage")) {
			hname = "Finalize";
		} else {
			hname = "Release";
		}
		System.out.println("in new pay regdao..........aniket");
		System.out.println("in new pay regdao");
		System.out.println("type selected...." + type);
		RepoartBean repBean = new RepoartBean();
		UtilityDAO dao = new UtilityDAO();
		Connection con = null;
		String BomDt = "";
		String EomDt = "";
		int lastdat = 0;

		String table_name = null;

		lastdat = (int) Calculate.getDays(PAYREGDT);

		BomDt = ReportDAO.BOM(PAYREGDT);
		EomDt = ReportDAO.EOM(PAYREGDT);

		String temp = PAYREGDT.substring(2);
		ResultSet emp = null;
		String EmpSql = "";
		String pBrcd1 = "";
		int tot_no_emp = 0;
		int br_tot_no_emp = 0;
		float totmthsal1 = 0.0f;
		float totearning1 = 0.0f;
		float totearning2 = 0.0f;
		float totactualpay = 0.0f;
		float totmobded = 0.0f;
		float totadvanc = 0.0f;
		float totloan = 0.0f;
		float tottds = 0.0f;

		try {
			if (type.equalsIgnoreCase("G")) {
				ReportDAO.OpenCon("", "", "", repBean);
				con = repBean.getCn();
				Statement st = con.createStatement();

				Document doc = new Document(new Rectangle(900, 500));

				PdfWriter writer = PdfWriter.getInstance(doc, new FileOutputStream(filepath));
				Footer ftr = dao.new Footer(lable1);
				writer.setPageEvent(ftr);
				doc.open();

				Font FONT = new Font(Font.HELVETICA, 30, Font.NORMAL, new GrayColor(0.75f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER,
						new Phrase(prop.getProperty("watermark"), FONT), 450f, 230, 45);

				Image image1 = Image.getInstance(imgpath);

				Phrase title = new Phrase(prop.getProperty("companyName"), new Font(FONT.TIMES_ROMAN, 8, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);

				image1.scaleAbsolute(90f, 50f);
				image1.setAbsolutePosition(50f, 405f);

				doc.add(image1);
				doc.add(para);

				para = new Paragraph(new Phrase(prop.getProperty("addressForReport"), new Font(Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(prop.getProperty("contactForReport"), new Font(Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(prop.getProperty("mailForReport"), new Font(Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);

				Font f = new Font(Font.HELVETICA, 8);
				Font f1 = new Font(Font.HELVETICA, 7);

				para = new Paragraph(
						new Phrase("Salary Sheet For The Month Of :- " + temp, new Font(Font.TIMES_ROMAN, 10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);

				Rectangle rec = new Rectangle(650, 100);

				PdfPTable main = new PdfPTable(11);
				main.setSpacingBefore(10);
				// main.setWidthPercentage(new
				// float[]{35,57,40,30,23,20,25,25,25,30,25,20,20,30,30,30,30,170},
				// rec);
				main.setWidthPercentage(new float[] { 30, 99, 59, 59, 59, 59, 59, 59, 49, 49, 60 }, rec);
				PdfPCell maincell;

				maincell = new PdfPCell(new Phrase("Emp code", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Emp Name", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("C.T.C", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("L.O.P Days", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Earning 1", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Earning 2", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Mobile Deduction", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Advance Given", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Loan", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("TDS", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("NET PAY", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				main.setHeaderRows(1);

				// EmpSql =
				// "select distinct p.empno,e.empcode from "+table_name+" p
				// right join EMPMAST e on e.EMPNO = p.EMPNO where TRNDT BETWEEN
				// '"
				// + BomDt + "' AND '" + EomDt + "' order by p.EMPNO";
				EmpSql = "select distinct p.empno,CONVERT(INT, e.empcode) as empcode,t.PRJ_SRNO,t.PRJ_CODE from paytran p right join EMPMAST e on e.EMPNO = p.EMPNO join EMPTRAN t on p.EMPNO = t.EMPNO where TRNDT BETWEEN '"
						+ BomDt + "' AND '" + EomDt + "' and e.STATUS = 'A'"
						+ "and T.EFFDATE = (SELECT E2.EFFDATE FROM EMPTRAN E2 WHERE E2.EMPNO = e.EMPNO AND E2.EFFDATE <= '"
						+ ReportDAO.EOM(PAYREGDT)
						+ "' and E2.srno=(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e.EMPNO AND E2.EFFDATE <= '"
						+ ReportDAO.EOM(PAYREGDT) + "')) order by t.PRJ_CODE,empcode";
				System.out.println(EmpSql);
				emp = st.executeQuery(EmpSql);

				List<Integer> results = new ArrayList<Integer>();

				while (emp.next()) {

					results.add(emp.getInt("empno"));
					// System.out.println(emp.getInt("empno"));
				}

				for (int empp : results) {

					EmpSql = "select empmast.EMPCODE ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as  name, doj,t.PRJ_CODE,t.PRJ_SRNO, "
							+ "(select inp_AMT from  paytran  where trncd = 199 and TRNDT BETWEEN '" + BomDt + "'and '"
							+ EomDt + "' and empno=" + empp + ") ctc, "
							+ "(select cal_amt from  paytran  where trncd = 301 and TRNDT BETWEEN '" + BomDt + "'and '"
							+ EomDt + "' and empno=" + empp + ") abs_cnt,"
							+ "(select net_amt as earning1 from  paytran  where trncd = 130 and TRNDT BETWEEN '" + BomDt
							+ "'and '" + EomDt + "' and empno=" + empp + ") earning1,"
							+ "(select net_amt as earning2 from  paytran  where trncd = 131 and TRNDT BETWEEN '" + BomDt
							+ "'and '" + EomDt + "' and empno=" + empp + ")earning2,"
							+ "(select net_amt as mobded from  paytran  where trncd = 223 and TRNDT BETWEEN '" + BomDt
							+ "'and '" + EomDt + "' and empno=" + empp + ")mobded,"
							+ "(select net_amt as added from  paytran  where trncd = 225 and TRNDT BETWEEN '" + BomDt
							+ "'and '" + EomDt + "' and empno=" + empp + ")added,"
							+ "(select net_amt as loan from  paytran  where trncd = 227 and TRNDT BETWEEN '" + BomDt
							+ "'and '" + EomDt + "' and empno=" + empp + ")loan,"
							+ "(select net_amt as tds from  paytran  where trncd = 228 and TRNDT BETWEEN '" + BomDt
							+ "'and '" + EomDt + "' and empno=" + empp + ")tds,"
							+ "(select net_amt as payable from  paytran  where trncd = 999 and TRNDT BETWEEN '" + BomDt
							+ "'and '" + EomDt + "' and empno=" + empp + ")payable "
							+ "from empmast,EMPTRAN t,paytran p1  where empmast.empno=" + empp + " and t.empno = "
							+ empp + "  and p1.trndt  BETWEEN '" + BomDt + "'and '" + EomDt + "' and p1.empno=" + empp
							+ " " + "  UNION  "
							+ "select empmast.EMPCODE ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as  name, doj,t.PRJ_CODE,t.PRJ_SRNO, "
							+ "(select inp_AMT from   paytran_stage   where trncd = 199 and TRNDT BETWEEN '" + BomDt
							+ "'and '" + EomDt + "' and empno=" + empp + ") ctc, "
							+ "(select cal_amt from   paytran_stage   where trncd = 301 and TRNDT BETWEEN '" + BomDt
							+ "'and '" + EomDt + "' and empno=" + empp + ") abs_cnt,"
							+ "(select net_amt as earning1 from   paytran_stage   where trncd = 130 and TRNDT BETWEEN '"
							+ BomDt + "'and '" + EomDt + "' and empno=" + empp + ") earning1,"
							+ "(select net_amt as earning2 from   paytran_stage   where trncd = 131 and TRNDT BETWEEN '"
							+ BomDt + "'and '" + EomDt + "' and empno=" + empp + ")earning2,"
							+ "(select net_amt as mobded from   paytran_stage   where trncd = 223 and TRNDT BETWEEN '"
							+ BomDt + "'and '" + EomDt + "' and empno=" + empp + ")mobded,"
							+ "(select net_amt as added from   paytran_stage   where trncd = 225 and TRNDT BETWEEN '"
							+ BomDt + "'and '" + EomDt + "' and empno=" + empp + ")added,"
							+ "(select net_amt as loan from   paytran_stage   where trncd = 227 and TRNDT BETWEEN '"
							+ BomDt + "'and '" + EomDt + "' and empno=" + empp + ")loan,"
							+ "(select net_amt as tds from   paytran_stage   where trncd = 228 and TRNDT BETWEEN '"
							+ BomDt + "'and '" + EomDt + "' and empno=" + empp + ")tds,"
							+ "(select net_amt as payable from   paytran_stage   where trncd = 999 and TRNDT BETWEEN '"
							+ BomDt + "'and '" + EomDt + "' and empno=" + empp + ")payable "
							+ "from empmast,EMPTRAN t ,paytran_stage p1 where empmast.empno=" + empp + " and t.empno = "
							+ empp + " and p1.trndt   BETWEEN '" + BomDt + "'and '" + EomDt + "' and p1.empno=" + empp
							+ "";
					System.out.println(EmpSql);
					// System.out.println(empp);
					emp = st.executeQuery(EmpSql);

					while (emp.next()) {
						maincell = new PdfPCell(new Phrase("" + emp.getString("empcode"), f));
						maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
						main.addCell(maincell);

						maincell = new PdfPCell(new Phrase("" + emp.getString("name"), f));
						maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
						main.addCell(maincell);

						float mthsal = 0.0f;
						float absent = 0.0f;

						mthsal = emp.getFloat("ctc");
						if (mthsal == 0) {
							mthsal = 0;

						} else {

							totmthsal1 = totmthsal1 + mthsal;
						}
						// ctc
						maincell = new PdfPCell(new Phrase("" + mthsal, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						absent = emp.getFloat("abs_cnt");
						// L.O.P days
						maincell = new PdfPCell(new Phrase("" + absent, f));
						maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
						main.addCell(maincell);

						float ear1 = 0.0f;
						ear1 = emp.getFloat("earning1");
						if (ear1 == 0.0) {
							ear1 = 0;

						} else {
							// earning1 = ear1;
							totearning1 = totearning1 + ear1;
						}

						// earning 1
						maincell = new PdfPCell(new Phrase("" + ear1, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float ear2 = 0.0f;

						ear2 = emp.getFloat("earning2");
						if (ear2 == 0.0) {
							ear2 = 0;

						} else {

							totearning2 = totearning2 + ear2;
						}

						// earning 2
						maincell = new PdfPCell(new Phrase("" + ear2, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float mobded = 0.0f;

						mobded = emp.getFloat("mobded");
						if (mobded == 0.0) {
							mobded = 0;

						} else {

							totmobded = totmobded + mobded;
						}

						// mobile ded
						maincell = new PdfPCell(new Phrase("" + mobded, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float advanc = 0.0f;

						advanc = emp.getFloat("added");
						if (advanc == 0.0) {
							advanc = 0;

						} else {

							totadvanc = totadvanc + advanc;
						}

						// advance given
						maincell = new PdfPCell(new Phrase("" + advanc, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float loan = 0.0f;
						/*
						 * EmpSql="select net_amt as loan from "+table_name+
						 * " where trncd = 227 and TRNDT BETWEEN '"
						 * +BomDt+"'and '"+EomDt+"' and empno="+empp;
						 * //System.out.println(EmpSql); emp =
						 * st.executeQuery(EmpSql); while(emp.next()){ loan =
						 * emp.getFloat("loan");
						 * 
						 * //System.out.println("loan "+emp.getString("loan"));
						 * }
						 */
						loan = emp.getFloat("loan");
						if (loan == 0.0) {
							loan = 0;

						} else {

							totloan = totloan + loan;
						}

						// loan
						maincell = new PdfPCell(new Phrase("" + loan, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float tds = 0.0f;
						/*
						 * EmpSql="select net_amt as tds from "+table_name+
						 * " where trncd = 228 and TRNDT BETWEEN '"
						 * +BomDt+"'and '"+EomDt+"' and empno="+empp;
						 * //System.out.println(EmpSql); emp =
						 * st.executeQuery(EmpSql); while(emp.next()){ tds =
						 * emp.getFloat("tds");
						 * 
						 * //System.out.println("tds "+emp.getString("tds")); }
						 */
						tds = emp.getFloat("tds");
						if (tds == 0.0) {
							tds = 0;

						} else {

							tottds = tottds + tds;
						}

						// tds
						maincell = new PdfPCell(new Phrase("" + tds, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						int payable = 0;
						/*
						 * EmpSql="select net_amt as payable from "+table_name+
						 * " where trncd = 999 and TRNDT BETWEEN '"
						 * +BomDt+"'and '"+EomDt+"' and empno="+empp; emp =
						 * st.executeQuery(EmpSql);
						 * //System.out.println(""+EmpSql); while(emp.next()){
						 * payable = emp.getInt("payable");
						 * 
						 * //System.out.println("payable "+emp.getString(
						 * "payable" )); }
						 */
						payable = emp.getInt("payable");
						if (payable == 0) {
							payable = 0;
						} else {

							totactualpay = totactualpay + payable;

						}
						// actual pay
						maincell = new PdfPCell(new Phrase("" + payable, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

					}

				}

				NumberFormat format = com.ibm.icu.text.NumberFormat.getCurrencyInstance(new Locale("en", "in"));
				String totpay = format.format(totmthsal1).substring(4);
				String eard1 = format.format(totearning1).substring(4);
				String eard2 = format.format(totearning2).substring(4);
				String totnetpay = format.format(totactualpay).substring(4);
				String tomobded = format.format(totmobded).substring(4);
				String toadv = format.format(totadvanc).substring(4);
				String toloan = format.format(totloan).substring(4);
				String totds = format.format(tottds).substring(4);

				maincell = new PdfPCell(new Phrase("TOTAL PAY", f));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				maincell.setColspan(2);
				main.addCell(maincell);
				// totctc
				maincell = new PdfPCell(new Phrase("" + totpay, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totlop
				maincell = new PdfPCell(new Phrase("", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totear1
				maincell = new PdfPCell(new Phrase("" + eard1, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totear2
				maincell = new PdfPCell(new Phrase("" + eard2, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totmobileded
				maincell = new PdfPCell(new Phrase("" + tomobded, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totadvancegiven
				maincell = new PdfPCell(new Phrase("" + toadv, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totloan
				maincell = new PdfPCell(new Phrase("" + toloan, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// tottds
				maincell = new PdfPCell(new Phrase("" + totds, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totnetpay
				maincell = new PdfPCell(new Phrase("" + totnetpay, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				doc.add(main);
				st.close();
				con.close();
				doc.close();
			}

			else if (type.equals("I")) {

				System.out.println("hello am in IIIIIIIIII");
				ReportDAO.OpenCon("", "", "", repBean);
				con = repBean.getCn();
				Statement st = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);

				System.out.println("in income head");
				Document doc = new Document(new Rectangle(2384, 3370));
				PdfWriter writer = PdfWriter.getInstance(doc, new FileOutputStream(filepath));
				Footer1 ftr = dao.new Footer1(lable1);
				writer.setPageEvent(ftr);
				doc.open();
				Font FONT = new Font(Font.HELVETICA, 190, Font.NORMAL, new GrayColor(0.85f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER,
						new Phrase(prop.getProperty("watermark"), FONT), 1300f, 1830f, 45);
				Image image1 = Image.getInstance(imgpath);
				Phrase title = new Phrase(prop.getProperty("companyName"), new Font(FONT.TIMES_ROMAN, 38, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				image1.scaleAbsolute(310f, 120f);
				image1.setAbsolutePosition(60f, 3200f);
				doc.add(image1);
				doc.add(para);
				para = new Paragraph(new Phrase(prop.getProperty("addressForReport"), new Font(Font.TIMES_ROMAN, 28)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(prop.getProperty("contactForReport"), new Font(Font.TIMES_ROMAN, 28)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(prop.getProperty("mailForReport"), new Font(Font.TIMES_ROMAN, 28)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);

				Font f = new Font(Font.HELVETICA, 23);
				Font f1 = new Font(Font.HELVETICA, 20);
				/*
				 * if(TName.equalsIgnoreCase("after")) para = new Paragraph(new
				 * Phrase
				 * ("Salary Sheet For The Income Heads for the Month Of :- "
				 * +temp,new Font(Font.TIMES_ROMAN,25))); else
				 * if(TName.equalsIgnoreCase("before")) para = new Paragraph(new
				 * Phrase
				 * ("Salary Sheet For The Income Heads for the Month Of :- "
				 * +temp+" (Before Finalize)",new Font(Font.TIMES_ROMAN,25)));
				 * else
				 */para = new Paragraph(
						new Phrase("Salary Sheet For The Income Heads for the Month Of :- " + temp + " (" + hname + ")",
								new Font(Font.TIMES_ROMAN, 25)));

				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);

				doc.add(para);

				Rectangle rec = new Rectangle(100, 100);

				float basic_total = 0.0f;
				float lstbasic_total = 0.0f;
				float currda_total = 0.0f;
				float lstcurrda_total = 0.0f;
				float hra_total = 0.0f;
				float lsthra_total = 0.0f;
				float medical_total = 0.0f;
				float lstmedical_total = 0.0f;
				float edu_total = 0.0f;
				float lstedu_total = 0.0f;
				float splall_total = 0.0f;
				float lstsplall_total = 0.0f;
				float convall_total = 0.0f;
				float lstconvall_total = 0.0f;
				float washingall_total = 0.0f;
				float lstwashingall_total = 0.0f;
				float bonus_total = 0.0f;
				float lstbonus_total = 0.0f;
				float minins_total = 0.0f;
				float lstminins_total = 0.0f;
				float addlss_total = 0.0f;
				float lstaddlss_total = 0.0f;
				float col_total = 0.0f;
				float lstcol_total = 0.0f;
				float special_total = 0.0f;
				float lstspecial_total = 0.0f;
				float addinc_total = 0.0f;
				float lstaddinc_total = 0.0f;
				float totinc_total = 0.0f;
				float lsttotinc_total = 0.0f;
				float totded_total = 0.0f;
				float lsttotded_total = 0.0f;
				float netpay_total = 0.0f;
				float lstnetpay_total = 0.0f;

				EmpSql = "select CONVERT(INT, empmast.empcode) as EMPCODE ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as name,empmast.empno,t.PRJ_SRNO,"
						+ "p1.NET_AMT as basic,p2.NET_AMT as payable,p3.NET_AMT as hra,p4.NET_AMT as medical,"
						+ "p5.NET_AMT as education,p6.NET_AMT as convall,p7.NET_AMT as min_ins," + "p10.NET_AMT as col,"
						+ "(select net_amt from  PAYTRAN where TRNCD = 127 and trndt BETWEEN '" + BomDt + "'and '"
						+ EomDt + "' and EMPNO = empmast.EMPNO) as addless," +
						// "(select net_amt from PAYTRAN where TRNCD = 129 and
						// trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO =
						// empmast.EMPNO) as special, "
						// +
						"(select net_amt from  PAYTRAN where TRNCD = 107 and trndt BETWEEN '" + BomDt + "'and '" + EomDt
						+ "' and EMPNO = empmast.EMPNO) as splall,"
						+ "(select net_amt from  PAYTRAN where TRNCD = 102 and trndt BETWEEN '" + BomDt + "'and '"
						+ EomDt + "' and EMPNO = empmast.EMPNO) as curda,"
						+ "(select net_amt from  PAYTRAN where TRNCD = 115 and trndt BETWEEN '" + BomDt + "'and '"
						+ EomDt + "' and EMPNO = empmast.EMPNO) as washall,"
						+ "(select net_amt from  PAYTRAN where TRNCD = 135 and trndt BETWEEN '" + BomDt + "'and '"
						+ EomDt + "' and EMPNO = empmast.EMPNO) as bonusall,"
						+ "(select SUM(net_amt) from  PAYTRAN where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and TRNCD not in(101,103,104,105,108,126,127,128,107,102,115,135) and trndt BETWEEN '"
						+ BomDt + "'and '" + EomDt + "' and EMPNO = empmast.EMPNO) as addinc,"
						+ "(select SUM(net_amt) from  PAYTRAN where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) and trndt BETWEEN '"
						+ BomDt + "'and '" + EomDt + "' and EMPNO = empmast.EMPNO) as totded, "
						+ "(select SUM(net_amt) from  PAYTRAN where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and trndt BETWEEN '"
						+ BomDt + "'and '" + EomDt + "' and EMPNO = empmast.EMPNO) as totear "
						+ "from EMPMAST empmast join "
						+ " PAYTRAN p1 on empmast.EMPNO = p1.EMPNO join  PAYTRAN p2 on empmast.EMPNO = p2.EMPNO "
						+ "join  PAYTRAN p3 on empmast.EMPNO = p3.EMPNO "
						+ "join  PAYTRAN p4 on empmast.EMPNO = p4.EMPNO "
						+ "join  PAYTRAN p5 on empmast.EMPNO = p5.EMPNO "
						+ "join  PAYTRAN p6 on empmast.EMPNO = p6.EMPNO "
						+ "join  PAYTRAN p7 on empmast.EMPNO = p7.EMPNO "
						+ "join  PAYTRAN p10 on empmast.EMPNO = p10.EMPNO "
						+ "join EMPTRAN t on t.EMPNO = empmast.EMPNO where " + "p1.TRNCD = 101 and p1.TRNDT BETWEEN '"
						+ BomDt + "'and '" + EomDt + "' " + "and p2.TRNCD = 999 and p2.TRNDT BETWEEN '" + BomDt
						+ "'and '" + EomDt + "' " + "and p3.TRNCD = 103 and p3.TRNDT BETWEEN '" + BomDt + "'and '"
						+ EomDt + "' " + "and p4.TRNCD = 104 and p4.TRNDT BETWEEN '" + BomDt + "'and '" + EomDt + "' "
						+ "and p5.TRNCD = 105 and p5.TRNDT BETWEEN '" + BomDt + "'and '" + EomDt + "' "
						+ "and p6.TRNCD = 108 and p6.TRNDT BETWEEN '" + BomDt + "'and '" + EomDt + "' "
						+ "and p7.TRNCD = 126 and p7.TRNDT BETWEEN '" + BomDt + "'and '" + EomDt + "' "
						+ "and p10.TRNCD = 128 and p10.TRNDT BETWEEN '" + BomDt + "'and '" + EomDt + "' " +
						// "and empmast.STATUS = 'A'" +
						" and T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
						+ ReportDAO.EOM(PAYREGDT) + "') " +

						" UNION  select CONVERT(INT, empmast.empcode) as EMPCODE ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as name,empmast.empno,t.PRJ_SRNO,"
						+ "p1.NET_AMT as basic,p2.NET_AMT as payable,p3.NET_AMT as hra,p4.NET_AMT as medical,"
						+ "p5.NET_AMT as education,p6.NET_AMT as convall,p7.NET_AMT as min_ins," + "p10.NET_AMT as col,"
						+ "(select net_amt from   paytran_stage  where TRNCD = 127 and trndt BETWEEN '" + BomDt
						+ "'and '" + EomDt + "' and EMPNO = empmast.EMPNO) as addless," +
						// "(select net_amt from paytran_stage where TRNCD = 129
						// and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and
						// EMPNO = empmast.EMPNO) as special, "
						// +
						"(select net_amt from   paytran_stage  where TRNCD = 107 and trndt BETWEEN '" + BomDt + "'and '"
						+ EomDt + "' and EMPNO = empmast.EMPNO) as splall,"
						+ "(select net_amt from   paytran_stage  where TRNCD = 102 and trndt BETWEEN '" + BomDt
						+ "'and '" + EomDt + "' and EMPNO = empmast.EMPNO) as curda,"
						+ "(select net_amt from   paytran_stage  where TRNCD = 115 and trndt BETWEEN '" + BomDt
						+ "'and '" + EomDt + "' and EMPNO = empmast.EMPNO) as washall,"
						+ "(select net_amt from   paytran_stage  where TRNCD = 135 and trndt BETWEEN '" + BomDt
						+ "'and '" + EomDt + "' and EMPNO = empmast.EMPNO) as bonusall,"
						+ "(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and TRNCD not in(101,103,104,105,108,126,127,128,107,102,115,135) and trndt BETWEEN '"
						+ BomDt + "'and '" + EomDt + "' and EMPNO = empmast.EMPNO) as addinc,"
						+ "(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) and trndt BETWEEN '"
						+ BomDt + "'and '" + EomDt + "' and EMPNO = empmast.EMPNO) as totded, "
						+ "(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and trndt BETWEEN '"
						+ BomDt + "'and '" + EomDt + "' and EMPNO = empmast.EMPNO) as totear "
						+ "from EMPMAST empmast join "
						+ "  paytran_stage  p1 on empmast.EMPNO = p1.EMPNO join   paytran_stage  p2 on empmast.EMPNO = p2.EMPNO "
						+ "join   paytran_stage  p3 on empmast.EMPNO = p3.EMPNO "
						+ "join   paytran_stage  p4 on empmast.EMPNO = p4.EMPNO "
						+ "join   paytran_stage  p5 on empmast.EMPNO = p5.EMPNO "
						+ "join   paytran_stage  p6 on empmast.EMPNO = p6.EMPNO "
						+ "join   paytran_stage  p7 on empmast.EMPNO = p7.EMPNO "
						+ "join   paytran_stage  p10 on empmast.EMPNO = p10.EMPNO "
						+ "join EMPTRAN t on t.EMPNO = empmast.EMPNO where " + "p1.TRNCD = 101 and p1.TRNDT BETWEEN '"
						+ BomDt + "'and '" + EomDt + "' " + "and p2.TRNCD = 999 and p2.TRNDT BETWEEN '" + BomDt
						+ "'and '" + EomDt + "' " + "and p3.TRNCD = 103 and p3.TRNDT BETWEEN '" + BomDt + "'and '"
						+ EomDt + "' " + "and p4.TRNCD = 104 and p4.TRNDT BETWEEN '" + BomDt + "'and '" + EomDt + "' "
						+ "and p5.TRNCD = 105 and p5.TRNDT BETWEEN '" + BomDt + "'and '" + EomDt + "' "
						+ "and p6.TRNCD = 108 and p6.TRNDT BETWEEN '" + BomDt + "'and '" + EomDt + "' "
						+ "and p7.TRNCD = 126 and p7.TRNDT BETWEEN '" + BomDt + "'and '" + EomDt + "' "
						+ "and p10.TRNCD = 128 and p10.TRNDT BETWEEN '" + BomDt + "'and '" + EomDt + "' " +
						// "and empmast.STATUS = 'A'" +
						" and T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
						+ ReportDAO.EOM(PAYREGDT) + "') " +

						"order by t.PRJ_SRNO,EMPCODE";
				System.out.println(EmpSql);
				ResultSet rs = st.executeQuery(EmpSql);

				while (rs.next()) {

					String prj_name = null;
					String prj_code = null;
					Connection conn = ConnectionManager.getConnectionTech();
					Statement stmt = conn.createStatement();
					String prjquery = "select Site_Name,Project_Code from Project_Sites where SITE_ID = '"
							+ rs.getString("PRJ_SRNO") + "'";
					// System.out.println(prjquery);
					ResultSet prj = stmt.executeQuery(prjquery);
					if (prj.next()) {
						prj_name = prj.getString("Site_Name");
						prj_code = prj.getString("Project_Code");
					}
					pBrcd1 = rs.getString("PRJ_SRNO");
					br_tot_no_emp = 0;
					para = new Paragraph(new Phrase(
							"Employee's Salary List For Project Site : " + prj_name + " (" + prj_code + ")", f));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(4);
					doc.add(para);
					prj.close();
					stmt.close();
					conn.close();
					PdfPTable datatab;
					PdfPTable datatot;
					PdfPTable main = new PdfPTable(18);
					main.setSpacingBefore(10);
					main.setWidthPercentage(new float[] { 3, 12, 5, 5, 5, 5, 5, 5, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f,
							5.5f, 5.5f, 5.5f, 5.5f }, rec);
					PdfPCell maincell;

					maincell = new PdfPCell(new Phrase("EMP CODE", f1));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("EMPNAME", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Basic", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Current D.A", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("H.R.A", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Medical", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Education", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Spl All", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Conv All", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Washing All", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Bonus", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Min Insurance", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Add less Amt", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Col", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					// maincell = new PdfPCell(new Phrase("Special",f));
					// maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					// main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Add income", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Tot income", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Tot deduction", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Net pay", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					doc.add(main);
					while (pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
						datatab = new PdfPTable(18);
						datatab.setWidthPercentage(new float[] { 3, 12, 5, 5, 5, 5, 5, 5, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f,
								5.5f, 5.5f, 5.5f, 5.5f, 5.5f }, rec);
						datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

						PdfPCell cell1 = new PdfPCell(new Phrase("" + rs.getString("EMPCODE"), f1));
						cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						datatab.addCell(cell1);

						PdfPCell cell2 = new PdfPCell(new Phrase("" + rs.getString("name"), f1));
						cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
						datatab.addCell(cell2);

						basic_total = basic_total + rs.getFloat("basic");
						PdfPCell cell3 = new PdfPCell(new Phrase("" + rs.getFloat("basic"), f1));
						cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell3);

						if (rs.getFloat("curda") == 0.0) {
							PdfPCell cell4 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell4);
						} else {
							float curda = rs.getFloat("curda");
							currda_total = currda_total + curda;
							PdfPCell cell4 = new PdfPCell(new Phrase("" + curda, f1));
							cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell4);
						}

						hra_total = hra_total + rs.getFloat("hra");
						PdfPCell cell5 = new PdfPCell(new Phrase("" + rs.getFloat("hra"), f1));
						cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell5);

						medical_total = medical_total = rs.getFloat("medical");
						PdfPCell cell6 = new PdfPCell(new Phrase("" + rs.getFloat("medical"), f1));
						cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell6);

						edu_total = edu_total = rs.getFloat("education");
						PdfPCell cell7 = new PdfPCell(new Phrase("" + rs.getFloat("education"), f1));
						cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell7);

						if (rs.getFloat("splall") == 0.0) {
							PdfPCell cell8 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell8);
						} else {
							float splall1 = rs.getFloat("splall");
							splall_total = splall_total + splall1;
							PdfPCell cell8 = new PdfPCell(new Phrase("" + rs.getFloat("splall"), f1));
							cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell8);
						}

						convall_total = convall_total + rs.getFloat("convall");
						PdfPCell cell9 = new PdfPCell(new Phrase("" + rs.getFloat("convall"), f1));
						cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell9);

						if (rs.getFloat("washall") == 0.0) {
							PdfPCell cell10 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell10);
						} else {
							float washing = rs.getFloat("washall");
							washingall_total = washingall_total = rs.getFloat("washall");
							PdfPCell cell10 = new PdfPCell(new Phrase("" + washing, f1));
							cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell10);
						}

						if (rs.getFloat("bonusall") == 0.0) {
							PdfPCell cell11 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell11);
						} else {
							float bonus = rs.getFloat("bonusall");
							bonus_total = bonus_total + rs.getFloat("bonusall");
							PdfPCell cell11 = new PdfPCell(new Phrase("" + bonus, f1));
							cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell11);
						}

						minins_total = minins_total + +rs.getFloat("min_ins");
						PdfPCell cell12 = new PdfPCell(new Phrase("" + rs.getFloat("min_ins"), f1));
						cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell12);

						if (rs.getFloat("addless") == 0.0) {
							PdfPCell cell13 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell13);
						} else {
							float addless = rs.getFloat("addless");
							addlss_total = addlss_total + addless;
							PdfPCell cell13 = new PdfPCell(new Phrase("" + addless, f1));
							cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell13);
						}

						col_total = col_total + +rs.getFloat("col");
						PdfPCell cell14 = new PdfPCell(new Phrase("" + rs.getFloat("col"), f1));
						cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell14);

						/*
						 * if(rs.getFloat("special")==0.0){ PdfPCell cell15 =
						 * new PdfPCell(new Phrase("",f1));
						 * datatab.addCell(cell15); } else{ float spcl =
						 * rs.getFloat("special"); special_total = special_total
						 * + spcl; PdfPCell cell15 = new PdfPCell(new
						 * Phrase(""+spcl,f1));
						 * cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
						 * datatab.addCell(cell15); }
						 */
						if (rs.getFloat("addinc") == 0.0) {
							PdfPCell cell16 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell16);
						} else {
							float add_inc = rs.getFloat("addinc");
							addinc_total = addinc_total + add_inc;
							PdfPCell cell16 = new PdfPCell(new Phrase("" + add_inc, f1));
							cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell16);
						}

						totinc_total = totinc_total + rs.getFloat("totear");
						PdfPCell cell17 = new PdfPCell(new Phrase("" + rs.getFloat("totear"), f1));
						cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell17);

						totded_total = totded_total + rs.getFloat("totded");
						PdfPCell cell18 = new PdfPCell(new Phrase("" + rs.getFloat("totded"), f1));
						cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell18);

						netpay_total = netpay_total + rs.getFloat("payable");
						PdfPCell cell19 = new PdfPCell(new Phrase("" + rs.getFloat("payable"), f1));
						cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell19);

						doc.add(datatab);

						tot_no_emp = tot_no_emp + 1;
						br_tot_no_emp = br_tot_no_emp + 1;
						if (!rs.next()) {
							break;
						}
						if (!pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
							rs.previous();
							break;
						}
					}

					datatot = new PdfPTable(18);
					datatot.setWidthPercentage(new float[] { 3, 12, 5, 5, 5, 5, 5, 5, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f,
							5.5f, 5.5f, 5.5f, 5.5f, 5.5f }, rec);
					datatot.setHorizontalAlignment(Element.ALIGN_LEFT);

					PdfPCell cell1 = new PdfPCell(new Phrase("Total:--", f1));
					cell1.setColspan(2);
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell1);

					PdfPCell cell3 = new PdfPCell(new Phrase("" + basic_total, f1));
					cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell3);
					lstbasic_total = lstbasic_total + basic_total;
					basic_total = 0.0f;

					PdfPCell cell4 = new PdfPCell(new Phrase("" + currda_total, f1));
					cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell4);
					lstcurrda_total = lstcurrda_total + currda_total;
					currda_total = 0.0f;

					PdfPCell cell5 = new PdfPCell(new Phrase("" + hra_total, f1));
					cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell5);
					lsthra_total = lsthra_total + hra_total;
					hra_total = 0.0f;

					PdfPCell cell6 = new PdfPCell(new Phrase("" + medical_total, f1));
					cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell6);
					lstmedical_total = lstmedical_total + medical_total;
					medical_total = 0.0f;

					PdfPCell cell7 = new PdfPCell(new Phrase("" + edu_total, f1));
					cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell7);
					lstedu_total = lstedu_total + edu_total;
					edu_total = 0.0f;

					PdfPCell cell8 = new PdfPCell(new Phrase("" + splall_total, f1));
					cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell8);
					lstsplall_total = lstsplall_total = splall_total;
					splall_total = 0.0f;

					PdfPCell cell9 = new PdfPCell(new Phrase("" + convall_total, f1));
					cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell9);
					lstconvall_total = lstconvall_total = convall_total;
					convall_total = 0.0f;

					PdfPCell cell10 = new PdfPCell(new Phrase("" + washingall_total, f1));
					cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell10);
					lstwashingall_total = lstwashingall_total + washingall_total;
					washingall_total = 0.0f;

					PdfPCell cell11 = new PdfPCell(new Phrase("" + bonus_total, f1));
					cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell11);
					lstbonus_total = lstbonus_total + bonus_total;
					bonus_total = 0.0f;

					PdfPCell cell12 = new PdfPCell(new Phrase("" + minins_total, f1));
					cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell12);
					lstminins_total = lstminins_total + minins_total;
					minins_total = 0.0f;

					PdfPCell cell13 = new PdfPCell(new Phrase("" + addlss_total, f1));
					cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell13);
					lstaddlss_total = lstaddlss_total + addlss_total;
					addlss_total = 0.0f;

					PdfPCell cell14 = new PdfPCell(new Phrase("" + col_total, f1));
					cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell14);
					lstcol_total = lstcol_total + col_total;
					col_total = 0.0f;

					/*
					 * PdfPCell cell15 = new PdfPCell(new
					 * Phrase(""+special_total,f1));
					 * cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 * datatot.addCell(cell15); lstspecial_total =
					 * lstspecial_total + special_total ; special_total = 0.0f;
					 */

					PdfPCell cell16 = new PdfPCell(new Phrase("" + addinc_total, f1));
					cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell16);
					lstaddinc_total = lstaddinc_total + addinc_total;
					addinc_total = 0.0f;

					PdfPCell cell17 = new PdfPCell(new Phrase("" + totinc_total, f1));
					cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell17);
					lsttotinc_total = lsttotinc_total + totinc_total;
					totinc_total = 0.0f;

					PdfPCell cell18 = new PdfPCell(new Phrase("" + totded_total, f1));
					cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell18);
					lsttotded_total = lsttotded_total + totded_total;
					totded_total = 0.0f;

					PdfPCell cell19 = new PdfPCell(new Phrase("" + netpay_total, f1));
					cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell19);
					lstnetpay_total = lstnetpay_total + netpay_total;
					netpay_total = 0.0f;

					doc.add(datatot);

					para = new Paragraph(new Phrase("No Of Employee :- " + br_tot_no_emp, f));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(10);
					doc.add(para);

				}
				para = new Paragraph(new Phrase("Total No Of Employee :- " + tot_no_emp, f));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(10);
				doc.add(para);

				System.out.println("Total No Of Employee :- " + tot_no_emp);

				PdfPTable main = new PdfPTable(18);
				main.setSpacingBefore(10);
				main.setWidthPercentage(new float[] { 5, 6, 5, 5.5f, 5.5f, 5.5f, 5, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f,
						5.5f, 5.5f, 6, 6, 6 }, rec);
				PdfPCell maincell;

				maincell = new PdfPCell(new Phrase("Summury", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				maincell.setColspan(2);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Basic", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Current D.A", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("H.R.A", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Medical", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Education", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Spl All", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Conv All", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Washing All", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Officiating All", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Min Insurance", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Add less Amt", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Col", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				/*
				 * maincell = new PdfPCell(new Phrase("Special",f));
				 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * main.addCell(maincell);
				 */

				maincell = new PdfPCell(new Phrase("Add income", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Tot income", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Tot deduction", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Net pay", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Gross Total:--", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				maincell.setColspan(2);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstbasic_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstcurrda_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lsthra_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstmedical_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstedu_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstsplall_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstconvall_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstwashingall_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstbonus_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstminins_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstaddlss_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstcol_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				/*
				 * maincell = new PdfPCell(new
				 * Phrase(""+trans((int)(lstspecial_total), "", "", false,
				 * false),f));
				 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * main.addCell(maincell);
				 */

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstaddinc_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lsttotinc_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lsttotded_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstnetpay_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				doc.add(main);

				/*
				 * System.out.println("last basic = "+lstbasic_total);
				 * System.out.println("last current da = "+lstcurrda_total);
				 * System.out.println("last hra = "+lsthra_total);
				 * System.out.println("last medical = "+lstmedical_total);
				 * System.out.println("last education = "+lstedu_total);
				 * System.out.println("last splall = "+lstsplall_total);
				 * System.out.println("last convall = "+lstconvall_total);
				 * System.out.println("last washing = "+lstwashingall_total);
				 * System.out.println("last bonus = "+lstbonus_total);
				 * System.out.println("last minins = "+lstminins_total);
				 * System.out.println("last addless = "+lstaddlss_total);
				 * System.out.println("last col = "+lstcol_total);
				 * //System.out.println("last special = "+lstspecial_total);
				 * System.out.println("last addinc = "+lstaddinc_total);
				 * System.out.println("last totinc = "+lsttotinc_total);
				 * System.out.println("last totded = "+lsttotded_total);
				 * System.out.println("last totnetpay = "+lstnetpay_total);
				 */

				st.close();
				con.close();
				doc.close();

			}

			else if (type.equals("ID")) {
				System.out.println("hello am in IDDDDD");
				ReportDAO.OpenCon("", "", "", repBean);
				con = repBean.getCn();
				Statement st = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);
				Statement stmtInsert = con.createStatement();
				Statement stmtTrnct = con.createStatement();

				DottedLineCell app = new DottedLineCell();
				System.out.println("in income & Deduction head");

				// A4 size pdf....
			//	Document document = new Document(new Rectangle(2384, 3370));
				
			//	Document document = new Document(PageSize.LEGAL);

			//	 Document document = new Document(new Rectangle(2834,4008));
				 
				//done for landscape
				Document document = new Document(new Rectangle(3000,4408));
			//	Document document = new Document(new Rectangle(3200,4408));
			
					
				document.left(100f);
				document.top(100f);
				document.bottom(100f);
				document.right(100f);

				PdfWriter writer = PdfWriter.getInstance(document, new FileOutputStream(filepath));
				HeaderAndFooter_New haf = new HeaderAndFooter_New(lable1, label2);
				writer.setPageEvent(haf);
				document.open();
				Font FONT = new Font(Font.HELVETICA, 190, Font.NORMAL, new GrayColor(0.85f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER,
						new Phrase(prop.getProperty("watermark"), FONT), 1300f, 1830f, 45);
				Image image1 = Image.getInstance(imgpath);

				Phrase title = new Phrase(prop.getProperty("companyName"), new Font(FONT.TIMES_ROMAN, 22, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				//image1.scaleAbsolute(310f, 120f);
				image1.scaleAbsolute(310f, 200f);

				// chaange possition of image
				/* image1.setAbsolutePosition(60f, 2750f); */
			
				//image1.setAbsolutePosition(60f, 3200f);
				image1.setAbsolutePosition(400f, 4200f);
				document.add(image1);
				document.add(para);

				para = new Paragraph(new Phrase(prop.getProperty("addressForReport"), new Font(Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase(prop.getProperty("contactForReport"), new Font(Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase(prop.getProperty("mailForReport"), new Font(Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);

				document.add(para);

				Font f = new Font(Font.HELVETICA, 22);
				Font f1 = new Font(Font.HELVETICA, 22);
				Font fbold = new Font(Font.HELVETICA, 22, Font.BOLD);
				Font f2 = new Font(Font.HELVETICA, 22);

//				para = new Paragraph(new Phrase("Salary Sheet For The Income Heads for the Month Of :- " + temp + " (" + hname + ")", new Font(Font.TIMES_ROMAN, 20)));
				para = new Paragraph(new Phrase("Salary Sheet For The Month Of :- " + temp + " (" + hname + ")", new Font(Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);

				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(30);

				document.add(para);

				Rectangle rec = new Rectangle(100, 100);

				float basic_total = 0.0f;
				float lstbasic_total = 0.0f;
				float lic_total = 0.0f;
				float lstlic_total = 0.0f;
				float hra_total = 0.0f;
				float lsthra_total = 0.0f;
				float medical_total = 0.0f;
				float lstmedical_total = 0.0f;
				float leave_TC = 0.0f;
				float lstleave_total = 0.0f;
				float any_total = 0.0f;
				float lstany_total = 0.0f;
				float edu_total = 0.0f;
				float lstedu_total = 0.0f;
				float splall_total = 0.0f;
				float lstsplall_total = 0.0f;
				float convall_total = 0.0f;
				float lstconvall_total = 0.0f;
				float pf_total = 0.0f;
				float lstpf_total = 0.0f;
				float pt_total = 0.0f;
				float lstpt_total = 0.0f;
				float mlwf_total = 0.0f;
				float lstmlwf_total = 0.0f;
				float other_total = 0.0f;
				float med_total = 0.0f;
				float ERP_total = 0.0f;
				float istotmed_total = 0.0f;
				float istotERPDED_total = 0.0f;
				float lstother_total = 0.0f;
				float esic_total = 0.0f;
				float lstesic_total = 0.0f;
				float mob_total = 0.0f;
				float lstmob_total = 0.0f;
				float adv_total = 0.0f;
				float lstadv_total = 0.0f;
				float tds_total = 0.0f;
				float lsttds_total = 0.0f;
				float relif_total = 0.0f;
				float lstrelif_total = 0.0f;
				float netc_total = 0.0f;
				float lstnetc_total = 0.0f;
				float minins_total = 0.0f;
				float lstminins_total = 0.0f;
				float addlss_total = 0.0f;
				float lstaddlss_total = 0.0f;
				float col_total = 0.0f;
				float lstcol_total = 0.0f;
				float special_total = 0.0f;
				float lstspecial_total = 0.0f;
				float addinc_total = 0.0f;
				float lstaddinc_total = 0.0f;
				float totinc_total = 0.0f;
				float lsttotinc_total = 0.0f;
				float loan_total = 0.0f;
				float lstloan_total = 0.0f;
				float totded_total = 0.0f;
				float lsttotded_total = 0.0f;
				float netpay_total = 0.0f;
				float lstnetpay_total = 0.0f;
				float da_total = 0.0f;
				float lstda_total = 0.0f;
				float deptall_total = 0.0f;
				float lstdeptall_total = 0.0f;
				float othersplall_total = 0.0f;
				float lstothersplall_total = 0.0f;
				float mediclaim_total = 0.0f;
				float lstmediclaim_total = 0.0f;
				float otherded_total = 0.0f;
				float lstotherded_total = 0.0f;
				float memded_total = 0.0f;
				float lstmemded_total = 0.0f;
				float bankloan_total = 0.0f;
				float lstbankloan_total = 0.0f;
				float otherloan_total = 0.0f;
				float lstotherloan_total = 0.0f;

				if(emptype.equalsIgnoreCase("4"))
				{
					emptype="1,2,3";
				}
				else if(emptype.equalsIgnoreCase("5")){
					emptype="0,1,2,3";
				}
				
				String BranchCodeList="";
				if(branchCode.equalsIgnoreCase("0"))
				{
					BranchCodeList = "";
				}
				else 
				{
					BranchCodeList = " AND t.PRJ_SRNO IN ("+branchCode+")";
				}

				
				if (reptype.equalsIgnoreCase("paytran")) {
					EmpSql = "         SELECT  EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+' '+RTRIM(EMPMAST.LNAME)AS NAME,"
							+ "     	EMPMAST.EMPNO, EMPMAST.DOL, EMPMAST.STATUS,  T.PRJ_SRNO, L.LKP_DISC AS DESIG,"

							+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 101 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)   "
							+ "		THEN	(SELECT NET_AMT AS BASIC  FROM   PAYTRAN WHERE TRNCD = 101 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE	(SELECT 0 AS BASIC) END AS 'BASIC',"

							+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 102 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN			(SELECT NET_AMT AS DA  FROM   PAYTRAN WHERE TRNCD = 102 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS DA) END AS 'DA',"

							+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 103 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN			(SELECT NET_AMT AS HRA  FROM   PAYTRAN WHERE TRNCD = 103 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS HRA) END AS 'HRA',"

							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 107 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN (SELECT NET_AMT AS DEPTALL  FROM   PAYTRAN WHERE TRNCD = 107  AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE (SELECT 0 AS DEPTALL) END AS 'DEPTALL',"

							+ " 		CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 108 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	    THEN			(SELECT NET_AMT AS CONVALL  FROM   PAYTRAN WHERE TRNCD = 108 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS CONVALL) END AS 'CONVALL',"

							+ " 		CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 129 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	    THEN			(SELECT NET_AMT AS OTHERSPLALL  FROM   PAYTRAN WHERE TRNCD = 129 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS OTHERSPLALL) END AS 'OTHERSPLALL',"

							+ "	    CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 999 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN			(SELECT NET_AMT AS PAYABLE  FROM   PAYTRAN WHERE TRNCD = 999 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS PAYABLE) END AS 'PAYABLE',"

							+ " 		 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 201 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "			THEN		(SELECT NET_AMT AS PF  FROM   PAYTRAN WHERE TRNCD = 201 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)    			"
							+ "		ELSE		(SELECT 0 AS PF) END AS 'PF',	 "

							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 202 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN	(SELECT NET_AMT AS PT  FROM   PAYTRAN WHERE TRNCD = 202 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)		"
							+ "ELSE			(SELECT 0 AS PT) END AS 'PT', "

							+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 205 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "			THEN			(SELECT NET_AMT AS LIC  FROM   PAYTRAN WHERE TRNCD = 205 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "				ELSE		(SELECT 0 AS LIC) END AS 'LIC',"

							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 212 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "			THEN		(SELECT NET_AMT AS MEDICLAIM  FROM   PAYTRAN WHERE TRNCD = 212 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS MEDICLAIM) END AS 'MEDICLAIM',"

							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 213 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "			THEN		(SELECT NET_AMT AS OTHERDED  FROM   PAYTRAN WHERE TRNCD = 213 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE	(SELECT 0 AS OTHERDED) END AS 'OTHERDED',"

							+ "		 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 223 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN		(SELECT NET_AMT AS MEMDED  FROM   PAYTRAN WHERE TRNCD = 223 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE  (SELECT 0 AS MEMDED) END AS 'MEMDED',"

							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 228 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN		(SELECT NET_AMT AS TDS  FROM   PAYTRAN WHERE TRNCD = 228 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE		(SELECT 0 AS TDS) END AS 'TDS',"

							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 211 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN		(SELECT NET_AMT AS MLWF  FROM   PAYTRAN WHERE TRNCD = 211 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE		(SELECT 0 AS MLWF) END AS 'MLWF',"

						/*	+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 248 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN		(SELECT NET_AMT AS BANKLOAN  FROM   PAYTRAN WHERE TRNCD = 248 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE		(SELECT 0 AS BANKLOAN) END AS 'BANKLOAN',"

							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 249 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN		(SELECT NET_AMT AS OTHERLOAN  FROM   PAYTRAN WHERE TRNCD = 249 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE		(SELECT 0 AS OTHERLOAN) END AS 'OTHERLOAN',"
*/							
							+ "	 CASE WHEN EXISTS(SELECT SUM(NET_AMT) FROM   PAYTRAN WHERE TRNCD IN (244, 245, 246, 247) AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN		(SELECT SUM(NET_AMT) AS BANKLOAN  FROM   PAYTRAN WHERE TRNCD IN (244, 245, 246, 247) AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE		(SELECT 0 AS BANKLOAN) END AS 'BANKLOAN',"

							+ "	 CASE WHEN EXISTS(SELECT SUM(NET_AMT) FROM   PAYTRAN WHERE TRNCD IN(248, 249) AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN		(SELECT SUM(NET_AMT) AS OTHERLOAN  FROM   PAYTRAN WHERE TRNCD IN(248, 249) AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE		(SELECT 0 AS OTHERLOAN) END AS 'OTHERLOAN',"
							
							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 301 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN		(SELECT NET_AMT AS ABSCENTDAYS  FROM   PAYTRAN WHERE TRNCD = 301 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE		(SELECT 0 AS ABSCENTDAYS) END AS 'ABSCENTDAYS',"

							+ "    case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "    and TRNCD not in(101,102,103,107,108,129)" + "    and trndt BETWEEN '" + BomDt
							+ "' and '" + EomDt + "' and EMPNO =  EMPMAST.EMPNO )"
							+ "	 THEN	(select SUM(net_amt) as addinc from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "    and TRNCD not in(101,102,103,107,108,129)" + "    and trndt BETWEEN '" + BomDt
							+ "' and '" + EomDt + "' and EMPNO =  EMPMAST.EMPNO) "
							+ "	 ELSE		(SELECT 0 AS addinc) END AS 'addinc',"

							+ "      case when EXISTS(select SUM(net_amt)   from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
							+ "     and TRNCD not in(201,202,205,212,213,223,228,211,248,249, 244, 245, 246, 247) and trndt BETWEEN '"
							+ BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO)"
							+ "	  THEN	(select SUM(net_amt)  as other from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
							+ "     and TRNCD not in(201,202,205,212,213,223,228,211,248,249, 244, 245, 246, 247) and trndt BETWEEN '"
							+ BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO)"
							+ "	  ELSE	(SELECT 0 AS other) END AS 'other' ,"

							+ "	  case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO)"
							+ "	  THEN			(select SUM(net_amt) as totded from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299) "
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt
							+ "' and EMPNO = empmast.EMPNO)	" + "	  ELSE 	(SELECT 0 AS totded) END AS 'totded' ,"

							+ "	  case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO) "
							+ "	  THEN	(select SUM(net_amt) from   PAYTRAN  where TRNCD in    (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO)"
							+ "	  ELSE		(SELECT 0 AS totear) END AS 'totear'"

							+ "     from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO , LOOKUP L "
							+ " WHERE  T.DESIG=L.LKP_SRNO AND L.LKP_CODE='DESIG' AND      T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
							+ EomDt + "'" + "     and (( empmast.STATUS='A' AND	empmast.DOJ <= '" + EomDt
							+ "') or  (empmast.STATUS ='N' And empmast.DOL>='" + BomDt + "' )) )"
							+ "     AND T.EMPNO in (SELECT DISTINCT EMPNO FROM PAYTRAN WHERE TRNDT BETWEEN '" + BomDt
						  //	+ "' and '" + EomDt + "') "
							+ "' and '" + EomDt + "') AND EMPLOYEE_TYPE IN("+emptype+")"+BranchCodeList

							
							+ "    UNION "

							+ "         SELECT  EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+' '+RTRIM(EMPMAST.LNAME)AS NAME,"
							+ "     	EMPMAST.EMPNO,  EMPMAST.DOL, EMPMAST.STATUS, T.PRJ_SRNO, L.LKP_DISC AS DESIG,"

							+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 101 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN	(SELECT NET_AMT AS BASIC  FROM   PAYTRAN_STAGE WHERE TRNCD = 101 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE	(SELECT 0 AS BASIC) END AS 'BASIC',"

							+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 102 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN			(SELECT NET_AMT AS DA  FROM   PAYTRAN_STAGE WHERE TRNCD = 102 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS DA) END AS 'DA',   "

							+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 103 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN			(SELECT NET_AMT AS HRA  FROM   PAYTRAN_STAGE WHERE TRNCD = 103 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS HRA) END AS 'HRA',"

							+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 107 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)		"
							+ "	    THEN		(SELECT NET_AMT AS DEPTALL  FROM   PAYTRAN_STAGE WHERE TRNCD = 107 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	    ELSE 	(SELECT 0 AS DEPTALL) END AS 'DEPTALL',  "

							+ "          CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 108 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	    THEN			(SELECT NET_AMT AS CONVALL  FROM   PAYTRAN_STAGE WHERE TRNCD = 108 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS CONVALL) END AS 'CONVALL',"

							+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 129 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)		"
							+ "	    THEN		(SELECT NET_AMT AS OTHERSPLALL  FROM   PAYTRAN_STAGE WHERE TRNCD = 129 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	    ELSE 	(SELECT 0 AS OTHERSPLALL) END AS 'OTHERSPLALL',  "

							+ "	    CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 999 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN			(SELECT NET_AMT AS PAYABLE  FROM   PAYTRAN_STAGE WHERE TRNCD = 999 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS PAYABLE) END AS 'PAYABLE',"

							+ "			 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 201 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "			THEN		(SELECT NET_AMT AS PF  FROM   PAYTRAN_STAGE WHERE TRNCD = 201 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)    			"
							+ "		ELSE		(SELECT 0 AS PF) END AS 'PF',	 "

							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 202 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN	(SELECT NET_AMT AS PT  FROM   PAYTRAN_STAGE WHERE TRNCD = 202 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)	"
							+ "	ELSE			(SELECT 0 AS PT) END AS 'PT', "

							+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 205 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "			THEN			(SELECT NET_AMT AS LIC  FROM   PAYTRAN_STAGE WHERE TRNCD = 205 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "				ELSE		(SELECT 0 AS LIC) END AS 'LIC',"

							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 212 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "			THEN		(SELECT NET_AMT AS MEDICLAIM  FROM   PAYTRAN_STAGE WHERE TRNCD = 212 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS MEDICLAIM) END AS 'MEDICLAIM',"

							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 213 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN		(SELECT NET_AMT AS OTHERDED  FROM   PAYTRAN_STAGE WHERE TRNCD = 213 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE		(SELECT 0 AS OTHERDED) END AS 'OTHERDED',"

							+ "		 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 223 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN		(SELECT NET_AMT AS MEMDED  FROM   PAYTRAN_STAGE WHERE TRNCD = 223 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE  (SELECT 0 AS MEMDED) END AS 'MEMDED',"

							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 228 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN		(SELECT NET_AMT AS TDS  FROM   PAYTRAN_STAGE WHERE TRNCD = 228 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE		(SELECT 0 AS TDS) END AS 'TDS',"

							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 211 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN		(SELECT NET_AMT AS MLWF  FROM   PAYTRAN_STAGE WHERE TRNCD = 211 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE		(SELECT 0 AS MLWF) END AS 'MLWF',"

							+ "	 CASE WHEN EXISTS(SELECT SUM(NET_AMT) FROM   PAYTRAN_STAGE WHERE TRNCD IN (244, 245, 246, 247) AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "			THEN		(SELECT SUM(NET_AMT) AS BANKLOAN  FROM   PAYTRAN_STAGE WHERE TRNCD IN (244, 245, 246, 247) AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE	(SELECT 0 AS BANKLOAN) END AS 'BANKLOAN',"

							+ "	 CASE WHEN EXISTS(SELECT SUM(NET_AMT) FROM   PAYTRAN_STAGE WHERE TRNCD IN (248, 249) AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN		(SELECT SUM(NET_AMT) AS OTHERLOAN  FROM   PAYTRAN_STAGE WHERE TRNCD IN (248, 249) AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE		(SELECT 0 AS OTHERLOAN) END AS 'OTHERLOAN',"

							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 301 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN		(SELECT NET_AMT AS ABSCENTDAYS  FROM   PAYTRAN_STAGE WHERE TRNCD = 301 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE		(SELECT 0 AS ABSCENTDAYS) END AS 'ABSCENTDAYS',"

							+ "    case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "    and TRNCD not in(101,102,103,107,108,129)" + "    and trndt BETWEEN '" + BomDt
							+ "' and '" + EomDt + "' and EMPNO =  EMPMAST.EMPNO )"
							+ "	 THEN	(select SUM(net_amt) as addinc from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "    and TRNCD not in(101,102,103,107,108,129)" + "    and trndt BETWEEN '" + BomDt
							+ "' and '" + EomDt + "' and EMPNO =  EMPMAST.EMPNO) "
							+ "	 ELSE		(SELECT 0 AS addinc) END AS 'addinc',"

							+ "      case when EXISTS(select SUM(net_amt)   from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
							+ "     and TRNCD not in(201,202,205,212,213,223,228,211,248,249, 244, 245, 246, 247) and trndt BETWEEN '"
							+ BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO)"
							+ "	  THEN	(select SUM(net_amt)  as other from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
							+ "     and TRNCD not in(201,202,205,212,213,223,228,211,248,249, 244, 245, 246, 247) and trndt BETWEEN '"
							+ BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO)"
							+ "	  ELSE	(SELECT 0 AS other) END AS 'other' ,"

							+ "	  case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO)"
							+ "	  THEN			(select SUM(net_amt) as totded from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) "
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt
							+ "' and EMPNO = empmast.EMPNO)	" + "	  ELSE 	(SELECT 0 AS totded) END AS 'totded' ,"

							+ "	  case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO) "
							+ "	  THEN	(select SUM(net_amt) from   paytran_stage  where TRNCD in    (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO)"
							+ "	  ELSE		(SELECT 0 AS totear) END AS 'totear'"

							+ "     from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO , LOOKUP L "
							+ "  WHERE  T.DESIG=L.LKP_SRNO AND L.LKP_CODE='DESIG' AND      T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
							+ EomDt + "'" + "     and (( empmast.STATUS='A' AND	empmast.DOJ <= '" + EomDt
							+ "') or  (empmast.STATUS ='N' And empmast.DOL>='" + BomDt + "' )) )"
							+ "     AND T.EMPNO in (SELECT DISTINCT EMPNO FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '"
							//+ BomDt + "' and '" + EomDt + "') " + "     order by   t.PRJ_SRNO,empno  ";
							+ BomDt + "' and '" + EomDt + "') AND EMPLOYEE_TYPE IN("+emptype+")   " +BranchCodeList+ "     order by   t.PRJ_SRNO,empno  ";
					System.out.println("newpayregwithNewFormat ID :" + EmpSql);
				}

				else if (reptype.equalsIgnoreCase("ytdtran")) {
					EmpSql = "	SELECT  EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+' '+RTRIM(EMPMAST.LNAME)AS NAME,"
							+ "	EMPMAST.EMPNO, EMPMAST.DOL, EMPMAST.STATUS,  T.PRJ_SRNO, L.LKP_DISC AS DESIG,"

							+ "     CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 101 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN	(SELECT NET_AMT AS BASIC  FROM   ytdtran WHERE TRNCD = 101 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE	(SELECT 0 AS BASIC) END AS 'BASIC',"

							+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 102 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN			(SELECT NET_AMT AS DA  FROM   ytdtran WHERE TRNCD = 102 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS DA) END AS 'DA',"

							+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 103 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN			(SELECT NET_AMT AS HRA  FROM   ytdtran WHERE TRNCD = 103 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS HRA) END AS 'HRA',"

							+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 107 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN			(SELECT NET_AMT AS DEPTALL  FROM   ytdtran WHERE TRNCD = 107 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS DEPTALL) END AS 'DEPTALL',"

							+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 108 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN			(SELECT NET_AMT AS CONVALL  FROM   ytdtran WHERE TRNCD = 108 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS CONVALL) END AS 'CONVALL',"

							+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 129 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN			(SELECT NET_AMT AS OTHERSPLALL  FROM   ytdtran WHERE TRNCD = 129 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS OTHERSPLALL) END AS 'OTHERSPLALL',"

							+ "	    CASE  WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 999 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN			(SELECT NET_AMT AS PAYABLE  FROM   ytdtran WHERE TRNCD = 999 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS PAYABLE) END AS 'PAYABLE',"

							+ "			 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 201 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "			THEN		(SELECT NET_AMT AS PF  FROM   ytdtran WHERE TRNCD = 201 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)    			"
							+ "		ELSE		(SELECT 0 AS PF) END AS 'PF',	 "

							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 202 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN	(SELECT NET_AMT AS PT  FROM   ytdtran WHERE TRNCD = 202 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)		"
							+ "ELSE			(SELECT 0 AS PT) END AS 'PT', "

							+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 205 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "			THEN			(SELECT NET_AMT AS LIC  FROM   ytdtran WHERE TRNCD = 205 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "				ELSE		(SELECT 0 AS LIC) END AS 'LIC',"

							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 212 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "			THEN		(SELECT NET_AMT AS MEDICLAIM  FROM   ytdtran WHERE TRNCD = 212 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS MEDICLAIM) END AS 'MEDICLAIM',"

							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 213 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "			THEN		(SELECT NET_AMT AS OTHERDED  FROM   ytdtran WHERE TRNCD = 213 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS OTHERDED) END AS 'OTHERDED',"

							+ "		 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 223 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN		(SELECT NET_AMT AS MEMDED  FROM   ytdtran WHERE TRNCD = 223 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE  (SELECT 0 AS MEMDED) END AS 'MEMDED',"

							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 228 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN		(SELECT NET_AMT AS TDS  FROM   ytdtran WHERE TRNCD = 228 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE		(SELECT 0 AS TDS) END AS 'TDS',"

							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 211 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "			THEN		(SELECT NET_AMT AS MLWF  FROM   ytdtran WHERE TRNCD = 211 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE 	(SELECT 0 AS MLWF) END AS 'MLWF',"

							+ "	 CASE WHEN EXISTS(SELECT SUM(NET_AMT) FROM   ytdtran WHERE TRNCD IN (244, 245, 246, 247) AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN		(SELECT SUM(NET_AMT) AS BANKLOAN  FROM   ytdtran WHERE TRNCD IN (244, 245, 246, 247) AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE		(SELECT 0 AS BANKLOAN) END AS 'BANKLOAN',"

							+ "	 CASE WHEN EXISTS(SELECT SUM(NET_AMT) FROM   ytdtran WHERE TRNCD IN (248, 249) AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN		(SELECT SUM(NET_AMT )AS OTHERLOAN  FROM   ytdtran WHERE TRNCD IN (248, 249) AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE		(SELECT 0 AS OTHERLOAN) END AS 'OTHERLOAN',"

							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 301 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN		(SELECT NET_AMT AS ABSCENTDAYS  FROM   ytdtran WHERE TRNCD = 301 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE		(SELECT 0 AS ABSCENTDAYS) END AS 'ABSCENTDAYS',"

							+ "    case when EXISTS(select SUM(net_amt) from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "    and TRNCD not in(101,102,103,107,108,129)" + "    and trndt BETWEEN '" + BomDt
							+ "' and '" + EomDt + "' and EMPNO =  EMPMAST.EMPNO )"
							+ "	 THEN	(select SUM(net_amt) as addinc from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "    and TRNCD not in(101,102,103,107,108,129)" + "    and trndt BETWEEN '" + BomDt
							+ "' and '" + EomDt + "' and EMPNO =  EMPMAST.EMPNO) "
							+ "	 ELSE		(SELECT 0 AS addinc) END AS 'addinc',"

							+ "      case when EXISTS(select SUM(net_amt)   from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
							+ "     and TRNCD not in(201,202,205,212,213,223,228,211,248,249) and trndt BETWEEN '"
							+ BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO)"
							+ "	  THEN	(select SUM(net_amt)  as other from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
							+ "     and TRNCD not in(201,202,205,212,213,223,228,211,248,249) and trndt BETWEEN '"
							+ BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO)"
							+ "	  ELSE	(SELECT 0 AS other) END AS 'other' ,"

							+ "	  case when EXISTS(select SUM(net_amt) from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO)"
							+ "	  THEN			(select SUM(net_amt) as totded from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) "
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt
							+ "' and EMPNO = empmast.EMPNO)	" + "	  ELSE 	(SELECT 0 AS totded) END AS 'totded' ,"

							+ "	  case when EXISTS(select SUM(net_amt) from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO) "
							+ "	  THEN	(select SUM(net_amt) from   ytdtran  where TRNCD in    (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO)"
							+ "	  ELSE		(SELECT 0 AS totear) END AS 'totear'"

							+ "     from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO , LOOKUP L "
							+ "  WHERE  T.DESIG=L.LKP_SRNO AND L.LKP_CODE='DESIG' AND      T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
							+ EomDt + "'" + "     and (( empmast.STATUS='A' AND	empmast.DOJ <= '" + EomDt
							+ "') or  (empmast.STATUS ='N' And empmast.DOL>='" + BomDt + "' )) )"
							+ "     AND T.EMPNO in (SELECT DISTINCT EMPNO FROM ytdtran WHERE TRNDT BETWEEN '" + BomDt
							//+ "' and '" + EomDt + "') " + "     order by   t.PRJ_SRNO,empno  ";
							+ "' and '" + EomDt + "') AND EMPLOYEE_TYPE IN("+emptype+ ") "+BranchCodeList+ "     order by   t.PRJ_SRNO,empno  ";
							System.out.println("newpayregwithNewFormat ytdtran :" + EmpSql);
				}

				else if (reptype.equalsIgnoreCase("paytran_stage")) {
					EmpSql = "         SELECT  EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+' '+RTRIM(EMPMAST.LNAME)AS NAME,"
							+ "     	EMPMAST.EMPNO, EMPMAST.DOL, EMPMAST.STATUS,  T.PRJ_SRNO, L.LKP_DISC AS DESIG,"

							+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 101 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN	(SELECT NET_AMT AS BASIC  FROM   PAYTRAN_STAGE WHERE TRNCD = 101 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE	(SELECT 0 AS BASIC) END AS 'BASIC',"

							+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 102 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN			(SELECT NET_AMT AS DA  FROM   PAYTRAN_STAGE WHERE TRNCD = 102 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS DA) END AS 'DA',"

							+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 103 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN			(SELECT NET_AMT AS HRA  FROM   PAYTRAN_STAGE WHERE TRNCD = 103 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS HRA) END AS 'HRA',"

							+ "          CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 107 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	    THEN		 	(SELECT NET_AMT AS DEPTALL  FROM   PAYTRAN_STAGE WHERE TRNCD = 107 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS DEPTALL) END AS 'DEPTALL',"

							+ "          CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 108 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	    THEN		 	(SELECT NET_AMT AS CONVALL  FROM   PAYTRAN_STAGE WHERE TRNCD = 108 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS CONVALL) END AS 'CONVALL',"

							+ "          CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 129 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	    THEN		 	(SELECT NET_AMT AS OTHERSPLALL  FROM   PAYTRAN_STAGE WHERE TRNCD = 129 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS OTHERSPLALL) END AS 'OTHERSPLALL',"

							+ "	    CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 999 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN			(SELECT NET_AMT AS PAYABLE  FROM   PAYTRAN_STAGE WHERE TRNCD = 999 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS PAYABLE) END AS 'PAYABLE',"

							+ "			 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 201 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "			THEN		(SELECT NET_AMT AS PF  FROM   PAYTRAN_STAGE WHERE TRNCD = 201 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)    			"
							+ "		ELSE		(SELECT 0 AS PF) END AS 'PF',	 "

							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 202 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN	(SELECT NET_AMT AS PT  FROM   PAYTRAN_STAGE WHERE TRNCD = 202 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)		"
							+ "ELSE			(SELECT 0 AS PT) END AS 'PT', "

							+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 205 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "			THEN			(SELECT NET_AMT AS LIC  FROM   PAYTRAN_STAGE WHERE TRNCD = 205 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "				ELSE		(SELECT 0 AS LIC) END AS 'LIC',"

							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 212 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "			THEN		(SELECT NET_AMT AS MEDICLAIM  FROM   PAYTRAN_STAGE WHERE TRNCD = 212 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS MEDICLAIM) END AS 'MEDICLAIM',"

							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 213 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "			THEN		(SELECT NET_AMT AS OTHERDED  FROM   PAYTRAN_STAGE WHERE TRNCD = 213 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE		(SELECT 0 AS OTHERDED) END AS 'OTHERDED',"

							+ "		 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 223 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		THEN		(SELECT NET_AMT AS MEMDED  FROM   PAYTRAN_STAGE WHERE TRNCD = 223 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "		ELSE  (SELECT 0 AS MEMDED) END AS 'MEMDED',"

							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 228 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN		(SELECT NET_AMT AS TDS  FROM   PAYTRAN_STAGE WHERE TRNCD = 228 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE		(SELECT 0 AS TDS) END AS 'TDS',"

							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 211 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "			THEN		(SELECT NET_AMT AS MLWF  FROM   PAYTRAN_STAGE WHERE TRNCD = 211 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE	(SELECT 0 AS MLWF) END AS 'MLWF',"

							+ "	 CASE WHEN EXISTS(SELECT SUM(NET_AMT) FROM   PAYTRAN_STAGE WHERE TRNCD IN (244, 245, 246, 247) AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN		(SELECT SUM(NET_AMT) AS BANKLOAN  FROM   PAYTRAN_STAGE WHERE TRNCD IN (244, 245, 246, 247) AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE		(SELECT 0 AS BANKLOAN) END AS 'BANKLOAN'," +

							"	 CASE WHEN EXISTS(SELECT SUM(NET_AMT) FROM   PAYTRAN_STAGE WHERE TRNCD IN (248, 249) AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN		(SELECT SUM(NET_AMT) AS OTHERLOAN  FROM   PAYTRAN_STAGE WHERE TRNCD IN (248, 249) AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE		(SELECT 0 AS OTHERLOAN) END AS 'OTHERLOAN',"

							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 301 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	THEN		(SELECT NET_AMT AS ABSCENTDAYS  FROM   PAYTRAN_STAGE WHERE TRNCD = 301 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)"
							+ "	ELSE		(SELECT 0 AS ABSCENTDAYS) END AS 'ABSCENTDAYS',"


							+ "    case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "    and TRNCD not in(101,102,103,107,108,129)" + "    and trndt BETWEEN '" + BomDt
							+ "' and '" + EomDt + "' and EMPNO =  EMPMAST.EMPNO )"
							+ "	 THEN	(select SUM(net_amt) as addinc from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "    and TRNCD not in(101,102,103,107,108,129)" + "    and trndt BETWEEN '" + BomDt
							+ "' and '" + EomDt + "' and EMPNO =  EMPMAST.EMPNO) "
							+ "	 ELSE		(SELECT 0 AS addinc) END AS 'addinc',"

							+ "      case when EXISTS(select SUM(net_amt)   from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
							+ "     and TRNCD not in(201,202,205,212,213,223,228,211,248,249, 244, 245, 246, 247) and trndt BETWEEN '"
							+ BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO)"
							+ "	  THEN	(select SUM(net_amt)  as other from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
							+ "     and TRNCD not in(201,202,205,212,213,223,228,211,248,249, 244, 245, 246, 247) and trndt BETWEEN '"
							+ BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO)"
							+ "	  ELSE	(SELECT 0 AS other) END AS 'other' ,"

							+ "	  case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO)"
							+ "	  THEN			(select SUM(net_amt) as totded from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) "
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt
							+ "' and EMPNO = empmast.EMPNO)	" + "	  ELSE 	(SELECT 0 AS totded) END AS 'totded' ,"

							+ "	  case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO) "
							+ "	  THEN	(select SUM(net_amt) from   paytran_stage  where TRNCD in    (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO)"
							+ "	  ELSE		(SELECT 0 AS totear) END AS 'totear'"

							+ "     from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO , LOOKUP L "
							+ "  WHERE  T.DESIG=L.LKP_SRNO AND L.LKP_CODE='DESIG' AND   T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
							+ EomDt + "'" + "     and (( empmast.STATUS='A' AND	empmast.DOJ <= '" + EomDt
							+ "') or  (empmast.STATUS ='N' And empmast.DOL>='" + BomDt + "' )) )"
							+ "     AND T.EMPNO in (SELECT DISTINCT EMPNO FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '"
							//+ BomDt + "' and '" + EomDt + "') " + "     order by   t.PRJ_SRNO,empno  ";
							+ BomDt + "' and '" + EomDt + "') AND EMPLOYEE_TYPE IN("+emptype+") " +BranchCodeList+ "     order by   t.PRJ_SRNO,empno  ";
					System.out.println("newpayregwithNewFormat paytran_stage :" + EmpSql);
				}

				ResultSet rs = st.executeQuery(EmpSql);

				while (rs.next()) {

					String prj_name = null;
					String prj_code = null;

					Connection conn = ConnectionManager.getConnectionTech();

					Statement stmt = conn.createStatement();
					String prjquery = "select Site_Name,Project_Code from Project_Sites where SITE_ID = '"
							+ rs.getString("PRJ_SRNO") + "'";
					// System.out.println(prjquery);

					ResultSet prj = stmt.executeQuery(prjquery);

					if (prj.next()) {
						prj_name = prj.getString("Site_Name");
						prj_code = prj.getString("Project_Code");
					}

					pBrcd1 = rs.getString("PRJ_SRNO");
					br_tot_no_emp = 0;

					para = new Paragraph(new Phrase(
							"Employee's Salary List For Branch : " + prj_name + " (" + prj_code + ")", f));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(4);

					document.add(para);

					prj.close();
					stmt.close();
					conn.close();

					PdfPTable datatab;
					PdfPTable datatot;

					PdfPTable main = new PdfPTable(24);
					main.setSpacingBefore(10);
					
					main.setWidthPercentage(new float[] { 4, 9.0f, 3.0f,
							4.0f, 5.0f, 4.0f, 3.0f, 3.0f, 4.0f, 4.0f, 5.0f, 4.0f, 3.0f, 4.0f, 4.0f, 4.0f, 4.0f, 4.0f, 3.0f, 4.0f, 4.0f, 4.0f, 5.0f, 5.0f }, rec);

					main.setHorizontalAlignment(Element.ALIGN_LEFT);
					PdfPCell maincell;

					
					maincell = new PdfPCell(new Phrase("CODE", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					//maincell.setFixedHeight(50);
					//maincell.disableBorderSide(rec.BOTTOM);
					maincell.setFixedHeight(80f);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("EMPNAME", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					//maincell.disableBorderSide(rec.BOTTOM);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Days", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Basic", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("DA", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("HRA", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Dept All", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Conv All", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Other Spl All", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Add Income", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Tot income", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase("PF", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase("PT", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase("LIC", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase("Mediclaim", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase("Other Ded", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase("Mem Ded", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase("TDS", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase("MLWF", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase("Bank Loan", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase("Other Loan", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase("Extra Ded", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase("Tot Ded", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase("Net Pay", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					
					document.add(main);

					while (pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
						System.out.println("this is pbrcd...." + pBrcd1);
						float pageHeight = writer.getPageSize().getHeight();

						datatab = new PdfPTable(24);
						//datatab.setWidthPercentage(new float[] { 5, 17.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f }, rec);
						
						datatab.setWidthPercentage(new float[] { 4, 9.0f, 3.0f,
								4.0f, 5.0f, 4.0f, 3.0f, 3.0f, 4.0f, 4.0f, 5.0f, 4.0f, 3.0f, 4.0f, 4.0f, 4.0f, 4.0f, 4.0f, 3.0f, 4.0f, 4.0f, 4.0f, 5.0f, 5.0f }, rec);

						datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

					//	PdfPCell cell1 = new PdfPCell(new Phrase("" + rs.getString("EMPCODE"), f1));
						PdfPCell cell1 = new PdfPCell(new Phrase("" + rs.getString("EMPCODE"), fbold));
						cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						//cell1.setFixedHeight(50);
						//cell1.disableBorderSide(rec.BOTTOM);
						cell1.setFixedHeight(80f);
						datatab.addCell(cell1);

						//PdfPCell cell2 = new PdfPCell(new Phrase("" + rs.getString("name"), f));
						PdfPCell cell2 = new PdfPCell(new Phrase("" + rs.getString("name")+"\n\n" +rs.getString("DESIG"), fbold));
						//cell2.disableBorderSide(rec.BOTTOM);
						cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						datatab.addCell(cell2);
						
						System.out.println("DATE DAYS : "+EomDt.substring(0,2));
						String MonthDays = EomDt.substring(0,2);
						Float PresentDays = (Float.parseFloat(MonthDays) - rs.getFloat("ABSCENTDAYS"));
						
						PdfPCell cell111 = new PdfPCell(new Phrase("" + PresentDays, f1));
						cell111.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell111);
						
						basic_total = basic_total + rs.getFloat("BASIC");
						PdfPCell cell3 = new PdfPCell(new Phrase("" + rs.getFloat("BASIC"), f1));
						cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell3);

						da_total = da_total + rs.getFloat("DA");
						PdfPCell cell4 = new PdfPCell(new Phrase("" + rs.getFloat("DA"), f1));
						cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell4);

						hra_total = hra_total + +rs.getFloat("HRA");
						PdfPCell cell11 = new PdfPCell(new Phrase("" + rs.getFloat("HRA"), f1));
						cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell11);

						deptall_total = deptall_total + rs.getFloat("DEPTALL");
						PdfPCell cell5 = new PdfPCell(new Phrase("" + rs.getFloat("DEPTALL"), f1));
						cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell5);

						convall_total = convall_total + rs.getFloat("CONVALL");
						PdfPCell cell8 = new PdfPCell(new Phrase("" + rs.getFloat("CONVALL"), f1));
						cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell8);

						othersplall_total = othersplall_total + rs.getFloat("OTHERSPLALL");
						PdfPCell cell6 = new PdfPCell(new Phrase("" + rs.getFloat("OTHERSPLALL"), f1));
						cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell6);

						float add_inc = rs.getFloat("addinc");
						addinc_total = addinc_total + add_inc;
						PdfPCell cell23 = new PdfPCell(new Phrase("" + (int) add_inc + ".0", f1));
						cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell23);

						totinc_total = totinc_total + rs.getFloat("totear");
						PdfPCell cell25 = new PdfPCell(new Phrase("" + (int) rs.getFloat("totear") + ".0", f1));
						cell25.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell25);


						if (rs.getFloat("PF") == 0.0) {
							PdfPCell cell13 = new PdfPCell(new Phrase("" + rs.getFloat("PF"), f1));
							cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell13);
						} else {
							float pf = rs.getFloat("PF");
							pf_total = pf_total + pf;
							PdfPCell cell13 = new PdfPCell(new Phrase("" + pf, f1));
							cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell13);
						}

						if (rs.getFloat("PT") == 0.0f) {
							PdfPCell cell17 = new PdfPCell(new Phrase("" + rs.getFloat("PT"), f1));
							cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell17);
						} else {
							float pt = rs.getFloat("PT");
							pt_total = pt_total + pt;
							PdfPCell cell17 = new PdfPCell(new Phrase("" + pt, f1));
							cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell17);
						}

						if (rs.getFloat("LIC") == 0.0) {
							PdfPCell cell14 = new PdfPCell(new Phrase("" + rs.getFloat("LIC"), f1));
							cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell14);
						} else {
							float lic = rs.getFloat("LIC");
							lic_total = lic_total + lic;
							PdfPCell cell14 = new PdfPCell(new Phrase("" + lic, f1));
							cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell14);
						}

						if (rs.getFloat("MEDICLAIM") == 0.0f) {
							PdfPCell cell22 = new PdfPCell(new Phrase("" + rs.getFloat("MEDICLAIM"), f1));
							cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell22);
						} else {
							float mediclaim = rs.getFloat("MEDICLAIM");
							mediclaim_total = mediclaim_total + mediclaim;
							PdfPCell cell22 = new PdfPCell(new Phrase("" + mediclaim, f1));
							cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell22);
						}

						if (rs.getFloat("OTHERDED") == 0.0f) {
							PdfPCell cell19 = new PdfPCell(new Phrase("" + rs.getFloat("OTHERDED"), f1));
							cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell19);
						} else {
							float otherded = rs.getFloat("OTHERDED");
							otherded_total = otherded_total + otherded;
							PdfPCell cell19 = new PdfPCell(new Phrase("" + otherded, f1));
							cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell19);
						}

						if (rs.getFloat("MEMDED") == 0.0) {
							PdfPCell cell16 = new PdfPCell(new Phrase("" + rs.getFloat("MEMDED"), f1));
							cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell16);
						} else {
							float memded = rs.getFloat("MEMDED");
							memded_total = memded_total + memded;
							PdfPCell cell16 = new PdfPCell(new Phrase("" + memded, f1));
							cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell16);
						}

						if (rs.getFloat("TDS") == 0.0f) {
							PdfPCell cell18 = new PdfPCell(new Phrase("" + rs.getFloat("TDS"), f1));
							cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell18);
						} else {
							float tds = rs.getFloat("TDS");
							tds_total = tds_total + tds;
							PdfPCell cell18 = new PdfPCell(new Phrase("" + tds, f1));
							cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell18);
						}

						if (rs.getFloat("MLWF") == 0.0f) {
							PdfPCell cell21 = new PdfPCell(new Phrase("" + rs.getFloat("MLWF"), f1));
							cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell21);
						} else {
							float mlwf = rs.getFloat("MLWF");
							mlwf_total = mlwf_total + mlwf;
							PdfPCell cell21 = new PdfPCell(new Phrase("" + mlwf, f1));
							cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell21);
						}

						if (rs.getFloat("BANKLOAN") == 0.0) {
							PdfPCell cell15 = new PdfPCell(new Phrase("" + rs.getFloat("BANKLOAN"), f1));
							cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell15);
						} else {
							float bankloan = rs.getFloat("BANKLOAN");
							bankloan_total = bankloan_total + bankloan;
							PdfPCell cell15 = new PdfPCell(new Phrase("" + bankloan, f1));
							cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell15);
						}

						if (rs.getFloat("OTHERLOAN") == 0.0f) {
							PdfPCell cell20 = new PdfPCell(new Phrase("" + rs.getFloat("OTHERLOAN"), f1));
							cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell20);
						} else {
							float otherloan = rs.getFloat("OTHERLOAN");
							otherloan_total = otherloan_total + otherloan;
							PdfPCell cell20 = new PdfPCell(new Phrase("" + otherloan, f1));
							cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell20);
						}

						other_total = other_total + rs.getFloat("other");
						PdfPCell cell2131 = new PdfPCell(new Phrase("" + rs.getFloat("other"), f1));
						cell2131.disableBorderSide(rec.TOP);
						cell2131.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell2131);

						totded_total = totded_total + rs.getFloat("totded");
						PdfPCell cell26 = new PdfPCell(new Phrase("" + (int) rs.getFloat("totded") + ".0", f1));
						cell26.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell26);

						netpay_total = totinc_total - totded_total;
						// netpay_total = netpay_total + rs.getFloat("payable");
						System.out.println("Net Pay Total Old is:- " + netpay_total);
						// System.out.println("Add Income is:-
						// "+rs.getFloat("addinc"));
						PdfPCell cell27 = new PdfPCell(new Phrase("" + (int) rs.getFloat("payable") + ".0", f1));
						cell27.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell27);

						
						document.add(datatab);

						// Total of columns ...............

						tot_no_emp = tot_no_emp + 1;
						br_tot_no_emp = br_tot_no_emp + 1;
						if (!rs.next()) {
							break;
						}
						if (!pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
							rs.previous();
							break;
						}
					}

					datatot = new PdfPTable(23);
					
					datatot.setWidthPercentage(new float[] { 4, 9.0f, 
							4.0f, 5.0f, 4.0f, 4.0f, 4.0f, 4.0f, 4.0f, 5.0f, 4.0f, 4.0f, 4.0f, 4.0f, 4.0f, 4.0f, 4.0f, 3.0f, 4.0f, 4.0f, 4.0f, 5.0f, 5.0f }, rec);

					datatot.setHorizontalAlignment(Element.ALIGN_LEFT);

					PdfPCell cell1 = new PdfPCell(new Phrase("Total :--", fbold));
					cell1.setColspan(2);
					cell1.setFixedHeight(50);
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell1);

					PdfPCell cell3 = new PdfPCell(new Phrase("" + basic_total, f1));
					cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell3);
					lstbasic_total = lstbasic_total + basic_total;
					basic_total = 0.0f;

					PdfPCell cell4 = new PdfPCell(new Phrase("" + da_total, f1));
					cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell4);
					lstda_total = lstda_total + da_total;
					da_total = 0.0f;

					PdfPCell cell11 = new PdfPCell(new Phrase("" + hra_total, f1));
					cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell11);
					lsthra_total = lsthra_total + hra_total;
					hra_total = 0.0f;

					PdfPCell cell5 = new PdfPCell(new Phrase("" + deptall_total, f1));
					cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell5);
					lstdeptall_total = lstdeptall_total + deptall_total;
					deptall_total = 0.0f;

					PdfPCell cell8 = new PdfPCell(new Phrase("" + convall_total, f1));
					cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell8);
					lstconvall_total = lstconvall_total + convall_total;
					convall_total = 0.0f;

					PdfPCell cell6 = new PdfPCell(new Phrase("" + othersplall_total, f1));
					cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell6);
					lstothersplall_total = lstothersplall_total + othersplall_total;
					othersplall_total = 0.0f;

					PdfPCell cell23 = new PdfPCell(new Phrase("" + (int) addinc_total + ".0", f1));
					cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell23);
					lstaddinc_total = lstaddinc_total + addinc_total;
					addinc_total = 0.0f;

					PdfPCell cell25 = new PdfPCell(new Phrase("" + (int) totinc_total + ".0", fbold));
					cell25.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell25);

					System.out.println("~~~~~~~~before adding sitewise income~~~~~~~~~" + lsttotinc_total);

					lsttotinc_total = lsttotinc_total + totinc_total;

					System.out.println("@@@@@@@@@@@@@@@BRANCH ID--------->" + prj_name + "#####TOTAL INCOME------>"
							+ totinc_total);
					System.out.println("~~~~~~~~after adding sitewise income~~~~~~~~~" + lsttotinc_total);

					totinc_total = 0.0f;

					PdfPCell cell13 = new PdfPCell(new Phrase("" + pf_total, f1));
					cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell13);
					lstpf_total = lstpf_total + pf_total;
					pf_total = 0.0f;

					PdfPCell cell17 = new PdfPCell(new Phrase("" + pt_total, f1));
					cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell17);
					lstpt_total = lstpt_total + pt_total;
					pt_total = 0.0f;

					PdfPCell cell14 = new PdfPCell(new Phrase("" + lic_total, f1));
					cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell14);
					lstlic_total = lstlic_total + lic_total;
					lic_total = 0.0f;

					PdfPCell cell20 = new PdfPCell(new Phrase("" + mediclaim_total, f1));
					cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell20);
					lstmediclaim_total = lstmediclaim_total + mediclaim_total;
					mediclaim_total = 0.0f;

					PdfPCell cell19 = new PdfPCell(new Phrase("" + otherded_total, f1));
					cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell19);
					lstotherded_total = lstotherded_total + otherded_total;
					otherded_total = 0.0f;

					PdfPCell cell16 = new PdfPCell(new Phrase("" + memded_total, f1));
					cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell16);
					lstmemded_total = lstmemded_total + memded_total;
					memded_total = 0.0f;

					PdfPCell cell18 = new PdfPCell(new Phrase("" + tds_total, f1));
					cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell18);
					lsttds_total = lsttds_total + tds_total;
					tds_total = 0.0f;

					PdfPCell cell22 = new PdfPCell(new Phrase("" + mlwf_total, f1));
					cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell22);
					lstmlwf_total = lstmlwf_total + mlwf_total;
					mlwf_total = 0.0f;

					PdfPCell cell15 = new PdfPCell(new Phrase("" + bankloan_total, f1));
					cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell15);
					lstbankloan_total = lstbankloan_total + bankloan_total;
					bankloan_total = 0.0f;

					PdfPCell cell21 = new PdfPCell(new Phrase("" + otherloan_total, f1));
					cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell21);
					lstotherloan_total = lstotherloan_total + otherloan_total;
					otherloan_total = 0.0f;

					PdfPCell cell131 = new PdfPCell(new Phrase("" + other_total, f1));
					cell131.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell131);
					lstother_total = lstother_total + other_total;
					other_total = 0.0f;

					PdfPCell cell26 = new PdfPCell(new Phrase("" + totded_total, fbold));
					cell26.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell26);
					lsttotded_total = lsttotded_total + totded_total;

					System.out.println("@@@@@@@@@@@@@@@BRANCH ID--------->" + prj_name + "#####TOTAL INCOME------>"
							+ totded_total);

					totded_total = 0.0f;

					PdfPCell cell27 = new PdfPCell(new Phrase("" + (int) netpay_total + ".0", fbold));
					cell27.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell27);
					lstnetpay_total = lstnetpay_total + netpay_total;

					System.out.println("@@@@@@@@@@@@@@@BRANCH ID--------->" + prj_name + "#####TOTAL INCOME------>"
							+ netpay_total);

					netpay_total = 0.0f;


					document.add(datatot);


					para = new Paragraph(new Phrase("No Of Employee :- " + br_tot_no_emp, f));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(20);
					document.add(para);

				}

				para = new Paragraph(new Phrase("Total No Of Employee :- " + tot_no_emp, f));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(40);
				document.add(para);

				System.out.println("Total No Of Employee :- " + tot_no_emp);

				para = new Paragraph(new Phrase("-:Summary :- ", new Font(Font.HELVETICA, 40, Font.BOLDITALIC)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);
				document.add(para);

				PdfPTable main = new PdfPTable(10);
				main.setSpacingBefore(10);
				main.setWidthPercentage(new float[] { 9, 9, 9, 9, 9, 9, 9, 9, 9, 9 }, rec);
				PdfPCell maincell;

				maincell = new PdfPCell(new Phrase(" Basic Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstbasic_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" DA Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstda_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" HRA Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lsthra_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Dept All Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstdeptall_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Conv All Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstconvall_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Other Spl All Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstothersplall_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Add Income Total:-", f));
				maincell.setFixedHeight(50);
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstaddinc_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" PF Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstpf_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" PT Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstpt_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" LIC Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstlic_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Mediclaim Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstmediclaim_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Other Ded Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstotherded_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Member Ded Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstmemded_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" TDS Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lsttds_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" MLWF Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstmlwf_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Bank Loan Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstbankloan_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Other Loan Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstotherloan_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Other :-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lstother_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				// empty col
				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Tot income Total:-", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lsttotinc_total), "", "", false, false), fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Tot Ded. Total:-", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + trans((int) (lsttotded_total), "", "", false, false), fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Net Pay Total:-", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				float tttt = 0;
				ResultSet rsss;
				try {
					// System.out.println("date===="+date);
					Statement sttt = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);
		/*			rs = st.executeQuery("select sum(net_amt) from paytran where trndt between '"
							+ ReportDAO.BOM(PAYREGDT) + "' and '" + ReportDAO.EOM(PAYREGDT)
							+ "'  and trncd=999  union  "
							+ "select sum(net_amt) from paytran_stage where trndt between '" + ReportDAO.BOM(PAYREGDT)
							+ "' and '" + ReportDAO.EOM(PAYREGDT) + "'  and trncd=999 ");
		*/
					
					rs = st.executeQuery("select sum(net_amt) from paytran P, EMPMAST E, EMPTRAN T where E.EMPNO=P.EMPNO AND trndt between '"
							+ ReportDAO.BOM(PAYREGDT) + "' and '" + ReportDAO.EOM(PAYREGDT)
							+ "'  and P.trncd=999 AND EMPLOYEE_TYPE IN("+emptype+") AND E.EMPNO=T.EMPNO "
									+ "AND T.SRNO=(SELECT MAX(SRNO) FROM EMPTRAN ETA WHERE T.EMPNO=ETA.EMPNO)"+BranchCodeList
									+ "union  "
							+ "select sum(net_amt) from paytran_stage P, EMPMAST E, EMPTRAN T where E.EMPNO=P.EMPNO AND trndt between '" + ReportDAO.BOM(PAYREGDT)
							+ "' and '" + ReportDAO.EOM(PAYREGDT) + "'  and P.trncd=999 AND EMPLOYEE_TYPE IN("+emptype+") "
									+ "AND E.EMPNO=T.EMPNO AND T.SRNO=(SELECT MAX(SRNO) FROM EMPTRAN ETA WHERE T.EMPNO=ETA.EMPNO)"+BranchCodeList);
		
					System.out.println("CHECK QUERY : select sum(net_amt) from paytran P, EMPMAST E, EMPTRAN T where E.EMPNO=P.EMPNO AND trndt between '"
							+ ReportDAO.BOM(PAYREGDT) + "' and '" + ReportDAO.EOM(PAYREGDT)
							+ "'  and P.trncd=999 AND EMPLOYEE_TYPE IN("+emptype+") AND E.EMPNO=T.EMPNO "
									+ "AND T.SRNO=(SELECT MAX(SRNO) FROM EMPTRAN ETA WHERE T.EMPNO=ETA.EMPNO)"+BranchCodeList
									+ "union  "
							+ "select sum(net_amt) from paytran_stage P, EMPMAST E, EMPTRAN T where E.EMPNO=P.EMPNO AND trndt between '" + ReportDAO.BOM(PAYREGDT)
							+ "' and '" + ReportDAO.EOM(PAYREGDT) + "'  and P.trncd=999 AND EMPLOYEE_TYPE IN("+emptype+") "
									+ "AND E.EMPNO=T.EMPNO AND T.SRNO=(SELECT MAX(SRNO) FROM EMPTRAN ETA WHERE T.EMPNO=ETA.EMPNO)"+BranchCodeList);

			
					while (rs.next()) {
						tttt += rs.getFloat(1);
					}
				} catch (Exception e) {
					e.printStackTrace();
				}

				maincell = new PdfPCell(new Phrase("" + trans((int) (tttt), "", "", false, false), fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));

				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));

				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				document.add(main);

				document.add(Chunk.NEWLINE);
				document.add(Chunk.NEWLINE);
				document.add(Chunk.NEWLINE);
				document.add(Chunk.NEWLINE);

				para = new Paragraph(new Phrase(
						"Prepared By                         Checked By                        Approved By                 ",
						new Font(Font.TIMES_ROMAN, 35, Font.BOLD)));
				para.setAlignment(Element.ALIGN_RIGHT);
				para.setSpacingBefore(30);
				document.add(para);

				stmtInsert.close();
				stmtTrnct.close();
				st.close();
				con.close();
				document.close();

			}

		}

		catch (Exception e) {
			e.printStackTrace();
		}

	}

	
	
	public static void newpayregAccountwise(String PAYREGDT, String imgpath, String filepath, String type, String reptype, String emptype, String branchCode)
	{
		System.out.println("Hi newpayregAccountwise");
		
		String hname = "";
		Properties prop = new Properties();
		try {
			ClassLoader classLoader = Thread.currentThread().getContextClassLoader();
			InputStream stream = classLoader.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {
			System.out.println("Error in constant Properties " + e);
		}

		if (reptype.equalsIgnoreCase("paytran")) {
			hname = "Pre-Finalize";
		} else if (reptype.equalsIgnoreCase("paytran_stage")) {
			hname = "Finalize";
		} else {
			hname = "Release";
		}
		RepoartBean repBean = new RepoartBean();
		UtilityDAO dao = new UtilityDAO();
		Connection con = null;
		String BomDt = "";
		String EomDt = "";
		int lastdat = 0;

		String table_name = null;

		lastdat = (int) Calculate.getDays(PAYREGDT);
		BomDt = ReportDAO.BOM(PAYREGDT);
		EomDt = ReportDAO.EOM(PAYREGDT);

		String temp = PAYREGDT.substring(2);
		ResultSet emp = null;
		String EmpSql = "";
		String pBrcd1 = "";
		int tot_no_emp = 0;
		int br_tot_no_emp = 0;
		float totactualpay = 0.0f;

		try {
				ReportDAO.OpenCon("", "", "", repBean);
				con = repBean.getCn();
				Statement st = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);
				Statement stmtInsert = con.createStatement();
				Statement stmtTrnct = con.createStatement();

				DottedLineCell app = new DottedLineCell();

				// A4 size pdf....
				Document document = new Document(new Rectangle(1500, 2200));
				
				document.left(100f);
				document.top(100f);
				document.bottom(100f);
				document.right(100f);

				PdfWriter writer = PdfWriter.getInstance(document, new FileOutputStream(filepath));
				HeaderAndFooter_AccountWise haf = new HeaderAndFooter_AccountWise(lable1, label2);
				writer.setPageEvent(haf);
				document.open();
				Font FONT = new Font(Font.HELVETICA, 190, Font.NORMAL, new GrayColor(0.85f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER,
						new Phrase(prop.getProperty("watermark"), FONT), 1300f, 1830f, 45);
				Image image1 = Image.getInstance(imgpath);

				Phrase title = new Phrase(prop.getProperty("companyName"), new Font(FONT.TIMES_ROMAN, 22, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				image1.scaleAbsolute(210f, 100f);
				image1.setAbsolutePosition(60f, 2050f);

				document.add(image1);
				document.add(para);

				para = new Paragraph(new Phrase(prop.getProperty("addressForReport"), new Font(Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase(prop.getProperty("contactForReport"), new Font(Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase(prop.getProperty("mailForReport"), new Font(Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);

				document.add(para);

				Font f = new Font(Font.HELVETICA, 22);
				Font f1 = new Font(Font.HELVETICA, 22);
				Font fbold = new Font(Font.HELVETICA, 22, Font.BOLD);
				Font f2 = new Font(Font.HELVETICA, 22);

				para = new Paragraph(new Phrase("Salary Sheet AccountWise For The Month Of :- " + temp + " (" + hname + ")", new Font(Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);

				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(30);
				document.add(para);

				Rectangle rec = new Rectangle(100, 100);

				float netc_total = 0.0f;
				float lstnetc_total = 0.0f;
				float totinc_total = 0.0f;
				float lsttotinc_total = 0.0f;
				float totded_total = 0.0f;
				float lsttotded_total = 0.0f;
				float netpay_total = 0.0f;
				float lstnetpay_total = 0.0f;

				if(emptype.equalsIgnoreCase("4"))
				{
					emptype="1,2,3";
				}
				else if(emptype.equalsIgnoreCase("5")){
					emptype="0,1,2,3";
				}
				
				String BranchCodeList="";
				if(branchCode.equalsIgnoreCase("0"))
				{
					BranchCodeList = "";
				}
				else 
				{
					BranchCodeList = " AND t.BRANCH IN ("+branchCode+")";
				}

				
				if (reptype.equalsIgnoreCase("paytran")) {
					EmpSql = "  SELECT EMPCODE, (FNAME+' '+MNAME+' '+LNAME) AS NAME, ACNO, INP_AMT, CAL_AMT, NET_AMT, T.BRANCH FROM empmast E, EMPTRAN T, PAYTRAN_STAGE P "
							+ "WHERE E.EMPNO=T.EMPNO AND E.EMPNO=P.EMPNO AND P.TRNDT BETWEEN '"+BomDt+"' AND '"+EomDt+"' AND P.TRNCD=999 "
							+ "AND T.SRNO=(SELECT MAX(SRNO) FROM EMPTRAN ETA WHERE T.EMPNO=ETA.EMPNO) "
							+ "AND (( E.STATUS='A' AND	E.DOJ <= '"+EomDt+"') or  (E.STATUS ='N' And E.DOL>='"+BomDt+"' )) "
							+ "AND EMPLOYEE_TYPE IN("+emptype+") " +BranchCodeList  
							
							+ "    UNION "

							+ " SELECT EMPCODE, (FNAME+' '+MNAME+' '+LNAME) AS NAME, ACNO, INP_AMT, CAL_AMT, NET_AMT, T.BRANCH FROM empmast E, EMPTRAN T, PAYTRAN_STAGE P "
							+ "WHERE E.EMPNO=T.EMPNO AND E.EMPNO=P.EMPNO AND P.TRNDT BETWEEN '"+BomDt+"' AND '"+EomDt+"' AND P.TRNCD=999 "
							+ "AND T.SRNO=(SELECT MAX(SRNO) FROM EMPTRAN ETA WHERE T.EMPNO=ETA.EMPNO) "
							+ "AND (( E.STATUS='A' AND	E.DOJ <= '"+EomDt+"') or  (E.STATUS ='N' And E.DOL>='"+BomDt+"' )) "
							+ "AND EMPLOYEE_TYPE IN("+emptype+") " +BranchCodeList+ "     order by   t.BRANCH, e.empno    ";
					System.out.println("newpayregwithNewFormat ID :" + EmpSql);
				}

				else if (reptype.equalsIgnoreCase("ytdtran")) {
					EmpSql = "	SELECT EMPCODE, (FNAME+' '+MNAME+' '+LNAME) AS NAME, ACNO, INP_AMT, CAL_AMT, NET_AMT, T.BRANCH FROM empmast E, EMPTRAN T, YTDTRAN P "
							+ "WHERE E.EMPNO=T.EMPNO AND E.EMPNO=P.EMPNO AND P.TRNDT BETWEEN '"+BomDt+"' AND '"+EomDt+"' AND P.TRNCD=999 "
							+ "AND T.SRNO=(SELECT MAX(SRNO) FROM EMPTRAN ETA WHERE T.EMPNO=ETA.EMPNO) "
							+ "AND (( E.STATUS='A' AND	E.DOJ <= '"+EomDt+"') or  (E.STATUS ='N' And E.DOL>='"+BomDt+"' )) "
							+ "AND EMPLOYEE_TYPE IN("+emptype+") " +BranchCodeList+ "     order by   t.BRANCH, e.empno    ";
							System.out.println("newpayregwithNewFormat ytdtran :" + EmpSql);
				}

				else if (reptype.equalsIgnoreCase("paytran_stage")) {
					EmpSql = "SELECT EMPCODE, (FNAME+' '+MNAME+' '+LNAME) AS NAME, ACNO, INP_AMT, CAL_AMT, NET_AMT, T.BRANCH FROM empmast E, EMPTRAN T, PAYTRAN_STAGE P "
							+ "WHERE E.EMPNO=T.EMPNO AND E.EMPNO=P.EMPNO AND P.TRNDT BETWEEN '"+BomDt+"' AND '"+EomDt+"' AND P.TRNCD=999 "
							+ "AND T.SRNO=(SELECT MAX(SRNO) FROM EMPTRAN ETA WHERE T.EMPNO=ETA.EMPNO) "
							+ "AND (( E.STATUS='A' AND	E.DOJ <= '"+EomDt+"') or  (E.STATUS ='N' And E.DOL>='"+BomDt+"' )) "
							+ "AND EMPLOYEE_TYPE IN("+emptype+") " +BranchCodeList+ "     order by   t.BRANCH, e.empno  ";
					System.out.println("newpayregwithNewFormat paytran_stage :" + EmpSql);
				}

				ResultSet rs = st.executeQuery(EmpSql);

				while (rs.next()) {

					String prj_name = null;
					String prj_code = null;

					Connection conn = ConnectionManager.getConnectionTech();

					Statement stmt = conn.createStatement();
					String prjquery = "select Site_Name,Project_Code from Project_Sites where SITE_ID = '"+ rs.getString("BRANCH") + "'";

					ResultSet prj = stmt.executeQuery(prjquery);

					if (prj.next()) {
						prj_name = prj.getString("Site_Name");
						prj_code = prj.getString("Project_Code");
					}

					pBrcd1 = rs.getString("BRANCH");
					br_tot_no_emp = 0;

					para = new Paragraph(new Phrase("Employee's Salary List For Branch : " + prj_name + " (" + prj_code + ")", f));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(4);
					document.add(para);

					prj.close();
					stmt.close();
					conn.close();

					PdfPTable datatab;
					PdfPTable datatot;

					PdfPTable main = new PdfPTable(6);
					main.setSpacingBefore(10);
					main.setWidthPercentage(new float[] { 10f, 30.0f, 15.0f, 15.0f, 15.0f, 15.0f }, rec);
					main.setHorizontalAlignment(Element.ALIGN_LEFT);
					PdfPCell maincell;

					
					maincell = new PdfPCell(new Phrase("EMP CODE", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					maincell.setFixedHeight(80f);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("EMP NAME", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Account Number", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Total Income", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase("Total Deduction", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					maincell = new PdfPCell(new Phrase("Net Pay", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					document.add(main);

					while (pBrcd1.equals(rs.getString("BRANCH"))) {

						float pageHeight = writer.getPageSize().getHeight();

						datatab = new PdfPTable(6);
						datatab.setWidthPercentage(new float[] { 10f, 30.0f, 15.0f, 15.0f, 15.0f, 15.0f }, rec);
						datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

						PdfPCell cell1 = new PdfPCell(new Phrase("" + rs.getString("EMPCODE"), f1));
						cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						cell1.setFixedHeight(50f);
						datatab.addCell(cell1);

						PdfPCell cell2 = new PdfPCell(new Phrase("" + rs.getString("name"), f));
						cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
						datatab.addCell(cell2);

						PdfPCell cell3 = new PdfPCell(new Phrase("" + rs.getString("ACNO"), f1));
						cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
						datatab.addCell(cell3);

						totinc_total = totinc_total + rs.getFloat("INP_AMT");
						PdfPCell cell25 = new PdfPCell(new Phrase("" + (int) rs.getFloat("INP_AMT") + ".0", f1));
						cell25.setHorizontalAlignment(Element.ALIGN_CENTER);
						datatab.addCell(cell25);

						totded_total = totded_total + rs.getFloat("CAL_AMT");
						PdfPCell cell26 = new PdfPCell(new Phrase("" + (int) rs.getFloat("CAL_AMT") + ".0", f1));
						cell26.setHorizontalAlignment(Element.ALIGN_CENTER);
						datatab.addCell(cell26);

						netpay_total = netpay_total + rs.getFloat("NET_AMT");
						PdfPCell cell27 = new PdfPCell(new Phrase("" + (int) rs.getFloat("NET_AMT") + ".0", f1));
						cell27.setHorizontalAlignment(Element.ALIGN_CENTER);
						datatab.addCell(cell27);

						document.add(datatab);

						// Total of columns ...............

						tot_no_emp = tot_no_emp + 1;
						br_tot_no_emp = br_tot_no_emp + 1;
						if (!rs.next()) {
							break;
						}
						if (!pBrcd1.equals(rs.getString("BRANCH"))) {
							rs.previous();
							break;
						}
					}

					datatot = new PdfPTable(6);
					
					datatot.setWidthPercentage(new float[] { 10f, 30.0f, 15.0f, 15.0f, 15.0f, 15.0f }, rec);

					datatot.setHorizontalAlignment(Element.ALIGN_LEFT);

					PdfPCell cell1 = new PdfPCell(new Phrase("Total :--", fbold));
					cell1.setColspan(2);
					cell1.setFixedHeight(50);
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell1);

					PdfPCell cell25 = new PdfPCell(new Phrase("" + (int) totinc_total + ".0", fbold));
					cell25.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell25);

					lsttotinc_total = lsttotinc_total + totinc_total;
					totinc_total = 0.0f;

					PdfPCell cell26 = new PdfPCell(new Phrase("" + totded_total, fbold));
					cell26.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell26);
					lsttotded_total = lsttotded_total + totded_total;

					totded_total = 0.0f;

					PdfPCell cell27 = new PdfPCell(new Phrase("" + (int) netpay_total + ".0", fbold));
					cell27.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell27);
					lstnetpay_total = lstnetpay_total + netpay_total;

					System.out.println("@@@@@@@@@@@@@@@BRANCH ID--------->" + prj_name + "#####TOTAL INCOME------>"
							+ netpay_total);

					netpay_total = 0.0f;
					document.add(datatot);


					para = new Paragraph(new Phrase("No Of Employee :- " + br_tot_no_emp, f));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(20);
					document.add(para);

				}

				para = new Paragraph(new Phrase("Total No Of Employee :- " + tot_no_emp, f));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(40);
				document.add(para);

				System.out.println("Total No Of Employee :- " + tot_no_emp);

				para = new Paragraph(new Phrase("-:Summary :- ", new Font(Font.HELVETICA, 40, Font.BOLDITALIC)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);
				document.add(para);

				PdfPTable main = new PdfPTable(3);
				main.setSpacingBefore(3);
				main.setWidthPercentage(new float[] {30f, 30f, 30f }, rec);
				PdfPCell maincell;
		
				maincell = new PdfPCell(new Phrase(" Total Income  :-     " + trans((int) (lsttotinc_total), "", "", false, false), fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Total Deduction  :-     "+ trans((int) (lsttotded_total), "", "", false, false), fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				float tttt = 0;
				ResultSet rsss;
				try {

					Statement sttt = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);
					
					rs = st.executeQuery("select sum(net_amt) from paytran P, EMPMAST E, EMPTRAN T where E.EMPNO=P.EMPNO AND trndt between '"
							+ ReportDAO.BOM(PAYREGDT) + "' and '" + ReportDAO.EOM(PAYREGDT)
							+ "'  and P.trncd=999 AND EMPLOYEE_TYPE IN("+emptype+") AND E.EMPNO=T.EMPNO "
									+ "AND T.SRNO=(SELECT MAX(SRNO) FROM EMPTRAN ETA WHERE T.EMPNO=ETA.EMPNO)"+BranchCodeList
									+ "union  "
							+ "select sum(net_amt) from paytran_stage P, EMPMAST E, EMPTRAN T where E.EMPNO=P.EMPNO AND trndt between '" + ReportDAO.BOM(PAYREGDT)
							+ "' and '" + ReportDAO.EOM(PAYREGDT) + "'  and P.trncd=999 AND EMPLOYEE_TYPE IN("+emptype+") "
									+ "AND E.EMPNO=T.EMPNO AND T.SRNO=(SELECT MAX(SRNO) FROM EMPTRAN ETA WHERE T.EMPNO=ETA.EMPNO)"+BranchCodeList);
		
					while (rs.next()) {
						tttt += rs.getFloat(1);
					}
				} catch (Exception e) {
					e.printStackTrace();
				}

				maincell = new PdfPCell(new Phrase(" Total Net Pay  :-      "+ trans((int) (tttt), "", "", false, false), fbold));
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
								
				document.add(main);

				document.add(Chunk.NEWLINE);
				document.add(Chunk.NEWLINE);
				document.add(Chunk.NEWLINE);
				document.add(Chunk.NEWLINE);

				para = new Paragraph(new Phrase(
						"Prepared By                         Checked By                        Approved By                 ",
						new Font(Font.TIMES_ROMAN, 35, Font.BOLD)));
				para.setAlignment(Element.ALIGN_RIGHT);
				para.setSpacingBefore(30);
				document.add(para);

				stmtInsert.close();
				stmtTrnct.close();
				st.close();
				con.close();
				document.close();

		}

		catch (Exception e) {
			e.printStackTrace();
		}
	}
	
//Govi

public static void payregWithBranchPdf(String rdt, String type, String filepath, String imagepath) {
	
	RepoartBean repBean  = new RepoartBean();
	Connection Cn = null;
	ResultSet rs = null;
	String EmpSql = "";
	
	int i=1;
	int BranchTotalempno = 0;	
	int totalempno=0;

	String pBrcd1 = "";
	int tot_no_emp = 0;
	int br_tot_no_emp = 0;
	float totmthsal1 = 0.0f;
	float totearning1 = 0.0f;
	float totearning2 = 0.0f;
	float totactualpay = 0.0f;
	float totmobded = 0.0f;
	float totadvanc = 0.0f;
	float totloan = 0.0f;
	float tottds = 0.0f;
	
	
	float basic_total = 0.0f;
	float lstbasic_total = 0.0f;
	float lic_total = 0.0f;
	float lstlic_total = 0.0f;
	float hra_total = 0.0f;
	float lsthra_total = 0.0f;
	float medical_total = 0.0f;
	float lstmedical_total = 0.0f;
	float leave_TC = 0.0f;
	float lstleave_total = 0.0f;
	float any_total = 0.0f;
	float lstany_total = 0.0f;
	float edu_total = 0.0f;
	float lstedu_total = 0.0f;
	float splall_total = 0.0f;
	float lstsplall_total = 0.0f;
	float convall_total = 0.0f;
//	float specialAllo = 0.0f;
	float lstconvall_total = 0.0f;
	float pf_total = 0.0f;
	float lstpf_total = 0.0f;
	float pt_total = 0.0f;
	float lstpt_total = 0.0f;
	float mlwf_total = 0.0f;
	float lstmlwf_total = 0.0f;
	float otherdeduc_total = 0.0f;
	float lstotherdeduc_total = 0.0f;
	float other_total = 0.0f;
	float med_total = 0.0f;
	float ERP_total = 0.0f;
	float istotmed_total = 0.0f;
	float istotERPDED_total = 0.0f;
	float lstother_total = 0.0f;
	float esic_total = 0.0f;
	float lstesic_total = 0.0f;
	float mob_total = 0.0f;
	float lstmob_total = 0.0f;
	float adv_total = 0.0f;
	float lstadv_total = 0.0f;
	float tds_total = 0.0f;
	float lsttds_total = 0.0f;
	float relif_total = 0.0f;
	float lstrelif_total = 0.0f;
	float netc_total = 0.0f;
	float lstnetc_total = 0.0f;
	float minins_total = 0.0f;
	float lstminins_total = 0.0f;
	float addlss_total = 0.0f;
	float lstaddlss_total = 0.0f;
	float col_total = 0.0f;
	float lstcol_total = 0.0f;
	float special_total = 0.0f;
	float lstspecial_total = 0.0f;
	float addinc_total = 0.0f;
	float lstaddinc_total = 0.0f;
	int totinc_total = 0;
	float lsttotinc_total = 0.0f;
	float loan_total = 0.0f;
	float lstloan_total = 0.0f;
	float totded_total = 0.0f;
	float lsttotded_total = 0.0f;
	int netpay_total = 0;
	float lstnetpay_total = 0.0f;
	float da_total = 0.0f;
	float lstda_total = 0.0f;
		//new
	float deptall_total = 0.0f;
	float lstdeptall_total = 0.0f;
	
	
	float othersplall_total = 0.0f;
	float lstothersplall_total = 0.0f;
	float mediclaim_total = 0.0f;
	float lstmediclaim_total = 0.0f;
	float otherded_total = 0.0f;
	float lstotherded_total = 0.0f;
	float memded_total = 0.0f;
	float lstmemded_total = 0.0f;
	float bankloan_total = 0.0f;
	float lstbankloan_total = 0.0f;
	float otherloan_total = 0.0f;
	float lstotherloan_total = 0.0f;
	float vda_total=0.0f;
	float lstvda_total = 0.0f;
	float MediA_total=0.0f;
	float lstMediA_total = 0.0f;
	float EduA_total=0.0f;
	float lstEduA_total = 0.0f;
	float CLSG_total=0.0f;
	float lstCLSG_total = 0.0f;
	float ARRHRA_total=0.0f;
	float lstARRHRA_total = 0.0f;
	float AREAALL_total=0.0f;
	float lstAREAALL_total = 0.0f;
	float AREABDV_total=0.0f;
	float lstAREABDV_total = 0.0f;
	float SociDedc_total=0.0f;
	float lstSociDedc_total = 0.0f;
	float GrpInsU_total=0.0f;
	float lstGrpInsU_total=0.0f;
	float MLWFDed_total=0.0f;
	float lstMLWFDed_total = 0.0f;
	float CODS_total=0.0f;
	float lstCODS_total = 0.0f;
	float OtherLoan_total=0.0f;
	float lstOtherLoan_total = 0.0f;
	float DeathFund_total=0.0f;
	float lstDeathFund_total = 0.0f;
	float Unionsub_total=0.0f;
	float lstUnionsub_total = 0.0f;
	float LWPAmt_total=0.0f;
	float lstLWPAmt_total = 0.0f;
	float House_total=0.0f;
	float lstHouse_total = 0.0f;
	float Vehical_total=0.0f;
	float lstVehical_total = 0.0f;
	float Festival_total=0.0f;
	float lstFestival_total = 0.0f;
	float Personal_total=0.0f;
	float lstPersonal_total = 0.0f;
	float Stamp_total=0.0f;
	float lstStamp_total = 0.0f;
	float k = 0.0f;
	float lstK=0.0f;
	Connection con = null;
	
	Document doc = new Document(PageSize.A4.rotate());
	SimpleDateFormat output = new SimpleDateFormat("dd/MM/yyyy");
	String table=type.equalsIgnoreCase("before")?"PAYTRAN":"PAYTRAN_STAGE";	
	try{

		//Document doc = new Document();
	
		PdfWriter writer =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
		doc.open();
		
		Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));                 //35
		
		Image image1 = Image.getInstance(imagepath);
		
		Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.",new Font(FONT.TIMES_ROMAN,8,Font.BOLD));
		Paragraph para = new Paragraph(title);
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingBefore(0);
		doc.add(para);
		
		//image1.scaleAbsolute(70f, 70f);
		//image1.setAbsolutePosition(40f, 730f);
		/*image1.scaleAbsolute(100f, 80f);
		image1.setAbsolutePosition(105f, 490f);
		
		doc.add(image1);*/
   	
		para = new Paragraph(new Phrase("Rajan Complex Arcade, Datta Mandir, Nashik Road, Nashik - 422101",new Font(Font.TIMES_ROMAN,8)));
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingAfter(0);

		doc.add(para);
		para = new Paragraph(new Phrase("Tel : +91-20 26812190",new Font(Font.TIMES_ROMAN,8)));
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingAfter(0);

		doc.add(para);
		para = new Paragraph(new Phrase("Email : ",new Font(Font.TIMES_ROMAN,8)));
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingAfter(0);
		
		doc.add(para);
		para = new Paragraph(new Phrase("Branch Wise PayRegister Report "+rdt.substring(3)+"  "+(type.equalsIgnoreCase("before")?" (Before Finalize)":"(After Finalize)"),new Font(Font.TIMES_ROMAN,10)));
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingAfter(30);
		doc.add(para);

		PdfPTable tab = new PdfPTable(14);
		//tab.setWidthPercentage(new float[]{6,16,6,3,6,3,3,3,14,6,6,8,10,10}, new Rectangle(100, 100));
		tab.setSpacingBefore(5); 
		tab.setHorizontalAlignment(Element.ALIGN_CENTER);
		
		tab.setHeaderRows(1);
		ReportDAO.OpenCon("", "", "",repBean);
		Cn = repBean.getCn();
		
		
	
		EmpSql  ="WITH empcount "
					+ "     AS (SELECT Count(e.empno) AS emptotal, "
					+ "                t.site_name, "
					+ "                et.prj_srno    AS siteId "
					+ "         FROM   emptran et, "
					+ "                empmast e, "
					+ "                project_sites t "
					+ "         WHERE  e.empno = et.empno "
					+ "                AND t.site_id = et.prj_srno "
					+ "                AND et.srno = (SELECT Max(srno) "
					+ "                               FROM   emptran "
					+ "                               WHERE  empno = E.empno) "
					+ "                AND ( ( E.status = 'A' "
					+ "                        AND E.doj <= '"+ReportDAO.EOM(rdt)+"' ) "
					+ "                       OR ( E.status = 'N' "
					+ "                            AND E.dol >= '"+ReportDAO.BOM(rdt)+"' ) ) "
					+ "         GROUP  BY t.site_name, "
					+ "                   et.prj_srno) "
					+ "SELECT * "
					+ "FROM   (SELECT site_name, "
					+ "               cnt.siteid, "
					+ "               cnt.emptotal, "
					+ "               Sum(CASE trncd "
					+ "                     WHEN 101 THEN net_amt "
					+ "                     ELSE 0 "
					+ "                   END) AS basic, "
					+ "               Sum(CASE "
					+ "                     WHEN trncd = 102 THEN net_amt "
					+ "                     ELSE 0 "
					+ "                   END) AS da, "
					+ "               "
					+ "               Sum(CASE "
					+ "                     WHEN trncd = 103 THEN net_amt "
					+ "                     ELSE 0 "
					+ "                   END) AS hra, "
					+ "                Sum(CASE "
					+ "                 WHEN trncd = 107 THEN net_amt "
					+ "                 ELSE 0 "
					+ "               END) AS DeptAll, "
					+ "                        "
					+ "               Sum(CASE "
					+ "                     WHEN trncd = 108 THEN net_amt "
					+ "                     ELSE 0 "
					+ "                   END) AS convall, "
					+ "            Sum(CASE "
					+ "				 WHEN trncd = 129 THEN net_amt "
					+ "				 ELSE 0 "
					+ "			   END) AS specialAllo, "
					+ "                          "
					+ "               Sum(CASE "
					+ "                    WHEN trncd = 132 THEN net_amt "
					+ "                     ELSE 0 "
					+ "                   END) AS ADD_Income, "
					+ "                                        "
					+ "               Sum(CASE "
					+ "                     WHEN trncd = 999 THEN inp_amt "
					+ "                     ELSE 0 "
					+ "                   END) AS Total_Income, "
					+ "                    "
					+ "               Sum(CASE "
					+ "                     WHEN trncd = 201 THEN net_amt "
					+ "                     ELSE 0 "
					+ "                   END) AS PF, "
					+ "               Sum(CASE "
					+ "                     WHEN trncd = 202 THEN net_amt "
					+ "                     ELSE 0 "
					+ "                   END) AS PT, "
					+ "               Sum(CASE "
					+ "                     WHEN trncd = 205 THEN net_amt "
					+ "                     ELSE 0 "
					+ "                   END) AS LIC, "
					+ "             "
					+ "             Sum(CASE "
					+ "                     WHEN trncd = 212 THEN net_amt "
					+ "                     ELSE 0 "
					+ "                   END) AS MEDICLAIM, "
					+ "			  Sum(CASE "
					+ "				 WHEN trncd = 213 THEN net_amt "
					+ "				 ELSE 0 "
					+ "			   END) AS otherdeduc, "
					+ "			    "
					+ "			     Sum(CASE "
					+ "                     WHEN trncd = 223 THEN net_amt "
					+ "                     ELSE 0 "
					+ "                   END) AS MEMBER_DEDUCTION, "
					+ "                    "
					+ "                     Sum(CASE "
					+ "                 WHEN trncd = 228 THEN net_amt "
					+ "                     ELSE 0 "
					+ "                   END) AS TDS, "
					+ "                  Sum(CASE "
					+ "                     WHEN trncd = ( CASE "
					+ "                                      WHEN Month('"+ReportDAO.EOM(rdt)+"') = 5 THEN 220 "
					+ "                                      ELSE 211 "
					+ "                                    END ) THEN net_amt "
					+ "                     ELSE 0 "
					+ "                   END) AS MLWF, "
					+ "               Sum(CASE "
					+ "                     WHEN trncd = 248 THEN net_amt "
					+ "                     ELSE 0 "
					+ "                   END) AS BANKINST, "
					+ "                    "
					+ "                    "
					+ "                 Sum(CASE "
					+ "                     WHEN trncd = 226 THEN net_amt "
					+ "                     ELSE 0 "
					+ "                   END) AS otherloan, "
					+ "                    "
					+ "                    "
					+ "                    Sum(CASE "
					+ "                     WHEN trncd NOT IN ( 201, 202, 205, 206, "
					+ "                                         207, 211, 212, 216, "
					+ "                                         226, 228, 230, 242, "
					+ "                                         243, 244, 245, 246, "
					+ "                                         247, 248, 250 ) THEN net_amt "
					+ "                     ELSE 0 "
					+ "                   END) AS other, "
					+ "                 Sum(CASE "
					+ "                     WHEN trncd = 999 THEN cal_amt "
					+ "                     ELSE 0 "
					+ "                   END) AS Total_Deduction, "
					+ "                    "
					+ "                 Sum(CASE "
					+ "                     WHEN trncd = 999 THEN net_amt "
					+ "                     ELSE 0 "
					+ "                   END) AS netPay "
					+ "                    "
					+ "              FROM   (SELECT p.trncd        AS trncd, "
					+ "                       Sum(p.net_amt) AS net_amt, "
					+ "                       Sum(p.inp_amt) AS inp_amt, "
					+ "                       Sum(p.cal_amt) AS cal_amt, "
					+ "                       et.prj_srno    AS siteId "
					+ "                FROM   "+type+" p, "
					+ "                       emptran et, "
					+ "                       empmast e, "
					+ "                       project_sites t "
					+ "                WHERE  e.empno = et.empno "
					+ "                       AND et.empno = p.empno "
					+ "                       AND t.site_id = et.prj_srno "
					+ "                       AND p.trndt BETWEEN '"+ReportDAO.BOM(rdt)+"' AND '"+ReportDAO.EOM(rdt)+"' "
					+ "                       AND et.srno = (SELECT Max(srno) "
					+ "                                      FROM   emptran "
					+ "                                      WHERE  empno = E.empno) "
					+ "                       AND ( ( E.status = 'A' "
					+ "                               AND E.doj <= '"+ReportDAO.EOM(rdt)+"' ) "
					+ "                              OR ( E.status = 'N' "
					+ "                                   AND E.dol >= '"+ReportDAO.BOM(rdt)+"' ) ) "
					+ "                       AND p.trncd NOT IN( 301, 302 ) "
					+ "                GROUP  BY p.trncd, "
					+ "                          et.prj_srno, "
					+ "                          t.site_name) AS sss, "
					+ "               empcount cnt "
					+ "        WHERE  cnt.siteid = sss.siteid "
					+ "        GROUP  BY cnt.siteid, "
					+ "                  site_name, "
					+ "                  emptotal) cnt "
					+ "WHERE  cnt.basic != 0.00";
							
		System.out.println("query is   "+EmpSql);
				

		Statement st;
		PdfPTable datatab;
		PdfPTable datatot;
		PdfPTable datatot1;
		//System.out.println(table+"----"+EmpSql);
		st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY);
		rs = st.executeQuery(EmpSql);
		//System.out.println("after exicute !!!!");
		
		/*Font f = new Font(Font.HELVETICA,8);
		Font f1 = new Font(Font.HELVETICA,7);
		Font fbold = new Font(Font.TIMES_ROMAN,8,Font.BOLD);
		Font fsmall = new Font(Font.TIMES_ROMAN,7);*/

		Font f = new Font(Font.HELVETICA,9);
		Font f1 = new Font(Font.HELVETICA,8);
		Font fbold = new Font(Font.TIMES_ROMAN,9,Font.BOLD);
		Font fsmall = new Font(Font.TIMES_ROMAN,8);
		Font  fontcolor = FontFactory.getFont(FontFactory.HELVETICA, 10, new Color(6, 8, 193));
		
		//Font  fontcolor = FontFactory.getFont(FontFactory.HELVETICA, 9, new Color(6, 8, 193));
		Rectangle rec = new Rectangle(100, 100);    
		
		if(rs.next()){
			
			PdfPTable main = new PdfPTable(15);
			main.setSpacingBefore(5);                      
			main.setWidthPercentage(new float[] { 3, 15.0f, 5.3f, 5.3f,5.3f, 6.0f, 6.0f, 6.0f, 5.3f, 5.3f, 5.3f, 5.3f,5.3f, 5.3f, 5.3f }, rec);
			main.setHorizontalAlignment(Element.ALIGN_LEFT);
			PdfPCell maincell;

			maincell = new PdfPCell(new Phrase("Br C", fbold));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			maincell.setFixedHeight(25);        //20             
			maincell.disableBorderSide(rec.BOTTOM);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" Branch Name", fbold));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			maincell.disableBorderSide(rec.BOTTOM);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Basic", fbold));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("DA", fbold));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);
			
			maincell = new PdfPCell(new Phrase("HRA", fbold));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);
			
			maincell = new PdfPCell(new Phrase("Dept All", fbold));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);
			
			maincell = new PdfPCell(new Phrase("Conv All", fbold));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);
			
			maincell = new PdfPCell(new Phrase("Other Spl All", fbold));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);
			
			maincell = new PdfPCell(new Phrase("Add Income", fbold));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" ", fbold));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" ", fbold));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("   ", fbold));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" ", fbold));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Tot Income", fbold));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);
			
			maincell = new PdfPCell(new Phrase(" ", fbold));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);
			
			
			doc.add(main);				

			datatab = new PdfPTable(15);
			datatab.setWidthPercentage(new float[] { 3, 15.0f, 5.3f, 5.3f,5.3f, 6.0f, 6.0f, 6.0f, 5.3f, 5.3f, 5.3f, 5.3f,5.3f, 5.3f, 5.3f }, rec);
			datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

			PdfPCell maincell1 = new PdfPCell(new Phrase("", fbold));
			maincell1.disableBorderSide(rec.TOP);
			maincell1.setFixedHeight(20);
			datatab.addCell(maincell1);

			PdfPCell maincell2 = new PdfPCell(new Phrase("Total Employee", fbold));
			maincell2.disableBorderSide(rec.TOP);
			maincell2.setFixedHeight(20);
			datatab.addCell(maincell2);

			PdfPCell maincell3 = new PdfPCell(new Phrase("PF", fbold));
			maincell3.setHorizontalAlignment(Element.ALIGN_CENTER);
			datatab.addCell(maincell3);

			PdfPCell maincell4 = new PdfPCell(new Phrase("PT", fbold));
			maincell4.setHorizontalAlignment(Element.ALIGN_CENTER);
			datatab.addCell(maincell4);

			PdfPCell maincell5 = new PdfPCell(new Phrase("LIC", fbold));
			maincell5.setHorizontalAlignment(Element.ALIGN_CENTER);
			datatab.addCell(maincell5);
			
			PdfPCell maincell90 = new PdfPCell(new Phrase("Mediclaim", fbold));
			maincell5.setHorizontalAlignment(Element.ALIGN_CENTER);
			datatab.addCell(maincell90);
			
			PdfPCell maincell10 = new PdfPCell(new Phrase("Other Ded", fbold));
			maincell10.setHorizontalAlignment(Element.ALIGN_CENTER);
			datatab.addCell(maincell10);

			PdfPCell maincell80 = new PdfPCell(new Phrase("Mem Ded..", fbold));
			maincell10.setHorizontalAlignment(Element.ALIGN_CENTER);
			datatab.addCell(maincell80);

			
			PdfPCell maincell6 = new PdfPCell(new Phrase("TDS.", fbold));
			maincell6.setHorizontalAlignment(Element.ALIGN_CENTER);
			datatab.addCell(maincell6);

			PdfPCell maincell7 = new PdfPCell(new Phrase("MLWF", fbold));
			maincell7.setHorizontalAlignment(Element.ALIGN_CENTER);
			datatab.addCell(maincell7);

			PdfPCell maincell8 = new PdfPCell(new Phrase("Bank Loan ", fbold));
			maincell8.setHorizontalAlignment(Element.ALIGN_CENTER);
			datatab.addCell(maincell8);

			PdfPCell maincell9 = new PdfPCell(new Phrase("Other Loan", fbold));
			maincell9.setHorizontalAlignment(Element.ALIGN_CENTER);
			datatab.addCell(maincell9);
			
			PdfPCell maincell11 = new PdfPCell(new Phrase("Other ", fbold));
			maincell11.setHorizontalAlignment(Element.ALIGN_CENTER);
			datatab.addCell(maincell11);
			
			PdfPCell maincell12 = new PdfPCell(new Phrase("Tot Ded", fbold));
			maincell12.setHorizontalAlignment(Element.ALIGN_CENTER);
			datatab.addCell(maincell12);

			
			PdfPCell maincell111 = new PdfPCell(new Phrase("Net Pay", fbold));
			maincell111.disableBorderSide(rec.TOP);
			maincell111.setHorizontalAlignment(Element.ALIGN_CENTER);
			datatab.addCell(maincell111);
			doc.add(datatab);
			
		}
		   rs.previous();
				while (rs.next()){
																		
				float pageHeight = writer.getPageSize().getHeight();

				datatab = new PdfPTable(15);
				datatab.setWidthPercentage(new float[] { 3, 15.0f, 5.3f, 5.3f,5.3f, 6.0f, 6.0f, 6.0f, 5.3f, 5.3f, 5.3f, 5.3f,5.3f, 5.3f, 5.3f }, rec);
				datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

				PdfPCell cell1 = new PdfPCell(new Phrase("" + rs.getString("siteid"), f1));
				cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
				cell1.setFixedHeight(20);
				cell1.disableBorderSide(rec.BOTTOM);
				datatab.addCell(cell1);

				PdfPCell cell2 = new PdfPCell(new Phrase("" + rs.getString("site_name"), f));
				cell2.disableBorderSide(rec.BOTTOM);
				cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(cell2);

				basic_total = basic_total + rs.getFloat("basic");
				PdfPCell cell3 = new PdfPCell(new Phrase("" + rs.getFloat("basic"), f1));
				cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatab.addCell(cell3);

				da_total = da_total + rs.getFloat("da");
				PdfPCell cell4 = new PdfPCell(new Phrase("" + rs.getFloat("da"), f1));
				cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatab.addCell(cell4);

				
				
				hra_total = hra_total + +rs.getFloat("hra");
				PdfPCell cell11 = new PdfPCell(new Phrase("" + rs.getFloat("hra"), f1));
				cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatab.addCell(cell11);
				
				//new
				deptall_total = deptall_total + +rs.getFloat("DeptAll");
				PdfPCell cell201 = new PdfPCell(new Phrase("" + rs.getFloat("DeptAll"), f1));
				cell201.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatab.addCell(cell201);
				
				convall_total = convall_total + rs.getFloat("convall");
				PdfPCell cell8 = new PdfPCell(new Phrase("" + rs.getFloat("convall"), f1));
				cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatab.addCell(cell8);
				
				splall_total = splall_total + rs.getFloat("specialAllo");
				PdfPCell cell6 = new PdfPCell(new Phrase("" + rs.getFloat("specialAllo"), f1));
				cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatab.addCell(cell6);

				float add_inc = rs.getFloat("ADD_Income");
				addinc_total = addinc_total + add_inc;
				PdfPCell cell23 = new PdfPCell(new Phrase("" + (int) addinc_total + ".0", f1));
				cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatab.addCell(cell23);
				
				
				PdfPCell cell33 = new PdfPCell(new Phrase("" , f1));
				cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatab.addCell(cell33);
				
				PdfPCell cell34 = new PdfPCell(new Phrase("" , f1));
				cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatab.addCell(cell34);
				PdfPCell cell35 = new PdfPCell(new Phrase("" , f1));
				cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatab.addCell(cell35);
				PdfPCell cell36 = new PdfPCell(new Phrase("" , f1));
				cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatab.addCell(cell36);
			
				
				
				
				totinc_total = (int) (totinc_total + rs.getFloat("Total_Income"));
				//System.out.println("totinc_total :"+totinc_total);
				PdfPCell cell25 = new PdfPCell(new Phrase("" + (int) rs.getFloat("Total_Income") + ".0", f1));
				cell25.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatab.addCell(cell25);
				
				PdfPCell cell37 = new PdfPCell(new Phrase("" , f1));
				cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatab.addCell(cell37);

				
				doc.add(datatab);
				
				

				datatab = new PdfPTable(15);
				datatab.getDefaultCell().setBorder(PdfPCell.NO_BORDER);
				datatab.setWidthPercentage(new float[] { 3, 15.0f, 5.3f, 5.3f,5.3f, 6.0f, 6.0f, 6.0f, 5.3f, 5.3f, 5.3f, 5.3f,5.3f, 5.3f, 5.3f }, rec);
				datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

				PdfPCell cell113 = new PdfPCell(new Phrase("", f1));
				cell113.setFixedHeight(20);
				cell113.disableBorderSide(rec.TOP);
				datatab.addCell(cell113);

				int etot=rs.getInt("emptotal");
				PdfPCell cell209 = new PdfPCell(new Phrase(""+rs.getInt("emptotal") , f1));
				 totalempno= totalempno + etot;
				cell209.disableBorderSide(rec.TOP);
				datatab.addCell(cell209);


				if (rs.getFloat("PF") == 0.0) {
					PdfPCell cell13 = new PdfPCell(new Phrase("" + rs.getFloat("PF"), f1));
					cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell13);
				} else {
					float pf = rs.getFloat("PF");
					pf_total = pf_total + pf;
					PdfPCell cell13 = new PdfPCell(new Phrase("" + pf, f1));
					cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell13);
				}

				if (rs.getFloat("PT") == 0.0f) {
					PdfPCell cell17 = new PdfPCell(new Phrase("" + rs.getFloat("PT"), f1));
					cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell17);
				} else {
					float pt = rs.getFloat("PT");
					pt_total = pt_total + pt;
					PdfPCell cell17 = new PdfPCell(new Phrase("" + pt, f1));
					cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell17);
				}

				if (rs.getFloat("LIC") == 0.0) {
					PdfPCell cell14 = new PdfPCell(new Phrase("" + rs.getFloat("LIC"), f1));
					cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell14);
				} else {
					float lic = rs.getFloat("LIC");
					lic_total = lic_total + lic;
					PdfPCell cell14 = new PdfPCell(new Phrase("" + lic, f1));
					cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell14);
				}
				
				
				if (rs.getFloat("MEDICLAIM") == 0.0) {
					PdfPCell cell203 = new PdfPCell(new Phrase("" + rs.getFloat("MEDICLAIM"), f1));
					cell203.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell203);
				} else {
					float medDed = rs.getFloat("MEDICLAIM");
					mediclaim_total = mediclaim_total + medDed;
					PdfPCell cell203 = new PdfPCell(new Phrase("" +medDed, f1));
					cell203.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell203);
				}
				
				
				if (rs.getFloat("otherdeduc") == 0.0f) {
					PdfPCell cell22 = new PdfPCell(new Phrase("" + rs.getFloat("otherdeduc"), f1));
					cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell22);
				} else {
					float otherdeduc = rs.getFloat("otherdeduc");
					otherdeduc_total = otherdeduc_total + otherdeduc;
					PdfPCell cell22 = new PdfPCell(new Phrase("" + otherdeduc, f1));
					cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell22);
				}
				
				
				if (rs.getFloat("MEMBER_DEDUCTION") == 0.0f) {
					PdfPCell cell22 = new PdfPCell(new Phrase("" + rs.getFloat("MEMBER_DEDUCTION"), f1));
					cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell22);
				} else {
					float memdedtotal = rs.getFloat("MEMBER_DEDUCTION");
					memded_total = memded_total + memdedtotal;
					PdfPCell cell22 = new PdfPCell(new Phrase("" + memdedtotal, f1));
					cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell22);
				}
				
				
				
				
				
				if (rs.getFloat("TDS") == 0.0) {
					PdfPCell cell203 = new PdfPCell(new Phrase("" + rs.getFloat("TDS"), f1));
					cell203.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell203);
				} else {
					float tdstotal = rs.getFloat("TDS");
					tds_total = tds_total + tdstotal;
					PdfPCell cell203 = new PdfPCell(new Phrase("" +tdstotal, f1));
					cell203.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell203);
				}
				
				if (rs.getFloat("MLWF") == 0.0f) {
					PdfPCell cell21 = new PdfPCell(new Phrase("" + rs.getFloat("MLWF"), f1));
					cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell21);
				} else {
					float mlwf = rs.getFloat("MLWF");
					mlwf_total = mlwf_total + mlwf;
					PdfPCell cell21 = new PdfPCell(new Phrase("" + mlwf, f1));
					cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell21);
				}
				
				
				if (rs.getFloat("BANKINST") == 0.0f) {
					PdfPCell cell21 = new PdfPCell(new Phrase("" + rs.getFloat("BANKINST"), f1));
					cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell21);
				} else {
					float bankLoan = rs.getFloat("BANKINST");
					bankloan_total = bankloan_total + bankLoan;
					PdfPCell cell21 = new PdfPCell(new Phrase("" + bankLoan, f1));
					cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell21);
				}
				
				if (rs.getFloat("otherloan") == 0.0f) {
					PdfPCell cell206 = new PdfPCell(new Phrase("" + rs.getFloat("otherloan"), f1));
					cell206.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell206);
				} else {
					float OtherLoan = rs.getFloat("otherloan");
					OtherLoan_total =OtherLoan_total + OtherLoan;
					PdfPCell cell206 = new PdfPCell(new Phrase("" +OtherLoan, f1));
					cell206.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell206);
				}
			
				
				
				
			/*	if (rs.getFloat("deathfund") == 0.0f) {
					PdfPCell cell207 = new PdfPCell(new Phrase("" + rs.getFloat("deathfund"), f1));
					cell207.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell207);
				} else {
					float DeathFund = rs.getFloat("deathfund");
					DeathFund_total = DeathFund_total + DeathFund;
					PdfPCell cell207 = new PdfPCell(new Phrase("" +DeathFund, f1));
					cell207.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell207);
				}
				
				
				*/

				other_total = other_total + rs.getFloat("other");
				PdfPCell cell2131 = new PdfPCell(new Phrase("" + rs.getFloat("other"), f1));
				cell2131.disableBorderSide(rec.TOP);
				cell2131.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatab.addCell(cell2131);
				
				

				totded_total = totded_total + rs.getFloat("Total_Deduction");
				PdfPCell cell26 = new PdfPCell(new Phrase("" + (int) rs.getFloat("Total_Deduction") + ".0", f1));
				cell26.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatab.addCell(cell26);

				
				netpay_total=(int) (netpay_total+rs.getFloat("netPay"));
				PdfPCell cell1526 = new PdfPCell(new Phrase(""+rs.getFloat("netPay") , f1));
				cell1526.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatab.addCell(cell1526);
				
				
				doc.add(datatab);
				
				
				tot_no_emp = tot_no_emp + 1;
				br_tot_no_emp = br_tot_no_emp + 1;

				
			
				
				// Total of columns ...............

				
				/*if (!rs.next()) {
					break;
				}
				if (!pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
					rs.previous();
					break;
				}
			}	*/
			
				}
				
			//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
				
				
				doc.newPage();

				para = new Paragraph(new Phrase("-:Summary :- ", new Font(Font.HELVETICA, 15, Font.BOLDITALIC)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(20);
				doc.add(para);

				PdfPTable main1 = new PdfPTable(10);
				main1.setSpacingBefore(20);
				main1.setWidthPercentage(new float[] { 10, 9, 10, 9, 10, 9, 10, 9, 10, 9 }, rec);
				PdfPCell maincell0;

				maincell0 = new PdfPCell(new Phrase(" Basic Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setFixedHeight(20);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (basic_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase(" DA Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (da_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);
				
				/*maincell0 = new PdfPCell(new Phrase(" VDA Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (vda_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);*/

				maincell0 = new PdfPCell(new Phrase(" HRA Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);
				
				maincell0 = new PdfPCell(new Phrase("" + trans((int) (hra_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);
				
				maincell0 = new PdfPCell(new Phrase(" DEPT ALLOW Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (deptall_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);
				
				/*maincell0 = new PdfPCell(new Phrase(" EDUCATION ALLOW Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setFixedHeight(20);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (EduA_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);*/
				
				maincell0 = new PdfPCell(new Phrase(" CONV ALLOW Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (convall_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);
				
				maincell0 = new PdfPCell(new Phrase(" SPECIAL ALLOW Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (splall_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);
				
				/*maincell0 = new PdfPCell(new Phrase(" CLSG ALLOW Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);
				
				maincell0 = new PdfPCell(new Phrase("" + trans((int) (CLSG_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);
				
				maincell0 = new PdfPCell(new Phrase(" ARREARSHRA Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (ARRHRA_total), "", "", false, false), f));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);
				
				maincell0 = new PdfPCell(new Phrase(" ARREAALL Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setFixedHeight(20);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (AREAALL_total), "", "", false, false), f));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);
				
				maincell0 = new PdfPCell(new Phrase(" AREABDV Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (AREABDV_total), "", "", false, false), f));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);*/
				
				maincell0 = new PdfPCell(new Phrase(" Add Income Total:-", f));
				maincell0 = new PdfPCell(new Phrase("", fbold));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (addinc_total), "", "", false, false), f1));
				maincell0 = new PdfPCell(new Phrase("", fbold));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);
				
				
				
				lsttotinc_total=lsttotinc_total+totinc_total;

				maincell0 = new PdfPCell(new Phrase("", fbold));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main1.addCell(maincell0);

				

				maincell0 = new PdfPCell(new Phrase("", fbold));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("", fbold));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("", fbold));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase(" PF Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setFixedHeight(20);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (pf_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase(" PT Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (pt_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase(" LIC Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (lic_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase(" Mediclaim Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setFixedHeight(20);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);
				maincell0 = new PdfPCell(new Phrase("" + trans((int) (mediclaim_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);
				
				maincell0 = new PdfPCell(new Phrase(" Other Ded Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (otherded_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase(" Member Ded Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (memded_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);
				
				
				maincell0 = new PdfPCell(new Phrase(" TDS Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (tds_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);
				
				maincell0 = new PdfPCell(new Phrase(" MLWFDED Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (mlwf_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);
				
				maincell0 = new PdfPCell(new Phrase(" Bank Loan Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setFixedHeight(20);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (bankloan_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);
				
				maincell0 = new PdfPCell(new Phrase(" Other Loan Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setFixedHeight(20);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (otherloan_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("Other Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (other_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);
				
				
				
				/*maincell0 = new PdfPCell(new Phrase(" SOCIETY DEDUCT Total:-", f));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (SociDedc_total), "", "", false, false), f1));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);*/
				
			
			
				
			
				
		
			
				
				maincell0 = new PdfPCell(new Phrase("Total Employee :-", fbold));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main1.addCell(maincell0);

				//maincell0 = new PdfPCell(new Phrase("", fbold));
				maincell0 = new PdfPCell(new Phrase("" + totalempno, fbold));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("Total Income :-", fbold));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (lsttotinc_total), "", "", false, false), fbold));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("Total Deduction:-", fbold));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);
				maincell0 = new PdfPCell(new Phrase("" + trans((int) (totded_total), "", "", false, false), fbold));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);
				

				maincell0 = new PdfPCell(new Phrase(" Net Pay Total:-", fbold));
				maincell0.setBorderWidthRight(0);
				maincell0.setFixedHeight(20);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				/*float tttt = 0;
				ResultSet rsss;
				try {
					
					// System.out.println("date===="+date);
					Statement sttt = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);
					rs = st.executeQuery("select sum(net_amt) from paytran where trndt between '"
							+ ReportDAO.BOM(rdt) + "' and '" + ReportDAO.EOM(rdt)
							+ "'  and trncd=999  union  "
							+ "select sum(net_amt) from paytran_stage where trndt between '" + ReportDAO.BOM(rdt)
							+ "' and '" + ReportDAO.EOM(rdt) + "'  and trncd=999 ");

					while (rs.next()) {
						tttt += rs.getFloat(1);
					}
				} catch (Exception e) {
					e.printStackTrace();
				}*/

				maincell0 = new PdfPCell(new Phrase("" + trans((int) (netpay_total), "", "", false, false), fbold));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("", fbold));

				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("", fbold));
				maincell0.setBorderWidthLeft(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("", fbold));

				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_LEFT);
				main1.addCell(maincell0);

				maincell0 = new PdfPCell(new Phrase("", fbold));
				maincell0.setBorderWidthRight(0);
				maincell0.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main1.addCell(maincell0);

				doc.add(main1);

				doc.add(Chunk.NEWLINE);
				doc.add(Chunk.NEWLINE);
				doc.add(Chunk.NEWLINE);
				doc.add(Chunk.NEWLINE);

				para = new Paragraph(new Phrase("Prepared By                         Checked By                        Approved By                 ",
						new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
				para.setAlignment(Element.ALIGN_RIGHT);
				para.setSpacingBefore(10);
				doc.add(para);

				/*stmtInsert.close();
				stmtTrnct.close();
				st.close();
				con.close();
				document.close();*/

				
				
				
				
				
		//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%		
				
				
				
	//	doc.add(tab);
		
		
		doc.close();
		Cn.close();
		return;
		
		
	}
	catch(Exception e)
	{
		e.printStackTrace();
	}
}

//govi

public static void newpayregPDFG(String PGRDT, String imgpath, String filepath, String reptype, String Branch,

		String Desgn, String deptartment) {
	

	System.out.println("Hi newpayregwithNewFormat123");

	String hname = "";
	Properties prop = new Properties();
	try {
		ClassLoader classLoader = Thread.currentThread().getContextClassLoader();
		InputStream stream = classLoader.getResourceAsStream("constant.properties");
		prop.load(stream);
	} catch (Exception e) {
		System.out.println("Error in constant Properties " + e);
	}

	if (reptype.equalsIgnoreCase("paytran")) {
		hname = "Pre-Finalize";
	} else if (reptype.equalsIgnoreCase("paytran_stage")) {
		hname = "Finalize";
	} else {
		hname = "Release";
	}
	System.out.println("in new pay regdao..........aniket");
	System.out.println("in new pay regdao");
	System.out.println("type selected...." + Desgn);
	RepoartBean repBean = new RepoartBean();
	UtilityDAO dao = new UtilityDAO();
	Connection Cn = null;
	ResultSet rs=null;
	String BomDt = "";
	String EomDt = "";
	int lastdat = 0;

	String table_name = null;

	lastdat = (int) Calculate.getDays(PGRDT);

	BomDt = ReportDAO.BOM(PGRDT);
	EomDt = ReportDAO.EOM(PGRDT);

	String temp = PGRDT.substring(2);
	ResultSet emp = null;
	String EmpSql = "";
	String pBrcd1 = "";
	int tot_no_emp = 0;
	int br_tot_no_emp = 0;
	float totmthsal1 = 0.0f;
	float totearning1 = 0.0f;
	float totearning2 = 0.0f;
	float totactualpay = 0.0f;
	float totmobded = 0.0f;
	float totadvanc = 0.0f;
	float totloan = 0.0f;
	float tottds = 0.0f;

			try {
				
				
		
				System.out.println("hello am in IDDDDD");
				ReportDAO.OpenCon("", "", "", repBean);
				Cn = repBean.getCn();
				Statement st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);
				Statement stmtInsert = Cn.createStatement();
				Statement stmtTrnct = Cn.createStatement();
		
				DottedLineCell app = new DottedLineCell();
				System.out.println("in income & Deduction head");
		
				// A4 size pdf....
				Document document = new Document(new Rectangle(2384, 3370));
		
				// Document doc = new Document(new Rectangle(2834,4008));
				document.left(100f);
				document.top(100f);
				document.bottom(100f);
				document.right(100f);
		
				PdfWriter writer = PdfWriter.getInstance(document, new FileOutputStream(filepath));
				HeaderAndFooter haf = new HeaderAndFooter(lable1, label2);
				writer.setPageEvent(haf);
				document.open();
				Font FONT = new Font(Font.HELVETICA, 190, Font.NORMAL, new GrayColor(0.85f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(), Element.ALIGN_CENTER,
						new Phrase(prop.getProperty("watermark"), FONT), 1300f, 1830f, 45);
				Image image1 = Image.getInstance(imgpath);
		
				Phrase title = new Phrase(prop.getProperty("companyName"), new Font(FONT.TIMES_ROMAN, 22, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				image1.scaleAbsolute(310f, 120f);
		
				// chaange possition of image
				/* image1.setAbsolutePosition(60f, 2750f); */
				image1.setAbsolutePosition(60f, 3200f);
				document.add(image1);
				document.add(para);
		
				para = new Paragraph(new Phrase(prop.getProperty("addressForReport"), new Font(Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
		
				document.add(para);
				para = new Paragraph(new Phrase(prop.getProperty("contactForReport"), new Font(Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
		
				document.add(para);
				para = new Paragraph(new Phrase(prop.getProperty("mailForReport"), new Font(Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);
		
				document.add(para);
		
				Font f = new Font(Font.HELVETICA, 22);
				Font f1 = new Font(Font.HELVETICA, 22);
				Font fbold = new Font(Font.HELVETICA, 22, Font.BOLD);
				Font f2 = new Font(Font.HELVETICA, 22);
		
				para = new Paragraph(
						new Phrase("Salary Sheet For The Income Heads for the Month Of :- " + temp + " (" + hname + ")",
								new Font(Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);
		
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(30);
		
				document.add(para);
		
				Rectangle rec = new Rectangle(100, 100);
		
				float basic_total = 0.0f;
				float lstbasic_total = 0.0f;
				float lic_total = 0.0f;
				float lstlic_total = 0.0f;
				float hra_total = 0.0f;
				float lsthra_total = 0.0f;
				float medical_total = 0.0f;
				float lstmedical_total = 0.0f;
				float leave_TC = 0.0f;
				float lstleave_total = 0.0f;
				float any_total = 0.0f;
				float lstany_total = 0.0f;
				float edu_total = 0.0f;
				float lstedu_total = 0.0f;
				float splall_total = 0.0f;
				float lstsplall_total = 0.0f;
				float convall_total = 0.0f;
				float lstconvall_total = 0.0f;
				float pf_total = 0.0f;
				float lstpf_total = 0.0f;
				float pt_total = 0.0f;
				float lstpt_total = 0.0f;
				float mlwf_total = 0.0f;
				float lstmlwf_total = 0.0f;
				float other_total = 0.0f;
				float med_total = 0.0f;
				float ERP_total = 0.0f;
				float istotmed_total = 0.0f;
				float istotERPDED_total = 0.0f;
				float lstother_total = 0.0f;
				float esic_total = 0.0f;
				float lstesic_total = 0.0f;
				float mob_total = 0.0f;
				float lstmob_total = 0.0f;
				float adv_total = 0.0f;
				float lstadv_total = 0.0f;
				float tds_total = 0.0f;
				float lsttds_total = 0.0f;
				float relif_total = 0.0f;
				float lstrelif_total = 0.0f;
				float netc_total = 0.0f;
				float lstnetc_total = 0.0f;
				float minins_total = 0.0f;
				float lstminins_total = 0.0f;
				float addlss_total = 0.0f;
				float lstaddlss_total = 0.0f;
				float col_total = 0.0f;
				float lstcol_total = 0.0f;
				float special_total = 0.0f;
				float lstspecial_total = 0.0f;
				float addinc_total = 0.0f;
				float lstaddinc_total = 0.0f;
				float totinc_total = 0.0f;
				float lsttotinc_total = 0.0f;
				float loan_total = 0.0f;
				float lstloan_total = 0.0f;
				float totded_total = 0.0f;
				float lsttotded_total = 0.0f;
				float netpay_total = 0.0f;
				float lstnetpay_total = 0.0f;
				float da_total = 0.0f;
				float lstda_total = 0.0f;
				float deptall_total = 0.0f;
				float lstdeptall_total = 0.0f;
				float othersplall_total = 0.0f;
				float lstothersplall_total = 0.0f;
				float mediclaim_total = 0.0f;
				float lstmediclaim_total = 0.0f;
				float otherded_total = 0.0f;
				float lstotherded_total = 0.0f;
				float memded_total = 0.0f;
				float lstmemded_total = 0.0f;
				float bankloan_total = 0.0f;
				float lstbankloan_total = 0.0f;
				float otherloan_total = 0.0f;
				float lstotherloan_total = 0.0f;
				String constant ="";			
				if ((!"Select".equals(Branch) && (!"0".equals(Desgn)))){	
					constant="and t.PRJ_SRNO="+Branch;
				}else{
					constant=" ";
				}
				//filter=filter.replaceAll("UID", UID);
				if ((!"Select".equals(Branch) && (!"0".equals(Desgn) && (!"2".equals(Desgn))))){	
					constant="and t.PRJ_SRNO="+Branch;
				}
				/*else if((!"Select".equals(deptartment) && (!"0".equals(Desgn) && (!"1".equals(Desgn))))){
					if(deptartment.equalsIgnoreCase("all"))
					{
						constant=" "+filter;
					}else {
					constant="and t.DEPT="+deptartment+" "+filter;
					}
				}*/
				else{
					constant=" ";
				}
				
				
		
				if(Desgn.equalsIgnoreCase("0")){
					
					EmpSql = "         SELECT  empcode , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+' '+RTRIM(EMPMAST.LNAME)AS name, "
							+ "     	EMPMAST.empno,  empmast.DOL, empmast.STATUS, T.PRJ_SRNO,T.DEPT,"
							
							+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 101 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)   "
							+ "		THEN	(SELECT NET_AMT AS basic  FROM   PAYTRAN WHERE TRNCD = 101 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		ELSE	(SELECT 0 AS basic) END AS 'basic',"

							+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 102 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)   "
							+ "		THEN	(SELECT NET_AMT AS da  FROM   PAYTRAN WHERE TRNCD = 102 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		ELSE	(SELECT 0 AS da) END AS 'da',"
							
							+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 103 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		THEN			(SELECT NET_AMT AS hra  FROM   PAYTRAN WHERE TRNCD = 103 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		ELSE		(SELECT 0 AS hra) END AS 'hra',"

							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 107 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "				THEN (SELECT NET_AMT AS DeptAllw  FROM   PAYTRAN WHERE TRNCD = 107  AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)    			"
							+ "	ELSE (SELECT 0 AS DeptAllw) END AS 'DeptAllw'," 
							
							+" CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 108 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	    THEN			(SELECT NET_AMT AS ConvyAllw  FROM   PAYTRAN WHERE TRNCD = 108 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		ELSE		(SELECT 0 AS ConvyAllw) END AS 'ConvyAllw',"
														
							+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 129 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		THEN		(SELECT NET_AMT AS OtherSpclAllw  FROM   PAYTRAN WHERE TRNCD = 129 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		ELSE		(SELECT 0 AS OtherSpclAllw) END AS 'OtherSpclAllw',"
							
							+ "	    CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 999 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		THEN			(SELECT NET_AMT AS payable  FROM   PAYTRAN WHERE TRNCD = 999 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		ELSE		(SELECT 0 AS payable) END AS 'payable',"
							
							+"			 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 201 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "			THEN		(SELECT NET_AMT AS pf  FROM   PAYTRAN WHERE TRNCD = 201 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)    			"
							+ "		ELSE		(SELECT 0 AS er2) END AS 'pf',	 "
							
							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 202 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	THEN	(SELECT NET_AMT AS pt  FROM   PAYTRAN WHERE TRNCD = 202 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt
							+ "' AND empno = EMPMAST.empno)		ELSE			(SELECT 0 AS pt) END AS 'pt', "
							
							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 205 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	THEN	(SELECT NET_AMT AS lic  FROM   PAYTRAN WHERE TRNCD = 205 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt
							+ "' AND empno = EMPMAST.empno)	ELSE	(SELECT 0 AS lic) END AS 'lic', "
							
							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 212 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	THEN	(SELECT NET_AMT AS mediclaim  FROM   PAYTRAN WHERE TRNCD = 212 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt
							+ "' AND empno = EMPMAST.empno)	ELSE	(SELECT 0 AS mediclaim) END AS 'mediclaim', "
							
							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 213 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	THEN	(SELECT NET_AMT AS otherded  FROM   PAYTRAN WHERE TRNCD = 213 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt
							+ "' AND empno = EMPMAST.empno)	ELSE	(SELECT 0 AS otherded) END AS 'otherded', "
							
							+ "		 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 223 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		THEN		(SELECT NET_AMT AS membDed  FROM   PAYTRAN WHERE TRNCD = 223 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		ELSE  (SELECT 0 AS membDed) END AS 'membDed',"
							
							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 228 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	THEN		(SELECT NET_AMT AS tds  FROM   PAYTRAN WHERE TRNCD = 228 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	ELSE		(SELECT 0 AS tds) END AS 'tds'," 

							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 207 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	THEN	(SELECT NET_AMT AS mlwf  FROM   PAYTRAN WHERE TRNCD = 207 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt
							+ "' AND empno = EMPMAST.empno)	ELSE	(SELECT 0 AS mlwf) END AS 'mlwf', "
							
							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 248 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	THEN	(SELECT NET_AMT AS bankLoan  FROM   PAYTRAN WHERE TRNCD = 248 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt
							+ "' AND empno = EMPMAST.empno)	ELSE	(SELECT 0 AS bankLoan) END AS 'bankLoan', "
							
							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 249 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	THEN	(SELECT NET_AMT AS otherLoan  FROM   PAYTRAN WHERE TRNCD = 249 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt
							+ "' AND empno = EMPMAST.empno)	ELSE	(SELECT 0 AS otherLoan) END AS 'otherLoan', "
							
							+ "    case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "    and TRNCD not in(101,102,103,107,108,129)"
							+ "    and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and empno =  EMPMAST.empno )"
							+ "	 THEN	(select SUM(net_amt) as addinc from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "    and TRNCD not in(101,102,103,107,108,129)"
							+ "    and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and empno =  EMPMAST.empno) "
							+ "	 ELSE		(SELECT 0 AS addinc) END AS 'addinc',"
							
							+ "      case when EXISTS(select SUM(net_amt)   from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
							+ "     and TRNCD not in(201,202,205,212,213,223,228,207,248,249) and trndt BETWEEN '"
							+ BomDt + "' and '" + EomDt + "' and empno = empmast.empno)"
							+ "	  THEN	(select SUM(net_amt)  as other from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
							+ "     and TRNCD not in(201,202,205,212,213,223,228,207,248,249) and trndt BETWEEN '"
							+ BomDt + "' and '" + EomDt + "' and empno = empmast.empno)"
							+ "	  ELSE	(SELECT 0 AS other) END AS 'other' ,"
							
							+ "	  case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and empno = empmast.empno)"
							+ "	  THEN			(select SUM(net_amt) as totded from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299) "
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt
							+ "' and empno = empmast.empno)	" + "	  ELSE 	(SELECT 0 AS totded) END AS 'totded' ,"
							
							+ "	  case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and empno = empmast.empno) "
							+ "	  THEN	(select SUM(net_amt) from   PAYTRAN  where TRNCD in    (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and empno = empmast.empno)"
							+ "	  ELSE		(SELECT 0 AS totear) END AS 'totear',"
							
							+ " 	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 301 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	THEN	(SELECT NET_AMT AS absentdays  FROM   PAYTRAN WHERE TRNCD = 301 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	  ELSE		(SELECT 0 AS absentdays) END AS 'absentdays'"
							
							
							+ "     from EMPMAST empmast     join   EMPTRAN t on t.empno = empmast.empno"
							+ "     where      T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.empno = empmast.empno AND E2.EFFDATE <= '"
							+ EomDt + "'" + "     and (( empmast.STATUS='A' AND	empmast.DOJ <= '" + EomDt
							+ "') or  (empmast.STATUS ='N' And empmast.DOL>='" + BomDt + "' )) )"
							+ "     AND T.empno in (SELECT DISTINCT empno FROM PAYTRAN WHERE TRNDT BETWEEN '" + BomDt
							+ "' and '" + EomDt + "') " +

						
							
							"    UNION "
							+ "         SELECT  empcode , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+' '+RTRIM(EMPMAST.LNAME)AS name,"
							+ "     	EMPMAST.empno, empmast.DOL, empmast.STATUS, T.PRJ_SRNO,T.DEPT,"

						
							+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 101 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		THEN	(SELECT NET_AMT AS basic  FROM   PAYTRAN_STAGE WHERE TRNCD = 101 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		ELSE	(SELECT 0 AS basic) END AS 'basic',"
							
							+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 102 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		THEN	(SELECT NET_AMT AS da  FROM   PAYTRAN_STAGE WHERE TRNCD = 102 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		ELSE	(SELECT 0 AS da) END AS 'da',"
						
							+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 103 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		THEN			(SELECT NET_AMT AS hra  FROM   PAYTRAN_STAGE WHERE TRNCD = 103 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		ELSE		(SELECT 0 AS hra) END AS 'hra',"
														
							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 107 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "				THEN (SELECT NET_AMT AS deptall  FROM   PAYTRAN_STAGE WHERE TRNCD = 107  AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)    			"
							+ "	ELSE (SELECT 0 AS deptall) END AS 'deptall',"
														
							+"          CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 108 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	    THEN			(SELECT NET_AMT AS convall  FROM   PAYTRAN_STAGE WHERE TRNCD = 108 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		ELSE		(SELECT 0 AS convall) END AS 'convall',"
							
							+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 129 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		THEN		(SELECT NET_AMT AS othersplall  FROM   PAYTRAN_STAGE WHERE TRNCD = 129 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		ELSE		(SELECT 0 AS othersplall) END AS 'othersplall',"
							
							+ "	    CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 999 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		THEN			(SELECT NET_AMT AS payable  FROM   PAYTRAN_STAGE WHERE TRNCD = 999 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		ELSE		(SELECT 0 AS payable) END AS 'payable',"
							
							+"			 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 201 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "			THEN		(SELECT NET_AMT AS pf  FROM   PAYTRAN_STAGE WHERE TRNCD = 201 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)    			"
							+ "		ELSE		(SELECT 0 AS er2) END AS 'pf',	 "
							
							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 202 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	THEN	(SELECT NET_AMT AS pt  FROM   PAYTRAN_STAGE WHERE TRNCD = 202 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt
							+ "' AND empno = EMPMAST.empno)		ELSE			(SELECT 0 AS pt) END AS 'pt', "
							

							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 205 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	THEN	(SELECT NET_AMT AS lic  FROM   PAYTRAN_STAGE WHERE TRNCD = 205 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt
							+ "' AND empno = EMPMAST.empno)	ELSE	(SELECT 0 AS lic) END AS 'lic', "
								
							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 212 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	THEN	(SELECT NET_AMT AS mediclaim  FROM   PAYTRAN_STAGE WHERE TRNCD = 212 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt
							+ "' AND empno = EMPMAST.empno)	ELSE	(SELECT 0 AS mediclaim) END AS 'mediclaim', "
								
							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 213 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	THEN	(SELECT NET_AMT AS otherded  FROM   PAYTRAN_STAGE WHERE TRNCD = 213 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt
							+ "' AND empno = EMPMAST.empno)	ELSE	(SELECT 0 AS otherded) END AS 'otherded', "
								
							+ "		 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 223 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		THEN		(SELECT NET_AMT AS memded  FROM   PAYTRAN_STAGE WHERE TRNCD = 223 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "		ELSE  (SELECT 0 AS memded) END AS 'memded',"
							
							+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 228 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	THEN		(SELECT NET_AMT AS tds  FROM   PAYTRAN_STAGE WHERE TRNCD = 228 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	ELSE		(SELECT 0 AS tds) END AS 'tds',"

							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 207 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	THEN	(SELECT NET_AMT AS mlwf  FROM   PAYTRAN_STAGE WHERE TRNCD = 207 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt
							+ "' AND empno = EMPMAST.empno)	ELSE	(SELECT 0 AS mlwf) END AS 'mlwf', "
								
							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 248 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	THEN	(SELECT NET_AMT AS bankloan  FROM   PAYTRAN_STAGE WHERE TRNCD = 248 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt
							+ "' AND empno = EMPMAST.empno)	ELSE	(SELECT 0 AS bankloan) END AS 'bankloan', "
								
							+ "CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 249 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	THEN	(SELECT NET_AMT AS otherloan  FROM   PAYTRAN_STAGE WHERE TRNCD = 249 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt
							+ "' AND empno = EMPMAST.empno)	ELSE	(SELECT 0 AS otherloan) END AS 'otherloan', "
							
							
							+ "    case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "    and TRNCD not in(101,102,103,107,108,129)"
							+ "    and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and empno =  EMPMAST.empno )"
							+ "	 THEN	(select SUM(net_amt) as addinc from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "    and TRNCD not in(101,102,103,107,108,129)"
							+ "    and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and empno =  EMPMAST.empno) "
							+ "	 ELSE		(SELECT 0 AS addinc) END AS 'addinc',"
							
							+ "      case when EXISTS(select SUM(net_amt)   from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
							+ "     and TRNCD not in(201,202,205,212,213,223,228,207,248,249) and trndt BETWEEN '"
							+ BomDt + "' and '" + EomDt + "' and empno = empmast.empno)"
							+ "	  THEN	(select SUM(net_amt)  as other from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
							+ "     and TRNCD not in(201,202,205,212,213,223,228,207,248,249) and trndt BETWEEN '"
							+ BomDt + "' and '" + EomDt + "' and empno = empmast.empno)"
							+ "	  ELSE	(SELECT 0 AS other) END AS 'other' ,"
							
							+ "	  case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and empno = empmast.empno)"
							+ "	  THEN			(select SUM(net_amt) as totded from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) "
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt
							+ "' and empno = empmast.empno)	" + "	  ELSE 	(SELECT 0 AS totded) END AS 'totded' ,"
							
							+ "	  case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and empno = empmast.empno) "
							+ "	  THEN	(select SUM(net_amt) from   paytran_stage  where TRNCD in    (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
							+ "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt + "' and empno = empmast.empno)"
							+ "	  ELSE		(SELECT 0 AS totear) END AS 'totear',"
							
							+ " 	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 301 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	THEN	(SELECT NET_AMT AS absentdays  FROM   PAYTRAN_STAGE WHERE TRNCD = 301 AND TRNDT BETWEEN '"
							+ BomDt + "' AND '" + EomDt + "' AND empno = EMPMAST.empno)"
							+ "	  ELSE		(SELECT 0 AS absentdays) END AS 'absentdays'"
							
							
							+ "     from EMPMAST empmast     join   EMPTRAN t on t.empno = empmast.empno"
							+ "     where      T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.empno = empmast.empno AND E2.EFFDATE <= '"
							+ EomDt + "'" + "     and (( empmast.STATUS='A' AND	empmast.DOJ <= '" + EomDt
							+ "') or  (empmast.STATUS ='N' And empmast.DOL>='" + BomDt + "' )) )"
							+ "     AND T.empno in (SELECT DISTINCT empno FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '"
							+ BomDt + "' and '" + EomDt + "') " + "     order by   t.PRJ_SRNO,empno  ";
				
					}
					else{
					if(reptype.equalsIgnoreCase("paytran")){

						EmpSql="SELECT empcode, "
								+ "       Rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname) AS NAME, "
								+ "       empmast.empno, "
								+ "       T.prj_srno, "
								+ "       T.dept, "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd = 101 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS BASIC "
								+ "          FROM   paytran "
								+ "          WHERE  trncd = 101 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' "
								+ "                     AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS BASIC) "
								+ "       END                 AS 'BASIC', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd = 999 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS PAYABLE "
								+ "          FROM   paytran "
								+ "          WHERE  trncd = 999 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS PAYABLE) "
								+ "       END                 AS 'PAYABLE', "
								+ "        "
								+ "         "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd = 102 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS DA "
								+ "          FROM   paytran "
								+ "          WHERE  trncd = 102 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS DA) "
								+ "       END                 AS 'DA', "
								+ "        "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd = 103 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS HRA "
								+ "          FROM   paytran "
								+ "          WHERE  trncd = 103 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS HRA) "
								+ "       END                 AS 'HRA', "
								+ "        "
								+ "        "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd = 107 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS DeptAllw "
								+ "          FROM   paytran "
								+ "          WHERE  trncd = 107 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS DeptAllw) "
								+ "       END                 AS 'DeptAllw', "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd = 108 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS ConvyAllw "
								+ "          FROM   paytran "
								+ "          WHERE  trncd = 108 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS ConvyAllw ) "
								+ "       END                 AS 'ConvyAllw', "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd = 129 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS OtherSpclAllw "
								+ "          FROM   paytran "
								+ "          WHERE  trncd = 129 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS OtherSpclAllw) "
								+ "       END                 AS 'OtherSpclAllw', "
								+ "        CASE "
								+ "         WHEN EXISTS(SELECT Sum(net_amt) "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd IN (SELECT trncd "
								+ "                                      FROM   cdmast "
								+ "                                      WHERE  pslipyn = 'Y' "
								+ "                                             AND trncd BETWEEN 100 AND 198) "
								+ "                            AND trncd NOT IN( 101,102, 103, "
								+ "                                              108, 129) "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN (SELECT "
								+ "         Sum(net_amt) AS addinc FROM paytran_stage WHERE "
								+ "         trncd IN (SELECT trncd "
								+ "                   FROM   cdmast "
								+ "                   WHERE  pslipyn = 'Y' "
								+ "                          AND trncd BETWEEN 100 AND 198) "
								+ "         AND trncd NOT IN( 101, 102, 103, "
								+ "                           129, 108, "
								+ "                           107) "
								+ "         AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "         AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS addinc) "
								+ "       END                 AS 'addinc', "
								+ "        "
								+ "        "
								+ "        CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd = 999 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS TotalIncome "
								+ "          FROM   paytran "
								+ "          WHERE  trncd = 999 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS TotalIncome) "
								+ "       END                 AS 'TotalIncome', "
								+ "        "
								+ "        "
								+ "     "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd = 201 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS pf "
								+ "          FROM   paytran "
								+ "          WHERE  trncd = 201 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS pf) "
								+ "       END                 AS 'pf', "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd = 202 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS pt "
								+ "          FROM   paytran "
								+ "          WHERE  trncd = 202 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS pt) "
								+ "       END                 AS 'pt', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd = 205 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS lic "
								+ "          FROM   paytran "
								+ "          WHERE  trncd = 205 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS lic) "
								+ "       END                 AS 'lic', "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd = 212 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS mediclaim "
								+ "          FROM   paytran "
								+ "          WHERE  trncd = 212 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS mediclaim) "
								+ "       END                 AS 'mediclaim', "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd = 213 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS otherDed "
								+ "          FROM   paytran "
								+ "          WHERE  trncd = 213 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS otherDed) "
								+ "       END                 AS 'otherDed', "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd = 223 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS membDed "
								+ "          FROM   paytran "
								+ "          WHERE  trncd = 223 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS membDed) "
								+ "       END                 AS 'membDed', "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd = 228 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS tds "
								+ "          FROM   paytran "
								+ "          WHERE  trncd = 228 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS tds) "
								+ "       END                 AS 'tds', "
								
								
							
								
								
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd in (220,221) "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS mlwf "
								+ "          FROM   paytran "
								+ "          WHERE  trncd = 211 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS mlwf) "
								+ "       END                 AS 'mlwf', "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd = 248 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS bankLoan "
								+ "          FROM   paytran "
								+ "          WHERE  trncd = 248 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS bankLoan) "
								+ "       END                 AS 'bankLoan', "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd = 226 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS otherLoan "
								+ "          FROM   paytran "
								+ "          WHERE  trncd = 226 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS otherLoan) "
								+ "       END                 AS 'otherLoan', "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT Sum(net_amt) "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd IN (SELECT trncd "
								+ "                                      FROM   cdmast "
								+ "                                      WHERE  pslipyn = 'Y' "
								+ "                                             AND trncd BETWEEN 201 AND 299) "
								+ "                            AND trncd NOT IN( 201, 202, 205, 221, "
								+ "                                              223, 228,220,248,212, "
								+ "                                               226, 213 "
								+ "                                               ) "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN (SELECT "
								+ "         Sum(net_amt) AS other  FROM   paytran "
								+ "                          WHERE "
								+ "         trncd IN (SELECT trncd "
								+ "                   FROM   cdmast "
								+ "                   WHERE  pslipyn = 'Y' "
								+ "                          AND trncd BETWEEN 201 AND 299) "
								+ "         AND trncd NOT IN( 201, 202, 205, 221,212 , "
								+ "                           223, 228,  220, "
								+ "                           226,  213,248 ) "
								+ "         AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "         AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS other) "
								+ "       END                 AS 'other', "
								+ "       CASE "
								+ "        "
								+ "         WHEN EXISTS(SELECT Sum(net_amt) "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd IN (SELECT trncd "
								+ "                                      FROM   cdmast "
								+ "                                      WHERE  pslipyn = 'Y' "
								+ "                                             AND trncd BETWEEN 201 AND 299) "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN (SELECT "
								+ "         Sum(net_amt) AS totded "
								+ "                                                             FROM   paytran "
								+ "                                                             WHERE "
								+ "         trncd IN (SELECT trncd "
								+ "                   FROM   cdmast "
								+ "                   WHERE  pslipyn = 'Y' "
								+ "                          AND trncd BETWEEN 201 AND 299) "
								+ "         AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "         AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS totded) "
								+ "       END                 AS 'totded', "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT Sum(net_amt) "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd IN (SELECT trncd "
								+ "                                      FROM   cdmast "
								+ "                                      WHERE  pslipyn = 'Y' "
								+ "                                             AND trncd BETWEEN 100 AND 198) "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN (SELECT Sum(net_amt) "
								+ "                                                             FROM   paytran "
								+ "                                                             WHERE "
								+ "         trncd IN (SELECT trncd "
								+ "                   FROM   cdmast "
								+ "                   WHERE  pslipyn = 'Y' "
								+ "                          AND trncd BETWEEN 100 AND 198) "
								+ "         AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "         AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS totear) "
								+ "       END                 AS 'totear' "
								+ "        "
								+ "        "
								+ "         "
								+ "FROM   empmast empmast "
								+ "       JOIN emptran t "
								+ "         ON t.empno = empmast.empno "
								+ "WHERE  T.srno = (SELECT Max(E2.srno) "
								+ "                 FROM   emptran E2 "
								+ "                 WHERE  E2.empno = empmast.empno "
								+ "                        AND E2.effdate <= '"+EomDt+"' "
								+ "                        AND ( ( empmast.status = 'A' "
								+ "                                AND empmast.doj <= '"+EomDt+"' ) "
								+ "                               OR ( empmast.status = 'N' "
								+ "                                    AND empmast.dol >= '"+BomDt+"' ) )) "
								+ "       AND T.empno IN (SELECT DISTINCT empno "
								+ "                       FROM   paytran "
								+ "                       WHERE  trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"')"					 
								+constant+" "
								//+ "     order by  empno  "
						
								+ " UNION "
								+ " SELECT empcode, "
								+ "       Rtrim(empmast.fname)AS NAME, "
								+ "       empmast.empno, "
								+ "       T.prj_srno, "
								+ "       T.dept, "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 101 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS BASIC "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 101 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS BASIC) "
								+ "       END                 AS 'BASIC', "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 999 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS PAYABLE "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 999 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS PAYABLE) "
								+ "       END                 AS 'PAYABLE', "
								+ "        "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 102 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS DA "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 102 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS DA) "
								+ "       END                 AS 'DA', "
								+ "        "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 103 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS HRA "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 103 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS HRA) "
								+ "       END                 AS 'HRA', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 107 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS			DeptAllw "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 107 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS DeptAllw) "
								+ "       END                 AS 'DeptAllw', "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 108 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS ConvyAllw "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 108 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS ConvyALllw) "
								+ "       END                 AS 'ConvyAllw', "
								+ "        "
								+ "         "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 129 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS OtherAllw "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 129 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS OtherAllw) "
								+ "       END                 AS 'OtherAllw', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT Sum(net_amt) "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd IN (SELECT trncd "
								+ "                                      FROM   cdmast "
								+ "                                      WHERE  pslipyn = 'Y' "
								+ "                                             AND trncd BETWEEN 100 AND 198) "
								+ "                            AND trncd NOT IN( 101,102, 103,107, "
								+ "                                              108, 129) "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN (SELECT "
								+ "         Sum(net_amt) AS addinc FROM paytran_stage WHERE "
								+ "         trncd IN (SELECT trncd "
								+ "                   FROM   cdmast "
								+ "                   WHERE  pslipyn = 'Y' "
								+ "                          AND trncd BETWEEN 100 AND 198) "
								+ "         AND trncd NOT IN( 101, 102, 103, "
								+ "                           129, 108, "
								+ "                           107) "
								+ "         AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "         AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS addinc) "
								+ "       END                 AS 'addinc', "
								+ "        "
								+ "        "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 999 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS TotalIncome "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 999 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS TotalIncome) "
								+ "       END                 AS 'TotalIncome', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 201 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS pf "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 201 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS pf) "
								+ "       END                 AS 'pf', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 202 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS pt "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 202 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS pt) "
								+ "       END                 AS 'pt', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 205 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS lic "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 205 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS lic) "
								+ "       END                 AS 'lic', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 212 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS Mediclaim "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 212 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS Mediclaim) "
								+ "       END                 AS 'Mediclaim', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 213 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS Mediclaim "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 213 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS OtherDed) "
								+ "       END                 AS 'OtherDed', "
								+ "        "
								+ "        CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 223 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS MembDed "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 223 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS MembDed) "
								+ "       END                 AS 'MembDed', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 228 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS tds "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 228 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS tds) "
								+ "       END                 AS 'tds', "
								+ "        "
								+ "        CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran "
								+ "                     WHERE  trncd in (220,221) "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS mlwf "
								+ "          FROM   paytran "
								+ "          WHERE  trncd = 211 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS mlwf) "
								+ "       END                 AS 'mlwf', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 248 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS bankLoan "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 248 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS bankLoan) "
								+ "       END                 AS 'bankLoan', "
								+ "       "
								+ "       "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 248 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS otherLoan "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 248 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS otherLoan) "
								+ "       END                 AS 'otherLoan', "
								+ "      "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT Sum(net_amt) "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd IN (SELECT trncd "
								+ "                                      FROM   cdmast "
								+ "                                      WHERE  pslipyn = 'Y' "
								+ "                                             AND trncd BETWEEN 200 AND 299) "
								+ "                            AND trncd NOT IN( 201, 202, 205, 221, 213,212, "
								+ "                                              223, 248,226, 228, 220 ) "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN (SELECT "
								+ "         Sum(net_amt) AS other FROM paytran_stage "
								+ "                      WHERE "
								+ "         trncd IN (SELECT trncd "
								+ "                   FROM   cdmast "
								+ "                   WHERE  pslipyn = 'Y' "
								+ "                          AND trncd BETWEEN 200 AND 299) "
								+ "         AND trncd NOT IN( 201, 202, 205, 221,220, "
								+ "                           223,  228, 248, "
								+ "                            226, 211,213 ) "
								+ "         AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "         AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS other) "
								+ "       END                 AS 'other', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT Sum(net_amt) "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd IN (SELECT trncd "
								+ "                                      FROM   cdmast "
								+ "                                      WHERE  pslipyn = 'Y' "
								+ "                                             AND trncd BETWEEN 200 AND 299) "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN (SELECT "
								+ "         Sum(net_amt) AS totded FROM  paytran_stage "
								+ "                    WHERE "
								+ "         trncd IN (SELECT trncd "
								+ "                   FROM   cdmast "
								+ "                   WHERE  pslipyn = 'Y' "
								+ "                          AND trncd BETWEEN 200 AND 299) "
								+ "         AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "         AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS totded) "
								+ "       END                 AS 'totded', "
								+ "         "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT Sum(net_amt) "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd IN (SELECT trncd "
								+ "                                      FROM   cdmast "
								+ "                                      WHERE  pslipyn = 'Y' "
								+ "                                             AND trncd BETWEEN 100 AND 198) "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN (SELECT Sum(net_amt) "
								+ "                    FROM   paytran_stage "
								+ "                     WHERE "
								+ "         trncd IN (SELECT trncd "
								+ "                   FROM   cdmast "
								+ "                   WHERE  pslipyn = 'Y' "
								+ "                          AND trncd BETWEEN 100 AND 198) "
								+ "         AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "         AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS totear) "
								+ "       END                 AS 'totear' "
								+ "        "
								+ "FROM   empmast empmast "
								+ "       JOIN emptran t "
								+ "         ON t.empno = empmast.empno "
								+ "WHERE  T.srno = (SELECT Max(E2.srno) "
								+ "                 FROM   emptran E2 "
								+ "                 WHERE  E2.empno = empmast.empno "
								+ "                        AND E2.effdate <= '"+EomDt+"' "
								+ "                        AND ( ( empmast.status = 'A' "
								+ "                                AND empmast.doj <= '"+EomDt+"' ) "
								+ "                               OR ( empmast.status = 'N' "
								+ "                                    AND empmast.dol >= '"+BomDt+"' ) )) "
								+ "       AND T.empno IN (SELECT DISTINCT empno "
								+ "                       FROM   paytran_stage "
								+ "                       WHERE  trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"') "
								+constant+" "
								+ "     order by  empno  ";
							//	+ "          empno";

					      System.out.println("aj:  "+EmpSql);
					}


					else if(reptype.equalsIgnoreCase("ytdtran")){

						
						
						EmpSql= "SELECT empcode, "
								+ "       Rtrim(empmast.fname)+' '+Rtrim(empmast.mname)+' '+Rtrim(empmast.lname)AS NAME, "
								+ "       empmast.empno, "
								+ "       T.prj_srno, "
								+ "       T.dept, "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd = 101 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS BASIC "
								+ "          FROM   ytdtran "
								+ "          WHERE  trncd = 101 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS BASIC) "
								+ "       END                 AS 'BASIC', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd = 999 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS PAYABLE "
								+ "          FROM   ytdtran "
								+ "          WHERE  trncd = 999 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS PAYABLE) "
								+ "       END                 AS 'PAYABLE', "
								+ "        "
								+ "         "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd = 102 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS DA "
								+ "          FROM   ytdtran "
								+ "          WHERE  trncd = 102 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS DA) "
								+ "       END                 AS 'DA', "
								+ "        "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd = 103 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS HRA "
								+ "          FROM   ytdtran "
								+ "          WHERE  trncd = 103 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS HRA) "
								+ "       END                 AS 'HRA', "
								+ "        "
								+ "        "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd = 107 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS DeptAllw "
								+ "          FROM   ytdtran "
								+ "          WHERE  trncd = 107 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS DeptAllw) "
								+ "       END                 AS 'DeptAllw', "
								+ "        "
								+ "        "
								+ "       "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd = 108 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS ConvyAllw "
								+ "          FROM   ytdtran "
								+ "          WHERE  trncd = 108 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS ConvyAllw ) "
								+ "       END                 AS 'ConvyAllw', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd = 129 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS OtherSpclAllw "
								+ "          FROM   ytdtran "
								+ "          WHERE  trncd = 129 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS OtherSpclAllw) "
								+ "       END                 AS 'OtherSpclAllw', "
								+ "        "
								+ "        "
								+ "        "
								+ "        CASE "
								+ "         WHEN EXISTS(SELECT Sum(net_amt) "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd IN (SELECT trncd "
								+ "                                      FROM   cdmast "
								+ "                                      WHERE  pslipyn = 'Y' "
								+ "                                             AND trncd BETWEEN 100 AND 198) "
								+ "                            AND trncd NOT IN( 101,102, 103, 104, 105, "
								+ "                                               108, 107,129 ) "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN (SELECT "
								+ "         Sum(net_amt) AS addinc FROM ytdtran WHERE "
								+ "         trncd IN (SELECT trncd "
								+ "                   FROM   cdmast "
								+ "                   WHERE  pslipyn = 'Y' "
								+ "                          AND trncd BETWEEN 100 AND 198) "
								+ "         AND trncd NOT IN( 101, 102, 103, "
								+ "                           129, 108, "
								+ "                           107) "
								+ "         AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "         AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS addinc) "
								+ "       END                 AS 'addinc', "
								+ "        "
								+ "        "
								+ "        CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd = 999 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS TotalIncome "
								+ "          FROM   ytdtran "
								+ "          WHERE  trncd = 999 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS TotalIncome) "
								+ "       END                 AS 'TotalIncome', "
								+ "        "
								+ "        "
								+ "     "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd = 201 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS pf "
								+ "          FROM   ytdtran "
								+ "          WHERE  trncd = 201 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS pf) "
								+ "       END                 AS 'pf', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd = 202 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS pt "
								+ "          FROM   ytdtran "
								+ "          WHERE  trncd = 202 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS pt) "
								+ "       END                 AS 'pt', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd = 205 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS lic "
								+ "          FROM   ytdtran "
								+ "          WHERE  trncd = 205 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS lic) "
								+ "       END                 AS 'lic', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd = 212 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS mediclaim "
								+ "          FROM   ytdtran "
								+ "          WHERE  trncd = 212 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS mediclaim) "
								+ "       END                 AS 'mediclaim', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd = 213 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS otherDed "
								+ "          FROM   ytdtran "
								+ "          WHERE  trncd = 213 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS otherDed) "
								+ "       END                 AS 'otherDed', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd = 223 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS membDed "
								+ "          FROM   ytdtran "
								+ "          WHERE  trncd = 223 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS membDed) "
								+ "       END                 AS 'membDed', "
								+ "       "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd = 228 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS tds "
								+ "          FROM   ytdtran "
								+ "          WHERE  trncd = 228 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS tds) "
								+ "       END                 AS 'tds', "
								+ "        "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd in (220,221) "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS mlwf "
								+ "          FROM   ytdtran "
								+ "          WHERE  trncd = 211 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS mlwf) "
								+ "       END                 AS 'mlwf', "
								+ "        "
								+ "        "
								+ "        "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd = 248 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS bankLoan "
								+ "          FROM   ytdtran "
								+ "          WHERE  trncd = 248 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS bankLoan) "
								+ "       END                 AS 'bankLoan', "
								+ "        "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd = 226 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS otherLoan "
								+ "          FROM   ytdtran "
								+ "          WHERE  trncd = 226 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS otherLoan) "
								+ "       END                 AS 'otherLoan', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT Sum(net_amt) "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd IN (SELECT trncd "
								+ "                                      FROM   cdmast "
								+ "                                      WHERE  pslipyn = 'Y' "
								+ "                                             AND trncd BETWEEN 201 AND 299) "
								+ "                            AND trncd NOT IN( 201, 202, 205, 221, "
								+ "                                              223, 228,220,248,212, "
								+ "                                               226, 213 "
								+ "                                               ) "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN (SELECT "
								+ "         Sum(net_amt) AS other  FROM   ytdtran "
								+ "                          WHERE "
								+ "         trncd IN (SELECT trncd "
								+ "                   FROM   cdmast "
								+ "                   WHERE  pslipyn = 'Y' "
								+ "                          AND trncd BETWEEN 201 AND 299) "
								+ "         AND trncd NOT IN( 201, 202, 205, 221,212 , "
								+ "                           223, 228,  220, "
								+ "                           226,  213,248 ) "
								+ "         AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "         AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS other) "
								+ "       END                 AS 'other', "
								+ "       CASE "
								+ "        "
								+ "         WHEN EXISTS(SELECT Sum(net_amt) "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd IN (SELECT trncd "
								+ "                                      FROM   cdmast "
								+ "                                      WHERE  pslipyn = 'Y' "
								+ "                                             AND trncd BETWEEN 201 AND 299) "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN (SELECT "
								+ "         Sum(net_amt) AS totded "
								+ "                                                             FROM   ytdtran "
								+ "                                                             WHERE "
								+ "         trncd IN (SELECT trncd "
								+ "                   FROM   cdmast "
								+ "                   WHERE  pslipyn = 'Y' "
								+ "                          AND trncd BETWEEN 201 AND 299) "
								+ "         AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "         AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS totded) "
								+ "       END                 AS 'totded', "
								+ "       CASE "
								+ "        "
								+ "        "
								+ "         WHEN EXISTS(SELECT Sum(net_amt) "
								+ "                     FROM   ytdtran "
								+ "                     WHERE  trncd IN (SELECT trncd "
								+ "                                      FROM   cdmast "
								+ "                                      WHERE  pslipyn = 'Y' "
								+ "                                             AND trncd BETWEEN 100 AND 198) "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN (SELECT Sum(net_amt) "
								+ "                                                             FROM   ytdtran "
								+ "                                                             WHERE "
								+ "         trncd IN (SELECT trncd "
								+ "                   FROM   cdmast "
								+ "                   WHERE  pslipyn = 'Y' "
								+ "                          AND trncd BETWEEN 100 AND 198) "
								+ "         AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "         AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS totear) "
								+ "       END                 AS 'totear' "
								+ "        "
								+ "         "
								+ "FROM   empmast empmast "
								+ "       JOIN emptran t "
								+ "         ON t.empno = empmast.empno "
								+ "WHERE  T.srno = (SELECT Max(E2.srno) "
								+ "                 FROM   emptran E2 "
								+ "                 WHERE  E2.empno = empmast.empno "
								+ "                        AND E2.effdate <= '"+EomDt+"' "
								+ "                        AND ( ( empmast.status = 'A' "
								+ "                                AND empmast.doj <= '"+EomDt+"' ) "
								+ "                               OR ( empmast.status = 'N' "
								+ "                                    AND empmast.dol >= '"+BomDt+"' ) )) "
								+ "       AND T.empno IN (SELECT DISTINCT empno "
								+ "                       FROM   ytdtran "
								+ "                       WHERE  trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"')"
								 +constant+" "
								+ "     order by  empno  ";
					     System.out.println(EmpSql);
					}

					else if(reptype.equalsIgnoreCase("paytran_stage")){

						
						EmpSql= "SELECT empcode, "
								+ "       Rtrim(empmast.fname)+' '+Rtrim(empmast.mname)+' '+Rtrim(empmast.lname)AS NAME, "
								+ "       empmast.empno, "
								+ "       T.prj_srno, "
								+ "       T.dept, "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 101 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS BASIC "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 101 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS BASIC) "
								+ "       END                 AS 'BASIC', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 999 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS PAYABLE "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 999 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS PAYABLE) "
								+ "       END                 AS 'PAYABLE', "
								+ "        "
								+ "         "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 102 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS DA "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 102 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS DA) "
								+ "       END                 AS 'DA', "
								+ "        "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 103 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS HRA "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 103 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS HRA) "
								+ "       END                 AS 'HRA', "
								+ "        "
								+ "        "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 107 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS DeptAllw "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 107 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS DeptAllw) "
								+ "       END                 AS 'DeptAllw', "
								+ "        "
								+ "        "
								+ "       "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 108 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS ConvyAllw "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 108 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS ConvyAllw ) "
								+ "       END                 AS 'ConvyAllw', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 129 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS OtherSpclAllw "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 129 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS OtherSpclAllw) "
								+ "       END                 AS 'OtherSpclAllw', "
								+ "        "
								+ "        "
								+ "        "
								+ "        CASE "
								+ "         WHEN EXISTS(SELECT Sum(net_amt) "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd IN (SELECT trncd "
								+ "                                      FROM   cdmast "
								+ "                                      WHERE  pslipyn = 'Y' "
								+ "                                             AND trncd BETWEEN 100 AND 198) "
								+ "                            AND trncd NOT IN( 101,102, 103, 104, 105, "
								+ "                                               108, 107,129 ) "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN (SELECT "
								+ "         Sum(net_amt) AS addinc FROM paytran_stage WHERE "
								+ "         trncd IN (SELECT trncd "
								+ "                   FROM   cdmast "
								+ "                   WHERE  pslipyn = 'Y' "
								+ "                          AND trncd BETWEEN 100 AND 198) "
								+ "         AND trncd NOT IN( 101, 102, 103, "
								+ "                           129, 108, "
								+ "                           107) "
								+ "         AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "         AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS addinc) "
								+ "       END                 AS 'addinc', "
								+ "        "
								+ "        "
								+ "        CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 999 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS TotalIncome "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 999 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS TotalIncome) "
								+ "       END                 AS 'TotalIncome', "
								+ "        "
								+ "        "
								+ "     "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 201 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS pf "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 201 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS pf) "
								+ "       END                 AS 'pf', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 202 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS pt "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 202 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS pt) "
								+ "       END                 AS 'pt', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 205 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS lic "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 205 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS lic) "
								+ "       END                 AS 'lic', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 212 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS mediclaim "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 212 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS mediclaim) "
								+ "       END                 AS 'mediclaim', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 213 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS otherDed "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 213 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS otherDed) "
								+ "       END                 AS 'otherDed', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 223 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS membDed "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 223 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS membDed) "
								+ "       END                 AS 'membDed', "
								+ "       "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 228 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS tds "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 228 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS tds) "
								+ "       END                 AS 'tds', "
								+ "        "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd in (220,221) "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS mlwf "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 211 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS mlwf) "
								+ "       END                 AS 'mlwf', "
								+ "        "
								+ "        "
								+ "        "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 248 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS bankLoan "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 248 "
								+ "                 AND trndt BETWEEN "
								+ "                    '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS bankLoan) "
								+ "       END                 AS 'bankLoan', "
								+ "        "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT net_amt "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd = 226 "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN "
								+ "         (SELECT net_amt AS otherLoan "
								+ "          FROM   paytran_stage "
								+ "          WHERE  trncd = 226 "
								+ "                 AND trndt BETWEEN "
								+ "                     '"+BomDt+"' AND '"+EomDt+"' "
								+ "                 AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS otherLoan) "
								+ "       END                 AS 'otherLoan', "
								+ "        "
								+ "       CASE "
								+ "         WHEN EXISTS(SELECT Sum(net_amt) "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd IN (SELECT trncd "
								+ "                                      FROM   cdmast "
								+ "                                      WHERE  pslipyn = 'Y' "
								+ "                                             AND trncd BETWEEN 201 AND 299) "
								+ "                            AND trncd NOT IN( 201, 202, 205, 221, "
								+ "                                              223, 228,220,248,212, "
								+ "                                               226, 213 "
								+ "                                               ) "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN (SELECT "
								+ "         Sum(net_amt) AS other  FROM   paytran_stage "
								+ "                          WHERE "
								+ "         trncd IN (SELECT trncd "
								+ "                   FROM   cdmast "
								+ "                   WHERE  pslipyn = 'Y' "
								+ "                          AND trncd BETWEEN 201 AND 299) "
								+ "         AND trncd NOT IN( 201, 202, 205, 221,212 , "
								+ "                           223, 228,  220, "
								+ "                           226,  213,248 ) "
								+ "         AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "         AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS other) "
								+ "       END                 AS 'other', "
								+ "       CASE "
								+ "        "
								+ "         WHEN EXISTS(SELECT Sum(net_amt) "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd IN (SELECT trncd "
								+ "                                      FROM   cdmast "
								+ "                                      WHERE  pslipyn = 'Y' "
								+ "                                             AND trncd BETWEEN 201 AND 299) "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN (SELECT "
								+ "         Sum(net_amt) AS totded "
								+ "                                                             FROM   paytran_stage "
								+ "                                                             WHERE "
								+ "         trncd IN (SELECT trncd "
								+ "                   FROM   cdmast "
								+ "                   WHERE  pslipyn = 'Y' "
								+ "                          AND trncd BETWEEN 201 AND 299) "
								+ "         AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "         AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS totded) "
								+ "       END                 AS 'totded', "
								+ "       CASE "
								+ "        "
								+ "        "
								+ "         WHEN EXISTS(SELECT Sum(net_amt) "
								+ "                     FROM   paytran_stage "
								+ "                     WHERE  trncd IN (SELECT trncd "
								+ "                                      FROM   cdmast "
								+ "                                      WHERE  pslipyn = 'Y' "
								+ "                                             AND trncd BETWEEN 100 AND 198) "
								+ "                            AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "                            AND empno = empmast.empno) THEN (SELECT Sum(net_amt) "
								+ "                                                             FROM   paytran_stage "
								+ "                                                             WHERE "
								+ "         trncd IN (SELECT trncd "
								+ "                   FROM   cdmast "
								+ "                   WHERE  pslipyn = 'Y' "
								+ "                          AND trncd BETWEEN 100 AND 198) "
								+ "         AND trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"' "
								+ "         AND empno = empmast.empno) "
								+ "         ELSE (SELECT 0 AS totear) "
								+ "       END                 AS 'totear' "
								+ "        "
								+ "         "
								+ "FROM   empmast empmast "
								+ "       JOIN emptran t "
								+ "         ON t.empno = empmast.empno "
								+ "WHERE  T.srno = (SELECT Max(E2.srno) "
								+ "                 FROM   emptran E2 "
								+ "                 WHERE  E2.empno = empmast.empno "
								+ "                        AND E2.effdate <= '"+EomDt+"' "
								+ "                        AND ( ( empmast.status = 'A' "
								+ "                                AND empmast.doj <= '"+EomDt+"' ) "
								+ "                               OR ( empmast.status = 'N' "
								+ "                                    AND empmast.dol >= '"+BomDt+"' ) )) "
								+ "       AND T.empno IN (SELECT DISTINCT empno "
								+ "                       FROM   paytran_stage "
								+ "                       WHERE  trndt BETWEEN '"+BomDt+"' AND '"+EomDt+"')"
								+constant+" "
									+ "     order by  empno  ";
								
							System.out.println(EmpSql);
						}
					}

		
				rs = st.executeQuery(EmpSql);
				 int count=0;
				while (rs.next()) {
					System.out.println("Govi "+(++count));
					String prj_name = null;
					String prj_code = null;
		
					Connection conn = ConnectionManager.getConnectionTech();
		
					Statement stmt = conn.createStatement();
					String prjquery = "select Site_Name,Project_Code from Project_Sites where SITE_ID = '"
							+ rs.getString("PRJ_SRNO") + "'";
					// System.out.println(prjquery);
		
					ResultSet prj = stmt.executeQuery(prjquery);
		
					if (prj.next()) {
						prj_name = prj.getString("Site_Name");
						prj_code = prj.getString("Project_Code");
					}
		
					pBrcd1 = rs.getString("PRJ_SRNO");
					br_tot_no_emp = 0;
		
					para = new Paragraph(new Phrase(
							"Employee's Salary List For Project Site : " + prj_name + " (" + prj_code + ")", f));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(4);
		
					document.add(para);
		
					prj.close();
					stmt.close();
					conn.close();
		
					PdfPTable datatab;
					PdfPTable datatot;
		
					PdfPTable main = new PdfPTable(15);
					main.setSpacingBefore(10);
					main.setWidthPercentage(new float[] { 5, 17.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f,
							6.0f, 6.0f, 6.0f, 6.0f, 6.0f }, rec);
		
					main.setHorizontalAlignment(Element.ALIGN_LEFT);
					PdfPCell maincell;
		
					maincell = new PdfPCell(new Phrase("CODE", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					maincell.setFixedHeight(50);
					maincell.disableBorderSide(rec.BOTTOM);
					main.addCell(maincell);
		
					maincell = new PdfPCell(new Phrase("EMPNAME", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					maincell.disableBorderSide(rec.BOTTOM);
					main.addCell(maincell);
		
					maincell = new PdfPCell(new Phrase("Basic", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
		
					maincell = new PdfPCell(new Phrase("DA", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
		
					maincell = new PdfPCell(new Phrase("HRA", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
		
					maincell = new PdfPCell(new Phrase("Dept All", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
		
					maincell = new PdfPCell(new Phrase("Conv All", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
		
					maincell = new PdfPCell(new Phrase("Other Spl All", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
		
					maincell = new PdfPCell(new Phrase("Add Income", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
		
					maincell = new PdfPCell(new Phrase("", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
		
					maincell = new PdfPCell(new Phrase("", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
		
					maincell = new PdfPCell(new Phrase("", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
		
					maincell = new PdfPCell(new Phrase("", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
		
					maincell = new PdfPCell(new Phrase("Tot income", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
		
					maincell = new PdfPCell(new Phrase("", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
		
					document.add(main);
		
					datatab = new PdfPTable(15);
					datatab.setWidthPercentage(new float[] { 5, 17.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f,
							6.0f, 6.0f, 6.0f, 6.0f, 6.0f }, rec);
		
					datatab.setHorizontalAlignment(Element.ALIGN_LEFT);
		
					PdfPCell maincell1 = new PdfPCell(new Phrase("", fbold));
					maincell1.disableBorderSide(rec.TOP);
					maincell1.setFixedHeight(50);
					datatab.addCell(maincell1);
		
					PdfPCell maincell2 = new PdfPCell(new Phrase("", fbold));
					maincell2.disableBorderSide(rec.TOP);
					maincell2.setFixedHeight(50);
					datatab.addCell(maincell2);
		
					PdfPCell maincell3 = new PdfPCell(new Phrase("PF", fbold));
					maincell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell3);
		
					PdfPCell maincell4 = new PdfPCell(new Phrase("PT", fbold));
					maincell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell4);
		
					PdfPCell maincell5 = new PdfPCell(new Phrase("LIC", fbold));
					maincell5.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell5);
		
					PdfPCell maincell6 = new PdfPCell(new Phrase("Mediclaim", fbold));
					maincell6.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell6);
		
					PdfPCell maincell7 = new PdfPCell(new Phrase("Other Ded", fbold));
					maincell7.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell7);
		
					PdfPCell maincell8 = new PdfPCell(new Phrase("Mem Ded", fbold));
					maincell8.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell8);
		
					PdfPCell maincell9 = new PdfPCell(new Phrase("TDS", fbold));
					maincell9.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell9);
		
					PdfPCell maincell10 = new PdfPCell(new Phrase("MLWF", fbold));
					maincell10.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell10);
		
					PdfPCell maincell11 = new PdfPCell(new Phrase("Bank Loan", fbold));
					maincell11.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell11);
		
					PdfPCell maincell12 = new PdfPCell(new Phrase("Other Loan", fbold));
					maincell12.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell12);
		
					PdfPCell maincell111 = new PdfPCell(new Phrase("Other", fbold));
					maincell111.disableBorderSide(rec.TOP);
					maincell111.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell111);
		
					PdfPCell maincell13 = new PdfPCell(new Phrase("Tot Ded", fbold));
					maincell13.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell13);
		
					PdfPCell maincell14 = new PdfPCell(new Phrase("Net Pay", fbold));
					maincell14.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell14);
		
					document.add(datatab);
		
					while (pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
						System.out.println("this is pbrcd...." + pBrcd1);
						float pageHeight = writer.getPageSize().getHeight();
		
						datatab = new PdfPTable(15);
						datatab.setWidthPercentage(new float[] { 5, 17.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f,
								6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f }, rec);
		
						datatab.setHorizontalAlignment(Element.ALIGN_LEFT);
		
						PdfPCell cell1 = new PdfPCell(new Phrase("" + rs.getString("EMPCODE"), f1));
						cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						cell1.setFixedHeight(50);
						cell1.disableBorderSide(rec.BOTTOM);
						datatab.addCell(cell1);
		
						PdfPCell cell2 = new PdfPCell(new Phrase("" + rs.getString("name"), f));
						cell2.disableBorderSide(rec.BOTTOM);
						cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						datatab.addCell(cell2);
		
						basic_total = basic_total + rs.getFloat("BASIC");
						PdfPCell cell3 = new PdfPCell(new Phrase("" + rs.getFloat("BASIC"), f1));
						cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell3);
		
						da_total = da_total + rs.getFloat("DA");
						PdfPCell cell4 = new PdfPCell(new Phrase("" + rs.getFloat("DA"), f1));
						cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell4);
		
						hra_total = hra_total + +rs.getFloat("HRA");
						PdfPCell cell11 = new PdfPCell(new Phrase("" + rs.getFloat("HRA"), f1));
						cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell11);
		
						deptall_total = deptall_total + rs.getFloat("DeptAllw");
						PdfPCell cell5 = new PdfPCell(new Phrase("" + rs.getFloat("DeptAllw"), f1));
						cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell5);
		
						convall_total = convall_total + rs.getFloat("ConvyAllw");
						PdfPCell cell8 = new PdfPCell(new Phrase("" + rs.getFloat("ConvyAllw"), f1));
						cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell8);
		
						othersplall_total = othersplall_total + rs.getFloat("OtherSpclAllw");
						PdfPCell cell6 = new PdfPCell(new Phrase("" + rs.getFloat("OtherSpclAllw"), f1));
						cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell6);
		
						float add_inc = rs.getFloat("addinc");
						addinc_total = addinc_total + add_inc;
						PdfPCell cell23 = new PdfPCell(new Phrase("" + (int) add_inc + ".0", f1));
						cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell23);
		
						PdfPCell cell2226 = new PdfPCell(new Phrase("", f1));
						cell2226.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell2226);
		
						PdfPCell cell2227 = new PdfPCell(new Phrase("", f1));
						cell2227.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell2227);
		
						PdfPCell cell2301 = new PdfPCell(new Phrase("", f1));
						cell2301.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell2301);
		
						PdfPCell cell2302 = new PdfPCell(new Phrase("", f1));
						cell2302.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell2302);
		
						totinc_total = totinc_total + rs.getFloat("totear");
						PdfPCell cell25 = new PdfPCell(new Phrase("" + (int) rs.getFloat("totear") + ".0", f1));
						cell25.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell25);
		
						PdfPCell cell2228 = new PdfPCell(new Phrase("", f1));
						cell2228.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell2228);
		
						document.add(datatab);
		
						datatab = new PdfPTable(15);
						datatab.getDefaultCell().setBorder(PdfPCell.NO_BORDER);
						datatab.setWidthPercentage(new float[] { 5, 17.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f,
								6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f }, rec);
		
						datatab.setHorizontalAlignment(Element.ALIGN_LEFT);
		
						PdfPCell cell113 = new PdfPCell(new Phrase("", f1));
						cell113.setFixedHeight(50);
						cell113.disableBorderSide(rec.TOP);
						datatab.addCell(cell113);
		
						PdfPCell cell213 = new PdfPCell(new Phrase("", f1));
						cell213.disableBorderSide(rec.TOP);
						datatab.addCell(cell213);
		
						if (rs.getFloat("PF") == 0.0) {
							PdfPCell cell13 = new PdfPCell(new Phrase("" + rs.getFloat("PF"), f1));
							cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell13);
						} else {
							float pf = rs.getFloat("PF");
							pf_total = pf_total + pf;
							PdfPCell cell13 = new PdfPCell(new Phrase("" + pf, f1));
							cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell13);
						}
		
						if (rs.getFloat("PT") == 0.0f) {
							PdfPCell cell17 = new PdfPCell(new Phrase("" + rs.getFloat("PT"), f1));
							cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell17);
						} else {
							float pt = rs.getFloat("PT");
							pt_total = pt_total + pt;
							PdfPCell cell17 = new PdfPCell(new Phrase("" + pt, f1));
							cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell17);
						}
		
						if (rs.getFloat("LIC") == 0.0) {
							PdfPCell cell14 = new PdfPCell(new Phrase("" + rs.getFloat("LIC"), f1));
							cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell14);
						} else {
							float lic = rs.getFloat("LIC");
							lic_total = lic_total + lic;
							PdfPCell cell14 = new PdfPCell(new Phrase("" + lic, f1));
							cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell14);
						}
		
						if (rs.getFloat("mediclaim") == 0.0f) {
							PdfPCell cell22 = new PdfPCell(new Phrase("" + rs.getFloat("mediclaim"), f1));
							cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell22);
						} else {
							float mediclaim = rs.getFloat("mediclaim");
							mediclaim_total = mediclaim_total + mediclaim;
							PdfPCell cell22 = new PdfPCell(new Phrase("" + mediclaim, f1));
							cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell22);
						}
		
						if (rs.getFloat("otherDed") == 0.0f) {
							PdfPCell cell19 = new PdfPCell(new Phrase("" + rs.getFloat("otherDed"), f1));
							cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell19);
						} else {
							float otherded = rs.getFloat("otherDed");
							otherded_total = otherded_total + otherded;
							PdfPCell cell19 = new PdfPCell(new Phrase("" + otherded, f1));
							cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell19);
						}
		
						if (rs.getFloat("membDed") == 0.0) {
							PdfPCell cell16 = new PdfPCell(new Phrase("" + rs.getFloat("membDed"), f1));
							cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell16);
						} else {
							float memded = rs.getFloat("membDed");
							memded_total = memded_total + memded;
							PdfPCell cell16 = new PdfPCell(new Phrase("" + memded, f1));
							cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell16);
						}
		
						if (rs.getFloat("TDS") == 0.0f) {
							PdfPCell cell18 = new PdfPCell(new Phrase("" + rs.getFloat("TDS"), f1));
							cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell18);
						} else {
							float tds = rs.getFloat("TDS");
							tds_total = tds_total + tds;
							PdfPCell cell18 = new PdfPCell(new Phrase("" + tds, f1));
							cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell18);
						}
		
						if (rs.getFloat("MLWF") == 0.0f) {
							PdfPCell cell21 = new PdfPCell(new Phrase("" + rs.getFloat("MLWF"), f1));
							cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell21);
						} else {
							float mlwf = rs.getFloat("MLWF");
							mlwf_total = mlwf_total + mlwf;
							PdfPCell cell21 = new PdfPCell(new Phrase("" + mlwf, f1));
							cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell21);
						}
		
						if (rs.getFloat("bankLoan") == 0.0) {
							PdfPCell cell15 = new PdfPCell(new Phrase("" + rs.getFloat("bankLoan"), f1));
							cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell15);
						} else {
							float bankloan = rs.getFloat("bankLoan");
							bankloan_total = bankloan_total + bankloan;
							PdfPCell cell15 = new PdfPCell(new Phrase("" + bankloan, f1));
							cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell15);
						}
		
						if (rs.getFloat("otherLoan") == 0.0f) {
							PdfPCell cell20 = new PdfPCell(new Phrase("" + rs.getFloat("otherLoan"), f1));
							cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell20);
						} else {
							float otherloan = rs.getFloat("otherLoan");
							otherloan_total = otherloan_total + otherloan;
							PdfPCell cell20 = new PdfPCell(new Phrase("" + otherloan, f1));
							cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell20);
						}
		
						other_total = other_total + rs.getFloat("other");
						PdfPCell cell2131 = new PdfPCell(new Phrase("" + rs.getFloat("other"), f1));
						cell2131.disableBorderSide(rec.TOP);
						cell2131.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell2131);
		
						totded_total = totded_total + rs.getFloat("totded");
						PdfPCell cell26 = new PdfPCell(new Phrase("" + (int) rs.getFloat("totded") + ".0", f1));
						cell26.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell26);
		
						netpay_total = totinc_total - totded_total;
						// netpay_total = netpay_total + rs.getFloat("payable");
						System.out.println("Net Pay Total Old is:- " + netpay_total);
						// System.out.println("Add Income is:-
						// "+rs.getFloat("addinc"));
						PdfPCell cell27 = new PdfPCell(new Phrase("" + (int) rs.getFloat("payable") + ".0", f1));
						cell27.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell27);
		
						document.add(datatab);
		
						// Total of columns ...............
		
						tot_no_emp = tot_no_emp + 1;
						br_tot_no_emp = br_tot_no_emp + 1;
						if (!rs.next()) {
							break;
						}
						if (!pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
							rs.previous();
							break;
						}
					}
		
					datatot = new PdfPTable(15);
					datatot.setWidthPercentage(new float[] { 5, 17.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f,
							6.0f, 6.0f, 6.0f, 6.0f, 6.0f }, rec);
		
					datatot.setHorizontalAlignment(Element.ALIGN_LEFT);
		
					PdfPCell cell1 = new PdfPCell(new Phrase("Total Income:--", fbold));
					cell1.setColspan(2);
					cell1.setFixedHeight(50);
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell1);
		
					PdfPCell cell3 = new PdfPCell(new Phrase("" + basic_total, f1));
					cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell3);
					lstbasic_total = lstbasic_total + basic_total;
					basic_total = 0.0f;
		
					PdfPCell cell4 = new PdfPCell(new Phrase("" + da_total, f1));
					cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell4);
					lstda_total = lstda_total + da_total;
					da_total = 0.0f;
		
					PdfPCell cell11 = new PdfPCell(new Phrase("" + hra_total, f1));
					cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell11);
					lsthra_total = lsthra_total + hra_total;
					hra_total = 0.0f;
		
					PdfPCell cell5 = new PdfPCell(new Phrase("" + deptall_total, f1));
					cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell5);
					lstdeptall_total = lstdeptall_total + deptall_total;
					deptall_total = 0.0f;
		
					PdfPCell cell8 = new PdfPCell(new Phrase("" + convall_total, f1));
					cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell8);
					lstconvall_total = lstconvall_total + convall_total;
					convall_total = 0.0f;
		
					PdfPCell cell6 = new PdfPCell(new Phrase("" + othersplall_total, f1));
					cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell6);
					lstothersplall_total = lstothersplall_total + othersplall_total;
					othersplall_total = 0.0f;
		
					PdfPCell cell23 = new PdfPCell(new Phrase("" + (int) addinc_total + ".0", f1));
					cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell23);
					lstaddinc_total = lstaddinc_total + addinc_total;
					addinc_total = 0.0f;
		
					PdfPCell cellempty1 = new PdfPCell(new Phrase("", fbold));
					cellempty1.setFixedHeight(50);
					cellempty1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cellempty1);
		
					PdfPCell cellempty2 = new PdfPCell(new Phrase("", fbold));
					cellempty2.setFixedHeight(50);
					cellempty2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cellempty2);
		
					PdfPCell cellempty3 = new PdfPCell(new Phrase("", fbold));
					cellempty3.setFixedHeight(50);
					cellempty3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cellempty3);
		
					PdfPCell cellempty4 = new PdfPCell(new Phrase("", fbold));
					cellempty4.setFixedHeight(50);
					cellempty4.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cellempty4);
		
					PdfPCell cell25 = new PdfPCell(new Phrase("" + (int) totinc_total + ".0", fbold));
					cell25.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell25);
		
					System.out.println("~~~~~~~~before adding sitewise income~~~~~~~~~" + lsttotinc_total);
		
					lsttotinc_total = lsttotinc_total + totinc_total;
		
					System.out.println("@@@@@@@@@@@@@@@BRANCH ID--------->" + prj_name + "#####TOTAL INCOME------>"
							+ totinc_total);
					System.out.println("~~~~~~~~after adding sitewise income~~~~~~~~~" + lsttotinc_total);
		
					totinc_total = 0.0f;
		
					PdfPCell cell28 = new PdfPCell(new Phrase("Net Pay", fbold));
					cell28.setFixedHeight(50);
					cell28.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell28);
		
					document.add(datatot);
		
					datatot = new PdfPTable(15);
					datatot.setWidthPercentage(new float[] { 5, 17.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f, 6.0f,
							6.0f, 6.0f, 6.0f, 6.0f, 6.0f }, rec);
		
					datatot.setHorizontalAlignment(Element.ALIGN_LEFT);
		
					PdfPCell cell0 = new PdfPCell(new Phrase("Total Deduction:--", fbold));
					cell0.setColspan(2);
					cell0.setFixedHeight(50);
					cell0.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell0);
		
					PdfPCell cell13 = new PdfPCell(new Phrase("" + pf_total, f1));
					cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell13);
					lstpf_total = lstpf_total + pf_total;
					pf_total = 0.0f;
		
					PdfPCell cell17 = new PdfPCell(new Phrase("" + pt_total, f1));
					cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell17);
					lstpt_total = lstpt_total + pt_total;
					pt_total = 0.0f;
		
					PdfPCell cell14 = new PdfPCell(new Phrase("" + lic_total, f1));
					cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell14);
					lstlic_total = lstlic_total + lic_total;
					lic_total = 0.0f;
		
					PdfPCell cell20 = new PdfPCell(new Phrase("" + mediclaim_total, f1));
					cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell20);
					lstmediclaim_total = lstmediclaim_total + mediclaim_total;
					mediclaim_total = 0.0f;
		
					PdfPCell cell19 = new PdfPCell(new Phrase("" + otherded_total, f1));
					cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell19);
					lstotherded_total = lstotherded_total + otherded_total;
					otherded_total = 0.0f;
		
					PdfPCell cell16 = new PdfPCell(new Phrase("" + memded_total, f1));
					cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell16);
					lstmemded_total = lstmemded_total + memded_total;
					memded_total = 0.0f;
		
					PdfPCell cell18 = new PdfPCell(new Phrase("" + tds_total, f1));
					cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell18);
					lsttds_total = lsttds_total + tds_total;
					tds_total = 0.0f;
		
					PdfPCell cell22 = new PdfPCell(new Phrase("" + mlwf_total, f1));
					cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell22);
					lstmlwf_total = lstmlwf_total + mlwf_total;
					mlwf_total = 0.0f;
		
					PdfPCell cell15 = new PdfPCell(new Phrase("" + bankloan_total, f1));
					cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell15);
					lstbankloan_total = lstbankloan_total + bankloan_total;
					bankloan_total = 0.0f;
		
					PdfPCell cell21 = new PdfPCell(new Phrase("" + otherloan_total, f1));
					cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell21);
					lstotherloan_total = lstotherloan_total + otherloan_total;
					otherloan_total = 0.0f;
		
					PdfPCell cell131 = new PdfPCell(new Phrase("" + other_total, f1));
					cell131.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell131);
					lstother_total = lstother_total + other_total;
					other_total = 0.0f;
		
					PdfPCell cell26 = new PdfPCell(new Phrase("" + totded_total, fbold));
					cell26.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell26);
					lsttotded_total = lsttotded_total + totded_total;
		
					System.out.println("@@@@@@@@@@@@@@@BRANCH ID--------->" + prj_name + "#####TOTAL INCOME------>"
							+ totded_total);
		
					totded_total = 0.0f;
		
					PdfPCell cell27 = new PdfPCell(new Phrase("" + (int) netpay_total + ".0", fbold));
					cell27.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell27);
					lstnetpay_total = lstnetpay_total + netpay_total;
		
					System.out.println("@@@@@@@@@@@@@@@BRANCH ID--------->" + prj_name + "#####TOTAL INCOME------>"
							+ netpay_total);
		
					netpay_total = 0.0f;
		
					document.add(datatot);
		
					para = new Paragraph(new Phrase("No Of Employee :- " + br_tot_no_emp, f));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(20);
					
					
					document.add(para);
		
				}
		
				para = new Paragraph(new Phrase("Total No Of Employee :- " + tot_no_emp, f));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(40);
				document.add(para);
		
				System.out.println("Total No Of Employee :- " + tot_no_emp);
		
				para = new Paragraph(new Phrase("-:Summary :- ", new Font(Font.HELVETICA, 40, Font.BOLDITALIC)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);
				document.add(para);
		
				PdfPTable main = new PdfPTable(10);
				main.setSpacingBefore(10);
				main.setWidthPercentage(new float[] { 9, 9, 9, 9, 9, 9, 9, 9, 9, 9 }, rec);
				PdfPCell maincell;
		
				maincell = new PdfPCell(new Phrase(" Basic Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lstbasic_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase(" DA Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lstda_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase(" HRA Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lsthra_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase(" Dept All Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lstdeptall_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase(" Conv All Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lstconvall_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase(" Other Spl All Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lstothersplall_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase(" Add Income Total:-", f));
				maincell.setFixedHeight(50);
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lstaddinc_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase(" PF Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lstpf_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase(" PT Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lstpt_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase(" LIC Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lstlic_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase(" Mediclaim Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lstmediclaim_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase(" Other Ded Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lstotherded_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase(" Member Ded Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lstmemded_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase(" TDS Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lsttds_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase(" MLWF Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lstmlwf_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase(" Bank Loan Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lstbankloan_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase(" Other Loan Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lstotherloan_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("Other :-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lstother_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				// empty col
				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase(" Tot income Total:-", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lsttotinc_total), "", "", false, false), fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase(" Tot Ded. Total:-", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lsttotded_total), "", "", false, false), fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase(" Net Pay Total:-", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				float tttt = 0;
				ResultSet rsss;
				try {
					// System.out.println("date===="+date);
					Statement sttt = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);
					rs = st.executeQuery("select sum(net_amt) from paytran where trndt between '"
							+ ReportDAO.BOM(PGRDT) + "' and '" + ReportDAO.EOM(PGRDT)
							+ "'  and trncd=999  union  "
							+ "select sum(net_amt) from paytran_stage where trndt between '" + ReportDAO.BOM(PGRDT)
							+ "' and '" + ReportDAO.EOM(PGRDT) + "'  and trncd=999 ");
		
					while (rs.next()) {
						tttt += rs.getFloat(1);
					}
				} catch (Exception e) {
					e.printStackTrace();
				}
		
				maincell = new PdfPCell(new Phrase("" + trans((int) (lsttotinc_total-lsttotded_total), "", "", false, false), fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("", fbold));
		
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("", fbold));
		
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
		
				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);
		
				document.add(main);
		
				document.add(Chunk.NEWLINE);
				document.add(Chunk.NEWLINE);
				document.add(Chunk.NEWLINE);
				document.add(Chunk.NEWLINE);
		
				para = new Paragraph(new Phrase(
						"Prepared By                         Checked By                        Approved By                 ",
						new Font(Font.TIMES_ROMAN, 35, Font.BOLD)));
				para.setAlignment(Element.ALIGN_RIGHT);
				para.setSpacingBefore(30);
				document.add(para);
		
				stmtInsert.close();
				stmtTrnct.close();
				st.close();
				Cn.close();
				document.close();
		
			
			}

	catch (Exception e) {
		e.printStackTrace();
	}


	
	
}//function

public static void SocietyEmpListPDF(String rdt, String filepath) 
{
	RepoartBean repBean = new RepoartBean();
	Connection Cn = null;
	ResultSet emp = null;
	String EmpSql = "";
	SimpleDateFormat output = new SimpleDateFormat("dd/MM/yyyy");

	try {

		Document doc = new Document();
		PdfWriter writer = PdfWriter.getInstance(doc, new FileOutputStream(filepath));
		doc.open();
		doc.setPageSize(PageSize.A4);
		Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new GrayColor(0.75f));

		Phrase title = new Phrase("THE BUSINESS CO.OP BANK LTD.", new Font(FONT.TIMES_ROMAN, 8, Font.BOLD));
		Paragraph para = new Paragraph(title);
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingBefore(0);
		doc.add(para);
		para = new Paragraph(new Phrase(
				"Rajan Complex Arcade, Datta Mandir Circle, Nashik Road, Nashik - 422101",
				new Font(Font.TIMES_ROMAN, 8)));
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingAfter(0);

		doc.add(para);
		para = new Paragraph(
				new Phrase("Tel : 0253-2406100, 2469545", new Font(Font.TIMES_ROMAN, 8)));
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingAfter(0);

		doc.add(para);
//		para = new Paragraph(new Phrase("Email : hrd@namcobank.in", new Font(Font.TIMES_ROMAN, 8)));
//		para.setAlignment(Element.ALIGN_CENTER);
//		para.setSpacingAfter(0);
//
//		doc.add(para);
		para = new Paragraph(new Phrase(
				"Society Employee List - " + rdt.substring(3) + "  "+ " ",
				new Font(Font.TIMES_ROMAN, 10)));
		para.setAlignment(Element.ALIGN_CENTER);
		para.setSpacingAfter(0);
		doc.add(para);

		PdfPTable tab = new PdfPTable(7);

		tab.setWidthPercentage(new float[] { 10, 10, 40, 10, 10, 10, 20 }, new Rectangle(100, 100));
		tab.setSpacingBefore(5);
		tab.setHorizontalAlignment(Element.ALIGN_CENTER);
		tab.addCell(new Phrase("  Sr No", new Font(Font.TIMES_ROMAN, 10)));
		tab.addCell(new Phrase("  Emp Code", new Font(Font.TIMES_ROMAN, 10)));
		tab.addCell(new Phrase("  Employee Name", new Font(Font.TIMES_ROMAN, 10)));
		tab.addCell(new Phrase("  DOB", new Font(Font.TIMES_ROMAN, 10)));
		tab.addCell(new Phrase("  AGE", new Font(Font.TIMES_ROMAN, 10)));
		tab.addCell(new Phrase("  GENDER", new Font(Font.TIMES_ROMAN, 10)));
		tab.addCell(new Phrase("  AADHAR NUMBER", new Font(Font.TIMES_ROMAN, 10)));
		
		tab.setHeaderRows(1);
		
		ReportDAO.OpenCon("", "", "", repBean);
		Cn = repBean.getCn();

	EmpSql = "SELECT E.EMPNO, E.EMPCODE, (L.LKP_DISC+' '+E.FNAME+' '+E.MNAME+' '+E.LNAME) AS NAME, E.GENDER,E.DOB, E.AADHAARNUM, "
				+ "DATEDIFF(YEAR,DOB,'" + ReportDAO.EOM(rdt)+"') AS AGE FROM empmast E, YTDTRAN Y, LOOKUP L "
				+ "WHERE E.EMPNO=Y.EMPNO AND E.SALUTE=L.LKP_SRNO AND LKP_CODE='SALUTE' AND Y.TRNCD=206  "
				+ "AND Y.TRNDT between '" + ReportDAO.BOM(rdt) + "' and '" + ReportDAO.EOM(rdt)+"' AND Y.NET_AMT<>0";
		
		Statement st;
		System.out.println("EmpSql ----" + EmpSql);
		st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);
		emp = st.executeQuery(EmpSql);
		if (!emp.next()) {
			System.out.println("No Any Record Found");
			return;
		}

		int count1 = 1;
		emp.previous();
		int i;
		int count = 1;
		emp.previous();
		int k = 0;
		while (emp.next()) {

			k++;

				tab.addCell(new Phrase("  " + count++, new Font(Font.TIMES_ROMAN, 8)));
				tab.addCell(new Phrase("  " +emp.getString("EMPCODE"), new Font(Font.TIMES_ROMAN, 8)));
				tab.addCell(new Phrase("  " +emp.getString("NAME"), new Font(Font.TIMES_ROMAN, 8)));
				tab.addCell(new Phrase("  " +emp.getString("DOB"), new Font(Font.TIMES_ROMAN, 8)));
				tab.addCell(new Phrase("  " +emp.getString("AGE"), new Font(Font.TIMES_ROMAN, 8)));
				tab.addCell(new Phrase("  " +emp.getString("GENDER"), new Font(Font.TIMES_ROMAN, 8)));
				tab.addCell(new Phrase("  " +emp.getString("AADHAARNUM"), new Font(Font.TIMES_ROMAN, 8)));
		}
		
		PdfPCell tot = new PdfPCell(new Phrase("Total Employee :", new Font(Font.TIMES_ROMAN, 8)));
		tot.setHorizontalAlignment(Element.ALIGN_CENTER);
		tot.setColspan(3);
		tab.addCell(tot);
		PdfPCell totdisp = new PdfPCell(new Phrase("" + k, new Font(Font.TIMES_ROMAN, 8)));
		totdisp.setHorizontalAlignment(Element.ALIGN_CENTER);
		totdisp.setColspan(4);
		tab.addCell(totdisp);

		doc.add(tab);

		doc.close();
		Cn.close();
		return;
	} catch (Exception e) {
		e.printStackTrace();
	}

}
		

}




	


	


